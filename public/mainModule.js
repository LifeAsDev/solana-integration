/*! For license information please see mainModule.js.LICENSE.txt */
var e,t,r={22:(e,t,r)=>{const n=r(8341).v4,i=r(3289),s=function(e,t){if(!(this instanceof s))return new s(e,t);t||(t={}),this.options={reviver:void 0!==t.reviver?t.reviver:null,replacer:void 0!==t.replacer?t.replacer:null,generator:void 0!==t.generator?t.generator:function(){return n()},version:void 0!==t.version?t.version:2,notificationIdNull:"boolean"==typeof t.notificationIdNull&&t.notificationIdNull},this.callServer=e};e.exports=s,s.prototype.request=function(e,t,r,n){const s=this;let o=null;const a=Array.isArray(e)&&"function"==typeof t;if(1===this.options.version&&a)throw new TypeError("JSON-RPC 1.0 does not support batching");if(a||!a&&e&&"object"==typeof e&&"function"==typeof t)n=t,o=e;else{"function"==typeof r&&(n=r,r=void 0);const s="function"==typeof n;try{o=i(e,t,r,{generator:this.options.generator,version:this.options.version,notificationIdNull:this.options.notificationIdNull})}catch(e){if(s)return n(e);throw e}if(!s)return o}let c;try{c=JSON.stringify(o,this.options.replacer)}catch(e){return n(e)}return this.callServer(c,function(e,t){s._parseResponse(e,t,n)}),o},s.prototype._parseResponse=function(e,t,r){if(e)return void r(e);if(!t)return r();let n;try{n=JSON.parse(t,this.options.reviver)}catch(e){return r(e)}if(3===r.length){if(Array.isArray(n)){const e=function(e){return void 0!==e.error},t=function(t){return!e(t)};return r(null,n.filter(e),n.filter(t))}return r(null,n.error,n.result)}r(null,n)}},36:(e,t,r)=>{r.d(t,{s:()=>l});var n=r(3450),i=r(5595),s=r(6056),o=r(1211),a=r(8075),c=r(4496);const l={async getTokenList(e){const t=await i.T.fetchSwapTokens({chainId:e});return t?.tokens?.map(e=>({...e,eip2612:!1,quantity:{decimals:"0",numeric:"0"},price:0,value:0}))||[]},async fetchGasPrice(){const e=s.W.state.activeCaipNetwork;if(!e)return null;try{if("solana"===e.chainNamespace){const e=(await(o.x?.estimateGas({chainNamespace:"solana"})))?.toString();return{standard:e,fast:e,instant:e}}return await i.T.fetchGasPrice({chainId:e.caipNetworkId})}catch{return null}},async fetchSwapAllowance({tokenAddress:e,userAddress:t,sourceTokenAmount:r,sourceTokenDecimals:n}){const s=await i.T.fetchSwapAllowance({tokenAddress:e,userAddress:t});if(s?.allowance&&r&&n){const e=o.x.parseUnits(r,n)||0;return BigInt(s.allowance)>=e}return!1},async getMyTokensWithBalance(e){const t=await a.Z.getMyTokensWithBalance(e);return n.U.setTokenBalance(t,s.W.state.activeChain),this.mapBalancesToSwapTokens(t)},mapBalancesToSwapTokens:e=>e?.map(e=>({...e,address:e?.address?e.address:(0,c.K1)(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1}))||[]}},148:(e,t,r)=>{r.d(t,{z8:()=>n,tt:()=>l,Zv:()=>s.Z,EM:()=>u.E,RF:()=>i.RF,JX:()=>i.JX,ds:()=>i.ds});const n={interpolate(e,t,r){if(2!==e.length||2!==t.length)throw new Error("inputRange and outputRange must be an array of length 2");const n=e[0]||0,i=e[1]||0,s=t[0]||0,o=t[1]||0;return r<n?s:r>i?o:(o-s)/(i-n)*(r-n)+s}};var i=r(6109),s=r(3612),o=r(8169);const a=["receive","deposit","borrow","claim"],c=["withdraw","repay","burn"],l={getTransactionGroupTitle(e,t){const r=o.r.getYear(),n=o.r.getMonthNameByIndex(t);return e===r?n:`${n} ${e}`},getTransactionImages(e){const[t,r]=e,n=Boolean(t)&&e?.every(e=>Boolean(e.nft_info)),i=e?.length>1;return 2!==e?.length||n?i?e.map(e=>this.getTransactionImage(e)):[this.getTransactionImage(t)]:[this.getTransactionImage(r),this.getTransactionImage(t)]},getTransactionImage:e=>({type:l.getTransactionTransferTokenType(e),url:l.getTransactionImageURL(e)}),getTransactionImageURL(e){let t;const r=Boolean(e?.nft_info),n=Boolean(e?.fungible_info);return e&&r?t=e?.nft_info?.content?.preview?.url:e&&n&&(t=e?.fungible_info?.icon?.url),t},getTransactionTransferTokenType:e=>e?.fungible_info?"FUNGIBLE":e?.nft_info?"NFT":void 0,getTransactionDescriptions(e){const t=e?.metadata?.operationType,r=e?.transfers,n=e?.transfers?.length>0,i=e?.transfers?.length>1,o=n&&r?.every(e=>Boolean(e?.fungible_info)),[l,u]=r;let h=this.getTransferDescription(l),d=this.getTransferDescription(u);if(!n)return"send"!==t&&"receive"!==t||!o?[e.metadata.status]:(h=s.Z.getTruncateString({string:e?.metadata.sentFrom,charsStart:4,charsEnd:6,truncate:"middle"}),d=s.Z.getTruncateString({string:e?.metadata.sentTo,charsStart:4,charsEnd:6,truncate:"middle"}),[h,d]);if(i)return r.map(e=>this.getTransferDescription(e)).reverse();let p="";return a.includes(t)?p="+":c.includes(t)&&(p="-"),h=p.concat(h),[h]},getTransferDescription(e){let t="";return e?(e?.nft_info?t=e?.nft_info?.name||"-":e?.fungible_info&&(t=this.getFungibleTransferDescription(e)||"-"),t):t},getFungibleTransferDescription(e){return e?[this.getQuantityFixedValue(e?.quantity.numeric),e?.fungible_info?.symbol].join(" ").trim():null},getQuantityFixedValue:e=>e?parseFloat(e).toFixed(3):null};var u=r(3494)},152:(e,t,r)=>{r.d(t,{OH:()=>i,Vl:()=>a,gS:()=>s,hy:()=>n,s1:()=>o});const n=("undefined"!=typeof process&&void 0!==process.env?process.env.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||"https://secure.walletconnect.org/sdk",i=("undefined"!=typeof process&&void 0!==process.env?process.env.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",s=("undefined"!=typeof process&&void 0!==process.env?process.env.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",o={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",APP_RPC_ABORT:"@w3m-app/RPC_ABORT",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",FRAME_RPC_ABORT_SUCCESS:"@w3m-frame/RPC_ABORT_SUCCESS",FRAME_RPC_ABORT_ERROR:"@w3m-frame/RPC_ABORT_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},a={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}}},184:(e,t,r)=>{r.d(t,{E:()=>m});var n=r(8126),i=r(4376),s=r(6036),o=r(6742),a=r(5905),c=r(3450),l=r(1655),u=r(6056),h=r(2733);const d=o.w.getAnalyticsUrl(),p=new a.Z({baseUrl:d,clientId:null}),f=["MODAL_CREATED"],g=(0,n.BX)({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"}}),m={state:g,subscribe:e=>(0,n.B1)(g,()=>e(g)),getSdkProperties(){const{projectId:e,sdkType:t,sdkVersion:r}=h.H.state;return{projectId:e,st:t,sv:r||"html-wagmi-4.2.2"}},async _sendAnalyticsEvent(e){try{let t=c.U.state.address;if("address"in e.data&&e.data.address&&(t=e.data.address),f.includes(e.data.event)||"undefined"==typeof window)return;const r=u.W.getActiveCaipNetwork()?.caipNetworkId;await p.post({path:"/e",params:m.getSdkProperties(),body:{eventId:o.w.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:e.timestamp,props:{...e.data,address:t,properties:{..."properties"in e.data?e.data.properties:{},caipNetworkId:r}}}}),g.reportedErrors.FORBIDDEN=!1}catch(e){e instanceof Error&&e.cause instanceof Response&&e.cause.status===i.o.HTTP_STATUS_CODES.FORBIDDEN&&!g.reportedErrors.FORBIDDEN&&(l.h.open({displayMessage:"Invalid App Configuration",debugMessage:`Origin ${(0,s.IP)()?window.origin:"uknown"} not found on Allowlist - update configuration on cloud.reown.com`},"error"),g.reportedErrors.FORBIDDEN=!0)}},sendEvent(e){g.timestamp=Date.now(),g.data=e,(h.H.state.features?.analytics||"INITIALIZE"===e.event)&&m._sendAnalyticsEvent(g)}}},221:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fromMiliseconds=t.toMiliseconds=void 0;const n=r(9026);t.toMiliseconds=function(e){return e*n.ONE_THOUSAND},t.fromMiliseconds=function(e){return Math.floor(e/n.ONE_THOUSAND)}},228:e=>{var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function s(e,t,n,s,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new i(n,s||e,o),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function o(e,t){0===--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,s=n.length,o=new Array(s);i<s;i++)o[i]=n[i].fn;return o},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,i,s,o){var a=r?r+e:e;if(!this._events[a])return!1;var c,l,u=this._events[a],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,i),!0;case 5:return u.fn.call(u.context,t,n,i,s),!0;case 6:return u.fn.call(u.context,t,n,i,s,o),!0}for(l=1,c=new Array(h-1);l<h;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var d,p=u.length;for(l=0;l<p;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),h){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,n);break;case 4:u[l].fn.call(u[l].context,t,n,i);break;default:if(!c)for(d=1,c=new Array(h-1);d<h;d++)c[d-1]=arguments[d];u[l].fn.apply(u[l].context,c)}}return!0},a.prototype.on=function(e,t,r){return s(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return s(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,i){var s=r?r+e:e;if(!this._events[s])return this;if(!t)return o(this,s),this;var a=this._events[s];if(a.fn)a.fn!==t||i&&!a.once||n&&a.context!==n||o(this,s);else{for(var c=0,l=[],u=a.length;c<u;c++)(a[c].fn!==t||i&&!a[c].once||n&&a[c].context!==n)&&l.push(a[c]);l.length?this._events[s]=1===l.length?l[0]:l:o(this,s)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&o(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},251:(e,t)=>{t.read=function(e,t,r,n,i){var s,o,a=8*i-n-1,c=(1<<a)-1,l=c>>1,u=-7,h=r?i-1:0,d=r?-1:1,p=e[t+h];for(h+=d,s=p&(1<<-u)-1,p>>=-u,u+=a;u>0;s=256*s+e[t+h],h+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=n;u>0;o=256*o+e[t+h],h+=d,u-=8);if(0===s)s=1-l;else{if(s===c)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),s-=l}return(p?-1:1)*o*Math.pow(2,s-n)},t.write=function(e,t,r,n,i,s){var o,a,c,l=8*s-i-1,u=(1<<l)-1,h=u>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,f=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+h>=1?d/c:d*Math.pow(2,1-h))*c>=2&&(o++,c/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(t*c-1)*Math.pow(2,i),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[r+p]=255&a,p+=f,a/=256,i-=8);for(o=o<<i|a,l+=i;l>0;e[r+p]=255&o,p+=f,o/=256,l-=8);e[r+p-f]|=128*g}},601:(e,t,r)=>{t.I0=t.DH=t.NX=t.u8=t.cY=void 0,t.av=t.O6=t.w3=t.Wg=void 0;const n=r(8287);function i(e){if(!(e instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}function s(e){return i(e),n.Buffer.from(e.buffer,e.byteOffset,e.length)}class o{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}function a(e,t){return t.property?e+"["+t.property+"]":e}class c extends o{isCount(){throw new Error("ExternalLayout is abstract")}}class l extends c{constructor(e,t=0,r){if(!(e instanceof o))throw new TypeError("layout must be a Layout");if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,r||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof u||this.layout instanceof h}decode(e,t=0){return this.layout.decode(e,t+this.offset)}encode(e,t,r=0){return this.layout.encode(e,t,r+this.offset)}}class u extends o{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return s(e).readUIntLE(t,this.span)}encode(e,t,r=0){return s(t).writeUIntLE(e,r,this.span),this.span}}class h extends o{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return s(e).readUIntBE(t,this.span)}encode(e,t,r=0){return s(t).writeUIntBE(e,r,this.span),this.span}}const d=Math.pow(2,32);function p(e){const t=Math.floor(e/d);return{hi32:t,lo32:e-t*d}}function f(e,t){return e*d+t}class g extends o{constructor(e){super(8,e)}decode(e,t=0){const r=s(e),n=r.readUInt32LE(t);return f(r.readUInt32LE(t+4),n)}encode(e,t,r=0){const n=p(e),i=s(t);return i.writeUInt32LE(n.lo32,r),i.writeUInt32LE(n.hi32,r+4),8}}class m extends o{constructor(e){super(8,e)}decode(e,t=0){const r=s(e),n=r.readUInt32LE(t);return f(r.readInt32LE(t+4),n)}encode(e,t,r=0){const n=p(e),i=s(t);return i.writeUInt32LE(n.lo32,r),i.writeInt32LE(n.hi32,r+4),8}}class y extends o{constructor(e,t,r){if(!(e instanceof o))throw new TypeError("elementLayout must be a Layout");if(!(t instanceof c&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let n=-1;!(t instanceof c)&&0<e.span&&(n=t*e.span),super(n,r),this.elementLayout=e,this.count=t}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0,n=this.count;if(n instanceof c&&(n=n.decode(e,t)),0<this.elementLayout.span)r=n*this.elementLayout.span;else{let i=0;for(;i<n;)r+=this.elementLayout.getSpan(e,t+r),++i}return r}decode(e,t=0){const r=[];let n=0,i=this.count;for(i instanceof c&&(i=i.decode(e,t));n<i;)r.push(this.elementLayout.decode(e,t)),t+=this.elementLayout.getSpan(e,t),n+=1;return r}encode(e,t,r=0){const n=this.elementLayout,i=e.reduce((e,i)=>e+n.encode(i,t,r+e),0);return this.count instanceof c&&this.count.encode(e.length,t,r),i}}class w extends o{constructor(e,t,r){if(!Array.isArray(e)||!e.reduce((e,t)=>e&&t instanceof o,!0))throw new TypeError("fields must be array of Layout instances");"boolean"==typeof t&&void 0===r&&(r=t,t=void 0);for(const t of e)if(0>t.span&&void 0===t.property)throw new Error("fields cannot contain unnamed variable-length layout");let n=-1;try{n=e.reduce((e,t)=>e+t.getSpan(),0)}catch(e){}super(n,t),this.fields=e,this.decodePrefixes=!!r}getSpan(e,t=0){if(0<=this.span)return this.span;let r=0;try{r=this.fields.reduce((r,n)=>{const i=n.getSpan(e,t);return t+=i,r+i},0)}catch(e){throw new RangeError("indeterminate span")}return r}decode(e,t=0){i(e);const r=this.makeDestinationObject();for(const n of this.fields)if(void 0!==n.property&&(r[n.property]=n.decode(e,t)),t+=n.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return r}encode(e,t,r=0){const n=r;let i=0,s=0;for(const n of this.fields){let o=n.span;if(s=0<o?o:0,void 0!==n.property){const i=e[n.property];void 0!==i&&(s=n.encode(i,t,r),0>o&&(o=n.getSpan(t,r)))}i=r,r+=o}return i+s-n}fromArray(e){const t=this.makeDestinationObject();for(const r of this.fields)void 0!==r.property&&0<e.length&&(t[r.property]=e.shift());return t}layoutFor(e){if("string"!=typeof e)throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if("string"!=typeof e)throw new TypeError("property must be string");let t=0;for(const r of this.fields){if(r.property===e)return t;0>r.span?t=-1:0<=t&&(t+=r.span)}}}class b extends o{constructor(e,t){if(!(e instanceof c&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let r=-1;e instanceof c||(r=e),super(r,t),this.length=e}getSpan(e,t){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),r}decode(e,t=0){let r=this.span;return 0>r&&(r=this.length.decode(e,t)),s(e).slice(t,t+r)}encode(e,t,r){let n=this.length;if(this.length instanceof c&&(n=e.length),!(e instanceof Uint8Array&&n===e.length))throw new TypeError(a("Blob.encode",this)+" requires (length "+n+") Uint8Array as src");if(r+n>t.length)throw new RangeError("encoding overruns Uint8Array");const i=s(e);return s(t).write(i.toString("hex"),r,n,"hex"),this.length instanceof c&&this.length.encode(n,t,r),n}}t.cY=(e,t,r)=>new l(e,t,r),t.u8=e=>new u(1,e),t.NX=e=>new u(2,e),t.DH=e=>new u(4,e),t.I0=e=>new g(e),t.Wg=e=>new m(e),t.w3=(e,t,r)=>new w(e,t,r),t.O6=(e,t,r)=>new y(e,t,r),t.av=(e,t)=>new b(e,t)},615:(e,t,r)=>{r.d(t,{Ak:()=>c,UT:()=>v,Xf:()=>w,fH:()=>y,hT:()=>m,u0:()=>a});var n=r(1848),i=r(8030);const s=BigInt(0),o=BigInt(1);function a(e,t){const r=t.negate();return e?r:t}function c(e,t){const r=(0,i.pS)(e.Fp,t.map(e=>e.Z));return t.map((t,n)=>e.fromAffine(t.toAffine(r[n])))}function l(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function u(e,t){l(e,t);const r=2**e;return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1),mask:(0,n.OG)(e),maxNumber:r,shiftBy:BigInt(e)}}function h(e,t,r){const{windowSize:n,mask:i,maxNumber:s,shiftBy:a}=r;let c=Number(e&i),l=e>>a;c>n&&(c-=s,l+=o);const u=t*n;return{nextN:l,offset:u+Math.abs(c)-1,isZero:0===c,isNeg:c<0,isNegF:t%2!=0,offsetF:u}}const d=new WeakMap,p=new WeakMap;function f(e){return p.get(e)||1}function g(e){if(e!==s)throw new Error("invalid wNAF")}class m{constructor(e,t){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=t}_unsafeLadder(e,t,r=this.ZERO){let n=e;for(;t>s;)t&o&&(r=r.add(n)),n=n.double(),t>>=o;return r}precomputeWindow(e,t){const{windows:r,windowSize:n}=u(t,this.bits),i=[];let s=e,o=s;for(let e=0;e<r;e++){o=s,i.push(o);for(let e=1;e<n;e++)o=o.add(s),i.push(o);s=o.double()}return i}wNAF(e,t,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let n=this.ZERO,i=this.BASE;const s=u(e,this.bits);for(let e=0;e<s.windows;e++){const{nextN:o,offset:c,isZero:l,isNeg:u,isNegF:d,offsetF:p}=h(r,e,s);r=o,l?i=i.add(a(d,t[p])):n=n.add(a(u,t[c]))}return g(r),{p:n,f:i}}wNAFUnsafe(e,t,r,n=this.ZERO){const i=u(e,this.bits);for(let e=0;e<i.windows&&r!==s;e++){const{nextN:s,offset:o,isZero:a,isNeg:c}=h(r,e,i);if(r=s,!a){const e=t[o];n=n.add(c?e.negate():e)}}return g(r),n}getPrecomputes(e,t,r){let n=d.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&("function"==typeof r&&(n=r(n)),d.set(t,n))),n}cached(e,t,r){const n=f(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)}unsafe(e,t,r,n){const i=f(e);return 1===i?this._unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)}createCache(e,t){l(t,this.bits),p.set(e,t),d.delete(e)}hasCache(e){return 1!==f(e)}}function y(e,t,r,n){let i=t,a=e.ZERO,c=e.ZERO;for(;r>s||n>s;)r&o&&(a=a.add(i)),n&o&&(c=c.add(i)),i=i.double(),r>>=o,n>>=o;return{p1:a,p2:c}}function w(e,t,r,i){(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw new Error("invalid point at index "+r)})})(r,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+r)})}(i,t);const s=r.length,o=i.length;if(s!==o)throw new Error("arrays of points and scalars must have equal length");const a=e.ZERO,c=(0,n.dJ)(BigInt(s));let l=1;c>12?l=c-3:c>4?l=c-2:c>0&&(l=2);const u=(0,n.OG)(l),h=new Array(Number(u)+1).fill(a);let d=a;for(let e=Math.floor((t.BITS-1)/l)*l;e>=0;e-=l){h.fill(a);for(let t=0;t<o;t++){const n=i[t],s=Number(n>>BigInt(e)&u);h[s]=h[s].add(r[t])}let t=a;for(let e=h.length-1,r=a;e>0;e--)r=r.add(h[e]),t=t.add(r);if(d=d.add(t),0!==e)for(let e=0;e<l;e++)d=d.double()}return d}function b(e,t,r){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return(0,i.jr)(t),t}return(0,i.D0)(e,{isLE:r})}function v(e,t,r={},n){if(void 0===n&&(n="edwards"===e),!t||"object"!=typeof t)throw new Error(`expected valid ${e} CURVE object`);for(const e of["p","n","h"]){const r=t[e];if(!("bigint"==typeof r&&r>s))throw new Error(`CURVE.${e} must be positive bigint`)}const i=b(t.p,r.Fp,n),o=b(t.n,r.Fn,n),a=["Gx","Gy","a","weierstrass"===e?"b":"d"];for(const e of a)if(!i.isValid(t[e]))throw new Error(`CURVE.${e} must be valid field element of CURVE.Fp`);return{CURVE:t=Object.freeze(Object.assign({},t)),Fp:i,Fn:o}}},793:e=>{function t(e){try{return JSON.stringify(e)}catch(e){return'"[Circular]"'}}e.exports=function(e,r,n){var i=n&&n.stringify||t;if("object"==typeof e&&null!==e){var s=r.length+1;if(1===s)return e;var o=new Array(s);o[0]=i(e);for(var a=1;a<s;a++)o[a]=i(r[a]);return o.join(" ")}if("string"!=typeof e)return e;var c=r.length;if(0===c)return e;for(var l="",u=0,h=-1,d=e&&e.length||0,p=0;p<d;){if(37===e.charCodeAt(p)&&p+1<d){switch(h=h>-1?h:0,e.charCodeAt(p+1)){case 100:case 102:if(u>=c)break;if(null==r[u])break;h<p&&(l+=e.slice(h,p)),l+=Number(r[u]),h=p+2,p++;break;case 105:if(u>=c)break;if(null==r[u])break;h<p&&(l+=e.slice(h,p)),l+=Math.floor(Number(r[u])),h=p+2,p++;break;case 79:case 111:case 106:if(u>=c)break;if(void 0===r[u])break;h<p&&(l+=e.slice(h,p));var f=typeof r[u];if("string"===f){l+="'"+r[u]+"'",h=p+2,p++;break}if("function"===f){l+=r[u].name||"<anonymous>",h=p+2,p++;break}l+=i(r[u]),h=p+2,p++;break;case 115:if(u>=c)break;h<p&&(l+=e.slice(h,p)),l+=String(r[u]),h=p+2,p++;break;case 37:h<p&&(l+=e.slice(h,p)),l+="%",h=p+2,p++,u--}++u}++p}return-1===h?e:(h<d&&(l+=e.slice(h)),l)}},829:e=>{function t(e){return(4294967296+e).toString(16).substring(1)}e.exports={normalizeInput:function(e){let t;if(e instanceof Uint8Array)t=e;else{if("string"!=typeof e)throw new Error("Input must be an string, Buffer or Uint8Array");t=(new TextEncoder).encode(e)}return t},toHex:function(e){return Array.prototype.map.call(e,function(e){return(e<16?"0":"")+e.toString(16)}).join("")},debugPrint:function(e,r,n){let i="\n"+e+" = ";for(let s=0;s<r.length;s+=2){if(32===n)i+=t(r[s]).toUpperCase(),i+=" ",i+=t(r[s+1]).toUpperCase();else{if(64!==n)throw new Error("Invalid size "+n);i+=t(r[s+1]).toUpperCase(),i+=t(r[s]).toUpperCase()}s%6==4?i+="\n"+new Array(e.length+4).join(" "):s<r.length-2&&(i+=" ")}console.log(i)},testSpeed:function(e,t,r){let n=(new Date).getTime();const i=new Uint8Array(t);for(let e=0;e<t;e++)i[e]=e%256;const s=(new Date).getTime();console.log("Generated random input in "+(s-n)+"ms"),n=s;for(let s=0;s<r;s++){const r=e(i),s=(new Date).getTime(),o=s-n;n=s,console.log("Hashed in "+o+"ms: "+r.substring(0,20)+"..."),console.log(Math.round(t/(1<<20)/(o/1e3)*100)/100+" MB PER SECOND")}}}},842:(e,t,r)=>{r.d(t,{mN:()=>C,AH:()=>l,W3:()=>_,Ec:()=>I,iz:()=>c});const n=globalThis,i=n.ShadowRoot&&(void 0===n.ShadyCSS||n.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s=Symbol(),o=new WeakMap;class a{constructor(e,t,r){if(this._$cssResult$=!0,r!==s)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(i&&void 0===e){const r=void 0!==t&&1===t.length;r&&(e=o.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&o.set(t,e))}return e}toString(){return this.cssText}}const c=e=>new a("string"==typeof e?e:e+"",void 0,s),l=(e,...t)=>{const r=1===e.length?e[0]:t.reduce((t,r,n)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(r)+e[n+1],e[0]);return new a(r,e,s)},u=(e,t)=>{if(i)e.adoptedStyleSheets=t.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet);else for(const r of t){const t=document.createElement("style"),i=n.litNonce;void 0!==i&&t.setAttribute("nonce",i),t.textContent=r.cssText,e.appendChild(t)}},h=i?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const r of e.cssRules)t+=r.cssText;return c(t)})(e):e,{is:d,defineProperty:p,getOwnPropertyDescriptor:f,getOwnPropertyNames:g,getOwnPropertySymbols:m,getPrototypeOf:y}=Object,w=globalThis,b=w.trustedTypes,v=b?b.emptyScript:"",E=w.reactiveElementPolyfillSupport,A=(e,t)=>e,_={toAttribute(e,t){switch(t){case Boolean:e=e?v:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let r=e;switch(t){case Boolean:r=null!==e;break;case Number:r=null===e?null:Number(e);break;case Object:case Array:try{r=JSON.parse(e)}catch(e){r=null}}return r}},I=(e,t)=>!d(e,t),S={attribute:!0,type:String,converter:_,reflect:!1,useDefault:!1,hasChanged:I};Symbol.metadata??=Symbol("metadata"),w.litPropertyMetadata??=new WeakMap;class C extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=S){if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){const r=Symbol(),n=this.getPropertyDescriptor(e,r,t);void 0!==n&&p(this.prototype,e,n)}}static getPropertyDescriptor(e,t,r){const{get:n,set:i}=f(this.prototype,e)??{get(){return this[t]},set(e){this[t]=e}};return{get:n,set(t){const s=n?.call(this);i?.call(this,t),this.requestUpdate(e,s,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??S}static _$Ei(){if(this.hasOwnProperty(A("elementProperties")))return;const e=y(this);e.finalize(),void 0!==e.l&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(A("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(A("properties"))){const e=this.properties,t=[...g(e),...m(e)];for(const r of t)this.createProperty(r,e[r])}const e=this[Symbol.metadata];if(null!==e){const t=litPropertyMetadata.get(e);if(void 0!==t)for(const[e,r]of t)this.elementProperties.set(e,r)}this._$Eh=new Map;for(const[e,t]of this.elementProperties){const r=this._$Eu(e,t);void 0!==r&&this._$Eh.set(r,e)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const e of r)t.unshift(h(e))}else void 0!==e&&t.push(h(e));return t}static _$Eu(e,t){const r=t.attribute;return!1===r?void 0:"string"==typeof r?r:"string"==typeof e?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),void 0!==this.renderRoot&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const r of t.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return u(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,t,r){this._$AK(e,r)}_$ET(e,t){const r=this.constructor.elementProperties.get(e),n=this.constructor._$Eu(e,r);if(void 0!==n&&!0===r.reflect){const i=(void 0!==r.converter?.toAttribute?r.converter:_).toAttribute(t,r.type);this._$Em=e,null==i?this.removeAttribute(n):this.setAttribute(n,i),this._$Em=null}}_$AK(e,t){const r=this.constructor,n=r._$Eh.get(e);if(void 0!==n&&this._$Em!==n){const e=r.getPropertyOptions(n),i="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==e.converter?.fromAttribute?e.converter:_;this._$Em=n;const s=i.fromAttribute(t,e.type);this[n]=s??this._$Ej?.get(n)??s,this._$Em=null}}requestUpdate(e,t,r){if(void 0!==e){const n=this.constructor,i=this[e];if(r??=n.getPropertyOptions(e),!((r.hasChanged??I)(i,t)||r.useDefault&&r.reflect&&i===this._$Ej?.get(e)&&!this.hasAttribute(n._$Eu(e,r))))return;this.C(e,t,r)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(e,t,{useDefault:r,reflect:n,wrapped:i},s){r&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,s??t??this[e]),!0!==i||void 0!==s)||(this._$AL.has(e)||(this.hasUpdated||r||(t=void 0),this._$AL.set(e,t)),!0===n&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[e,t]of this._$Ep)this[e]=t;this._$Ep=void 0}const e=this.constructor.elementProperties;if(e.size>0)for(const[t,r]of e){const{wrapped:e}=r,n=this[t];!0!==e||this._$AL.has(t)||void 0===n||this.C(t,void 0,r,n)}}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),this._$EO?.forEach(e=>e.hostUpdate?.()),this.update(t)):this._$EM()}catch(t){throw e=!1,this._$EM(),t}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$EO?.forEach(e=>e.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach(e=>this._$ET(e,this[e])),this._$EM()}updated(e){}firstUpdated(e){}}C.elementStyles=[],C.shadowRootOptions={mode:"open"},C[A("elementProperties")]=new Map,C[A("finalized")]=new Map,E?.({ReactiveElement:C}),(w.reactiveElementVersions??=[]).push("2.1.1")},1089:(e,t)=>{function r(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product}function n(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowser=t.isNode=t.isReactNative=void 0,t.isReactNative=r,t.isNode=n,t.isBrowser=function(){return!r()&&!n()}},1122:(e,t,r)=>{r.d(t,{U:()=>y}),r(6601);var n=r(4376),i=r(152),s=r(3450),o=r(6056),a=r(1211),c=r(6010),l=r(184),u=r(6396),h=r(2733),d=r(8508),p=r(1871),f=r(4496),g=r(6742);let m=null;const y={getSIWX:()=>h.H.state.siwx,async initializeIfEnabled(e=o.W.getActiveCaipAddress()){const t=h.H.state.siwx;if(!t||!e)return;const[r,n,i]=e.split(":");if(o.W.checkIfSupportedNetwork(r,`${r}:${n}`))try{if(h.H.state.remoteFeatures?.emailCapture){const e=o.W.getAccountData(r)?.user;return void await u.W.open({view:"DataCapture",data:{email:e?.email??void 0}})}if(m&&await m,(await t.getSessions(`${r}:${n}`,i)).length)return;await u.W.open({view:"SIWXSignMessage"})}catch(e){console.error("SIWXUtil:initializeIfEnabled",e),l.E.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties()}),await(a.x._getClient()?.disconnect().catch(console.error)),d.I.reset("Connect"),p.P.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){const e=h.H.state.siwx,t=g.w.getPlainAddress(o.W.getActiveCaipAddress()),r=(0,f.kg)(),i=a.x._getClient();if(!e)throw new Error("SIWX is not enabled");if(!t)throw new Error("No ActiveCaipAddress found");if(!r)throw new Error("No ActiveCaipNetwork or client found");if(!i)throw new Error("No ConnectionController client found");try{const s=await e.createMessage({chainId:r.caipNetworkId,accountAddress:t}),a=s.toString();c.a.getConnectorId(r.chainNamespace)===n.o.CONNECTOR_ID.AUTH&&d.I.pushTransactionStack({});const h=await i.signMessage(a);await e.addSession({data:s,message:a,signature:h}),o.W.setLastConnectedSIWECaipNetwork(r),u.W.close(),l.E.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(e){const t=this.getSIWXEventProperties();u.W.state.open&&"ApproveTransaction"!==d.I.state.view||await u.W.open({view:"SIWXSignMessage"}),p.P.showError("Error signing message"),l.E.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:t}),console.error("SWIXUtil:requestSignMessage",e)}},async cancelSignMessage(){try{const e=this.getSIWX(),t=e?.getRequired?.();if(t){const t=o.W.getLastConnectedSIWECaipNetwork();if(t){const r=await(e?.getSessions(t?.caipNetworkId,g.w.getPlainAddress(o.W.getActiveCaipAddress())||""));r&&r.length>0?await o.W.switchActiveNetwork(t):await a.x.disconnect()}else await a.x.disconnect()}else u.W.close();u.W.close(),l.E.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getAllSessions(){const e=this.getSIWX(),t=o.W.getAllRequestedCaipNetworks(),r=[];return await Promise.all(t.map(async t=>{const n=await(e?.getSessions(t.caipNetworkId,g.w.getPlainAddress(o.W.getActiveCaipAddress())||""));n&&r.push(...n)})),r},async getSessions(e){const t=h.H.state.siwx;let r=e?.address;if(!r){const e=o.W.getActiveCaipAddress();r=g.w.getPlainAddress(e)}let n=e?.caipNetworkId;if(!n){const e=o.W.getActiveCaipNetwork();n=e?.caipNetworkId}return t&&r&&n?t.getSessions(n,r):[]},async isSIWXCloseDisabled(){const e=this.getSIWX();if(e){const t="ApproveTransaction"===d.I.state.view,r="SIWXSignMessage"===d.I.state.view;if(t||r)return e.getRequired?.()&&0===(await this.getSessions()).length}return!1},async authConnectorAuthenticate({authConnector:e,chainId:t,socialUri:r,preferredAccountType:i,chainNamespace:s}){const o=y.getSIWX();if(!o||!s.includes(n.o.CHAIN.EVM)||h.H.state.remoteFeatures?.emailCapture){const n=await e.connect({chainId:t,socialUri:r,preferredAccountType:i});return{address:n.address,chainId:n.chainId,accounts:n.accounts}}const a=`${s}:${t}`,c=await o.createMessage({chainId:a,accountAddress:"<<AccountAddress>>"}),l={accountAddress:c.accountAddress,chainId:c.chainId,domain:c.domain,uri:c.uri,version:c.version,nonce:c.nonce,notBefore:c.notBefore,statement:c.statement,resources:c.resources,requestId:c.requestId,issuedAt:c.issuedAt,expirationTime:c.expirationTime,serializedMessage:c.toString()},u=await e.connect({chainId:t,socialUri:r,siwxMessage:l,preferredAccountType:i});if(l.accountAddress=u.address,l.serializedMessage=u.message||"",u.signature&&u.message){const e=y.addEmbeddedWalletSession(l,u.message,u.signature);await e}return{address:u.address,chainId:u.chainId,accounts:u.accounts}},async addEmbeddedWalletSession(e,t,r){if(m)return m;const n=y.getSIWX();return n?(m=n.addSession({data:e,message:t,signature:r}).finally(()=>{m=null}),m):Promise.resolve()},async universalProviderAuthenticate({universalProvider:e,chains:t,methods:r}){const n=y.getSIWX(),i=(0,f.kg)(),a=new Set(t.map(e=>e.split(":")[0]));if(!n||1!==a.size||!a.has("eip155"))return!1;const c=await n.createMessage({chainId:(0,f.kg)()?.caipNetworkId||"",accountAddress:""}),u=await e.authenticate({nonce:c.nonce,domain:c.domain,uri:c.uri,exp:c.expirationTime,iat:c.issuedAt,nbf:c.notBefore,requestId:c.requestId,version:c.version,resources:c.resources,statement:c.statement,chainId:c.chainId,methods:r,chains:[c.chainId,...t.filter(e=>e!==c.chainId)]});if(p.P.showLoading("Authenticating...",{autoClose:!1}),s.U.setConnectedWalletInfo({...u.session.peer.metadata,name:u.session.peer.metadata.name,icon:u.session.peer.metadata.icons?.[0],type:"WALLET_CONNECT"},Array.from(a)[0]),u?.auths?.length){const t=u.auths.map(t=>{const r=e.client.formatAuthMessage({request:t.p,iss:t.p.iss});return{data:{...t.p,accountAddress:t.p.iss.split(":").slice(-1).join(""),chainId:t.p.iss.split(":").slice(2,4).join(":"),uri:t.p.aud,version:t.p.version||c.version,expirationTime:t.p.exp,issuedAt:t.p.iat,notBefore:t.p.nbf},message:r,signature:t.s.s,cacao:t}});try{await n.setSessions(t),i&&o.W.setLastConnectedSIWECaipNetwork(i),l.E.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:y.getSIWXEventProperties()})}catch(t){throw console.error("SIWX:universalProviderAuth - failed to set sessions",t),l.E.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:y.getSIWXEventProperties()}),await e.disconnect().catch(console.error),t}finally{p.P.hide()}}return!0},getSIWXEventProperties(){const e=o.W.state.activeChain;if(!e)throw new Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:o.W.state.activeCaipNetwork?.caipNetworkId||"",isSmartAccount:(0,f.lj)(e)===i.Vl.ACCOUNT_TYPES.SMART_ACCOUNT}},async clearSessions(){const e=this.getSIWX();e&&await e.setSessions([])}}},1211:(e,t,r)=>{r.d(t,{x:()=>S});var n=r(8126),i=r(4707),s=r(4376),o=r(5910),a=r(4496),c=r(8577),l=r(152),u=r(3450),h=r(6056),d=r(6010),p=r(184),f=r(6396),g=r(8508),m=r(2944),y=r(6742),w=r(7508);const b={checkNamespaceConnectorId:(e,t)=>d.a.getConnectorId(e)===t,isSocialProvider:e=>m.oU.DEFAULT_REMOTE_FEATURES.socials.includes(e),connectWalletConnect:({walletConnect:e,connector:t,closeModalOnConnect:r=!0,redirectViewOnModalClose:n="Connect",onOpen:i,onConnect:s})=>new Promise((a,c)=>{if(e&&d.a.setActiveConnector(t),i?.(y.w.isMobile()&&e),n){const e=f.W.subscribeKey("open",t=>{t||(g.I.state.view!==n&&g.I.replace(n),e(),c(new Error("Modal closed")))})}const l=h.W.subscribeKey("activeCaipAddress",e=>{e&&(s?.(),r&&f.W.close(),l(),a(o.C.parseCaipAddress(e)))})}),connectExternal:e=>new Promise((t,r)=>{const n=h.W.subscribeKey("activeCaipAddress",e=>{e&&(f.W.close(),n(),t(o.C.parseCaipAddress(e)))});S.connectExternal(e,e.chain).catch(()=>{n(),r(new Error("Connection rejected"))})}),connectSocial({social:e,namespace:t,closeModalOnConnect:r=!0,onOpenFarcaster:n,onConnect:i}){let a=u.U.state.socialWindow,c=u.U.state.socialProvider,l=!1,g=null;const m=t||h.W.state.activeChain,b=h.W.subscribeKey("activeCaipAddress",e=>{e&&(r&&f.W.close(),b())});return new Promise((t,r)=>{async function b(e){if(e.data?.resultUri)if(e.origin===s.o.SECURE_SITE_SDK_ORIGIN){window.removeEventListener("message",b,!1);try{const n=d.a.getAuthConnector(m);if(n&&!l){a&&(a.close(),u.U.setSocialWindow(void 0,m),a=u.U.state.socialWindow),l=!0;const i=e.data.resultUri;if(c&&p.E.sendEvent({type:"track",event:"SOCIAL_LOGIN_REQUEST_USER_DATA",properties:{provider:c}}),c){w.i.setConnectedSocialProvider(c),await S.connectExternal({id:n.id,type:n.type,socialUri:i},n.chain);const e=h.W.state.activeCaipAddress;if(!e)return void r(new Error("Failed to connect"));t(o.C.parseCaipAddress(e)),p.E.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:c}})}}}catch(e){c&&p.E.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:c}}),r(new Error("Failed to connect"))}}else c&&p.E.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:c}})}!async function(){if(e&&(u.U.setSocialProvider(e,m),c=u.U.state.socialProvider,p.E.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:c}})),"farcaster"===c){n?.();const t=f.W.subscribeKey("open",n=>{n||"farcaster"!==e||(r(new Error("Popup closed")),i?.(),t())}),s=d.a.getAuthConnector();if(s&&!u.U.state.farcasterUrl)try{const{url:e}=await s.provider.getFarcasterUri();u.U.setFarcasterUrl(e,m)}catch{r(new Error("Failed to connect to farcaster"))}}else{const e=d.a.getAuthConnector();g=y.w.returnOpenHref(`${s.o.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes");try{if(e&&c){const{uri:t}=await e.provider.getSocialRedirectUri({provider:c});if(g&&t){u.U.setSocialWindow(g,m),a=u.U.state.socialWindow,g.location.href=t;const e=setInterval(()=>{a?.closed&&!l&&(r(new Error("Popup closed")),clearInterval(e))},1e3);window.addEventListener("message",b,!1)}else g?.close(),r(new Error("Failed to initiate social connection"))}}catch{r(new Error("Failed to initiate social connection")),g?.close()}}}()})},connectEmail:({closeModalOnConnect:e=!0,redirectViewOnModalClose:t="Connect",onOpen:r,onConnect:n})=>new Promise((i,s)=>{if(r?.(),t){const e=f.W.subscribeKey("open",r=>{r||(g.I.state.view!==t&&g.I.replace(t),e(),s(new Error("Modal closed")))})}const a=h.W.subscribeKey("activeCaipAddress",t=>{t&&(n?.(),e&&f.W.close(),a(),i(o.C.parseCaipAddress(t)))})}),async updateEmail(){const e=w.i.getConnectedConnectorId(h.W.state.activeChain),t=d.a.getAuthConnector();if(!t)throw new Error("No auth connector found");if(e!==s.o.CONNECTOR_ID.AUTH)throw new Error("Not connected to email or social");const r=t.provider.getEmail()??"";return await f.W.open({view:"UpdateEmailWallet",data:{email:r,redirectView:void 0}}),new Promise((e,n)=>{const i=setInterval(()=>{const n=t.provider.getEmail()??"";n!==r&&(f.W.close(),clearInterval(i),s(),e({email:n}))},1e3),s=f.W.subscribeKey("open",e=>{e||("Connect"!==g.I.state.view&&g.I.push("Connect"),clearInterval(i),s(),n(new Error("Modal closed")))})})},canSwitchToSmartAccount:e=>h.W.checkIfSmartAccountEnabled()&&(0,a.lj)(e)===l.Vl.ACCOUNT_TYPES.EOA};var v=r(5940),E=r(6360);const A=(0,n.BX)({connections:new Map,recentConnections:new Map,isSwitchingConnection:!1,wcError:!1,buffering:!1,status:"disconnected"});let _;const I={state:A,subscribe:e=>(0,n.B1)(A,()=>e(A)),subscribeKey:(e,t)=>(0,i.u$)(A,e,t),_getClient:()=>A._client,setClient(e){A._client=(0,n.KR)(e)},initialize(e){const t=e.filter(e=>Boolean(e.namespace)).map(e=>e.namespace);S.syncStorageConnections(t)},syncStorageConnections(e){const t=w.i.getConnections(),r=e??Array.from(h.W.state.chains.keys());for(const e of r){const r=t[e]??[],n=new Map(A.recentConnections);n.set(e,r),A.recentConnections=n}},getConnections:e=>e?A.connections.get(e)??[]:[],hasAnyConnection(e){const t=S.state.connections;return Array.from(t.values()).flatMap(e=>e).some(({connectorId:t})=>t===e)},async connectWalletConnect(){if(y.w.isTelegram()||y.w.isSafari()&&y.w.isIos()){if(_)return await _,void(_=void 0);if(!y.w.isPairingExpired(A?.wcPairingExpiry)){const e=A.wcUri;return void(A.wcUri=e)}_=S._getClient()?.connectWalletConnect?.().catch(()=>{}),S.state.status="connecting",await _,_=void 0,A.wcPairingExpiry=void 0,S.state.status="connected"}else await(S._getClient()?.connectWalletConnect?.())},async connectExternal(e,t,r=!0){const n=await(S._getClient()?.connectExternal?.(e));return r&&h.W.setActiveNamespace(t),n},async reconnectExternal(e){await(S._getClient()?.reconnectExternal?.(e));const t=e.chain||h.W.state.activeChain;t&&d.a.setConnectorId(e.id,t)},async setPreferredAccountType(e,t){if(!t)return;f.W.setLoading(!0,h.W.state.activeChain);const r=d.a.getAuthConnector();r&&(u.U.setPreferredAccountType(e,t),await r.provider.setPreferredAccount(e),w.i.setPreferredAccountTypes(Object.entries(h.W.state.chains).reduce((e,[t,r])=>{const n=t,i=(0,a.lj)(n);return void 0!==i&&(e[n]=i),e},{})),await S.reconnectExternal(r),f.W.setLoading(!1,h.W.state.activeChain),p.E.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:e,network:h.W.state.activeCaipNetwork?.caipNetworkId||""}}))},signMessage:async e=>S._getClient()?.signMessage(e),parseUnits:(e,t)=>S._getClient()?.parseUnits(e,t),formatUnits:(e,t)=>S._getClient()?.formatUnits(e,t),sendTransaction:async e=>S._getClient()?.sendTransaction(e),getCapabilities:async e=>S._getClient()?.getCapabilities(e),grantPermissions:async e=>S._getClient()?.grantPermissions(e),walletGetAssets:async e=>S._getClient()?.walletGetAssets(e)??{},estimateGas:async e=>S._getClient()?.estimateGas(e),writeContract:async e=>S._getClient()?.writeContract(e),getEnsAddress:async e=>S._getClient()?.getEnsAddress(e),getEnsAvatar:async e=>S._getClient()?.getEnsAvatar(e),checkInstalled:e=>S._getClient()?.checkInstalled?.(e)||!1,resetWcConnection(){A.wcUri=void 0,A.wcPairingExpiry=void 0,A.wcLinking=void 0,A.recentWallet=void 0,A.status="disconnected",E.W.resetTransactions(),w.i.deleteWalletConnectDeepLink()},resetUri(){A.wcUri=void 0,A.wcPairingExpiry=void 0,_=void 0},finalizeWcConnection(e){const{wcLinking:t,recentWallet:r}=S.state;t&&w.i.setWalletConnectDeepLink(t),r&&w.i.setAppKitRecent(r),p.E.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:e,properties:{method:t?"mobile":"qrcode",name:g.I.state.data?.wallet?.name||"Unknown"}})},setWcBasic(e){A.wcBasic=e},setUri(e){A.wcUri=e,A.wcPairingExpiry=y.w.getPairingExpiry()},setWcLinking(e){A.wcLinking=e},setWcError(e){A.wcError=e,A.buffering=!1},setRecentWallet(e){A.recentWallet=e},setBuffering(e){A.buffering=e},setStatus(e){A.status=e},setIsSwitchingConnection(e){A.isSwitchingConnection=e},async disconnect({id:e,namespace:t,initialDisconnect:r}={}){try{await(S._getClient()?.disconnect({id:e,chainNamespace:t,initialDisconnect:r}))}catch(e){throw new v.A("Failed to disconnect","INTERNAL_SDK_ERROR",e)}},setConnections(e,t){const r=new Map(A.connections);r.set(t,e),A.connections=r},async handleAuthAccountSwitch({address:e,namespace:t}){const r=u.U.state.user?.accounts?.find(e=>"smartAccount"===e.type),n=r&&r.address.toLowerCase()===e.toLowerCase()&&b.canSwitchToSmartAccount(t)?"smartAccount":"eoa";await S.setPreferredAccountType(n,t)},async handleActiveConnection({connection:e,namespace:t,address:r}){const n=d.a.getConnectorById(e.connectorId),i=e.connectorId===s.o.CONNECTOR_ID.AUTH;if(!n)throw new Error(`No connector found for connection: ${e.connectorId}`);if(!i){const e=await S.connectExternal({id:n.id,type:n.type,provider:n.provider,address:r,chain:t},t);return e?.address}return i&&r&&await S.handleAuthAccountSwitch({address:r,namespace:t}),r},async handleDisconnectedConnection({connection:e,namespace:t,address:r,closeModalOnConnect:n}){const i=d.a.getConnectorById(e.connectorId),o=e.auth?.name?.toLowerCase(),a=e.connectorId===s.o.CONNECTOR_ID.AUTH,c=e.connectorId===s.o.CONNECTOR_ID.WALLET_CONNECT;if(!i)throw new Error(`No connector found for connection: ${e.connectorId}`);let l;if(a)if(o&&b.isSocialProvider(o)){const{address:e}=await b.connectSocial({social:o,closeModalOnConnect:n,onOpenFarcaster(){f.W.open({view:"ConnectingFarcaster"})},onConnect(){g.I.replace("ProfileWallets")}});l=e}else{const{address:e}=await b.connectEmail({closeModalOnConnect:n,onOpen(){f.W.open({view:"EmailLogin"})},onConnect(){g.I.replace("ProfileWallets")}});l=e}else if(c){const{address:e}=await b.connectWalletConnect({walletConnect:!0,connector:i,closeModalOnConnect:n,onOpen(e){f.W.open({view:e?"AllWallets":"ConnectingWalletConnect"})},onConnect(){g.I.replace("ProfileWallets")}});l=e}else{const e=await S.connectExternal({id:i.id,type:i.type,provider:i.provider,chain:t},t);e&&(l=e.address)}return a&&r&&await S.handleAuthAccountSwitch({address:r,namespace:t}),l},async switchConnection({connection:e,address:t,namespace:r,closeModalOnConnect:n,onChange:i}){let s;const a=u.U.getCaipAddress(r);if(a){const{address:e}=o.C.parseCaipAddress(a);s=e}const l=c.b.getConnectionStatus(e,r);switch(l){case"connected":case"active":{const n=await S.handleActiveConnection({connection:e,namespace:r,address:t});if(s&&n){const e=n.toLowerCase()!==s.toLowerCase();i?.({address:n,namespace:r,hasSwitchedAccount:e,hasSwitchedWallet:"active"===l})}break}case"disconnected":{const s=await S.handleDisconnectedConnection({connection:e,namespace:r,address:t,closeModalOnConnect:n});s&&i?.({address:s,namespace:r,hasSwitchedAccount:!0,hasSwitchedWallet:!0});break}default:throw new Error(`Invalid connection status: ${l}`)}}},S=(0,v.X)(I)},1307:(e,t,r)=>{r.d(t,{A:()=>n});const n=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let e=0;e<t.length;e++)t[e]=255;for(let r=0;r<e.length;r++){const n=e.charAt(r),i=n.charCodeAt(0);if(255!==t[i])throw new TypeError(n+" is ambiguous");t[i]=r}const r=e.length,n=e.charAt(0),i=Math.log(r)/Math.log(256),s=Math.log(256)/Math.log(r);function o(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;let s=0,o=0,a=0;for(;e[s]===n;)o++,s++;const c=(e.length-s)*i+1>>>0,l=new Uint8Array(c);for(;s<e.length;){const n=e.charCodeAt(s);if(n>255)return;let i=t[n];if(255===i)return;let o=0;for(let e=c-1;(0!==i||o<a)&&-1!==e;e--,o++)i+=r*l[e]>>>0,l[e]=i%256>>>0,i=i/256>>>0;if(0!==i)throw new Error("Non-zero carry");a=o,s++}let u=c-a;for(;u!==c&&0===l[u];)u++;const h=new Uint8Array(o+(c-u));let d=o;for(;u!==c;)h[d++]=l[u++];return h}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";let i=0,o=0,a=0;const c=t.length;for(;a!==c&&0===t[a];)a++,i++;const l=(c-a)*s+1>>>0,u=new Uint8Array(l);for(;a!==c;){let e=t[a],n=0;for(let t=l-1;(0!==e||n<o)&&-1!==t;t--,n++)e+=256*u[t]>>>0,u[t]=e%r>>>0,e=e/r>>>0;if(0!==e)throw new Error("Non-zero carry");o=n,a++}let h=l-o;for(;h!==l&&0===u[h];)h++;let d=n.repeat(i);for(;h<l;++h)d+=e.charAt(u[h]);return d},decodeUnsafe:o,decode:function(e){const t=o(e);if(t)return t;throw new Error("Non-base"+r+" character")}}}("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},1344:(e,t,r)=>{r.d(t,{C:()=>o});const n="2.33.3";let i=({docsBaseUrl:e,docsPath:t="",docsSlug:r})=>t?`${e??"https://viem.sh"}${t}${r?`#${r}`:""}`:void 0,s=`viem@${n}`;class o extends Error{constructor(e,t={}){const r=t.cause instanceof o?t.cause.details:t.cause?.message?t.cause.message:t.details,a=t.cause instanceof o&&t.cause.docsPath||t.docsPath,c=i?.({...t,docsPath:a});super([e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...c?[`Docs: ${c}`]:[],...r?[`Details: ${r}`]:[],...s?[`Version: ${s}`]:[]].join("\n"),t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=a,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=n}walk(e){return a(this,e)}}function a(e,t){return t?.(e)?e:e&&"object"==typeof e&&"cause"in e&&void 0!==e.cause?a(e.cause,t):t?null:e}},1454:(e,t,r)=>{r.d(t,{w:()=>s});var n=r(2531);class i extends n.Vw{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,(0,n.sd)(e);const r=(0,n.ZJ)(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?e.create().update(r).digest():r);for(let e=0;e<s.length;e++)s[e]^=54;this.iHash.update(s),this.oHash=e.create();for(let e=0;e<s.length;e++)s[e]^=106;this.oHash.update(s),(0,n.uH)(s)}update(e){return(0,n.CC)(this),this.iHash.update(e),this}digestInto(e){(0,n.CC)(this),(0,n.DO)(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:n,destroyed:i,blockLen:s,outputLen:o}=this;return e.finished=n,e.destroyed=i,e.blockLen=s,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const s=(e,t,r)=>new i(e,t).update(r).digest();s.create=(e,t)=>new i(e,t)},1462:(e,t,r)=>{var n=r(2861).Buffer;e.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==t[o])throw new TypeError(s+" is ambiguous");t[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return n.alloc(0);for(var r=0,i=0,s=0;e[r]===c;)i++,r++;for(var o=(e.length-r)*l+1>>>0,u=new Uint8Array(o);r<e.length;){var h=e.charCodeAt(r);if(h>255)return;var d=t[h];if(255===d)return;for(var p=0,f=o-1;(0!==d||p<s)&&-1!==f;f--,p++)d+=a*u[f]>>>0,u[f]=d%256>>>0,d=d/256>>>0;if(0!==d)throw new Error("Non-zero carry");s=p,r++}for(var g=o-s;g!==o&&0===u[g];)g++;var m=n.allocUnsafe(i+(o-g));m.fill(0,0,i);for(var y=i;g!==o;)m[y++]=u[g++];return m}return{encode:function(t){if((Array.isArray(t)||t instanceof Uint8Array)&&(t=n.from(t)),!n.isBuffer(t))throw new TypeError("Expected Buffer");if(0===t.length)return"";for(var r=0,i=0,s=0,o=t.length;s!==o&&0===t[s];)s++,r++;for(var l=(o-s)*u+1>>>0,h=new Uint8Array(l);s!==o;){for(var d=t[s],p=0,f=l-1;(0!==d||p<i)&&-1!==f;f--,p++)d+=256*h[f]>>>0,h[f]=d%a>>>0,d=d/a>>>0;if(0!==d)throw new Error("Non-zero carry");i=p,s++}for(var g=l-i;g!==l&&0===h[g];)g++;for(var m=c.repeat(r);g<l;++g)m+=e.charAt(h[g]);return m},decodeUnsafe:h,decode:function(e){var t=h(e);if(t)return t;throw new Error("Non-base"+a+" character")}}}},1482:(e,t,r)=>{r.d(t,{o:()=>n});const n={ACCOUNT_TABS:[{label:"Tokens"},{label:"NFTs"},{label:"Activity"}],SECURE_SITE_ORIGIN:("undefined"!=typeof process&&void 0!==process.env?process.env.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120,ModalHeight:150,ViewTransition:150}}},1591:e=>{e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},1655:(e,t,r)=>{r.d(t,{h:()=>l});var n=r(8126),i=r(4707),s=r(5940),o=r(2733);const a=(0,n.BX)({message:"",variant:"info",open:!1}),c={state:a,subscribeKey:(e,t)=>(0,i.u$)(a,e,t),open(e,t){const{debug:r}=o.H.state,{code:n,displayMessage:i,debugMessage:s}=e;i&&r&&(a.message=i,a.variant=t,a.open=!0),s&&console.error("function"==typeof s?s():s,n?{code:n}:void 0)},close(){a.open=!1,a.message="",a.variant="info"}},l=(0,s.X)(c)},1727:(e,t,r)=>{r.d(t,{i3:()=>f,nj:()=>h});var n=r(1344);class i extends n.C{constructor({max:e,min:t,signed:r,size:n,value:i}){super(`Number "${i}" is not in safe ${n?`${8*n}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}n.C,n.C,n.C;class s extends n.C{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}n.C;class o extends n.C{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function a(e,{dir:t,size:r=32}={}){return"string"==typeof e?function(e,{dir:t,size:r=32}={}){if(null===r)return e;const n=e.replace("0x","");if(n.length>2*r)throw new o({size:Math.ceil(n.length/2),targetSize:r,type:"hex"});return`0x${n["right"===t?"padEnd":"padStart"](2*r,"0")}`}(e,{dir:t,size:r}):function(e,{dir:t,size:r=32}={}){if(null===r)return e;if(e.length>r)throw new o({size:e.length,targetSize:r,type:"bytes"});const n=new Uint8Array(r);for(let i=0;i<r;i++){const s="right"===t;n[s?i:r-i-1]=e[s?i:e.length-i-1]}return n}(e,{dir:t,size:r})}function c(e){return function(e,{strict:t=!0}={}){return!!e&&"string"==typeof e&&(t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x"))}(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}function l(e,{size:t}){if(c(e)>t)throw new s({givenSize:c(e),maxSize:t})}n.C;const u=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function h(e,t={}){return"number"==typeof e||"bigint"==typeof e?function(e,t={}){const{signed:r,size:n}=t,s=BigInt(e);let o;n?o=r?(1n<<8n*BigInt(n)-1n)-1n:2n**(8n*BigInt(n))-1n:"number"==typeof e&&(o=BigInt(Number.MAX_SAFE_INTEGER));const c="bigint"==typeof o&&r?-o-1n:0;if(o&&s>o||s<c){const t="bigint"==typeof e?"n":"";throw new i({max:o?`${o}${t}`:void 0,min:`${c}${t}`,signed:r,size:n,value:`${e}${t}`})}const l=`0x${(r&&s<0?(1n<<BigInt(8*n))+BigInt(s):s).toString(16)}`;return n?a(l,{size:n}):l}(e,t):"string"==typeof e?f(e,t):"boolean"==typeof e?function(e,t={}){const r=`0x${Number(e)}`;return"number"==typeof t.size?(l(r,{size:t.size}),a(r,{size:t.size})):r}(e,t):d(e,t)}function d(e,t={}){let r="";for(let t=0;t<e.length;t++)r+=u[e[t]];const n=`0x${r}`;return"number"==typeof t.size?(l(n,{size:t.size}),a(n,{dir:"right",size:t.size})):n}const p=new TextEncoder;function f(e,t={}){return d(p.encode(e),t)}},1785:(e,t,r)=>{r.d(t,{R:()=>i});var n=r(6036);const i={EmbeddedWalletAbortController:new AbortController,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"ORIGIN_NOT_ALLOWED"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{code:"APKT001",displayMessage:"Network Not Found",debugMessage:"The specified network is not recognized. Please ensure it is included in the `networks` array of your `createAppKit` configuration."},ORIGIN_NOT_ALLOWED:{code:"APKT002",displayMessage:"Invalid App Configuration",debugMessage:()=>`The origin ${(0,n.IP)()?window.origin:"unknown"} is not in your allow list. Please update your allowed domains at https://dashboard.reown.com.`},IFRAME_LOAD_FAILED:{code:"APKT003",displayMessage:"Network Error: Wallet Load Failed",debugMessage:()=>"Failed to load the embedded wallet. This may be due to network issues or server downtime. Please check your network connection and try again shortly. Contact support if the issue persists."},IFRAME_REQUEST_TIMEOUT:{code:"APKT004",displayMessage:"Wallet Request Timeout",debugMessage:()=>"The request to the embedded wallet timed out. Please check your network connection and try again shortly. Contact support if the issue persists."},UNVERIFIED_DOMAIN:{code:"APKT005",displayMessage:"Unverified Domain",debugMessage:()=>"Embedded wallet load failed. Ensure your domain is verified in https://dashboard.reown.com."},JWT_TOKEN_NOT_VALID:{code:"APKT006",displayMessage:"Session Expired",debugMessage:"Your session is invalid or expired. Please check your system’s date and time settings, then reconnect."},INVALID_PROJECT_ID:{code:"APKT007",displayMessage:"Invalid Project ID",debugMessage:"The specified project ID is invalid. Please visit https://dashboard.reown.com to obtain a valid project ID."},PROJECT_ID_NOT_CONFIGURED:{code:"APKT008",displayMessage:"Project ID Missing",debugMessage:"No project ID is configured. You can create and configure a project ID at https://dashboard.reown.com."},SERVER_ERROR_APP_CONFIGURATION:{code:"APKT009",displayMessage:"Server Error",debugMessage:e=>`Unable to fetch App Configuration. ${e}. Please check your network connection and try again shortly. Contact support if the issue persists.`},RATE_LIMITED_APP_CONFIGURATION:{code:"APKT010",displayMessage:"Rate Limited",debugMessage:"You have been rate limited while retrieving App Configuration. Please wait a few minutes and try again. Contact support if the issue persists."}},ALERT_WARNINGS:{LOCAL_CONFIGURATION_IGNORED:{debugMessage:e=>`[Reown Config Notice] ${e}`}}}},1786:(e,t,r)=>{var n=r(2861).Buffer;e.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==t[o])throw new TypeError(s+" is ambiguous");t[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return n.alloc(0);for(var r=0,i=0,s=0;e[r]===c;)i++,r++;for(var o=(e.length-r)*l+1>>>0,u=new Uint8Array(o);r<e.length;){var h=e.charCodeAt(r);if(h>255)return;var d=t[h];if(255===d)return;for(var p=0,f=o-1;(0!==d||p<s)&&-1!==f;f--,p++)d+=a*u[f]>>>0,u[f]=d%256>>>0,d=d/256>>>0;if(0!==d)throw new Error("Non-zero carry");s=p,r++}for(var g=o-s;g!==o&&0===u[g];)g++;var m=n.allocUnsafe(i+(o-g));m.fill(0,0,i);for(var y=i;g!==o;)m[y++]=u[g++];return m}return{encode:function(t){if((Array.isArray(t)||t instanceof Uint8Array)&&(t=n.from(t)),!n.isBuffer(t))throw new TypeError("Expected Buffer");if(0===t.length)return"";for(var r=0,i=0,s=0,o=t.length;s!==o&&0===t[s];)s++,r++;for(var l=(o-s)*u+1>>>0,h=new Uint8Array(l);s!==o;){for(var d=t[s],p=0,f=l-1;(0!==d||p<i)&&-1!==f;f--,p++)d+=256*h[f]>>>0,h[f]=d%a>>>0,d=d/a>>>0;if(0!==d)throw new Error("Non-zero carry");i=p,s++}for(var g=l-i;g!==l&&0===h[g];)g++;for(var m=c.repeat(r);g<l;++g)m+=e.charAt(h[g]);return m},decodeUnsafe:h,decode:function(e){var t=h(e);if(t)return t;throw new Error("Non-base"+a+" character")}}}},1825:(e,t,r)=>{r.d(t,{vE:()=>c,kb:()=>o});var n=r(8287),i=r(228),s=class extends i{socket;constructor(e,t,r){super(),this.socket=new window.WebSocket(e,r),this.socket.onopen=()=>this.emit("open"),this.socket.onmessage=e=>this.emit("message",e.data),this.socket.onerror=e=>this.emit("error",e),this.socket.onclose=e=>{this.emit("close",e.code,e.reason)}}send(e,t,r){const n=r||t;try{this.socket.send(e),n()}catch(e){n(e)}}close(e,t){this.socket.close(e,t)}addEventListener(e,t,r){this.socket.addEventListener(e,t,r)}};function o(e,t){return new s(e,t)}var a=class{encode(e){return JSON.stringify(e)}decode(e){return JSON.parse(e)}},c=class extends i{address;rpc_id;queue;options;autoconnect;ready;reconnect;reconnect_timer_id;reconnect_interval;max_reconnects;rest_options;current_reconnects;generate_request_id;socket;webSocketFactory;dataPack;constructor(e,t="ws://localhost:8080",{autoconnect:r=!0,reconnect:n=!0,reconnect_interval:i=1e3,max_reconnects:s=5,...o}={},c,l){super(),this.webSocketFactory=e,this.queue={},this.rpc_id=0,this.address=t,this.autoconnect=r,this.ready=!1,this.reconnect=n,this.reconnect_timer_id=void 0,this.reconnect_interval=i,this.max_reconnects=s,this.rest_options=o,this.current_reconnects=0,this.generate_request_id=c||(()=>"number"==typeof this.rpc_id?++this.rpc_id:Number(this.rpc_id)+1),this.dataPack=l||new a,this.autoconnect&&this._connect(this.address,{autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects,...this.rest_options})}connect(){this.socket||this._connect(this.address,{autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects,...this.rest_options})}call(e,t,r,n){return n||"object"!=typeof r||(n=r,r=null),new Promise((i,s)=>{if(!this.ready)return s(new Error("socket not ready"));const o=this.generate_request_id(e,t),a={jsonrpc:"2.0",method:e,params:t||void 0,id:o};this.socket.send(this.dataPack.encode(a),n,e=>{if(e)return s(e);this.queue[o]={promise:[i,s]},r&&(this.queue[o].timeout=setTimeout(()=>{delete this.queue[o],s(new Error("reply timeout"))},r))})})}async login(e){const t=await this.call("rpc.login",e);if(!t)throw new Error("authentication failed");return t}async listMethods(){return await this.call("__listMethods")}notify(e,t){return new Promise((r,n)=>{if(!this.ready)return n(new Error("socket not ready"));const i={jsonrpc:"2.0",method:e,params:t};this.socket.send(this.dataPack.encode(i),e=>{if(e)return n(e);r()})})}async subscribe(e){"string"==typeof e&&(e=[e]);const t=await this.call("rpc.on",e);if("string"==typeof e&&"ok"!==t[e])throw new Error("Failed subscribing to an event '"+e+"' with: "+t[e]);return t}async unsubscribe(e){"string"==typeof e&&(e=[e]);const t=await this.call("rpc.off",e);if("string"==typeof e&&"ok"!==t[e])throw new Error("Failed unsubscribing from an event with: "+t);return t}close(e,t){this.socket.close(e||1e3,t)}setAutoReconnect(e){this.reconnect=e}setReconnectInterval(e){this.reconnect_interval=e}setMaxReconnects(e){this.max_reconnects=e}_connect(e,t){clearTimeout(this.reconnect_timer_id),this.socket=this.webSocketFactory(e,t),this.socket.addEventListener("open",()=>{this.ready=!0,this.emit("open"),this.current_reconnects=0}),this.socket.addEventListener("message",({data:e})=>{e instanceof ArrayBuffer&&(e=n.Buffer.from(e).toString());try{e=this.dataPack.decode(e)}catch(e){return}if(e.notification&&this.listeners(e.notification).length){if(!Object.keys(e.params).length)return this.emit(e.notification);const t=[e.notification];if(e.params.constructor===Object)t.push(e.params);else for(let r=0;r<e.params.length;r++)t.push(e.params[r]);return Promise.resolve().then(()=>{this.emit.apply(this,t)})}if(!this.queue[e.id])return e.method?Promise.resolve().then(()=>{this.emit(e.method,e?.params)}):void 0;"error"in e=="result"in e&&this.queue[e.id].promise[1](new Error('Server response malformed. Response must include either "result" or "error", but not both.')),this.queue[e.id].timeout&&clearTimeout(this.queue[e.id].timeout),e.error?this.queue[e.id].promise[1](e.error):this.queue[e.id].promise[0](e.result),delete this.queue[e.id]}),this.socket.addEventListener("error",e=>this.emit("error",e)),this.socket.addEventListener("close",({code:r,reason:n})=>{this.ready&&setTimeout(()=>this.emit("close",r,n),0),this.ready=!1,this.socket=void 0,1e3!==r&&(this.current_reconnects++,this.reconnect&&(this.max_reconnects>this.current_reconnects||0===this.max_reconnects)&&(this.reconnect_timer_id=setTimeout(()=>this._connect(e,t),this.reconnect_interval)))})}}},1843:(e,t,r)=>{const n=r(829);function i(e,t){return e[t]^e[t+1]<<8^e[t+2]<<16^e[t+3]<<24}function s(e,t,r,n,i,s){l[e]=l[e]+l[t]+i,l[n]=o(l[n]^l[e],16),l[r]=l[r]+l[n],l[t]=o(l[t]^l[r],12),l[e]=l[e]+l[t]+s,l[n]=o(l[n]^l[e],8),l[r]=l[r]+l[n],l[t]=o(l[t]^l[r],7)}function o(e,t){return e>>>t^e<<32-t}const a=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),c=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),l=new Uint32Array(16),u=new Uint32Array(16);function h(e,t){let r=0;for(r=0;r<8;r++)l[r]=e.h[r],l[r+8]=a[r];for(l[12]^=e.t,l[13]^=e.t/4294967296,t&&(l[14]=~l[14]),r=0;r<16;r++)u[r]=i(e.b,4*r);for(r=0;r<10;r++)s(0,4,8,12,u[c[16*r+0]],u[c[16*r+1]]),s(1,5,9,13,u[c[16*r+2]],u[c[16*r+3]]),s(2,6,10,14,u[c[16*r+4]],u[c[16*r+5]]),s(3,7,11,15,u[c[16*r+6]],u[c[16*r+7]]),s(0,5,10,15,u[c[16*r+8]],u[c[16*r+9]]),s(1,6,11,12,u[c[16*r+10]],u[c[16*r+11]]),s(2,7,8,13,u[c[16*r+12]],u[c[16*r+13]]),s(3,4,9,14,u[c[16*r+14]],u[c[16*r+15]]);for(r=0;r<8;r++)e.h[r]^=l[r]^l[r+8]}function d(e,t){if(!(e>0&&e<=32))throw new Error("Incorrect output length, should be in [1, 32]");const r=t?t.length:0;if(t&&!(r>0&&r<=32))throw new Error("Incorrect key length, should be in [1, 32]");const n={h:new Uint32Array(a),b:new Uint8Array(64),c:0,t:0,outlen:e};return n.h[0]^=16842752^r<<8^e,r>0&&(p(n,t),n.c=64),n}function p(e,t){for(let r=0;r<t.length;r++)64===e.c&&(e.t+=e.c,h(e,!1),e.c=0),e.b[e.c++]=t[r]}function f(e){for(e.t+=e.c;e.c<64;)e.b[e.c++]=0;h(e,!0);const t=new Uint8Array(e.outlen);for(let r=0;r<e.outlen;r++)t[r]=e.h[r>>2]>>8*(3&r)&255;return t}function g(e,t,r){r=r||32,e=n.normalizeInput(e);const i=d(r,t);return p(i,e),f(i)}e.exports={blake2s:g,blake2sHex:function(e,t,r){const i=g(e,t,r);return n.toHex(i)},blake2sInit:d,blake2sUpdate:p,blake2sFinal:f}},1848:(e,t,r)=>{r.d(t,{DS:()=>A,OG:()=>v,Ph:()=>u,SJ:()=>_,aK:()=>w,d6:()=>o,dJ:()=>b,eV:()=>a,ex:()=>g,fg:()=>E,lX:()=>h,lq:()=>d,nC:()=>m,qj:()=>f,x:()=>I,z:()=>p,zW:()=>c});var n=r(2531);const i=BigInt(0),s=BigInt(1);function o(e,t=""){if("boolean"!=typeof e)throw new Error((t&&`"${t}"`)+"expected boolean, got type="+typeof e);return e}function a(e,t,r=""){const i=(0,n.aY)(e),s=e?.length,o=void 0!==t;if(!i||o&&s!==t)throw new Error((r&&`"${r}" `)+"expected Uint8Array"+(o?` of length ${t}`:"")+", got "+(i?`length=${s}`:"type="+typeof e));return e}function c(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function l(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?i:BigInt("0x"+e)}function u(e){return l((0,n.My)(e))}function h(e){return(0,n.DO)(e),l((0,n.My)(Uint8Array.from(e).reverse()))}function d(e,t){return(0,n.aT)(e.toString(16).padStart(2*t,"0"))}function p(e,t){return d(e,t).reverse()}function f(e,t,r){let i;if("string"==typeof t)try{i=(0,n.aT)(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!(0,n.aY)(t))throw new Error(e+" must be hex string or Uint8Array");i=Uint8Array.from(t)}const s=i.length;if("number"==typeof r&&s!==r)throw new Error(e+" of length "+r+" expected, got "+s);return i}function g(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}function m(e){return Uint8Array.from(e)}const y=e=>"bigint"==typeof e&&i<=e;function w(e,t,r,n){if(!function(e,t,r){return y(e)&&y(t)&&y(r)&&t<=e&&e<r}(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}function b(e){let t;for(t=0;e>i;e>>=s,t+=1);return t}const v=e=>(s<<BigInt(e))-s;function E(e,t,r){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof r)throw new Error("hmacFn must be a function");const i=e=>new Uint8Array(e),s=e=>Uint8Array.of(e);let o=i(e),a=i(e),c=0;const l=()=>{o.fill(1),a.fill(0),c=0},u=(...e)=>r(a,o,...e),h=(e=i(0))=>{a=u(s(0),e),o=u(),0!==e.length&&(a=u(s(1),e),o=u())},d=()=>{if(c++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const r=[];for(;e<t;){o=u();const t=o.slice();r.push(t),e+=o.length}return(0,n.Id)(...r)};return(e,t)=>{let r;for(l(),h(e);!(r=t(d()));)h();return l(),r}}function A(e,t,r={}){if(!e||"object"!=typeof e)throw new Error("expected valid options object");function n(t,r,n){const i=e[t];if(n&&void 0===i)return;const s=typeof i;if(s!==r||null===i)throw new Error(`param "${t}" is invalid: expected ${r}, got ${s}`)}Object.entries(t).forEach(([e,t])=>n(e,t,!1)),Object.entries(r).forEach(([e,t])=>n(e,t,!0))}const _=()=>{throw new Error("not implemented")};function I(e){const t=new WeakMap;return(r,...n)=>{const i=t.get(r);if(void 0!==i)return i;const s=e(r,...n);return t.set(r,s),s}}},1861:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=5*t.ONE_MINUTE,t.TEN_MINUTES=10*t.ONE_MINUTE,t.THIRTY_MINUTES=30*t.ONE_MINUTE,t.SIXTY_MINUTES=60*t.ONE_MINUTE,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=3*t.ONE_HOUR,t.SIX_HOURS=6*t.ONE_HOUR,t.TWELVE_HOURS=12*t.ONE_HOUR,t.TWENTY_FOUR_HOURS=24*t.ONE_HOUR,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=3*t.ONE_DAY,t.FIVE_DAYS=5*t.ONE_DAY,t.SEVEN_DAYS=7*t.ONE_DAY,t.THIRTY_DAYS=30*t.ONE_DAY,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=2*t.ONE_WEEK,t.THREE_WEEKS=3*t.ONE_WEEK,t.FOUR_WEEKS=4*t.ONE_WEEK,t.ONE_YEAR=365*t.ONE_DAY},1871:(e,t,r)=>{r.d(t,{P:()=>c});var n=r(8126),i=r(4707),s=r(6742);const o=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),a=(0,n.BX)({...o}),c={state:a,subscribeKey:(e,t)=>(0,i.u$)(a,e,t),showLoading(e,t={}){this._showMessage({message:e,variant:"loading",...t})},showSuccess(e){this._showMessage({message:e,variant:"success"})},showSvg(e,t){this._showMessage({message:e,svg:t})},showError(e){const t=s.w.parseError(e);this._showMessage({message:t,variant:"error"})},hide(){a.message=o.message,a.variant=o.variant,a.svg=o.svg,a.open=o.open,a.autoClose=o.autoClose},_showMessage({message:e,svg:t,variant:r="success",autoClose:n=o.autoClose}){a.open?(a.open=!1,setTimeout(()=>{a.message=e,a.variant=r,a.svg=t,a.open=!0,a.autoClose=n},150)):(a.message=e,a.variant=r,a.svg=t,a.open=!0,a.autoClose=n)}}},2010:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),r(5215).__exportStar(r(3093),t)},2063:(e,t,r)=>{t.g=void 0;const n=r(8196);t.g=function(){let e,t;try{e=n.getDocumentOrThrow(),t=n.getLocationOrThrow()}catch(e){return null}function r(...t){const r=e.getElementsByTagName("meta");for(let e=0;e<r.length;e++){const n=r[e],i=["itemprop","property","name"].map(e=>n.getAttribute(e)).filter(e=>!!e&&t.includes(e));if(i.length&&i){const e=n.getAttribute("content");if(e)return e}}return""}const i=function(){let t=r("name","og:site_name","og:title","twitter:title");return t||(t=e.title),t}();return{description:r("description","og:description","twitter:description","keywords"),url:t.origin,icons:function(){const r=e.getElementsByTagName("link"),n=[];for(let e=0;e<r.length;e++){const i=r[e],s=i.getAttribute("rel");if(s&&s.toLowerCase().indexOf("icon")>-1){const e=i.getAttribute("href");if(e)if(-1===e.toLowerCase().indexOf("https:")&&-1===e.toLowerCase().indexOf("http:")&&0!==e.indexOf("//")){let r=t.protocol+"//"+t.host;if(0===e.indexOf("/"))r+=e;else{const n=t.pathname.split("/");n.pop(),r+=n.join("/")+"/"+e}n.push(r)}else if(0===e.indexOf("//")){const r=t.protocol+e;n.push(r)}else n.push(e)}}return n}(),name:i}}},2150:(e,t,r)=>{r.d(t,{KC:()=>k,KJ:()=>w,L5:()=>N,NW:()=>C,PV:()=>S,YO:()=>m,Yj:()=>I,ai:()=>E,au:()=>x,bz:()=>g,eu:()=>b,g1:()=>_,lq:()=>A,me:()=>v,vt:()=>h,zM:()=>y});class n extends TypeError{constructor(e,t){let r;const{message:n,explanation:i,...s}=e,{path:o}=e,a=0===o.length?n:`At path: ${o.join(".")} -- ${n}`;super(i??a),null!=i&&(this.cause=a),Object.assign(this,s),this.name=this.constructor.name,this.failures=()=>r??(r=[e,...t()])}}function i(e){return"object"==typeof e&&null!=e}function s(e){return i(e)&&!Array.isArray(e)}function o(e){return"symbol"==typeof e?e.toString():"string"==typeof e?JSON.stringify(e):`${e}`}function a(e,t,r,n){if(!0===e)return;!1===e?e={}:"string"==typeof e&&(e={message:e});const{path:i,branch:s}=t,{type:a}=r,{refinement:c,message:l=`Expected a value of type \`${a}\`${c?` with refinement \`${c}\``:""}, but received: \`${o(n)}\``}=e;return{value:n,type:a,refinement:c,key:i[i.length-1],path:i,branch:s,...e,message:l}}function*c(e,t,r,n){var s;i(s=e)&&"function"==typeof s[Symbol.iterator]||(e=[e]);for(const i of e){const e=a(i,t,r,n);e&&(yield e)}}function*l(e,t,r={}){const{path:n=[],branch:s=[e],coerce:o=!1,mask:a=!1}=r,c={path:n,branch:s,mask:a};o&&(e=t.coercer(e,c));let u="valid";for(const n of t.validator(e,c))n.explanation=r.message,u="not_valid",yield[n,void 0];for(let[h,d,p]of t.entries(e,c)){const t=l(d,p,{path:void 0===h?n:[...n,h],branch:void 0===h?s:[...s,d],coerce:o,mask:a,message:r.message});for(const r of t)r[0]?(u=null!=r[0].refinement?"not_refined":"not_valid",yield[r[0],void 0]):o&&(d=r[1],void 0===h?e=d:e instanceof Map?e.set(h,d):e instanceof Set?e.add(d):i(e)&&(void 0!==d||h in e)&&(e[h]=d))}if("not_valid"!==u)for(const n of t.refiner(e,c))n.explanation=r.message,u="not_refined",yield[n,void 0];"valid"===u&&(yield[void 0,e])}class u{constructor(e){const{type:t,schema:r,validator:n,refiner:i,coercer:s=e=>e,entries:o=function*(){}}=e;this.type=t,this.schema=r,this.entries=o,this.coercer=s,this.validator=n?(e,t)=>c(n(e,t),t,this,e):()=>[],this.refiner=i?(e,t)=>c(i(e,t),t,this,e):()=>[]}assert(e,t){return function(e,t,r){const n=p(e,t,{message:r});if(n[0])throw n[0]}(e,this,t)}create(e,t){return h(e,this,t)}is(e){return d(e,this)}mask(e,t){return function(e,t,r){const n=p(e,t,{coerce:!0,mask:!0,message:r});if(n[0])throw n[0];return n[1]}(e,this,t)}validate(e,t={}){return p(e,this,t)}}function h(e,t,r){const n=p(e,t,{coerce:!0,message:r});if(n[0])throw n[0];return n[1]}function d(e,t){return!p(e,t)[0]}function p(e,t,r={}){const i=l(e,t,r),s=function(e){const{done:t,value:r}=e.next();return t?void 0:r}(i);return s[0]?[new n(s[0],function*(){for(const e of i)e[0]&&(yield e[0])}),void 0]:[void 0,s[1]]}function f(e,t){return new u({type:e,schema:null,validator:t})}function g(){return f("any",()=>!0)}function m(e){return new u({type:"array",schema:e,*entries(t){if(e&&Array.isArray(t))for(const[r,n]of t.entries())yield[r,n,e]},coercer:e=>Array.isArray(e)?e.slice():e,validator:e=>Array.isArray(e)||`Expected an array value, but received: ${o(e)}`})}function y(){return f("boolean",e=>"boolean"==typeof e)}function w(e){return f("instance",t=>t instanceof e||`Expected a \`${e.name}\` instance, but received: ${o(t)}`)}function b(e){const t=o(e),r=typeof e;return new u({type:"literal",schema:"string"===r||"number"===r||"boolean"===r?e:null,validator:r=>r===e||`Expected the literal \`${t}\`, but received: ${o(r)}`})}function v(e){return new u({...e,validator:(t,r)=>null===t||e.validator(t,r),refiner:(t,r)=>null===t||e.refiner(t,r)})}function E(){return f("number",e=>"number"==typeof e&&!isNaN(e)||`Expected a number, but received: ${o(e)}`)}function A(e){return new u({...e,validator:(t,r)=>void 0===t||e.validator(t,r),refiner:(t,r)=>void 0===t||e.refiner(t,r)})}function _(e,t){return new u({type:"record",schema:null,*entries(r){if(i(r))for(const n in r){const i=r[n];yield[n,n,e],yield[n,i,t]}},validator:e=>s(e)||`Expected an object, but received: ${o(e)}`,coercer:e=>s(e)?{...e}:e})}function I(){return f("string",e=>"string"==typeof e||`Expected a string, but received: ${o(e)}`)}function S(e){const t=f("never",()=>!1);return new u({type:"tuple",schema:null,*entries(r){if(Array.isArray(r)){const n=Math.max(e.length,r.length);for(let i=0;i<n;i++)yield[i,r[i],e[i]||t]}},validator:e=>Array.isArray(e)||`Expected an array, but received: ${o(e)}`,coercer:e=>Array.isArray(e)?e.slice():e})}function C(e){const t=Object.keys(e);return new u({type:"type",schema:e,*entries(r){if(i(r))for(const n of t)yield[n,r[n],e[n]]},validator:e=>s(e)||`Expected an object, but received: ${o(e)}`,coercer:e=>s(e)?{...e}:e})}function k(e){const t=e.map(e=>e.type).join(" | ");return new u({type:"union",schema:null,coercer(t,r){for(const n of e){const[e,i]=n.validate(t,{coerce:!0,mask:r.mask});if(!e)return i}return t},validator(r,n){const i=[];for(const t of e){const[...e]=l(r,t,n),[s]=e;if(!s[0])return[];for(const[t]of e)t&&i.push(t)}return[`Expected the value to satisfy a union of \`${t}\`, but received: ${o(r)}`,...i]}})}function N(){return f("unknown",()=>!0)}function x(e,t,r){return new u({...e,coercer:(n,i)=>d(n,t)?e.coercer(r(n,i),i):e.coercer(n,i)})}},2493:(e,t,r)=>{const n=r(4156),i=r(1843);e.exports={blake2b:n.blake2b,blake2bHex:n.blake2bHex,blake2bInit:n.blake2bInit,blake2bUpdate:n.blake2bUpdate,blake2bFinal:n.blake2bFinal,blake2s:i.blake2s,blake2sHex:i.blake2sHex,blake2sInit:i.blake2sInit,blake2sUpdate:i.blake2sUpdate,blake2sFinal:i.blake2sFinal}},2531:(e,t,r)=>{r.d(t,{Vw:()=>S,DO:()=>o,CC:()=>c,sd:()=>a,Fe:()=>s,Ht:()=>l,My:()=>w,uH:()=>h,Id:()=>I,qj:()=>C,O8:()=>d,aT:()=>E,aY:()=>i,po:()=>k,Ow:()=>p,fd:()=>g,ZJ:()=>_,DH:()=>u,AI:()=>A});const n="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function i(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function s(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function o(e,...t){if(!i(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function a(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.createHasher");s(e.outputLen),s(e.blockLen)}function c(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function l(e,t){o(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function u(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function h(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function d(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function p(e,t){return e<<32-t|e>>>t}function f(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}const g=(()=>68===new Uint8Array(new Uint32Array([287454020]).buffer)[0])()?e=>e:function(e){for(let t=0;t<e.length;t++)e[t]=f(e[t]);return e},m=(()=>"function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex)(),y=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function w(e){if(o(e),m)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=y[e[r]];return t}const b={_0:48,_9:57,A:65,F:70,a:97,f:102};function v(e){return e>=b._0&&e<=b._9?e-b._0:e>=b.A&&e<=b.F?e-(b.A-10):e>=b.a&&e<=b.f?e-(b.a-10):void 0}function E(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);if(m)return Uint8Array.fromHex(e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let t=0,i=0;t<r;t++,i+=2){const r=v(e.charCodeAt(i)),s=v(e.charCodeAt(i+1));if(void 0===r||void 0===s){const t=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+i)}n[t]=16*r+s}return n}function A(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}function _(e){return"string"==typeof e&&(e=A(e)),o(e),e}function I(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];o(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}class S{}function C(e){const t=t=>e().update(_(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function k(e=32){if(n&&"function"==typeof n.getRandomValues)return n.getRandomValues(new Uint8Array(e));if(n&&"function"==typeof n.randomBytes)return Uint8Array.from(n.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}},2571:(e,t,r)=>{r.d(t,{L:()=>s});var n=r(4376),i=r(9510);const s={ConnectorExplorerIds:{[n.o.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[n.o.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[n.o.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[n.o.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[n.o.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[i.o.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[i.o.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[i.o.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[i.o.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[i.o.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[i.o.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[i.o.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[i.o.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[i.o.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[i.o.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[i.o.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},ConnectorImageIds:{[n.o.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[n.o.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[n.o.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[n.o.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[n.o.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[n.o.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[n.o.CONNECTOR_ID.INJECTED]:"Browser Wallet",[n.o.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[n.o.CONNECTOR_ID.COINBASE]:"Coinbase",[n.o.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[n.o.CONNECTOR_ID.LEDGER]:"Ledger",[n.o.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[n.o.CONNECTOR_ID.INJECTED]:"INJECTED",[n.o.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[n.o.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[n.o.CONNECTOR_ID.AUTH]:"AUTH",[i.o.CONNECTOR_TYPE_AUTH]:"AUTH"},WalletConnectRpcChainIds:[1,5,11155111,10,420,42161,421613,137,80001,42220,1313161554,1313161555,56,97,43114,43113,100,8453,84531,7777777,999,324,280]}},2618:(e,t,r)=>{r.d(t,{WF:()=>o,AH:()=>n.AH,qy:()=>i.qy,JW:()=>i.JW,iz:()=>n.iz});var n=r(842),i=r(6752);const s=globalThis;class o extends n.mN{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=(0,i.XX)(t,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return i.c0}}o._$litElement$=!0,o.finalized=!0,s.litElementHydrateSupport?.({LitElement:o});const a=s.litElementPolyfillSupport;a?.({LitElement:o}),(s.litElementVersions??=[]).push("4.2.1")},2733:(e,t,r)=>{r.d(t,{H:()=>l});var n=r(8126),i=r(4707),s=r(2944),o=r(6742);const a={getFeatureValue(e,t){const r=t?.[e];return void 0===r?s.oU.DEFAULT_FEATURES[e]:r},filterSocialsByPlatform(e){if(!e||!e.length)return e;if(o.w.isTelegram()){if(o.w.isIos())return e.filter(e=>"google"!==e);if(o.w.isMac())return e.filter(e=>"x"!==e);if(o.w.isAndroid())return e.filter(e=>!["facebook","x"].includes(e))}return e}},c=(0,n.BX)({features:s.oU.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:s.oU.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1,remoteFeatures:{}}),l={state:c,subscribeKey:(e,t)=>(0,i.u$)(c,e,t),setOptions(e){Object.assign(c,e)},setRemoteFeatures(e){if(!e)return;const t={...c.remoteFeatures,...e};c.remoteFeatures=t,c.remoteFeatures?.socials&&(c.remoteFeatures.socials=a.filterSocialsByPlatform(c.remoteFeatures.socials)),c.features?.pay&&(c.remoteFeatures.email=!1,c.remoteFeatures.socials=!1)},setFeatures(e){if(!e)return;c.features||(c.features=s.oU.DEFAULT_FEATURES);const t={...c.features,...e};c.features=t,c.features?.pay&&c.remoteFeatures&&(c.remoteFeatures.email=!1,c.remoteFeatures.socials=!1)},setProjectId(e){c.projectId=e},setCustomRpcUrls(e){c.customRpcUrls=e},setAllWallets(e){c.allWallets=e},setIncludeWalletIds(e){c.includeWalletIds=e},setExcludeWalletIds(e){c.excludeWalletIds=e},setFeaturedWalletIds(e){c.featuredWalletIds=e},setTokens(e){c.tokens=e},setTermsConditionsUrl(e){c.termsConditionsUrl=e},setPrivacyPolicyUrl(e){c.privacyPolicyUrl=e},setCustomWallets(e){c.customWallets=e},setIsSiweEnabled(e){c.isSiweEnabled=e},setIsUniversalProvider(e){c.isUniversalProvider=e},setSdkVersion(e){c.sdkVersion=e},setMetadata(e){c.metadata=e},setDisableAppend(e){c.disableAppend=e},setEIP6963Enabled(e){c.enableEIP6963=e},setDebug(e){c.debug=e},setEnableWalletConnect(e){c.enableWalletConnect=e},setEnableWalletGuide(e){c.enableWalletGuide=e},setEnableAuthLogger(e){c.enableAuthLogger=e},setEnableWallets(e){c.enableWallets=e},setPreferUniversalLinks(e){c.experimental_preferUniversalLinks=e},setSIWX(e){if(e)for(const[t,r]of Object.entries(s.oU.SIWX_DEFAULTS))e[t]??=r;c.siwx=e},setConnectMethodsOrder(e){c.features={...c.features,connectMethodsOrder:e}},setWalletFeaturesOrder(e){c.features={...c.features,walletFeaturesOrder:e}},setSocialsOrder(e){c.remoteFeatures={...c.remoteFeatures,socials:e}},setCollapseWallets(e){c.features={...c.features,collapseWallets:e}},setEnableEmbedded(e){c.enableEmbedded=e},setAllowUnsupportedChain(e){c.allowUnsupportedChain=e},setManualWCControl(e){c.manualWCControl=e},setEnableNetworkSwitch(e){c.enableNetworkSwitch=e},setEnableReconnect(e){c.enableReconnect=e},setDefaultAccountTypes(e={}){Object.entries(e).forEach(([e,t])=>{t&&(c.defaultAccountTypes[e]=t)})},setUniversalProviderConfigOverride(e){c.universalProviderConfigOverride=e},getUniversalProviderConfigOverride:()=>c.universalProviderConfigOverride,getSnapshot:()=>(0,n.P9)(c)}},2755:function(e,t,r){var n=r(8287).Buffer,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__decorate||function(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&i(t,e,r);return s(t,e),t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeUnchecked=t.deserialize=t.serialize=t.BinaryReader=t.BinaryWriter=t.BorshError=t.baseDecode=t.baseEncode=void 0;const l=c(r(9404)),u=c(r(4989)),h=a(r(4281)),d=new("function"!=typeof TextDecoder?h.TextDecoder:TextDecoder)("utf-8",{fatal:!0});t.baseEncode=function(e){return"string"==typeof e&&(e=n.from(e,"utf8")),u.default.encode(n.from(e))},t.baseDecode=function(e){return n.from(u.default.decode(e))};const p=1024;class f extends Error{constructor(e){super(e),this.fieldPath=[],this.originalMessage=e}addToFieldPath(e){this.fieldPath.splice(0,0,e),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}t.BorshError=f;class g{constructor(){this.buf=n.alloc(p),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=n.concat([this.buf,n.alloc(p)]))}writeU8(e){this.maybeResize(),this.buf.writeUInt8(e,this.length),this.length+=1}writeU16(e){this.maybeResize(),this.buf.writeUInt16LE(e,this.length),this.length+=2}writeU32(e){this.maybeResize(),this.buf.writeUInt32LE(e,this.length),this.length+=4}writeU64(e){this.maybeResize(),this.writeBuffer(n.from(new l.default(e).toArray("le",8)))}writeU128(e){this.maybeResize(),this.writeBuffer(n.from(new l.default(e).toArray("le",16)))}writeU256(e){this.maybeResize(),this.writeBuffer(n.from(new l.default(e).toArray("le",32)))}writeU512(e){this.maybeResize(),this.writeBuffer(n.from(new l.default(e).toArray("le",64)))}writeBuffer(e){this.buf=n.concat([n.from(this.buf.subarray(0,this.length)),e,n.alloc(p)]),this.length+=e.length}writeString(e){this.maybeResize();const t=n.from(e,"utf8");this.writeU32(t.length),this.writeBuffer(t)}writeFixedArray(e){this.writeBuffer(n.from(e))}writeArray(e,t){this.maybeResize(),this.writeU32(e.length);for(const r of e)this.maybeResize(),t(r)}toArray(){return this.buf.subarray(0,this.length)}}function m(e,t,r){const n=r.value;r.value=function(...e){try{return n.apply(this,e)}catch(e){if(e instanceof RangeError){const t=e.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(t)>=0)throw new f("Reached the end of buffer when deserializing")}throw e}}}t.BinaryWriter=g;class y{constructor(e){this.buf=e,this.offset=0}readU8(){const e=this.buf.readUInt8(this.offset);return this.offset+=1,e}readU16(){const e=this.buf.readUInt16LE(this.offset);return this.offset+=2,e}readU32(){const e=this.buf.readUInt32LE(this.offset);return this.offset+=4,e}readU64(){const e=this.readBuffer(8);return new l.default(e,"le")}readU128(){const e=this.readBuffer(16);return new l.default(e,"le")}readU256(){const e=this.readBuffer(32);return new l.default(e,"le")}readU512(){const e=this.readBuffer(64);return new l.default(e,"le")}readBuffer(e){if(this.offset+e>this.buf.length)throw new f(`Expected buffer length ${e} isn't within bounds`);const t=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,t}readString(){const e=this.readU32(),t=this.readBuffer(e);try{return d.decode(t)}catch(e){throw new f(`Error decoding UTF-8 string: ${e}`)}}readFixedArray(e){return new Uint8Array(this.readBuffer(e))}readArray(e){const t=this.readU32(),r=Array();for(let n=0;n<t;++n)r.push(e());return r}}function w(e){return e.charAt(0).toUpperCase()+e.slice(1)}function b(e,t,r,n,i){try{if("string"==typeof n)i[`write${w(n)}`](r);else if(n instanceof Array)if("number"==typeof n[0]){if(r.length!==n[0])throw new f(`Expecting byte array of length ${n[0]}, but got ${r.length} bytes`);i.writeFixedArray(r)}else if(2===n.length&&"number"==typeof n[1]){if(r.length!==n[1])throw new f(`Expecting byte array of length ${n[1]}, but got ${r.length} bytes`);for(let t=0;t<n[1];t++)b(e,null,r[t],n[0],i)}else i.writeArray(r,r=>{b(e,t,r,n[0],i)});else if(void 0!==n.kind)switch(n.kind){case"option":null==r?i.writeU8(0):(i.writeU8(1),b(e,t,r,n.type,i));break;case"map":i.writeU32(r.size),r.forEach((r,s)=>{b(e,t,s,n.key,i),b(e,t,r,n.value,i)});break;default:throw new f(`FieldType ${n} unrecognized`)}else v(e,r,i)}catch(e){throw e instanceof f&&e.addToFieldPath(t),e}}function v(e,t,r){if("function"==typeof t.borshSerialize)return void t.borshSerialize(r);const n=e.get(t.constructor);if(!n)throw new f(`Class ${t.constructor.name} is missing in schema`);if("struct"===n.kind)n.fields.map(([n,i])=>{b(e,n,t[n],i,r)});else{if("enum"!==n.kind)throw new f(`Unexpected schema kind: ${n.kind} for ${t.constructor.name}`);{const i=t[n.field];for(let s=0;s<n.values.length;++s){const[o,a]=n.values[s];if(o===i){r.writeU8(s),b(e,o,t[o],a,r);break}}}}}function E(e,t,r,n){try{if("string"==typeof r)return n[`read${w(r)}`]();if(r instanceof Array){if("number"==typeof r[0])return n.readFixedArray(r[0]);if("number"==typeof r[1]){const t=[];for(let i=0;i<r[1];i++)t.push(E(e,null,r[0],n));return t}return n.readArray(()=>E(e,t,r[0],n))}if("option"===r.kind)return n.readU8()?E(e,t,r.type,n):void 0;if("map"===r.kind){let i=new Map;const s=n.readU32();for(let o=0;o<s;o++){const s=E(e,t,r.key,n),o=E(e,t,r.value,n);i.set(s,o)}return i}return A(e,r,n)}catch(e){throw e instanceof f&&e.addToFieldPath(t),e}}function A(e,t,r){if("function"==typeof t.borshDeserialize)return t.borshDeserialize(r);const n=e.get(t);if(!n)throw new f(`Class ${t.name} is missing in schema`);if("struct"===n.kind){const n={};for(const[i,s]of e.get(t).fields)n[i]=E(e,i,s,r);return new t(n)}if("enum"===n.kind){const i=r.readU8();if(i>=n.values.length)throw new f(`Enum index: ${i} is out of range`);const[s,o]=n.values[i],a=E(e,s,o,r);return new t({[s]:a})}throw new f(`Unexpected schema kind: ${n.kind} for ${t.constructor.name}`)}o([m],y.prototype,"readU8",null),o([m],y.prototype,"readU16",null),o([m],y.prototype,"readU32",null),o([m],y.prototype,"readU64",null),o([m],y.prototype,"readU128",null),o([m],y.prototype,"readU256",null),o([m],y.prototype,"readU512",null),o([m],y.prototype,"readString",null),o([m],y.prototype,"readFixedArray",null),o([m],y.prototype,"readArray",null),t.BinaryReader=y,t.serialize=function(e,t,r=g){const n=new r;return v(e,t,n),n.toArray()},t.deserialize=function(e,t,r,n=y){const i=new n(r),s=A(e,t,i);if(i.offset<r.length)throw new f(`Unexpected ${r.length-i.offset} bytes after deserialized data`);return s},t.deserializeUnchecked=function(e,t,r,n=y){return A(e,t,new n(r))}},2861:(e,t,r)=>{var n=r(8287),i=n.Buffer;function s(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(s(n,t),t.Buffer=o),o.prototype=Object.create(i.prototype),s(i,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},2944:(e,t,r)=>{r.d(t,{Db:()=>o,oU:()=>a,tM:()=>s});var n=r(4376);const i=("undefined"!=typeof process&&void 0!==process.env?process.env.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",s=[{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],o="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",a={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:i,SECURE_SITE_DASHBOARD:`${i}/dashboard`,SECURE_SITE_FAVICON:`${i}/images/favicon.png`,RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],BALANCE_SUPPORTED_CHAINS:[n.o.CHAIN.EVM,n.o.CHAIN.SOLANA],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:[n.o.CHAIN.EVM],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:[n.o.CHAIN.EVM,n.o.CHAIN.SOLANA],ACTIVITY_ENABLED_CHAIN_NAMESPACES:[n.o.CHAIN.EVM],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x",sui:"0x",stacks:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app",WEB:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:[n.o.CHAIN.EVM,n.o.CHAIN.SOLANA],DEFAULT_REMOTE_FEATURES:{swaps:["1inch"],onramp:["meld"],email:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],activity:!0,reownBranding:!0,multiWallet:!1,emailCapture:!1},DEFAULT_REMOTE_FEATURES_DISABLED:{email:!1,socials:!1,swaps:!1,onramp:!1,activity:!1,reownBranding:!1,emailCapture:!1},DEFAULT_FEATURES:{receive:!0,send:!0,emailShowWallets:!0,connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1},DEFAULT_SOCIALS:["google","x","farcaster","discord","apple","github","facebook"],DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"},SIWX_DEFAULTS:{signOutOnDisconnect:!0}}},2985:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.delay=void 0,t.delay=function(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}},3093:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IWatch=void 0,t.IWatch=class{}},3096:(e,t,r)=>{function n(e,t){return"light"===t?{"--w3m-accent":e?.["--w3m-accent"]||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":e?.["--w3m-accent"]||"hsla(230, 100%, 67%, 1)","--w3m-background":"#121313"}}r.d(t,{o:()=>n})},3289:(e,t,r)=>{const n=r(8341).v4;e.exports=function(e,t,r,i){if("string"!=typeof e)throw new TypeError(e+" must be a string");const s="number"==typeof(i=i||{}).version?i.version:2;if(1!==s&&2!==s)throw new TypeError(s+" must be 1 or 2");const o={method:e};if(2===s&&(o.jsonrpc="2.0"),t){if("object"!=typeof t&&!Array.isArray(t))throw new TypeError(t+" must be an object, array or omitted");o.params=t}if(void 0===r){const e="function"==typeof i.generator?i.generator:function(){return n()};o.id=e(o,i)}else 2===s&&null===r?i.notificationIdNull&&(o.id=null):o.id=r;return o}},3337:(e,t,r)=>{r.d(t,{j:()=>c});var n=r(8126),i=r(4707),s=r(5940);const o=(0,n.BX)({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),a={state:o,subscribeNetworkImages:e=>(0,n.B1)(o.networkImages,()=>e(o.networkImages)),subscribeKey:(e,t)=>(0,i.u$)(o,e,t),subscribe:e=>(0,n.B1)(o,()=>e(o)),setWalletImage(e,t){o.walletImages[e]=t},setNetworkImage(e,t){o.networkImages[e]=t},setChainImage(e,t){o.chainImages[e]=t},setConnectorImage(e,t){o.connectorImages={...o.connectorImages,[e]:t}},setTokenImage(e,t){o.tokenImages[e]=t},setCurrencyImage(e,t){o.currencyImages[e]=t}},c=(0,s.X)(a)},3450:(e,t,r)=>{r.d(t,{U:()=>d});var n=r(8126),i=r(8075),s=r(2944),o=r(6742),a=r(5940),c=r(6056),l=r(1871);const u=(0,n.BX)({currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map}),h={state:u,replaceState(e){e&&Object.assign(u,(0,n.KR)(e))},subscribe:e=>c.W.subscribeChainProp("accountState",t=>{if(t)return e(t)}),subscribeKey(e,t,r){let n;return c.W.subscribeChainProp("accountState",r=>{if(r){const i=r[e];n!==i&&(n=i,t(i))}},r)},setStatus(e,t){c.W.setAccountProp("status",e,t)},getCaipAddress(e){if(e)return c.W.state.chains.get(e)?.accountState?.caipAddress},setCaipAddress(e,t){const r=e?o.w.getPlainAddress(e):void 0;t===c.W.state.activeChain&&(c.W.state.activeCaipAddress=e),c.W.setAccountProp("caipAddress",e,t),c.W.setAccountProp("address",r,t)},setBalance(e,t,r){c.W.setAccountProp("balance",e,r),c.W.setAccountProp("balanceSymbol",t,r)},setProfileName(e,t){c.W.setAccountProp("profileName",e,t)},setProfileImage(e,t){c.W.setAccountProp("profileImage",e,t)},setUser(e,t){c.W.setAccountProp("user",e,t)},setAddressExplorerUrl(e,t){c.W.setAccountProp("addressExplorerUrl",e,t)},setSmartAccountDeployed(e,t){c.W.setAccountProp("smartAccountDeployed",e,t)},setCurrentTab(e){c.W.setAccountProp("currentTab",e,c.W.state.activeChain)},setTokenBalance(e,t){e&&c.W.setAccountProp("tokenBalance",e,t)},setShouldUpdateToAddress(e,t){c.W.setAccountProp("shouldUpdateToAddress",e,t)},addAddressLabel(e,t,r){if(!r)return;const n=c.W.state.chains.get(r)?.accountState?.addressLabels||new Map;n.set(e,t),c.W.setAccountProp("addressLabels",n,r)},removeAddressLabel(e,t){if(!t)return;const r=c.W.state.chains.get(t)?.accountState?.addressLabels||new Map;r.delete(e),c.W.setAccountProp("addressLabels",r,t)},setConnectedWalletInfo(e,t){c.W.setAccountProp("connectedWalletInfo",e,t,!1)},setPreferredAccountType(e,t){c.W.setAccountProp("preferredAccountType",e,t)},setSocialProvider(e,t){e&&c.W.setAccountProp("socialProvider",e,t)},setSocialWindow(e,t){c.W.setAccountProp("socialWindow",e?(0,n.KR)(e):void 0,t)},setFarcasterUrl(e,t){c.W.setAccountProp("farcasterUrl",e,t)},async fetchTokenBalance(e){u.balanceLoading=!0;const t=c.W.state.activeCaipNetwork?.caipNetworkId,r=c.W.state.activeCaipNetwork?.chainNamespace,n=c.W.state.activeCaipAddress,a=n?o.w.getPlainAddress(n):void 0;if(u.lastRetry&&!o.w.isAllowedRetry(u.lastRetry,30*s.oU.ONE_SEC_MS))return u.balanceLoading=!1,[];try{if(a&&t&&r){const e=await i.Z.getMyTokensWithBalance();return d.setTokenBalance(e,r),u.lastRetry=void 0,u.balanceLoading=!1,e}}catch(t){u.lastRetry=Date.now(),e?.(t),l.P.showError("Token Balance Unavailable")}finally{u.balanceLoading=!1}return[]},resetAccount(e){c.W.resetAccount(e)}},d=(0,a.X)(h)},3466:(e,t,r)=>{var n=r(5621);e.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},3494:(e,t,r)=>{function n(e){return function(t){return"function"==typeof t?function(e,t){return customElements.get(e)||customElements.define(e,t),t}(e,t):function(e,t){const{kind:r,elements:n}=t;return{kind:r,elements:n,finisher(t){customElements.get(e)||customElements.define(e,t)}}}(e,t)}}r.d(t,{E:()=>n})},3495:(e,t,r)=>{r.d(t,{L:()=>i,P:()=>s});var n=r(4376);const i={caipNetworkIdToNumber:e=>e?Number(e.split(":")[1]):void 0,parseEvmChainId(e){return"string"==typeof e?this.caipNetworkIdToNumber(e):e},getNetworksByNamespace:(e,t)=>e?.filter(e=>e.chainNamespace===t)||[],getFirstNetworkByNamespace(e,t){return this.getNetworksByNamespace(e,t)[0]},getNetworkNameByCaipNetworkId(e,t){if(!t)return;const r=e.find(e=>e.caipNetworkId===t);if(r)return r.name;const[i]=t.split(":");return n.o.CHAIN_NAME_MAP?.[i]||void 0}},s=["eip155","solana","polkadot","bip122","cosmos","sui","stacks"]},3554:(e,t,r)=>{r.d(t,{h:()=>o,j:()=>s});const n=e=>JSON.stringify(e,(e,t)=>"bigint"==typeof t?t.toString()+"n":t),i=e=>{const t=e.replace(/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,'$1"$2n"$3');return JSON.parse(t,(e,t)=>"string"==typeof t&&t.match(/^\d+n$/)?BigInt(t.substring(0,t.length-1)):t)};function s(e){if("string"!=typeof e)throw new Error("Cannot safe json parse value of type "+typeof e);try{return i(e)}catch(t){return e}}function o(e){return"string"==typeof e?e:n(e)||""}},3581:function(e){e.exports=function(e,t,r){r.updateLocale=function(e,t){var n=r.Ls[e];if(n)return(t?Object.keys(t):[]).forEach(function(e){n[e]=t[e]}),n}}},3612:(e,t,r)=>{r.d(t,{Z:()=>n});const n={getSpacingStyles:(e,t)=>Array.isArray(e)?e[t]?`var(--wui-spacing-${e[t]})`:void 0:"string"==typeof e?`var(--wui-spacing-${e})`:void 0,getFormattedDate:e=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}).format(e),getHostName(e){try{return new URL(e).hostname}catch(e){return""}},getTruncateString:({string:e,charsStart:t,charsEnd:r,truncate:n})=>e.length<=t+r?e:"end"===n?`${e.substring(0,t)}...`:"start"===n?`...${e.substring(e.length-r)}`:`${e.substring(0,Math.floor(t))}...${e.substring(e.length-Math.floor(r))}`,generateAvatarColors(e){const t=e.toLowerCase().replace(/^0x/iu,"").replace(/[^a-f0-9]/gu,"").substring(0,6).padEnd(6,"0"),r=this.hexToRgb(t),n=getComputedStyle(document.documentElement).getPropertyValue("--w3m-border-radius-master"),i=100-3*Number(n?.replace("px","")),s=`${i}% ${i}% at 65% 40%`,o=[];for(let e=0;e<5;e+=1){const t=this.tintColor(r,.15*e);o.push(`rgb(${t[0]}, ${t[1]}, ${t[2]})`)}return`\n    --local-color-1: ${o[0]};\n    --local-color-2: ${o[1]};\n    --local-color-3: ${o[2]};\n    --local-color-4: ${o[3]};\n    --local-color-5: ${o[4]};\n    --local-radial-circle: ${s}\n   `},hexToRgb(e){const t=parseInt(e,16);return[t>>16&255,t>>8&255,255&t]},tintColor(e,t){const[r,n,i]=e;return[Math.round(r+(255-r)*t),Math.round(n+(255-n)*t),Math.round(i+(255-i)*t)]},isNumber:e=>/^[0-9]+$/u.test(e),getColorTheme:e=>e||("undefined"!=typeof window&&window.matchMedia&&"function"==typeof window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)")?.matches?"dark":"light":"dark"),splitBalance(e){const t=e.split(".");return 2===t.length?[t[0],t[1]]:["0","00"]},roundNumber:(e,t,r)=>e.toString().length>=t?Number(e).toFixed(r):e}},3768:(e,t,r)=>{r.d(t,{S:()=>g});var n=1e6,i="[big.js] ",s=i+"Invalid ",o=s+"decimal places",a=s+"rounding mode",c=i+"Division by zero",l={},u=void 0,h=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function d(e,t,r,n){var i=e.c;if(r===u&&(r=e.constructor.RM),0!==r&&1!==r&&2!==r&&3!==r)throw Error(a);if(t<1)n=3===r&&(n||!!i[0])||0===t&&(1===r&&i[0]>=5||2===r&&(i[0]>5||5===i[0]&&(n||i[1]!==u))),i.length=1,n?(e.e=e.e-t+1,i[0]=1):i[0]=e.e=0;else if(t<i.length){if(n=1===r&&i[t]>=5||2===r&&(i[t]>5||5===i[t]&&(n||i[t+1]!==u||1&i[t-1]))||3===r&&(n||!!i[0]),i.length=t,n)for(;++i[--t]>9;)if(i[t]=0,0===t){++e.e,i.unshift(1);break}for(t=i.length;!i[--t];)i.pop()}return e}function p(e,t,r){var n=e.e,i=e.c.join(""),s=i.length;if(t)i=i.charAt(0)+(s>1?"."+i.slice(1):"")+(n<0?"e":"e+")+n;else if(n<0){for(;++n;)i="0"+i;i="0."+i}else if(n>0)if(++n>s)for(n-=s;n--;)i+="0";else n<s&&(i=i.slice(0,n)+"."+i.slice(n));else s>1&&(i=i.charAt(0)+"."+i.slice(1));return e.s<0&&r?"-"+i:i}l.abs=function(){var e=new this.constructor(this);return e.s=1,e},l.cmp=function(e){var t,r=this,n=r.c,i=(e=new r.constructor(e)).c,s=r.s,o=e.s,a=r.e,c=e.e;if(!n[0]||!i[0])return n[0]?s:i[0]?-o:0;if(s!=o)return s;if(t=s<0,a!=c)return a>c^t?1:-1;for(o=(a=n.length)<(c=i.length)?a:c,s=-1;++s<o;)if(n[s]!=i[s])return n[s]>i[s]^t?1:-1;return a==c?0:a>c^t?1:-1},l.div=function(e){var t=this,r=t.constructor,i=t.c,s=(e=new r(e)).c,a=t.s==e.s?1:-1,l=r.DP;if(l!==~~l||l<0||l>n)throw Error(o);if(!s[0])throw Error(c);if(!i[0])return e.s=a,e.c=[e.e=0],e;var h,p,f,g,m,y=s.slice(),w=h=s.length,b=i.length,v=i.slice(0,h),E=v.length,A=e,_=A.c=[],I=0,S=l+(A.e=t.e-e.e)+1;for(A.s=a,a=S<0?0:S,y.unshift(0);E++<h;)v.push(0);do{for(f=0;f<10;f++){if(h!=(E=v.length))g=h>E?1:-1;else for(m=-1,g=0;++m<h;)if(s[m]!=v[m]){g=s[m]>v[m]?1:-1;break}if(!(g<0))break;for(p=E==h?s:y;E;){if(v[--E]<p[E]){for(m=E;m&&!v[--m];)v[m]=9;--v[m],v[E]+=10}v[E]-=p[E]}for(;!v[0];)v.shift()}_[I++]=g?f:++f,v[0]&&g?v[E]=i[w]||0:v=[i[w]]}while((w++<b||v[0]!==u)&&a--);return _[0]||1==I||(_.shift(),A.e--,S--),I>S&&d(A,S,r.RM,v[0]!==u),A},l.eq=function(e){return 0===this.cmp(e)},l.gt=function(e){return this.cmp(e)>0},l.gte=function(e){return this.cmp(e)>-1},l.lt=function(e){return this.cmp(e)<0},l.lte=function(e){return this.cmp(e)<1},l.minus=l.sub=function(e){var t,r,n,i,s=this,o=s.constructor,a=s.s,c=(e=new o(e)).s;if(a!=c)return e.s=-c,s.plus(e);var l=s.c.slice(),u=s.e,h=e.c,d=e.e;if(!l[0]||!h[0])return h[0]?e.s=-c:l[0]?e=new o(s):e.s=1,e;if(a=u-d){for((i=a<0)?(a=-a,n=l):(d=u,n=h),n.reverse(),c=a;c--;)n.push(0);n.reverse()}else for(r=((i=l.length<h.length)?l:h).length,a=c=0;c<r;c++)if(l[c]!=h[c]){i=l[c]<h[c];break}if(i&&(n=l,l=h,h=n,e.s=-e.s),(c=(r=h.length)-(t=l.length))>0)for(;c--;)l[t++]=0;for(c=t;r>a;){if(l[--r]<h[r]){for(t=r;t&&!l[--t];)l[t]=9;--l[t],l[r]+=10}l[r]-=h[r]}for(;0===l[--c];)l.pop();for(;0===l[0];)l.shift(),--d;return l[0]||(e.s=1,l=[d=0]),e.c=l,e.e=d,e},l.mod=function(e){var t,r=this,n=r.constructor,i=r.s,s=(e=new n(e)).s;if(!e.c[0])throw Error(c);return r.s=e.s=1,t=1==e.cmp(r),r.s=i,e.s=s,t?new n(r):(i=n.DP,s=n.RM,n.DP=n.RM=0,r=r.div(e),n.DP=i,n.RM=s,this.minus(r.times(e)))},l.neg=function(){var e=new this.constructor(this);return e.s=-e.s,e},l.plus=l.add=function(e){var t,r,n,i=this,s=i.constructor;if(e=new s(e),i.s!=e.s)return e.s=-e.s,i.minus(e);var o=i.e,a=i.c,c=e.e,l=e.c;if(!a[0]||!l[0])return l[0]||(a[0]?e=new s(i):e.s=i.s),e;if(a=a.slice(),t=o-c){for(t>0?(c=o,n=l):(t=-t,n=a),n.reverse();t--;)n.push(0);n.reverse()}for(a.length-l.length<0&&(n=l,l=a,a=n),t=l.length,r=0;t;a[t]%=10)r=(a[--t]=a[t]+l[t]+r)/10|0;for(r&&(a.unshift(r),++c),t=a.length;0===a[--t];)a.pop();return e.c=a,e.e=c,e},l.pow=function(e){var t=this,r=new t.constructor("1"),n=r,i=e<0;if(e!==~~e||e<-1e6||e>1e6)throw Error(s+"exponent");for(i&&(e=-e);1&e&&(n=n.times(t)),e>>=1;)t=t.times(t);return i?r.div(n):n},l.prec=function(e,t){if(e!==~~e||e<1||e>n)throw Error(s+"precision");return d(new this.constructor(this),e,t)},l.round=function(e,t){if(e===u)e=0;else if(e!==~~e||e<-n||e>n)throw Error(o);return d(new this.constructor(this),e+this.e+1,t)},l.sqrt=function(){var e,t,r,n=this,s=n.constructor,o=n.s,a=n.e,c=new s("0.5");if(!n.c[0])return new s(n);if(o<0)throw Error(i+"No square root");0===(o=Math.sqrt(+p(n,!0,!0)))||o===1/0?((t=n.c.join("")).length+a&1||(t+="0"),a=((a+1)/2|0)-(a<0||1&a),e=new s(((o=Math.sqrt(t))==1/0?"5e":(o=o.toExponential()).slice(0,o.indexOf("e")+1))+a)):e=new s(o+""),a=e.e+(s.DP+=4);do{r=e,e=c.times(r.plus(n.div(r)))}while(r.c.slice(0,a).join("")!==e.c.slice(0,a).join(""));return d(e,(s.DP-=4)+e.e+1,s.RM)},l.times=l.mul=function(e){var t,r=this,n=r.constructor,i=r.c,s=(e=new n(e)).c,o=i.length,a=s.length,c=r.e,l=e.e;if(e.s=r.s==e.s?1:-1,!i[0]||!s[0])return e.c=[e.e=0],e;for(e.e=c+l,o<a&&(t=i,i=s,s=t,l=o,o=a,a=l),t=new Array(l=o+a);l--;)t[l]=0;for(c=a;c--;){for(a=0,l=o+c;l>c;)a=t[l]+s[c]*i[l-c-1]+a,t[l--]=a%10,a=a/10|0;t[l]=a}for(a?++e.e:t.shift(),c=t.length;!t[--c];)t.pop();return e.c=t,e},l.toExponential=function(e,t){var r=this,i=r.c[0];if(e!==u){if(e!==~~e||e<0||e>n)throw Error(o);for(r=d(new r.constructor(r),++e,t);r.c.length<e;)r.c.push(0)}return p(r,!0,!!i)},l.toFixed=function(e,t){var r=this,i=r.c[0];if(e!==u){if(e!==~~e||e<0||e>n)throw Error(o);for(e=e+(r=d(new r.constructor(r),e+r.e+1,t)).e+1;r.c.length<e;)r.c.push(0)}return p(r,!1,!!i)},l[Symbol.for("nodejs.util.inspect.custom")]=l.toJSON=l.toString=function(){var e=this,t=e.constructor;return p(e,e.e<=t.NE||e.e>=t.PE,!!e.c[0])},l.toNumber=function(){var e=+p(this,!0,!0);if(!0===this.constructor.strict&&!this.eq(e.toString()))throw Error(i+"Imprecise conversion");return e},l.toPrecision=function(e,t){var r=this,i=r.constructor,o=r.c[0];if(e!==u){if(e!==~~e||e<1||e>n)throw Error(s+"precision");for(r=d(new i(r),e,t);r.c.length<e;)r.c.push(0)}return p(r,e<=r.e||r.e<=i.NE||r.e>=i.PE,!!o)},l.valueOf=function(){var e=this,t=e.constructor;if(!0===t.strict)throw Error(i+"valueOf disallowed");return p(e,e.e<=t.NE||e.e>=t.PE,!0)};const f=function e(){function t(r){var n=this;if(!(n instanceof t))return r===u?e():new t(r);if(r instanceof t)n.s=r.s,n.e=r.e,n.c=r.c.slice();else{if("string"!=typeof r){if(!0===t.strict&&"bigint"!=typeof r)throw TypeError(s+"value");r=0===r&&1/r<0?"-0":String(r)}!function(e,t){var r,n,i;if(!h.test(t))throw Error(s+"number");for(e.s="-"==t.charAt(0)?(t=t.slice(1),-1):1,(r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),i=t.length,n=0;n<i&&"0"==t.charAt(n);)++n;if(n==i)e.c=[e.e=0];else{for(;i>0&&"0"==t.charAt(--i););for(e.e=r-n-1,e.c=[],r=0;n<=i;)e.c[r++]=+t.charAt(n++)}}(n,r)}n.constructor=t}return t.prototype=l,t.DP=20,t.RM=1,t.NE=-7,t.PE=21,t.strict=!1,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}(),g={bigNumber:e=>new f(e||0),multiply(e,t){if(void 0===e||void 0===t)return new f(0);const r=new f(e),n=new f(t);return r.times(n)},toFixed:(e,t=2)=>void 0===e||""===e?new f(0).toFixed(t):new f(e).toFixed(t),formatNumberToLocalString:(e,t=2)=>void 0===e||""===e?"0.00":"number"==typeof e?e.toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t,roundingMode:"floor"}):parseFloat(e).toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t,roundingMode:"floor"}),parseLocalStringToNumber(e){if(void 0===e||""===e)return 0;const t=e.replace(/,/gu,"");return new f(t).toNumber()}}},4156:(e,t,r)=>{const n=r(829);function i(e,t,r){const n=e[t]+e[r];let i=e[t+1]+e[r+1];n>=4294967296&&i++,e[t]=n,e[t+1]=i}function s(e,t,r,n){let i=e[t]+r;r<0&&(i+=4294967296);let s=e[t+1]+n;i>=4294967296&&s++,e[t]=i,e[t+1]=s}function o(e,t){return e[t]^e[t+1]<<8^e[t+2]<<16^e[t+3]<<24}function a(e,t,r,n,o,a){const c=h[o],l=h[o+1],d=h[a],p=h[a+1];i(u,e,t),s(u,e,c,l);let f=u[n]^u[e],g=u[n+1]^u[e+1];u[n]=g,u[n+1]=f,i(u,r,n),f=u[t]^u[r],g=u[t+1]^u[r+1],u[t]=f>>>24^g<<8,u[t+1]=g>>>24^f<<8,i(u,e,t),s(u,e,d,p),f=u[n]^u[e],g=u[n+1]^u[e+1],u[n]=f>>>16^g<<16,u[n+1]=g>>>16^f<<16,i(u,r,n),f=u[t]^u[r],g=u[t+1]^u[r+1],u[t]=g>>>31^f<<1,u[t+1]=f>>>31^g<<1}const c=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),l=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map(function(e){return 2*e})),u=new Uint32Array(32),h=new Uint32Array(32);function d(e,t){let r=0;for(r=0;r<16;r++)u[r]=e.h[r],u[r+16]=c[r];for(u[24]=u[24]^e.t,u[25]=u[25]^e.t/4294967296,t&&(u[28]=~u[28],u[29]=~u[29]),r=0;r<32;r++)h[r]=o(e.b,4*r);for(r=0;r<12;r++)a(0,8,16,24,l[16*r+0],l[16*r+1]),a(2,10,18,26,l[16*r+2],l[16*r+3]),a(4,12,20,28,l[16*r+4],l[16*r+5]),a(6,14,22,30,l[16*r+6],l[16*r+7]),a(0,10,20,30,l[16*r+8],l[16*r+9]),a(2,12,22,24,l[16*r+10],l[16*r+11]),a(4,14,16,26,l[16*r+12],l[16*r+13]),a(6,8,18,28,l[16*r+14],l[16*r+15]);for(r=0;r<16;r++)e.h[r]=e.h[r]^u[r]^u[r+16]}const p=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function f(e,t,r,n){if(0===e||e>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(t&&t.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(r&&16!==r.length)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(n&&16!==n.length)throw new Error("Illegal personal, expected Uint8Array with length is 16");const i={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:e};p.fill(0),p[0]=e,t&&(p[1]=t.length),p[2]=1,p[3]=1,r&&p.set(r,32),n&&p.set(n,48);for(let e=0;e<16;e++)i.h[e]=c[e]^o(p,4*e);return t&&(g(i,t),i.c=128),i}function g(e,t){for(let r=0;r<t.length;r++)128===e.c&&(e.t+=e.c,d(e,!1),e.c=0),e.b[e.c++]=t[r]}function m(e){for(e.t+=e.c;e.c<128;)e.b[e.c++]=0;d(e,!0);const t=new Uint8Array(e.outlen);for(let r=0;r<e.outlen;r++)t[r]=e.h[r>>2]>>8*(3&r);return t}function y(e,t,r,i,s){r=r||64,e=n.normalizeInput(e),i&&(i=n.normalizeInput(i)),s&&(s=n.normalizeInput(s));const o=f(r,t,i,s);return g(o,e),m(o)}e.exports={blake2b:y,blake2bHex:function(e,t,r,i,s){const o=y(e,t,r,i,s);return n.toHex(o)},blake2bInit:f,blake2bUpdate:g,blake2bFinal:m}},4281:(e,t)=>{function r(e,t,r){return t<=e&&e<=r}function n(e){if(void 0===e)return{};if(e===Object(e))return e;throw TypeError("Could not convert argument to dictionary")}function i(e){this.tokens=[].slice.call(e)}i.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():-1},prepend:function(e){if(Array.isArray(e))for(var t=e;t.length;)this.tokens.unshift(t.pop());else this.tokens.unshift(e)},push:function(e){if(Array.isArray(e))for(var t=e;t.length;)this.tokens.push(t.shift());else this.tokens.push(e)}};var s=-1;function o(e,t){if(e)throw TypeError("Decoder error");return t||65533}var a="utf-8";function c(e,t){if(!(this instanceof c))return new c(e,t);if((e=void 0!==e?String(e).toLowerCase():a)!==a)throw new Error("Encoding not supported. Only utf-8 is supported");t=n(t),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=Boolean(t.fatal),this._ignoreBOM=Boolean(t.ignoreBOM),Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}function l(e,t){if(!(this instanceof l))return new l(e,t);if((e=void 0!==e?String(e).toLowerCase():a)!==a)throw new Error("Encoding not supported. Only utf-8 is supported");t=n(t),this._streaming=!1,this._encoder=null,this._options={fatal:Boolean(t.fatal)},Object.defineProperty(this,"encoding",{value:"utf-8"})}function u(e){var t=e.fatal,n=0,i=0,a=0,c=128,l=191;this.handler=function(e,u){if(-1===u&&0!==a)return a=0,o(t);if(-1===u)return s;if(0===a){if(r(u,0,127))return u;if(r(u,194,223))a=1,n=u-192;else if(r(u,224,239))224===u&&(c=160),237===u&&(l=159),a=2,n=u-224;else{if(!r(u,240,244))return o(t);240===u&&(c=144),244===u&&(l=143),a=3,n=u-240}return n<<=6*a,null}if(!r(u,c,l))return n=a=i=0,c=128,l=191,e.prepend(u),o(t);if(c=128,l=191,n+=u-128<<6*(a-(i+=1)),i!==a)return null;var h=n;return n=a=i=0,h}}function h(e){e.fatal,this.handler=function(e,t){if(-1===t)return s;if(r(t,0,127))return t;var n,i;r(t,128,2047)?(n=1,i=192):r(t,2048,65535)?(n=2,i=224):r(t,65536,1114111)&&(n=3,i=240);for(var o=[(t>>6*n)+i];n>0;){var a=t>>6*(n-1);o.push(128|63&a),n-=1}return o}}c.prototype={decode:function(e,t){var r;r="object"==typeof e&&e instanceof ArrayBuffer?new Uint8Array(e):"object"==typeof e&&"buffer"in e&&e.buffer instanceof ArrayBuffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(0),t=n(t),this._streaming||(this._decoder=new u({fatal:this._fatal}),this._BOMseen=!1),this._streaming=Boolean(t.stream);for(var o,a=new i(r),c=[];!a.endOfStream()&&(o=this._decoder.handler(a,a.read()))!==s;)null!==o&&(Array.isArray(o)?c.push.apply(c,o):c.push(o));if(!this._streaming){do{if((o=this._decoder.handler(a,a.read()))===s)break;null!==o&&(Array.isArray(o)?c.push.apply(c,o):c.push(o))}while(!a.endOfStream());this._decoder=null}return c.length&&(-1===["utf-8"].indexOf(this.encoding)||this._ignoreBOM||this._BOMseen||(65279===c[0]?(this._BOMseen=!0,c.shift()):this._BOMseen=!0)),function(e){for(var t="",r=0;r<e.length;++r){var n=e[r];n<=65535?t+=String.fromCharCode(n):(n-=65536,t+=String.fromCharCode(55296+(n>>10),56320+(1023&n)))}return t}(c)}},l.prototype={encode:function(e,t){e=e?String(e):"",t=n(t),this._streaming||(this._encoder=new h(this._options)),this._streaming=Boolean(t.stream);for(var r,o=[],a=new i(function(e){for(var t=String(e),r=t.length,n=0,i=[];n<r;){var s=t.charCodeAt(n);if(s<55296||s>57343)i.push(s);else if(56320<=s&&s<=57343)i.push(65533);else if(55296<=s&&s<=56319)if(n===r-1)i.push(65533);else{var o=e.charCodeAt(n+1);if(56320<=o&&o<=57343){var a=1023&s,c=1023&o;i.push(65536+(a<<10)+c),n+=1}else i.push(65533)}n+=1}return i}(e));!a.endOfStream()&&(r=this._encoder.handler(a,a.read()))!==s;)Array.isArray(r)?o.push.apply(o,r):o.push(r);if(!this._streaming){for(;(r=this._encoder.handler(a,a.read()))!==s;)Array.isArray(r)?o.push.apply(o,r):o.push(r);this._encoder=null}return new Uint8Array(o)}},t.TextEncoder=l,t.TextDecoder=c},4305:(e,t,r)=>{r.d(t,{ev:()=>k});var n=r(8442),i=r(2531),s=r(615),o=r(1848),a=r(8030);const c=BigInt(0),l=BigInt(1),u=BigInt(2),h=BigInt(8);class d{constructor(e){this.ep=e}static fromBytes(e){(0,o.SJ)()}static fromHex(e){(0,o.SJ)()}get x(){return this.toAffine().x}get y(){return this.toAffine().y}clearCofactor(){return this}assertValidity(){this.ep.assertValidity()}toAffine(e){return this.ep.toAffine(e)}toHex(){return(0,i.My)(this.toBytes())}toString(){return this.toHex()}isTorsionFree(){return!0}isSmallOrder(){return!1}add(e){return this.assertSame(e),this.init(this.ep.add(e.ep))}subtract(e){return this.assertSame(e),this.init(this.ep.subtract(e.ep))}multiply(e){return this.init(this.ep.multiply(e))}multiplyUnsafe(e){return this.init(this.ep.multiplyUnsafe(e))}double(){return this.init(this.ep.double())}negate(){return this.init(this.ep.negate())}precompute(e,t){return this.init(this.ep.precompute(e,t))}toRawBytes(){return this.toBytes()}}function p(e){const{CURVE:t,curveOpts:r,hash:n,eddsaOpts:d}=function(e){const t={a:e.a,d:e.d,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r={Fp:e.Fp,Fn:(0,a.D0)(t.n,e.nBitLength,!0),uvRatio:e.uvRatio},n={randomBytes:e.randomBytes,adjustScalarBytes:e.adjustScalarBytes,domain:e.domain,prehash:e.prehash,mapToCurve:e.mapToCurve};return{CURVE:t,curveOpts:r,hash:e.hash,eddsaOpts:n}}(e),p=function(e,t={}){const r=(0,s.UT)("edwards",e,t,t.FpFnLE),{Fp:n,Fn:a}=r;let d=r.CURVE;const{h:p}=d;(0,o.DS)(t,{},{uvRatio:"function"});const f=u<<BigInt(8*a.BYTES)-l,g=e=>n.create(e),m=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:n.sqrt(n.div(e,t))}}catch(e){return{isValid:!1,value:c}}});if(!function(e,t,r,n){const i=e.sqr(r),s=e.sqr(n),o=e.add(e.mul(t.a,i),s),a=e.add(e.ONE,e.mul(t.d,e.mul(i,s)));return e.eql(o,a)}(n,d,d.Gx,d.Gy))throw new Error("bad curve params: generator point");function y(e,t,r=!1){const n=r?l:c;return(0,o.aK)("coordinate "+e,t,n,f),t}function w(e){if(!(e instanceof E))throw new Error("ExtendedPoint expected")}const b=(0,o.x)((e,t)=>{const{X:r,Y:i,Z:s}=e,o=e.is0();null==t&&(t=o?h:n.inv(s));const a=g(r*t),u=g(i*t),d=n.mul(s,t);if(o)return{x:c,y:l};if(d!==l)throw new Error("invZ was invalid");return{x:a,y:u}}),v=(0,o.x)(e=>{const{a:t,d:r}=d;if(e.is0())throw new Error("bad point: ZERO");const{X:n,Y:i,Z:s,T:o}=e,a=g(n*n),c=g(i*i),l=g(s*s),u=g(l*l),h=g(a*t);if(g(l*g(h+c))!==g(u+g(r*g(a*c))))throw new Error("bad point: equation left != right (1)");if(g(n*i)!==g(s*o))throw new Error("bad point: equation left != right (2)");return!0});class E{constructor(e,t,r,n){this.X=y("x",e),this.Y=y("y",t),this.Z=y("z",r,!0),this.T=y("t",n),Object.freeze(this)}static CURVE(){return d}static fromAffine(e){if(e instanceof E)throw new Error("extended point not allowed");const{x:t,y:r}=e||{};return y("x",t),y("y",r),new E(t,r,l,g(t*r))}static fromBytes(e,t=!1){const r=n.BYTES,{a:i,d:s}=d;e=(0,o.nC)((0,o.eV)(e,r,"point")),(0,o.d6)(t,"zip215");const a=(0,o.nC)(e),u=e[r-1];a[r-1]=-129&u;const h=(0,o.lX)(a),p=t?f:n.ORDER;(0,o.aK)("point.y",h,c,p);const y=g(h*h),w=g(y-l),b=g(s*y-i);let{isValid:v,value:A}=m(w,b);if(!v)throw new Error("bad point: invalid y coordinate");const _=(A&l)===l,I=!!(128&u);if(!t&&A===c&&I)throw new Error("bad point: x=0 and x_0=1");return I!==_&&(A=g(-A)),E.fromAffine({x:A,y:h})}static fromHex(e,t=!1){return E.fromBytes((0,o.qj)("point",e),t)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(e=8,t=!0){return A.createCache(this,e),t||this.multiply(u),this}assertValidity(){v(this)}equals(e){w(e);const{X:t,Y:r,Z:n}=this,{X:i,Y:s,Z:o}=e,a=g(t*o),c=g(i*n),l=g(r*o),u=g(s*n);return a===c&&l===u}is0(){return this.equals(E.ZERO)}negate(){return new E(g(-this.X),this.Y,this.Z,g(-this.T))}double(){const{a:e}=d,{X:t,Y:r,Z:n}=this,i=g(t*t),s=g(r*r),o=g(u*g(n*n)),a=g(e*i),c=t+r,l=g(g(c*c)-i-s),h=a+s,p=h-o,f=a-s,m=g(l*p),y=g(h*f),w=g(l*f),b=g(p*h);return new E(m,y,b,w)}add(e){w(e);const{a:t,d:r}=d,{X:n,Y:i,Z:s,T:o}=this,{X:a,Y:c,Z:l,T:u}=e,h=g(n*a),p=g(i*c),f=g(o*r*u),m=g(s*l),y=g((n+i)*(a+c)-h-p),b=m-f,v=m+f,A=g(p-t*h),_=g(y*b),I=g(v*A),S=g(y*A),C=g(b*v);return new E(_,I,C,S)}subtract(e){return this.add(e.negate())}multiply(e){if(!a.isValidNot0(e))throw new Error("invalid scalar: expected 1 <= sc < curve.n");const{p:t,f:r}=A.cached(this,e,e=>(0,s.Ak)(E,e));return(0,s.Ak)(E,[t,r])[0]}multiplyUnsafe(e,t=E.ZERO){if(!a.isValid(e))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return e===c?E.ZERO:this.is0()||e===l?this:A.unsafe(this,e,e=>(0,s.Ak)(E,e),t)}isSmallOrder(){return this.multiplyUnsafe(p).is0()}isTorsionFree(){return A.unsafe(this,d.n).is0()}toAffine(e){return b(this,e)}clearCofactor(){return p===l?this:this.multiplyUnsafe(p)}toBytes(){const{x:e,y:t}=this.toAffine(),r=n.toBytes(t);return r[r.length-1]|=e&l?128:0,r}toHex(){return(0,i.My)(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(e){return(0,s.Ak)(E,e)}static msm(e,t){return(0,s.Xf)(E,a,e,t)}_setWindowSize(e){this.precompute(e)}toRawBytes(){return this.toBytes()}}E.BASE=new E(d.Gx,d.Gy,l,g(d.Gx*d.Gy)),E.ZERO=new E(c,l,l,c),E.Fp=n,E.Fn=a;const A=new s.hT(E,a.BITS);return E.BASE.precompute(8),E}(t,r);return function(e,t){const r=t.Point;return Object.assign({},t,{ExtendedPoint:r,CURVE:e,nBitLength:r.Fn.BITS,nByteLength:r.Fn.BYTES})}(e,function(e,t,r={}){if("function"!=typeof t)throw new Error('"hash" function param is required');(0,o.DS)(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:n}=r,{BASE:s,Fp:a,Fn:c}=e,u=r.randomBytes||i.po,h=r.adjustScalarBytes||(e=>e),d=r.domain||((e,t,r)=>{if((0,o.d6)(r,"phflag"),t.length||r)throw new Error("Contexts/pre-hash are not supported");return e});function p(e){return c.create((0,o.lX)(e))}function f(e){const{head:r,prefix:n,scalar:i}=function(e){const r=b.secretKey;e=(0,o.qj)("private key",e,r);const n=(0,o.qj)("hashed private key",t(e),2*r),i=h(n.slice(0,r));return{head:i,prefix:n.slice(r,2*r),scalar:p(i)}}(e),a=s.multiply(i),c=a.toBytes();return{head:r,prefix:n,scalar:i,point:a,pointBytes:c}}function g(e){return f(e).pointBytes}function m(e=Uint8Array.of(),...r){const s=(0,i.Id)(...r);return p(t(d(s,(0,o.qj)("context",e),!!n)))}const y={zip215:!0},w=a.BYTES,b={secretKey:w,publicKey:w,signature:2*w,seed:w};function v(e=u(b.seed)){return(0,o.eV)(e,b.seed,"seed")}const E={getExtendedPublicKey:f,randomSecretKey:v,isValidSecretKey:function(e){return(0,i.aY)(e)&&e.length===c.BYTES},isValidPublicKey:function(t,r){try{return!!e.fromBytes(t,r)}catch(e){return!1}},toMontgomery(t){const{y:r}=e.fromBytes(t),n=b.publicKey,i=32===n;if(!i&&57!==n)throw new Error("only defined for 25519 and 448");const s=i?a.div(l+r,l-r):a.div(r-l,r+l);return a.toBytes(s)},toMontgomeryPriv(e){const r=b.secretKey;(0,o.eV)(e,r);const n=t(e.subarray(0,r));return h(n).subarray(0,r)},randomPrivateKey:v,precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)};return Object.freeze({keygen:function(e){const t=E.randomSecretKey(e);return{secretKey:t,publicKey:g(t)}},getPublicKey:g,sign:function(e,t,r={}){e=(0,o.qj)("message",e),n&&(e=n(e));const{prefix:a,scalar:l,pointBytes:u}=f(t),h=m(r.context,a,e),d=s.multiply(h).toBytes(),p=m(r.context,d,u,e),g=c.create(h+p*l);if(!c.isValid(g))throw new Error("sign failed: invalid s");const y=(0,i.Id)(d,c.toBytes(g));return(0,o.eV)(y,b.signature,"result")},verify:function(t,r,i,a=y){const{context:c,zip215:l}=a,u=b.signature;t=(0,o.qj)("signature",t,u),r=(0,o.qj)("message",r),i=(0,o.qj)("publicKey",i,b.publicKey),void 0!==l&&(0,o.d6)(l,"zip215"),n&&(r=n(r));const h=u/2,d=t.subarray(0,h),p=(0,o.lX)(t.subarray(h,u));let f,g,w;try{f=e.fromBytes(i,l),g=e.fromBytes(d,l),w=s.multiplyUnsafe(p)}catch(e){return!1}if(!l&&f.isSmallOrder())return!1;const v=m(c,g.toBytes(),f.toBytes(),r);return g.add(f.multiplyUnsafe(v)).subtract(w).clearCofactor().is0()},utils:E,Point:e,lengths:b})}(p,n,d))}(0,i.AI)("HashToScalar-");const f=BigInt(0),g=BigInt(1),m=BigInt(2),y=(BigInt(3),BigInt(5)),w=BigInt(8),b=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),v=(()=>({p:b,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:w,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")}))();function E(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}const A=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function _(e,t){const r=b,n=(0,a.zi)(t*t*t,r),i=function(e){const t=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=b,o=e*e%s*e%s,c=(0,a.zH)(o,m,s)*o%s,l=(0,a.zH)(c,g,s)*e%s,u=(0,a.zH)(l,y,s)*l%s,h=(0,a.zH)(u,t,s)*u%s,d=(0,a.zH)(h,r,s)*h%s,p=(0,a.zH)(d,n,s)*d%s,f=(0,a.zH)(p,i,s)*p%s,w=(0,a.zH)(f,i,s)*p%s,v=(0,a.zH)(w,t,s)*u%s;return{pow_p_5_8:(0,a.zH)(v,m,s)*e%s,b2:o}}(e*(0,a.zi)(n*n*t,r)).pow_p_5_8;let s=(0,a.zi)(e*n*i,r);const o=(0,a.zi)(t*s*s,r),c=s,l=(0,a.zi)(s*A,r),u=o===e,h=o===(0,a.zi)(-e,r),d=o===(0,a.zi)(-e*A,r);return u&&(s=c),(h||d)&&(s=l),(0,a.dQ)(s,r)&&(s=(0,a.zi)(-s,r)),{isValid:u||h,value:s}}const I=(()=>(0,a.D0)(v.p,{isLE:!0}))(),S=(()=>(0,a.D0)(v.n,{isLE:!0}))(),C=(()=>({...v,Fp:I,hash:n.Zf,adjustScalarBytes:E,uvRatio:_}))(),k=(()=>p(C))(),N=A,x=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),T=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),O=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),P=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),R=e=>_(g,e),U=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),B=e=>k.Point.Fp.create((0,o.lX)(e)&U);function M(e){const{d:t}=v,r=b,n=e=>I.create(e),i=n(N*e*e),s=n((i+g)*O);let o=BigInt(-1);const c=n((o-t*i)*n(i+t));let{isValid:l,value:u}=_(s,c),h=n(u*e);(0,a.dQ)(h,r)||(h=n(-h)),l||(u=h),l||(o=i);const d=n(o*(i-g)*P-c),p=u*u,f=n((u+u)*c),m=n(d*x),y=n(g-p),w=n(g+p);return new k.Point(n(f*w),n(y*m),n(m*w),n(f*y))}class L extends d{constructor(e){super(e)}static fromAffine(e){return new L(k.Point.fromAffine(e))}assertSame(e){if(!(e instanceof L))throw new Error("RistrettoPoint expected")}init(e){return new L(e)}static hashToCurve(e){return function(e){(0,i.DO)(e,64);const t=M(B(e.subarray(0,32))),r=M(B(e.subarray(32,64)));return new L(t.add(r))}((0,o.qj)("ristrettoHash",e,64))}static fromBytes(e){(0,i.DO)(e,32);const{a:t,d:r}=v,n=b,s=e=>I.create(e),c=B(e);if(!(0,o.ex)(I.toBytes(c),e)||(0,a.dQ)(c,n))throw new Error("invalid ristretto255 encoding 1");const l=s(c*c),u=s(g+t*l),h=s(g-t*l),d=s(u*u),p=s(h*h),m=s(t*r*d-p),{isValid:y,value:w}=R(s(m*p)),E=s(w*h),A=s(w*E*m);let _=s((c+c)*E);(0,a.dQ)(_,n)&&(_=s(-_));const S=s(u*A),C=s(_*S);if(!y||(0,a.dQ)(C,n)||S===f)throw new Error("invalid ristretto255 encoding 2");return new L(new k.Point(_,S,g,C))}static fromHex(e){return L.fromBytes((0,o.qj)("ristrettoHex",e,32))}static msm(e,t){return(0,s.Xf)(L,k.Point.Fn,e,t)}toBytes(){let{X:e,Y:t,Z:r,T:n}=this.ep;const i=b,s=e=>I.create(e),o=s(s(r+t)*s(r-t)),c=s(e*t),l=s(c*c),{value:u}=R(s(o*l)),h=s(u*o),d=s(u*c),p=s(h*d*n);let f;if((0,a.dQ)(n*p,i)){let r=s(t*N),n=s(e*N);e=r,t=n,f=s(h*T)}else f=d;(0,a.dQ)(e*p,i)&&(t=s(-t));let g=s((r-t)*f);return(0,a.dQ)(g,i)&&(g=s(-g)),I.toBytes(g)}equals(e){this.assertSame(e);const{X:t,Y:r}=this.ep,{X:n,Y:i}=e.ep,s=e=>I.create(e),o=s(t*i)===s(r*n),a=s(r*i)===s(t*n);return o||a}is0(){return this.equals(L.ZERO)}}L.BASE=(()=>new L(k.Point.BASE))(),L.ZERO=(()=>new L(k.Point.ZERO))(),L.Fp=(()=>I)(),L.Fn=(()=>S)()},4353:function(e){e.exports=function(){var e=6e4,t=36e5,r="millisecond",n="second",i="minute",s="hour",o="day",a="week",c="month",l="quarter",u="year",h="date",d="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,f=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,g={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||t[0])+"]"}},m=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},y={s:m,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),i=r%60;return(t<=0?"+":"-")+m(n,2,"0")+":"+m(i,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var n=12*(r.year()-t.year())+(r.month()-t.month()),i=t.clone().add(n,c),s=r-i<0,o=t.clone().add(n+(s?-1:1),c);return+(-(n+(r-i)/(s?i-o:o-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:u,w:a,d:o,D:h,h:s,m:i,s:n,ms:r,Q:l}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},w="en",b={};b[w]=g;var v="$isDayjsObject",E=function(e){return e instanceof S||!(!e||!e[v])},A=function e(t,r,n){var i;if(!t)return w;if("string"==typeof t){var s=t.toLowerCase();b[s]&&(i=s),r&&(b[s]=r,i=s);var o=t.split("-");if(!i&&o.length>1)return e(o[0])}else{var a=t.name;b[a]=t,i=a}return!n&&i&&(w=i),i||!n&&w},_=function(e,t){if(E(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new S(r)},I=y;I.l=A,I.i=E,I.w=function(e,t){return _(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var S=function(){function g(e){this.$L=A(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[v]=!0}var m=g.prototype;return m.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(I.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(p);if(n){var i=n[2]-1||0,s=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,s)):new Date(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,s)}}return new Date(t)}(e),this.init()},m.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},m.$utils=function(){return I},m.isValid=function(){return!(this.$d.toString()===d)},m.isSame=function(e,t){var r=_(e);return this.startOf(t)<=r&&r<=this.endOf(t)},m.isAfter=function(e,t){return _(e)<this.startOf(t)},m.isBefore=function(e,t){return this.endOf(t)<_(e)},m.$g=function(e,t,r){return I.u(e)?this[t]:this.set(r,e)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(e,t){var r=this,l=!!I.u(t)||t,d=I.p(e),p=function(e,t){var n=I.w(r.$u?Date.UTC(r.$y,t,e):new Date(r.$y,t,e),r);return l?n:n.endOf(o)},f=function(e,t){return I.w(r.toDate()[e].apply(r.toDate("s"),(l?[0,0,0,0]:[23,59,59,999]).slice(t)),r)},g=this.$W,m=this.$M,y=this.$D,w="set"+(this.$u?"UTC":"");switch(d){case u:return l?p(1,0):p(31,11);case c:return l?p(1,m):p(0,m+1);case a:var b=this.$locale().weekStart||0,v=(g<b?g+7:g)-b;return p(l?y-v:y+(6-v),m);case o:case h:return f(w+"Hours",0);case s:return f(w+"Minutes",1);case i:return f(w+"Seconds",2);case n:return f(w+"Milliseconds",3);default:return this.clone()}},m.endOf=function(e){return this.startOf(e,!1)},m.$set=function(e,t){var a,l=I.p(e),d="set"+(this.$u?"UTC":""),p=(a={},a[o]=d+"Date",a[h]=d+"Date",a[c]=d+"Month",a[u]=d+"FullYear",a[s]=d+"Hours",a[i]=d+"Minutes",a[n]=d+"Seconds",a[r]=d+"Milliseconds",a)[l],f=l===o?this.$D+(t-this.$W):t;if(l===c||l===u){var g=this.clone().set(h,1);g.$d[p](f),g.init(),this.$d=g.set(h,Math.min(this.$D,g.daysInMonth())).$d}else p&&this.$d[p](f);return this.init(),this},m.set=function(e,t){return this.clone().$set(e,t)},m.get=function(e){return this[I.p(e)]()},m.add=function(r,l){var h,d=this;r=Number(r);var p=I.p(l),f=function(e){var t=_(d);return I.w(t.date(t.date()+Math.round(e*r)),d)};if(p===c)return this.set(c,this.$M+r);if(p===u)return this.set(u,this.$y+r);if(p===o)return f(1);if(p===a)return f(7);var g=(h={},h[i]=e,h[s]=t,h[n]=1e3,h)[p]||1,m=this.$d.getTime()+r*g;return I.w(m,this)},m.subtract=function(e,t){return this.add(-1*e,t)},m.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||d;var n=e||"YYYY-MM-DDTHH:mm:ssZ",i=I.z(this),s=this.$H,o=this.$m,a=this.$M,c=r.weekdays,l=r.months,u=r.meridiem,h=function(e,r,i,s){return e&&(e[r]||e(t,n))||i[r].slice(0,s)},p=function(e){return I.s(s%12||12,e,"0")},g=u||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(f,function(e,n){return n||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return I.s(t.$y,4,"0");case"M":return a+1;case"MM":return I.s(a+1,2,"0");case"MMM":return h(r.monthsShort,a,l,3);case"MMMM":return h(l,a);case"D":return t.$D;case"DD":return I.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return h(r.weekdaysMin,t.$W,c,2);case"ddd":return h(r.weekdaysShort,t.$W,c,3);case"dddd":return c[t.$W];case"H":return String(s);case"HH":return I.s(s,2,"0");case"h":return p(1);case"hh":return p(2);case"a":return g(s,o,!0);case"A":return g(s,o,!1);case"m":return String(o);case"mm":return I.s(o,2,"0");case"s":return String(t.$s);case"ss":return I.s(t.$s,2,"0");case"SSS":return I.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")})},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(r,h,d){var p,f=this,g=I.p(h),m=_(r),y=(m.utcOffset()-this.utcOffset())*e,w=this-m,b=function(){return I.m(f,m)};switch(g){case u:p=b()/12;break;case c:p=b();break;case l:p=b()/3;break;case a:p=(w-y)/6048e5;break;case o:p=(w-y)/864e5;break;case s:p=w/t;break;case i:p=w/e;break;case n:p=w/1e3;break;default:p=w}return d?p:I.a(p)},m.daysInMonth=function(){return this.endOf(c).$D},m.$locale=function(){return b[this.$L]},m.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),n=A(e,t,!0);return n&&(r.$L=n),r},m.clone=function(){return I.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},g}(),C=S.prototype;return _.prototype=C,[["$ms",r],["$s",n],["$m",i],["$H",s],["$W",o],["$M",c],["$y",u],["$D",h]].forEach(function(e){C[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),_.extend=function(e,t){return e.$i||(e(t,S,_),e.$i=!0),_},_.locale=A,_.isDayjs=E,_.unix=function(e){return _(1e3*e)},_.en=b[w],_.Ls=b,_.p={},_}()},4376:(e,t,r)=>{r.d(t,{o:()=>n});const n={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos",sui:"Sui",stacks:"Stacks"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],HTTP_STATUS_CODES:{SERVER_ERROR:500,TOO_MANY_REQUESTS:429,SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:("undefined"!=typeof process&&void 0!==process.env?process.env.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",REMOTE_FEATURES_ALERTS:{MULTI_WALLET_NOT_ENABLED:{DEFAULT:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com."},CONNECTIONS_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnections hook."},CONNECTION_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnection hook."}}}}},4496:(e,t,r)=>{r.d(t,{K1:()=>s,kg:()=>a,lj:()=>o});var n=r(6056),i=r(2944);function s(){const e=n.W.state.activeCaipNetwork?.chainNamespace||"eip155";return`${e}:${n.W.state.activeCaipNetwork?.id||1}:${i.oU.NATIVE_TOKEN_ADDRESS[e]}`}function o(e){const t=n.W.getAccountData(e)?.preferredAccountType;return t}function a(e){return e?n.W.state.chains.get(e)?.networkState?.caipNetwork:n.W.state.activeCaipNetwork}},4549:(e,t,r)=>{r.d(t,{f:()=>y});var n=r(8126),i=r(4707);const s=2147483648,o={convertEVMChainIdToCoinType(e){if(e>=s)throw new Error("Invalid chainId");return(s|e)>>>0}};var a=r(7508),c=r(5940),l=r(3450),u=r(5595),h=r(6056),d=r(1211),p=r(6010),f=r(8508);const g=(0,n.BX)({suggestions:[],loading:!1}),m={state:g,subscribe:e=>(0,n.B1)(g,()=>e(g)),subscribeKey:(e,t)=>(0,i.u$)(g,e,t),async resolveName(e){try{return await u.T.lookupEnsName(e)}catch(e){const t=e;throw new Error(t?.reasons?.[0]?.description||"Error resolving name")}},async isNameRegistered(e){try{return await u.T.lookupEnsName(e),!0}catch{return!1}},async getSuggestions(e){try{g.loading=!0,g.suggestions=[];const t=await u.T.getEnsNameSuggestions(e);return g.suggestions=t.suggestions||[],g.suggestions}catch(e){const t=y.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(t)}finally{g.loading=!1}},async getNamesForAddress(e){try{if(!h.W.state.activeCaipNetwork)return[];const t=a.i.getEnsFromCacheForAddress(e);if(t)return t;const r=await u.T.reverseLookupEnsName({address:e});return a.i.updateEnsCache({address:e,ens:r,timestamp:Date.now()}),r}catch(e){const t=y.parseEnsApiError(e,"Error fetching names for address");throw new Error(t)}},async registerName(e){const t=h.W.state.activeCaipNetwork,r=l.U.state.address,n=p.a.getAuthConnector();if(!t)throw new Error("Network not found");if(!r||!n)throw new Error("Address or auth connector not found");g.loading=!0;try{const n=JSON.stringify({name:e,attributes:{},timestamp:Math.floor(Date.now()/1e3)});f.I.pushTransactionStack({onCancel(){f.I.replace("RegisterAccountName")}});const i=await d.x.signMessage(n);g.loading=!1;const s=t.id;if(!s)throw new Error("Network not found");const c=o.convertEVMChainIdToCoinType(Number(s));await u.T.registerEnsName({coinType:c,address:r,signature:i,message:n}),l.U.setProfileName(e,t.chainNamespace),a.i.updateEnsCache({address:r,ens:[{name:e,registered_at:(new Date).toISOString(),updated_at:void 0,addresses:{},attributes:[]}],timestamp:Date.now()}),f.I.replace("RegisterAccountNameSuccess")}catch(t){const r=y.parseEnsApiError(t,`Error registering name ${e}`);throw f.I.replace("RegisterAccountName"),new Error(r)}finally{g.loading=!1}},validateName:e=>/^[a-zA-Z0-9-]{4,}$/u.test(e),parseEnsApiError(e,t){const r=e;return r?.reasons?.[0]?.description||t}},y=(0,c.X)(m)},4707:(e,t,r)=>{r.d(t,{u$:()=>i,zC:()=>c});var n=r(8126);function i(e,t,r,i){let s=e[t];return(0,n.B1)(e,()=>{const n=e[t];Object.is(s,n)||r(s=n)},i)}Symbol();const{proxyStateMap:s,snapCache:o}=(0,n.h2)(),a=e=>s.has(e);function c(e){const t=[];let r=0;const i=new Map,s=new WeakMap,c=e=>s.get(e)||i;if(e){if("function"!=typeof e[Symbol.iterator])throw new TypeError("proxyMap:\n\tinitial state must be iterable\n\t\ttip: structure should be [[key, value]]");for(const[n,s]of e)i.set(n,r),t[r++]=s}const l={data:t,index:r,epoch:0,get size(){return a(this)||(()=>{const e=o.get(l),t=null==e?void 0:e[1];if(t&&!s.has(t)){const e=new Map(i);s.set(t,e)}})(),c(this).size},get(e){const t=c(this).get(e);if(void 0!==t)return this.data[t];this.epoch},has(e){const t=c(this);return this.epoch,t.has(e)},set(e,t){if(!a(this))throw new Error("Cannot perform mutations on a snapshot");const r=i.get(e);return void 0===r?(i.set(e,this.index),this.data[this.index++]=t):this.data[r]=t,this.epoch++,this},delete(e){if(!a(this))throw new Error("Cannot perform mutations on a snapshot");const t=i.get(e);return void 0!==t&&(delete this.data[t],i.delete(e),this.epoch++,!0)},clear(){if(!a(this))throw new Error("Cannot perform mutations on a snapshot");this.data.length=0,this.index=0,this.epoch++,i.clear()},forEach(e){this.epoch,c(this).forEach((t,r)=>{e(this.data[t],r,this)})},*entries(){this.epoch;const e=c(this);for(const[t,r]of e)yield[t,this.data[r]]},*keys(){this.epoch;const e=c(this);for(const t of e.keys())yield t},*values(){this.epoch;const e=c(this);for(const t of e.values())yield this.data[t]},[Symbol.iterator](){return this.entries()},get[Symbol.toStringTag](){return"Map"},toJSON(){return new Map(this.entries())}},u=(0,n.BX)(l);return Object.defineProperties(u,{size:{enumerable:!1},index:{enumerable:!1},epoch:{enumerable:!1},data:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(u),u}const{proxyStateMap:l,snapCache:u}=(0,n.h2)()},4874:(e,t,r)=>{const n=r(793);e.exports=o;const i=function(){function e(e){return void 0!==e&&e}try{return"undefined"!=typeof globalThis||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{},s={mapHttpRequest:d,mapHttpResponse:d,wrapRequestSerializer:p,wrapResponseSerializer:p,wrapErrorSerializer:p,req:d,res:d,err:function(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const r in e)void 0===t[r]&&(t[r]=e[r]);return t}};function o(e){(e=e||{}).browser=e.browser||{};const t=e.browser.transmit;if(t&&"function"!=typeof t.send)throw Error("pino: transmit option must have a send function");const r=e.browser.write||i;e.browser.write&&(e.browser.asObject=!0);const n=e.serializers||{},s=function(e,t){return Array.isArray(e)?e.filter(function(e){return"!stdSerializers.err"!==e}):!0===e&&Object.keys(t)}(e.browser.serialize,n);let d=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(d=!1),"function"==typeof r&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),!1===e.enabled&&(e.level="silent");const p=e.level||"info",g=Object.create(r);g.log||(g.log=f),Object.defineProperty(g,"levelVal",{get:function(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(g,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,a(m,g,"error","log"),a(m,g,"fatal","error"),a(m,g,"warn","error"),a(m,g,"info","log"),a(m,g,"debug","log"),a(m,g,"trace","log")}});const m={transmit:t,serialize:s,asObject:e.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:h(e)};return g.levels=o.levels,g.level=p,g.setMaxListeners=g.getMaxListeners=g.emit=g.addListener=g.on=g.prependListener=g.once=g.prependOnceListener=g.removeListener=g.removeAllListeners=g.listeners=g.listenerCount=g.eventNames=g.write=g.flush=f,g.serializers=n,g._serialize=s,g._stdErrSerialize=d,g.child=function(r,i){if(!r)throw new Error("missing bindings for child Pino");i=i||{},s&&r.serializers&&(i.serializers=r.serializers);const o=i.serializers;if(s&&o){var a=Object.assign({},n,o),h=!0===e.browser.serialize?Object.keys(a):s;delete r.serializers,c([r],h,a,this._stdErrSerialize)}function d(e){this._childLevel=1+(0|e._childLevel),this.error=l(e,r,"error"),this.fatal=l(e,r,"fatal"),this.warn=l(e,r,"warn"),this.info=l(e,r,"info"),this.debug=l(e,r,"debug"),this.trace=l(e,r,"trace"),a&&(this.serializers=a,this._serialize=h),t&&(this._logEvent=u([].concat(e._logEvent.bindings,r)))}return d.prototype=this,new d(this)},t&&(g._logEvent=u()),g}function a(e,t,r,s){const a=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?f:a[r]?a[r]:i[r]||i[s]||f,function(e,t,r){var s;(e.transmit||t[r]!==f)&&(t[r]=(s=t[r],function(){const a=e.timestamp(),l=new Array(arguments.length),h=Object.getPrototypeOf&&Object.getPrototypeOf(this)===i?i:this;for(var d=0;d<l.length;d++)l[d]=arguments[d];if(e.serialize&&!e.asObject&&c(l,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?s.call(h,function(e,t,r,i){e._serialize&&c(r,e._serialize,e.serializers,e._stdErrSerialize);const s=r.slice();let a=s[0];const l={};i&&(l.time=i),l.level=o.levels.values[t];let u=1+(0|e._childLevel);if(u<1&&(u=1),null!==a&&"object"==typeof a){for(;u--&&"object"==typeof s[0];)Object.assign(l,s.shift());a=s.length?n(s.shift(),s):void 0}else"string"==typeof a&&(a=n(s.shift(),s));return void 0!==a&&(l.msg=a),l}(this,r,l,a)):s.apply(h,l),e.transmit){const n=e.transmit.level||t.level,i=o.levels.values[n],s=o.levels.values[r];if(s<i)return;!function(e,t,r){const n=t.send,i=t.ts,s=t.methodLevel,o=t.methodValue,a=t.val,l=e._logEvent.bindings;c(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter(function(e){return-1===l.indexOf(e)}),e._logEvent.level.label=s,e._logEvent.level.value=o,n(s,e._logEvent,a),e._logEvent=u(l)}(this,{ts:a,methodLevel:r,methodValue:s,transmitLevel:n,transmitValue:o.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},l)}}))}(e,t,r)}function c(e,t,r,n){for(const i in e)if(n&&e[i]instanceof Error)e[i]=o.stdSerializers.err(e[i]);else if("object"==typeof e[i]&&!Array.isArray(e[i]))for(const n in e[i])t&&t.indexOf(n)>-1&&n in r&&(e[i][n]=r[n](e[i][n]))}function l(e,t,r){return function(){const n=new Array(1+arguments.length);n[0]=t;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return e[r].apply(this,n)}}function u(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function h(e){return"function"==typeof e.timestamp?e.timestamp:!1===e.timestamp?g:m}function d(){return{}}function p(e){return e}function f(){}function g(){return!1}function m(){return Date.now()}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=s,o.stdTimeFunctions=Object.assign({},{nullTime:g,epochTime:m,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}})},4945:(e,t,r)=>{var n="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==r.g&&r.g,i=function(){function e(){this.fetch=!1,this.DOMException=n.DOMException}return e.prototype=n,new e}();!function(e){!function(t){var n=void 0!==e&&e||"undefined"!=typeof self&&self||void 0!==r.g&&r.g||{},i="URLSearchParams"in n,s="Symbol"in n&&"iterator"in Symbol,o="FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch(e){return!1}}(),a="FormData"in n,c="ArrayBuffer"in n;if(c)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(e){return e&&l.indexOf(Object.prototype.toString.call(e))>-1};function h(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw new TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function d(e){return"string"!=typeof e&&(e=String(e)),e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return s&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){if(2!=e.length)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function g(e){if(!e._noBody)return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function m(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function y(e){var t=new FileReader,r=m(t);return t.readAsArrayBuffer(e),r}function w(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(e){var t;this.bodyUsed=this.bodyUsed,this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:o&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:a&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:i&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():c&&o&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=w(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c&&(ArrayBuffer.prototype.isPrototypeOf(e)||u(e))?this._bodyArrayBuffer=w(e):this._bodyText=e=Object.prototype.toString.call(e):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var e=g(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer)return g(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer));if(o)return this.blob().then(y);throw new Error("could not read as ArrayBuffer")},this.text=function(){var e,t,r,n,i,s=g(this);if(s)return s;if(this._bodyBlob)return e=this._bodyBlob,r=m(t=new FileReader),i=(n=/charset=([A-Za-z0-9_-]+)/.exec(e.type))?n[1]:"utf-8",t.readAsText(e,i),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a&&(this.formData=function(){return this.text().then(A)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(e,t){e=h(e),t=d(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},f.prototype.delete=function(e){delete this.map[h(e)]},f.prototype.get=function(e){return e=h(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(h(e))},f.prototype.set=function(e,t){this.map[h(e)]=d(t)},f.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},f.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),p(e)},f.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),p(e)},f.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),p(e)},s&&(f.prototype[Symbol.iterator]=f.prototype.entries);var v=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function E(e,t){if(!(this instanceof E))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var r,i,s=(t=t||{}).body;if(e instanceof E){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,s||null==e._bodyInit||(s=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=(i=(r=t.method||this.method||"GET").toUpperCase(),v.indexOf(i)>-1?i:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal||function(){if("AbortController"in n)return(new AbortController).signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&s)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(s),!("GET"!==this.method&&"HEAD"!==this.method||"no-store"!==t.cache&&"no-cache"!==t.cache)){var o=/([?&])_=[^&]*/;o.test(this.url)?this.url=this.url.replace(o,"$1_="+(new Date).getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}function A(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}}),t}function _(e,t){if(!(this instanceof _))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}E.prototype.clone=function(){return new E(this,{body:this._bodyInit})},b.call(E.prototype),b.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},_.error=function(){var e=new _(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var I=[301,302,303,307,308];_.redirect=function(e,t){if(-1===I.indexOf(t))throw new RangeError("Invalid status code");return new _(null,{status:t,headers:{location:e}})},t.DOMException=n.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function S(e,r){return new Promise(function(i,s){var a=new E(e,r);if(a.signal&&a.signal.aborted)return s(new t.DOMException("Aborted","AbortError"));var l=new XMLHttpRequest;function u(){l.abort()}if(l.onload=function(){var e,t,r={statusText:l.statusText,headers:(e=l.getAllResponseHeaders()||"",t=new f,e.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e}).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();try{t.append(n,i)}catch(e){console.warn("Response "+e.message)}}}),t)};0===a.url.indexOf("file://")&&(l.status<200||l.status>599)?r.status=200:r.status=l.status,r.url="responseURL"in l?l.responseURL:r.headers.get("X-Request-URL");var n="response"in l?l.response:l.responseText;setTimeout(function(){i(new _(n,r))},0)},l.onerror=function(){setTimeout(function(){s(new TypeError("Network request failed"))},0)},l.ontimeout=function(){setTimeout(function(){s(new TypeError("Network request timed out"))},0)},l.onabort=function(){setTimeout(function(){s(new t.DOMException("Aborted","AbortError"))},0)},l.open(a.method,function(e){try{return""===e&&n.location.href?n.location.href:e}catch(t){return e}}(a.url),!0),"include"===a.credentials?l.withCredentials=!0:"omit"===a.credentials&&(l.withCredentials=!1),"responseType"in l&&(o?l.responseType="blob":c&&(l.responseType="arraybuffer")),r&&"object"==typeof r.headers&&!(r.headers instanceof f||n.Headers&&r.headers instanceof n.Headers)){var p=[];Object.getOwnPropertyNames(r.headers).forEach(function(e){p.push(h(e)),l.setRequestHeader(e,d(r.headers[e]))}),a.headers.forEach(function(e,t){-1===p.indexOf(t)&&l.setRequestHeader(t,e)})}else a.headers.forEach(function(e,t){l.setRequestHeader(t,e)});a.signal&&(a.signal.addEventListener("abort",u),l.onreadystatechange=function(){4===l.readyState&&a.signal.removeEventListener("abort",u)}),l.send(void 0===a._bodyInit?null:a._bodyInit)})}S.polyfill=!0,n.fetch||(n.fetch=S,n.Headers=f,n.Request=E,n.Response=_),t.Headers=f,t.Request=E,t.Response=_,t.fetch=S,Object.defineProperty(t,"__esModule",{value:!0})}({})}(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var s=n.fetch?n:i;(t=s.fetch).default=s.fetch,t.fetch=s.fetch,t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response,e.exports=t},4989:(e,t,r)=>{var n=r(1462);e.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},5042:(e,t,r)=>{r.d(t,{A:()=>h});var n=r(6010),i=r(8249),s=r(2733),o=r(6742),a=r(7508),c=r(5306),l=r(6092),u=r(1482);const h={filterOutDuplicatesByRDNS(e){const t=s.H.state.enableEIP6963?n.a.state.connectors:[],r=a.i.getRecentWallets(),i=t.map(e=>e.info?.rdns).filter(Boolean),c=r.map(e=>e.rdns).filter(Boolean),l=i.concat(c);if(l.includes("io.metamask.mobile")&&o.w.isMobile()){const e=l.indexOf("io.metamask.mobile");l[e]="io.metamask"}return e.filter(e=>(!e?.rdns||!l.includes(String(e.rdns)))&&!(!e?.rdns&&t.some(t=>t.name===e.name)))},filterOutDuplicatesByIds(e){const t=n.a.state.connectors.filter(e=>"ANNOUNCED"===e.type||"INJECTED"===e.type),r=a.i.getRecentWallets(),i=t.map(e=>e.explorerId),s=r.map(e=>e.id),o=i.concat(s);return e.filter(e=>!o.includes(e?.id))},filterOutDuplicateWallets(e){const t=this.filterOutDuplicatesByRDNS(e);return this.filterOutDuplicatesByIds(t)},markWalletsAsInstalled(e){const{connectors:t}=n.a.state,{featuredWalletIds:r}=s.H.state,i=t.filter(e=>"ANNOUNCED"===e.type).reduce((e,t)=>t.info?.rdns?(e[t.info.rdns]=!0,e):e,{});return e.map(e=>({...e,installed:Boolean(e.rdns)&&Boolean(i[e.rdns??""])})).sort((e,t)=>{const n=Number(t.installed)-Number(e.installed);if(0!==n)return n;if(r?.length){const n=r.indexOf(e.id),i=r.indexOf(t.id);if(-1!==n&&-1!==i)return n-i;if(-1!==n)return-1;if(-1!==i)return 1}return 0})},getConnectOrderMethod(e,t){const r=e?.connectMethodsOrder||s.H.state.features?.connectMethodsOrder,o=t||n.a.state.connectors;if(r)return r;const{injected:a,announced:c}=l.g.getConnectorsByType(o,i.N.state.recommended,i.N.state.featured),h=a.filter(l.g.showConnector),d=c.filter(l.g.showConnector);return h.length||d.length?["wallet","email","social"]:u.o.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(e){const t=Boolean(e.rdns)&&i.N.state.excludedWallets.some(t=>t.rdns===e.rdns),r=Boolean(e.name)&&i.N.state.excludedWallets.some(t=>c.y.isLowerCaseMatch(t.name,e.name));return t||r},markWalletsWithDisplayIndex:e=>e.map((e,t)=>({...e,display_index:t}))}},5143:(e,t,r)=>{r.d(t,{bI:()=>k});var n=r(8442),i=r(1454),s=r(2531),o=r(1848),a=r(615),c=r(8030);const l=(e,t)=>(e+(e>=0?t:-t)/m)/t;function u(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function h(e,t){const r={};for(let n of Object.keys(t))r[n]=void 0===e[n]?t[n]:e[n];return(0,o.d6)(r.lowS,"lowS"),(0,o.d6)(r.prehash,"prehash"),void 0!==r.format&&u(r.format),r}class d extends Error{constructor(e=""){super(e)}}const p={Err:d,_tlv:{encode:(e,t)=>{const{Err:r}=p;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");const n=t.length/2,i=(0,o.zW)(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const s=n>127?(0,o.zW)(i.length/2|128):"";return(0,o.zW)(e)+s+i+t},decode(e,t){const{Err:r}=p;let n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");const i=t[n++];let s=0;if(128&i){const e=127&i;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");const o=t.subarray(n,n+e);if(o.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===o[0])throw new r("tlv.decode(long): zero leftmost byte");for(const e of o)s=s<<8|e;if(n+=e,s<128)throw new r("tlv.decode(long): not minimal encoding")}else s=i;const o=t.subarray(n,n+s);if(o.length!==s)throw new r("tlv.decode: wrong value length");return{v:o,l:t.subarray(n+s)}}},_int:{encode(e){const{Err:t}=p;if(e<f)throw new t("integer: negative integers are not allowed");let r=(0,o.zW)(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){const{Err:t}=p;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return(0,o.Ph)(e)}},toSig(e){const{Err:t,_int:r,_tlv:n}=p,i=(0,o.qj)("signature",e),{v:s,l:a}=n.decode(48,i);if(a.length)throw new t("invalid signature: left bytes after parsing");const{v:c,l}=n.decode(2,s),{v:u,l:h}=n.decode(2,l);if(h.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(c),s:r.decode(u)}},hexFromSig(e){const{_tlv:t,_int:r}=p,n=t.encode(2,r.encode(e.r))+t.encode(2,r.encode(e.s));return t.encode(48,n)}},f=BigInt(0),g=BigInt(1),m=BigInt(2),y=BigInt(3),w=BigInt(4);function b(e,t){const{BYTES:r}=e;let n;if("bigint"==typeof t)n=t;else{let i=(0,o.qj)("private key",t);try{n=e.fromBytes(i)}catch(e){throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof t}`)}}if(!e.isValidNot0(n))throw new Error("invalid private key: out of range [1..N-1]");return n}function v(e){return Uint8Array.of(e?2:3)}function E(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function A(e){const{CURVE:t,curveOpts:r,hash:n,ecdsaOpts:d}=function(e){const{CURVE:t,curveOpts:r}=function(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp;let n=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(e=>Math.ceil(e/2)))):void 0;return{CURVE:t,curveOpts:{Fp:r,Fn:(0,c.D0)(t.n,{BITS:e.nBitLength,allowedLengths:n,modFromBytes:e.wrapPrivateKey}),allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes}}}(e),n={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:r,hash:e.hash,ecdsaOpts:n}}(e);return function(e,t){const r=t.Point;return Object.assign({},t,{ProjectivePoint:r,CURVE:Object.assign({},e,(0,c.LH)(r.Fn.ORDER,r.Fn.BITS))})}(e,function(e,t,r={}){(0,s.sd)(t),(0,o.DS)(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const n=r.randomBytes||s.po,a=r.hmac||((e,...r)=>(0,i.w)(t,e,(0,s.Id)(...r))),{Fp:l,Fn:d}=e,{ORDER:y,BITS:w}=d,{keygen:A,getPublicKey:_,getSharedSecret:I,utils:S,lengths:C}=function(e,t={}){const{Fn:r}=e,n=t.randomBytes||s.po,i=Object.assign(E(e.Fp,r),{seed:(0,c.Tp)(r.ORDER)});function a(e){try{return!!b(r,e)}catch(e){return!1}}function l(e=n(i.seed)){return(0,c.qy)((0,o.eV)(e,i.seed,"seed"),r.ORDER)}function u(t,n=!0){return e.BASE.multiply(b(r,t)).toBytes(n)}function h(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;const{secretKey:n,publicKey:s,publicKeyUncompressed:a}=i;if(r.allowedLengths||n===s)return;const c=(0,o.qj)("key",t).length;return c===s||c===a}const d={isValidSecretKey:a,isValidPublicKey:function(t,r){const{publicKey:n,publicKeyUncompressed:s}=i;try{const i=t.length;return!(!0===r&&i!==n||!1===r&&i!==s||!e.fromBytes(t))}catch(e){return!1}},randomSecretKey:l,isValidPrivateKey:a,randomPrivateKey:l,normPrivateKeyToScalar:e=>b(r,e),precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)};return Object.freeze({getPublicKey:u,getSharedSecret:function(t,n,i=!0){if(!0===h(t))throw new Error("first arg must be private key");if(!1===h(n))throw new Error("second arg must be public key");const s=b(r,t);return e.fromHex(n).multiply(s).toBytes(i)},keygen:function(e){const t=l(e);return{secretKey:t,publicKey:u(t)}},Point:e,utils:d,lengths:i})}(e,r),k={prehash:!1,lowS:"boolean"==typeof r.lowS&&r.lowS,format:void 0,extraEntropy:!1},N="compact";function x(e){return e>y>>g}function T(e,t){if(!d.isValidNot0(t))throw new Error(`invalid signature ${e}: out of range 1..Point.Fn.ORDER`);return t}class O{constructor(e,t,r){this.r=T("r",e),this.s=T("s",t),null!=r&&(this.recovery=r),Object.freeze(this)}static fromBytes(e,t=N){let r;if(function(e,t){u(t);const r=C.signature,n="compact"===t?r:"recovered"===t?r+1:void 0;(0,o.eV)(e,n,`${t} signature`)}(e,t),"der"===t){const{r:t,s:r}=p.toSig((0,o.eV)(e));return new O(t,r)}"recovered"===t&&(r=e[0],t="compact",e=e.subarray(1));const n=d.BYTES,i=e.subarray(0,n),s=e.subarray(n,2*n);return new O(d.fromBytes(i),d.fromBytes(s),r)}static fromHex(e,t){return this.fromBytes((0,s.aT)(e),t)}addRecoveryBit(e){return new O(this.r,this.s,e)}recoverPublicKey(t){const r=l.ORDER,{r:n,s:i,recovery:a}=this;if(null==a||![0,1,2,3].includes(a))throw new Error("recovery id invalid");if(y*m<r&&a>1)throw new Error("recovery id is ambiguous for h>1 curve");const c=2===a||3===a?n+y:n;if(!l.isValid(c))throw new Error("recovery id 2 or 3 invalid");const u=l.toBytes(c),h=e.fromBytes((0,s.Id)(v(!(1&a)),u)),p=d.inv(c),f=R((0,o.qj)("msgHash",t)),g=d.create(-f*p),w=d.create(i*p),b=e.BASE.multiplyUnsafe(g).add(h.multiplyUnsafe(w));if(b.is0())throw new Error("point at infinify");return b.assertValidity(),b}hasHighS(){return x(this.s)}toBytes(e=N){if(u(e),"der"===e)return(0,s.aT)(p.hexFromSig(this));const t=d.toBytes(this.r),r=d.toBytes(this.s);if("recovered"===e){if(null==this.recovery)throw new Error("recovery bit must be present");return(0,s.Id)(Uint8Array.of(this.recovery),t,r)}return(0,s.Id)(t,r)}toHex(e){return(0,s.My)(this.toBytes(e))}assertValidity(){}static fromCompact(e){return O.fromBytes((0,o.qj)("sig",e),"compact")}static fromDER(e){return O.fromBytes((0,o.qj)("sig",e),"der")}normalizeS(){return this.hasHighS()?new O(this.r,d.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,s.My)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,s.My)(this.toBytes("compact"))}}const P=r.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");const t=(0,o.Ph)(e),r=8*e.length-w;return r>0?t>>BigInt(r):t},R=r.bits2int_modN||function(e){return d.create(P(e))},U=(0,o.OG)(w);function B(e){return(0,o.aK)("num < 2^"+w,e,f,U),d.toBytes(e)}function M(e,r){return(0,o.eV)(e,void 0,"message"),r?(0,o.eV)(t(e),void 0,"prehashed message"):e}return Object.freeze({keygen:A,getPublicKey:_,getSharedSecret:I,utils:S,lengths:C,Point:e,sign:function(r,i,c={}){r=(0,o.qj)("message",r);const{seed:l,k2sig:u}=function(t,r,i){if(["recovered","canonical"].some(e=>e in i))throw new Error("sign() legacy options not supported");const{lowS:a,prehash:c,extraEntropy:l}=h(i,k);t=M(t,c);const u=R(t),p=b(d,r),m=[B(p),B(u)];if(null!=l&&!1!==l){const e=!0===l?n(C.secretKey):l;m.push((0,o.qj)("extraEntropy",e))}const y=(0,s.Id)(...m),w=u;return{seed:y,k2sig:function(t){const r=P(t);if(!d.isValidNot0(r))return;const n=d.inv(r),i=e.BASE.multiply(r).toAffine(),s=d.create(i.x);if(s===f)return;const o=d.create(n*d.create(w+s*p));if(o===f)return;let c=(i.x===s?0:2)|Number(i.y&g),l=o;return a&&x(o)&&(l=d.neg(o),c^=1),new O(s,l,c)}}}(r,i,c);return(0,o.fg)(t.outputLen,d.BYTES,a)(l,u)},verify:function(t,r,n,i={}){const{lowS:a,prehash:c,format:l}=h(i,k);if(n=(0,o.qj)("publicKey",n),r=M((0,o.qj)("message",r),c),"strict"in i)throw new Error("options.strict was renamed to lowS");const u=void 0===l?function(e){let t;const r="string"==typeof e||(0,s.aY)(e),n=!r&&null!==e&&"object"==typeof e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!r&&!n)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(n)t=new O(e.r,e.s);else if(r){try{t=O.fromBytes((0,o.qj)("sig",e),"der")}catch(e){if(!(e instanceof p.Err))throw e}if(!t)try{t=O.fromBytes((0,o.qj)("sig",e),"compact")}catch(e){return!1}}return t||!1}(t):O.fromBytes((0,o.qj)("sig",t),l);if(!1===u)return!1;try{const t=e.fromBytes(n);if(a&&u.hasHighS())return!1;const{r:i,s}=u,o=R(r),c=d.inv(s),l=d.create(o*c),h=d.create(i*c),p=e.BASE.multiplyUnsafe(l).add(t.multiplyUnsafe(h));return!p.is0()&&d.create(p.x)===i}catch(e){return!1}},recoverPublicKey:function(e,t,r={}){const{prehash:n}=h(r,k);return t=M(t,n),O.fromBytes(e,"recovered").recoverPublicKey(t).toBytes()},Signature:O,hash:t})}(function(e,t={}){const r=(0,a.UT)("weierstrass",e,t),{Fp:n,Fn:i}=r;let c=r.CURVE;const{h:u,n:h}=c;(0,o.DS)(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:d}=t;if(d&&(!n.is0(c.a)||"bigint"!=typeof d.beta||!Array.isArray(d.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const p=E(n,i);function m(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}const A=t.toBytes||function(e,t,r){const{x:i,y:a}=t.toAffine(),c=n.toBytes(i);if((0,o.d6)(r,"isCompressed"),r){m();const e=!n.isOdd(a);return(0,s.Id)(v(e),c)}return(0,s.Id)(Uint8Array.of(4),c,n.toBytes(a))},_=t.fromBytes||function(e){(0,o.eV)(e,void 0,"Point");const{publicKey:t,publicKeyUncompressed:r}=p,i=e.length,s=e[0],a=e.subarray(1);if(i!==t||2!==s&&3!==s){if(i===r&&4===s){const e=n.BYTES,t=n.fromBytes(a.subarray(0,e)),r=n.fromBytes(a.subarray(e,2*e));if(!S(t,r))throw new Error("bad point: is not on curve");return{x:t,y:r}}throw new Error(`bad point: got length ${i}, expected compressed=${t} or uncompressed=${r}`)}{const e=n.fromBytes(a);if(!n.isValid(e))throw new Error("bad point: is not on curve, wrong x");const t=I(e);let r;try{r=n.sqrt(t)}catch(e){const t=e instanceof Error?": "+e.message:"";throw new Error("bad point: is not on curve, sqrt error"+t)}return m(),!(1&~s)!==n.isOdd(r)&&(r=n.neg(r)),{x:e,y:r}}};function I(e){const t=n.sqr(e),r=n.mul(t,e);return n.add(n.add(r,n.mul(e,c.a)),c.b)}function S(e,t){const r=n.sqr(t),i=I(e);return n.eql(r,i)}if(!S(c.Gx,c.Gy))throw new Error("bad curve params: generator point");const C=n.mul(n.pow(c.a,y),w),k=n.mul(n.sqr(c.b),BigInt(27));if(n.is0(n.add(C,k)))throw new Error("bad curve params: a or b");function N(e,t,r=!1){if(!n.isValid(t)||r&&n.is0(t))throw new Error(`bad point coordinate ${e}`);return t}function x(e){if(!(e instanceof U))throw new Error("ProjectivePoint expected")}function T(e){if(!d||!d.basises)throw new Error("no endo");return function(e,t,r){const[[n,i],[s,a]]=t,c=l(a*e,r),u=l(-i*e,r);let h=e-c*n-u*s,d=-c*i-u*a;const p=h<f,m=d<f;p&&(h=-h),m&&(d=-d);const y=(0,o.OG)(Math.ceil((0,o.dJ)(r)/2))+g;if(h<f||h>=y||d<f||d>=y)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:p,k1:h,k2neg:m,k2:d}}(e,d.basises,i.ORDER)}const O=(0,o.x)((e,t)=>{const{X:r,Y:i,Z:s}=e;if(n.eql(s,n.ONE))return{x:r,y:i};const o=e.is0();null==t&&(t=o?n.ONE:n.inv(s));const a=n.mul(r,t),c=n.mul(i,t),l=n.mul(s,t);if(o)return{x:n.ZERO,y:n.ZERO};if(!n.eql(l,n.ONE))throw new Error("invZ was invalid");return{x:a,y:c}}),P=(0,o.x)(e=>{if(e.is0()){if(t.allowInfinityPoint&&!n.is0(e.Y))return;throw new Error("bad point: ZERO")}const{x:r,y:i}=e.toAffine();if(!n.isValid(r)||!n.isValid(i))throw new Error("bad point: x or y not field elements");if(!S(r,i))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function R(e,t,r,i,s){return r=new U(n.mul(r.X,e),r.Y,r.Z),t=(0,a.u0)(i,t),r=(0,a.u0)(s,r),t.add(r)}class U{constructor(e,t,r){this.X=N("x",e),this.Y=N("y",t,!0),this.Z=N("z",r),Object.freeze(this)}static CURVE(){return c}static fromAffine(e){const{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw new Error("invalid affine point");if(e instanceof U)throw new Error("projective point not allowed");return n.is0(t)&&n.is0(r)?U.ZERO:new U(t,r,n.ONE)}static fromBytes(e){const t=U.fromAffine(_((0,o.eV)(e,void 0,"point")));return t.assertValidity(),t}static fromHex(e){return U.fromBytes((0,o.qj)("pointHex",e))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(e=8,t=!0){return M.createCache(this,e),t||this.multiply(y),this}assertValidity(){P(this)}hasEvenY(){const{y:e}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(e)}equals(e){x(e);const{X:t,Y:r,Z:i}=this,{X:s,Y:o,Z:a}=e,c=n.eql(n.mul(t,a),n.mul(s,i)),l=n.eql(n.mul(r,a),n.mul(o,i));return c&&l}negate(){return new U(this.X,n.neg(this.Y),this.Z)}double(){const{a:e,b:t}=c,r=n.mul(t,y),{X:i,Y:s,Z:o}=this;let a=n.ZERO,l=n.ZERO,u=n.ZERO,h=n.mul(i,i),d=n.mul(s,s),p=n.mul(o,o),f=n.mul(i,s);return f=n.add(f,f),u=n.mul(i,o),u=n.add(u,u),a=n.mul(e,u),l=n.mul(r,p),l=n.add(a,l),a=n.sub(d,l),l=n.add(d,l),l=n.mul(a,l),a=n.mul(f,a),u=n.mul(r,u),p=n.mul(e,p),f=n.sub(h,p),f=n.mul(e,f),f=n.add(f,u),u=n.add(h,h),h=n.add(u,h),h=n.add(h,p),h=n.mul(h,f),l=n.add(l,h),p=n.mul(s,o),p=n.add(p,p),h=n.mul(p,f),a=n.sub(a,h),u=n.mul(p,d),u=n.add(u,u),u=n.add(u,u),new U(a,l,u)}add(e){x(e);const{X:t,Y:r,Z:i}=this,{X:s,Y:o,Z:a}=e;let l=n.ZERO,u=n.ZERO,h=n.ZERO;const d=c.a,p=n.mul(c.b,y);let f=n.mul(t,s),g=n.mul(r,o),m=n.mul(i,a),w=n.add(t,r),b=n.add(s,o);w=n.mul(w,b),b=n.add(f,g),w=n.sub(w,b),b=n.add(t,i);let v=n.add(s,a);return b=n.mul(b,v),v=n.add(f,m),b=n.sub(b,v),v=n.add(r,i),l=n.add(o,a),v=n.mul(v,l),l=n.add(g,m),v=n.sub(v,l),h=n.mul(d,b),l=n.mul(p,m),h=n.add(l,h),l=n.sub(g,h),h=n.add(g,h),u=n.mul(l,h),g=n.add(f,f),g=n.add(g,f),m=n.mul(d,m),b=n.mul(p,b),g=n.add(g,m),m=n.sub(f,m),m=n.mul(d,m),b=n.add(b,m),f=n.mul(g,b),u=n.add(u,f),f=n.mul(v,b),l=n.mul(w,l),l=n.sub(l,f),f=n.mul(w,g),h=n.mul(v,h),h=n.add(h,f),new U(l,u,h)}subtract(e){return this.add(e.negate())}is0(){return this.equals(U.ZERO)}multiply(e){const{endo:r}=t;if(!i.isValidNot0(e))throw new Error("invalid scalar: out of range");let n,s;const o=e=>M.cached(this,e,e=>(0,a.Ak)(U,e));if(r){const{k1neg:t,k1:i,k2neg:a,k2:c}=T(e),{p:l,f:u}=o(i),{p:h,f:d}=o(c);s=u.add(d),n=R(r.beta,l,h,t,a)}else{const{p:t,f:r}=o(e);n=t,s=r}return(0,a.Ak)(U,[n,s])[0]}multiplyUnsafe(e){const{endo:r}=t,n=this;if(!i.isValid(e))throw new Error("invalid scalar: out of range");if(e===f||n.is0())return U.ZERO;if(e===g)return n;if(M.hasCache(this))return this.multiply(e);if(r){const{k1neg:t,k1:i,k2neg:s,k2:o}=T(e),{p1:c,p2:l}=(0,a.fH)(U,n,i,o);return R(r.beta,c,l,t,s)}return M.unsafe(n,e)}multiplyAndAddUnsafe(e,t,r){const n=this.multiplyUnsafe(t).add(e.multiplyUnsafe(r));return n.is0()?void 0:n}toAffine(e){return O(this,e)}isTorsionFree(){const{isTorsionFree:e}=t;return u===g||(e?e(U,this):M.unsafe(this,h).is0())}clearCofactor(){const{clearCofactor:e}=t;return u===g?this:e?e(U,this):this.multiplyUnsafe(u)}isSmallOrder(){return this.multiplyUnsafe(u).is0()}toBytes(e=!0){return(0,o.d6)(e,"isCompressed"),this.assertValidity(),A(U,this,e)}toHex(e=!0){return(0,s.My)(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(e=!0){return this.toBytes(e)}_setWindowSize(e){this.precompute(e)}static normalizeZ(e){return(0,a.Ak)(U,e)}static msm(e,t){return(0,a.Xf)(U,i,e,t)}static fromPrivateKey(e){return U.BASE.multiply(b(i,e))}}U.BASE=new U(c.Gx,c.Gy,n.ONE),U.ZERO=new U(n.ZERO,n.ONE,n.ZERO),U.Fp=n,U.Fn=i;const B=i.BITS,M=new a.hT(U,t.endo?Math.ceil(B/2):B);return U.BASE.precompute(8),U}(t,r),n,d))}const _={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},I={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},S=BigInt(2),C=(0,c.D0)(_.p,{sqrt:function(e){const t=_.p,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),o=BigInt(23),a=BigInt(44),l=BigInt(88),u=e*e*e%t,h=u*u*e%t,d=(0,c.zH)(h,r,t)*h%t,p=(0,c.zH)(d,r,t)*h%t,f=(0,c.zH)(p,S,t)*u%t,g=(0,c.zH)(f,i,t)*f%t,m=(0,c.zH)(g,s,t)*g%t,y=(0,c.zH)(m,a,t)*m%t,w=(0,c.zH)(y,l,t)*y%t,b=(0,c.zH)(w,a,t)*m%t,v=(0,c.zH)(b,r,t)*h%t,E=(0,c.zH)(v,o,t)*g%t,A=(0,c.zH)(E,n,t)*u%t,I=(0,c.zH)(A,S,t);if(!C.eql(C.sqr(I),e))throw new Error("Cannot find square root");return I}}),k=function(e,t){const r=t=>A({...e,hash:t});return{...r(t),create:r}}({..._,Fp:C,lowS:!0,endo:I},n.sc)},5215:(e,t,r)=>{r.r(t),r.d(t,{__assign:()=>s,__asyncDelegator:()=>v,__asyncGenerator:()=>b,__asyncValues:()=>E,__await:()=>w,__awaiter:()=>u,__classPrivateFieldGet:()=>S,__classPrivateFieldSet:()=>C,__createBinding:()=>d,__decorate:()=>a,__exportStar:()=>p,__extends:()=>i,__generator:()=>h,__importDefault:()=>I,__importStar:()=>_,__makeTemplateObject:()=>A,__metadata:()=>l,__param:()=>c,__read:()=>g,__rest:()=>o,__spread:()=>m,__spreadArrays:()=>y,__values:()=>f});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},n(e,t)};function i(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function a(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o}function c(e,t){return function(r,n){t(r,n,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e,t,r,n){return new(r||(r=Promise))(function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((n=n.apply(e,t||[])).next())})}function h(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function d(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}function p(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])}function f(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function g(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(g(arguments[t]));return e}function y(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function w(e){return this instanceof w?(this.v=e,this):new w(e)}function b(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){i[e]&&(n[e]=function(t){return new Promise(function(r,n){s.push([e,t,r,n])>1||a(e,t)})})}function a(e,t){try{(r=i[e](t)).value instanceof w?Promise.resolve(r.value.v).then(c,l):u(s[0][2],r)}catch(e){u(s[0][3],e)}var r}function c(e){a("next",e)}function l(e){a("throw",e)}function u(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function v(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:w(e[n](t)),done:"return"===n}:i?i(t):t}:i}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=f(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}}function A(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function _(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function I(e){return e&&e.__esModule?e:{default:e}}function S(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function C(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},5306:(e,t,r)=>{r.d(t,{y:()=>a});var n=r(4376),i=r(6056),s=r(6010),o=r(9510);const a={getCaipTokens(e){if(!e)return;const t={};return Object.entries(e).forEach(([e,r])=>{t[`${o.o.EIP155}:${e}`]=r}),t},isLowerCaseMatch:(e,t)=>e?.toLowerCase()===t?.toLowerCase(),getActiveNamespaceConnectedToAuth(){const e=i.W.state.activeChain;return n.o.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(t=>s.a.getConnectorId(t)===n.o.CONNECTOR_ID.AUTH&&t===e)},withRetry({conditionFn:e,intervalMs:t,maxRetries:r}){let n=0;return new Promise(i=>{!async function s(){return n+=1,await e()?i(!0):n>=r?i(!1):(setTimeout(s,t),null)}()})}}},5574:(e,t,r)=>{r.d(t,{O:()=>s,W:()=>o});var n=r(4376),i=r(6056);const s={PHANTOM:{id:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",url:"https://phantom.app"},SOLFLARE:{id:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",url:"https://solflare.com"},COINBASE:{id:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",url:"https://go.cb-w.com"},BINANCE:{id:"2fafea35bb471d22889ccb49c08d99dd0a18a37982602c33f696a5723934ba25",appId:"yFK5FCqYprrXDiVFbhyRx7",deeplink:"bnc://app.binance.com/mp/app",url:"https://app.binance.com/en/download"}},o={handleMobileDeeplinkRedirect(e,t){const r=window.location.href,o=encodeURIComponent(r);if(e===s.PHANTOM.id&&!("phantom"in window)){const e=r.startsWith("https")?"https":"http",t=r.split("/")[2],n=encodeURIComponent(`${e}://${t}`);window.location.href=`${s.PHANTOM.url}/ul/browse/${o}?ref=${n}`}if(e!==s.SOLFLARE.id||"solflare"in window||(window.location.href=`${s.SOLFLARE.url}/ul/v1/browse/${o}?ref=${o}`),t===n.o.CHAIN.SOLANA&&(e!==s.COINBASE.id||"coinbaseSolana"in window||(window.location.href=`${s.COINBASE.url}/dapp?cb_url=${o}`)),t===n.o.CHAIN.BITCOIN&&e===s.BINANCE.id&&!("binancew3w"in window)){const e=i.W.state.activeCaipNetwork,t=window.btoa("/pages/browser/index"),r=window.btoa(`url=${o}&defaultChainId=${e?.id??1}`),n=new URL(s.BINANCE.deeplink);n.searchParams.set("appId",s.BINANCE.appId),n.searchParams.set("startPagePath",t),n.searchParams.set("startPageQuery",r);const a=new URL(s.BINANCE.url);a.searchParams.set("_dp",window.btoa(n.toString())),window.location.href=a.toString()}}}},5595:(e,t,r)=>{r.d(t,{T:()=>g});var n=r(8126),i=r(2944),s=r(6742),o=r(5905),a=r(7508),c=r(3450),l=r(6056),u=r(2733),h=r(1871);const d={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},p=s.w.getBlockchainApiUrl(),f=(0,n.BX)({clientId:null,api:new o.Z({baseUrl:p,clientId:null}),supportedChains:{http:[],ws:[]}}),g={state:f,async get(e){const{st:t,sv:r}=g.getSdkProperties(),n=u.H.state.projectId,i={...e.params||{},st:t,sv:r,projectId:n};return f.api.get({...e,params:i})},getSdkProperties(){const{sdkType:e,sdkVersion:t}=u.H.state;return{st:e||"unknown",sv:t||"unknown"}},async isNetworkSupported(e){if(!e)return!1;try{f.supportedChains.http.length||await g.getSupportedNetworks()}catch(e){return!1}return f.supportedChains.http.includes(e)},async getSupportedNetworks(){try{const e=await g.get({path:"v1/supported-chains"});return f.supportedChains=e,e}catch{return f.supportedChains}},async fetchIdentity({address:e,caipNetworkId:t}){if(!await g.isNetworkSupported(t))return{avatar:"",name:""};const r=a.i.getIdentityFromCacheForAddress(e);if(r)return r;const n=await g.get({path:`/v1/identity/${e}`,params:{sender:l.W.state.activeCaipAddress?s.w.getPlainAddress(l.W.state.activeCaipAddress):void 0}});return a.i.updateIdentityCache({address:e,identity:n,timestamp:Date.now()}),n},async fetchTransactions({account:e,cursor:t,signal:r,cache:n,chainId:i}){if(!await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId))return{data:[],next:void 0};const s=a.i.getTransactionsCacheForAddress({address:e,chainId:i});if(s)return s;const o=await g.get({path:`/v1/account/${e}/history`,params:{cursor:t,chainId:i},signal:r,cache:n});return a.i.updateTransactionsCache({address:e,chainId:i,timestamp:Date.now(),transactions:o}),o},fetchSwapQuote:async({amount:e,userAddress:t,from:r,to:n,gasPrice:i})=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?g.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:e,userAddress:t,from:r,to:n,gasPrice:i}}):{quotes:[]},fetchSwapTokens:async({chainId:e})=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?g.get({path:"/v1/convert/tokens",params:{chainId:e}}):{tokens:[]},async fetchTokenPrice({addresses:e}){if(!await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId))return{fungibles:[]};const t=a.i.getTokenPriceCacheForAddresses(e);if(t)return t;const r=await f.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:e,projectId:u.H.state.projectId},headers:{"Content-Type":"application/json"}});return a.i.updateTokenPriceCache({addresses:e,timestamp:Date.now(),tokenPrice:r}),r},fetchSwapAllowance:async({tokenAddress:e,userAddress:t})=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?g.get({path:"/v1/convert/allowance",params:{tokenAddress:e,userAddress:t},headers:{"Content-Type":"application/json"}}):{allowance:"0"},async fetchGasPrice({chainId:e}){const{st:t,sv:r}=g.getSdkProperties();if(!await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Gas Price");return g.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:e,st:t,sv:r}})},async generateSwapCalldata({amount:e,from:t,to:r,userAddress:n,disableEstimate:s}){if(!await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return f.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:e,eip155:{slippage:i.oU.CONVERT_SLIPPAGE_TOLERANCE},projectId:u.H.state.projectId,from:t,to:r,userAddress:n,disableEstimate:s}})},async generateApproveCalldata({from:e,to:t,userAddress:r}){const{st:n,sv:i}=g.getSdkProperties();if(!await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return g.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:r,from:e,to:t,st:n,sv:i}})},async getBalance(e,t,r){const{st:n,sv:i}=g.getSdkProperties();if(!await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId))return h.P.showError("Token Balance Unavailable"),{balances:[]};const s=`${t}:${e}`,o=a.i.getBalanceCacheForCaipAddress(s);if(o)return o;const c=await g.get({path:`/v1/account/${e}/balance`,params:{currency:"usd",chainId:t,forceUpdate:r,st:n,sv:i}});return a.i.updateBalanceCache({caipAddress:s,balance:c,timestamp:Date.now()}),c},lookupEnsName:async e=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?g.get({path:`/v1/profile/account/${e}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]},reverseLookupEnsName:async({address:e})=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?g.get({path:`/v1/profile/reverse/${e}`,params:{sender:c.U.state.address,apiVersion:"2"}}):[],getEnsNameSuggestions:async e=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?g.get({path:`/v1/profile/suggestions/${e}`,params:{zone:"reown.id"}}):{suggestions:[]},registerEnsName:async({coinType:e,address:t,message:r,signature:n})=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?f.api.post({path:"/v1/profile/account",body:{coin_type:e,address:t,message:r,signature:n},headers:{"Content-Type":"application/json"}}):{success:!1},generateOnRampURL:async({destinationWallets:e,partnerUserId:t,defaultNetwork:r,purchaseAmount:n,paymentAmount:i})=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?(await f.api.post({path:"/v1/generators/onrampurl",params:{projectId:u.H.state.projectId},body:{destinationWallets:e,defaultNetwork:r,partnerUserId:t,defaultExperience:"buy",presetCryptoAmount:n,presetFiatAmount:i}})).url:"",async getOnrampOptions(){if(!await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await g.get({path:"/v1/onramp/options"})}catch(e){return d}},async getOnrampQuote({purchaseCurrency:e,paymentCurrency:t,amount:r,network:n}){try{return await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?await f.api.post({path:"/v1/onramp/quote",params:{projectId:u.H.state.projectId},body:{purchaseCurrency:e,paymentCurrency:t,amount:r,network:n}}):null}catch(e){return{networkFee:{amount:r,currency:t.id},paymentSubtotal:{amount:r,currency:t.id},paymentTotal:{amount:r,currency:t.id},purchaseAmount:{amount:r,currency:t.id},quoteId:"mocked-quote-id"}}},getSmartSessions:async e=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?g.get({path:`/v1/sessions/${e}`}):[],revokeSmartSession:async(e,t,r)=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?f.api.post({path:`/v1/sessions/${e}/revoke`,params:{projectId:u.H.state.projectId},body:{pci:t,signature:r}}):{success:!1},setClientId(e){f.clientId=e,f.api=new o.Z({baseUrl:p,clientId:e})}}},5621:(e,t,r)=>{var n=r(2861).Buffer;e.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==t[o])throw new TypeError(s+" is ambiguous");t[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return n.alloc(0);for(var r=0,i=0,s=0;e[r]===c;)i++,r++;for(var o=(e.length-r)*l+1>>>0,u=new Uint8Array(o);r<e.length;){var h=e.charCodeAt(r);if(h>255)return;var d=t[h];if(255===d)return;for(var p=0,f=o-1;(0!==d||p<s)&&-1!==f;f--,p++)d+=a*u[f]>>>0,u[f]=d%256>>>0,d=d/256>>>0;if(0!==d)throw new Error("Non-zero carry");s=p,r++}for(var g=o-s;g!==o&&0===u[g];)g++;var m=n.allocUnsafe(i+(o-g));m.fill(0,0,i);for(var y=i;g!==o;)m[y++]=u[g++];return m}return{encode:function(t){if((Array.isArray(t)||t instanceof Uint8Array)&&(t=n.from(t)),!n.isBuffer(t))throw new TypeError("Expected Buffer");if(0===t.length)return"";for(var r=0,i=0,s=0,o=t.length;s!==o&&0===t[s];)s++,r++;for(var l=(o-s)*u+1>>>0,h=new Uint8Array(l);s!==o;){for(var d=t[s],p=0,f=l-1;(0!==d||p<i)&&-1!==f;f--,p++)d+=256*h[f]>>>0,h[f]=d%a>>>0,d=d/a>>>0;if(0!==d)throw new Error("Non-zero carry");i=p,s++}for(var g=l-i;g!==l&&0===h[g];)g++;for(var m=c.repeat(r);g<l;++g)m+=e.charAt(h[g]);return m},decodeUnsafe:h,decode:function(e){var t=h(e);if(t)return t;throw new Error("Non-base"+a+" character")}}}},5682:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(5215);n.__exportStar(r(7173),t),n.__exportStar(r(1089),t)},5826:function(e){e.exports={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||t[0])+"]"}}},5839:(e,t,r)=>{r.d(t,{R:()=>ye});const n=(e,t,r)=>JSON.stringify(e,(e,r)=>{const n="bigint"==typeof r?r.toString():r;return"function"==typeof t?t(e,n):n},r);var i=r(1344);class s extends i.C{constructor({body:e,cause:t,details:r,headers:i,status:s,url:o}){super("HTTP request failed.",{cause:t,details:r,metaMessages:[s&&`Status: ${s}`,`URL: ${o}`,e&&`Request body: ${n(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=i,this.status=s,this.url=o}}i.C;class o extends i.C{constructor({body:e,error:t,url:r}){super("RPC Request failed.",{cause:t,details:t.message,metaMessages:[`URL: ${r}`,`Request body: ${n(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=t.code,this.data=t.data}}i.C;class a extends i.C{constructor({body:e,url:t}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${t}`,`Request body: ${n(e)}`],name:"TimeoutError"})}}class c extends i.C{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}const l=new Map;function u(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const h=u();class d extends i.C{constructor(e,{code:t,docsPath:r,metaMessages:n,name:i,shortMessage:s}){super(s,{cause:e,docsPath:r,metaMessages:n||e?.metaMessages,name:i||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=i||e.name,this.code=e instanceof o?e.code:t??-1}}class p extends d{constructor(e,t){super(e,t),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t.data}}class f extends d{constructor(e){super(e,{code:f.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(f,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class g extends d{constructor(e){super(e,{code:g.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(g,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class m extends d{constructor(e,{method:t}={}){super(e,{code:m.code,name:"MethodNotFoundRpcError",shortMessage:`The method${t?` "${t}"`:""} does not exist / is not available.`})}}Object.defineProperty(m,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class y extends d{constructor(e){super(e,{code:y.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join("\n")})}}Object.defineProperty(y,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class w extends d{constructor(e){super(e,{code:w.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(w,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class b extends d{constructor(e){super(e,{code:b.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join("\n")})}}Object.defineProperty(b,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class v extends d{constructor(e){super(e,{code:v.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(v,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class E extends d{constructor(e){super(e,{code:E.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(E,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class A extends d{constructor(e){super(e,{code:A.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(A,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class _ extends d{constructor(e,{method:t}={}){super(e,{code:_.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${t?` "${t}"`:""} is not supported.`})}}Object.defineProperty(_,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class I extends d{constructor(e){super(e,{code:I.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(I,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class S extends d{constructor(e){super(e,{code:S.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(S,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class C extends p{constructor(e){super(e,{code:C.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(C,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class k extends p{constructor(e){super(e,{code:k.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(k,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class N extends p{constructor(e,{method:t}={}){super(e,{code:N.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${t?` " ${t}"`:""}.`})}}Object.defineProperty(N,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class x extends p{constructor(e){super(e,{code:x.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(x,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class T extends p{constructor(e){super(e,{code:T.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(T,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class O extends p{constructor(e){super(e,{code:O.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(O,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class P extends p{constructor(e){super(e,{code:P.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(P,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class R extends p{constructor(e){super(e,{code:R.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(R,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class U extends p{constructor(e){super(e,{code:U.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(U,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class B extends p{constructor(e){super(e,{code:B.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(B,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class M extends p{constructor(e){super(e,{code:M.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(M,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class L extends p{constructor(e){super(e,{code:L.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(L,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class D extends p{constructor(e){super(e,{code:D.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(D,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class W extends d{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}var j=r(1727);class $ extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&void 0!==t&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const e=this.keys().next().value;e&&this.delete(e)}return this}}const z=new $(8192);async function q(e){return new Promise(t=>setTimeout(t,e))}function F(e,t={}){return async(r,o={})=>{const{dedupe:a=!1,methods:c,retryDelay:l=150,retryCount:u=3,uid:h}={...t,...o},{method:d}=r;if(c?.exclude?.includes(d))throw new _(new Error("method not supported"),{method:d});if(c?.include&&!c.include.includes(d))throw new _(new Error("method not supported"),{method:d});return function(e,{enabled:t=!0,id:r}){if(!t||!r)return e();if(z.get(r))return z.get(r);const n=e().finally(()=>z.delete(r));return z.set(r,n),n}(()=>function(e,{delay:t=100,retryCount:r=2,shouldRetry:n=()=>!0}={}){return new Promise((i,s)=>{const o=async({count:a=0}={})=>{try{const t=await e();i(t)}catch(e){if(a<r&&await n({count:a,error:e}))return(async({error:e})=>{const r="function"==typeof t?t({count:a,error:e}):t;r&&await q(r),o({count:a+1})})({error:e});s(e)}};o()})}(async()=>{try{return await e(r)}catch(e){const t=e;switch(t.code){case f.code:throw new f(t);case g.code:throw new g(t);case m.code:throw new m(t,{method:r.method});case y.code:throw new y(t);case w.code:throw new w(t);case b.code:throw new b(t);case v.code:throw new v(t);case E.code:throw new E(t);case A.code:throw new A(t);case _.code:throw new _(t,{method:r.method});case I.code:throw new I(t);case S.code:throw new S(t);case C.code:throw new C(t);case k.code:throw new k(t);case N.code:throw new N(t);case x.code:throw new x(t);case T.code:throw new T(t);case O.code:throw new O(t);case P.code:throw new P(t);case R.code:throw new R(t);case U.code:throw new U(t);case B.code:throw new B(t);case M.code:throw new M(t);case L.code:throw new L(t);case D.code:throw new D(t);case 5e3:throw new C(t);default:if(e instanceof i.C)throw e;throw new W(t)}}},{delay:({count:e,error:t})=>{if(t&&t instanceof s){const e=t?.headers?.get("Retry-After");if(e?.match(/\d/))return 1e3*Number.parseInt(e)}return(1<<e)*l},retryCount:u,shouldRetry:({error:e})=>function(e){return"code"in e&&"number"==typeof e.code?-1===e.code||e.code===I.code||e.code===w.code:!(e instanceof s&&e.status)||(403===e.status||408===e.status||413===e.status||429===e.status||500===e.status||502===e.status||503===e.status||504===e.status)}(e)}),{enabled:a,id:a?(0,j.i3)(`${h}.${n(r)}`):void 0})}}let H,K=256;function V({key:e,methods:t,name:r,request:n,retryCount:i=3,retryDelay:s=150,timeout:o,type:a},c){return{config:{key:e,methods:t,name:r,request:n,retryCount:i,retryDelay:s,timeout:o,type:a},request:F(n,{methods:t,retryCount:i,retryDelay:s,uid:function(e=11){if(!H||K+e>512){H="",K=0;for(let e=0;e<256;e++)H+=(256+256*Math.random()|0).toString(16).substring(1)}return H.substring(K,K+++e)}()}),value:c}}function Y(e,t={}){const{batch:r,fetchOptions:i,key:u="http",methods:d,name:p="HTTP JSON-RPC",onFetchRequest:f,onFetchResponse:g,retryDelay:m,raw:y}=t;return({chain:w,retryCount:b,timeout:v})=>{const{batchSize:E=1e3,wait:A=0}="object"==typeof r?r:{},_=t.retryCount??b,I=v??t.timeout??1e4,S=e||w?.rpcUrls.default.http[0];if(!S)throw new c;const C=function(e,t={}){return{async request(r){const{body:i,onRequest:o=t.onRequest,onResponse:c=t.onResponse,timeout:l=t.timeout??1e4}=r,u={...t.fetchOptions??{},...r.fetchOptions??{}},{headers:d,method:p,signal:f}=u;try{const t=await function(e,{errorInstance:t=new Error("timed out"),timeout:r,signal:n}){return new Promise((i,s)=>{(async()=>{let o;try{const a=new AbortController;r>0&&(o=setTimeout(()=>{n?a.abort():s(t)},r)),i(await e({signal:a?.signal||null}))}catch(e){"AbortError"===e?.name&&s(t),s(e)}finally{clearTimeout(o)}})()})}(async({signal:t})=>{const r={...u,body:Array.isArray(i)?n(i.map(e=>({jsonrpc:"2.0",id:e.id??h.take(),...e}))):n({jsonrpc:"2.0",id:i.id??h.take(),...i}),headers:{"Content-Type":"application/json",...d},method:p||"POST",signal:f||(l>0?t:null)},s=new Request(e,r),a=await(o?.(s,r))??{...r,url:e};return await fetch(a.url??e,a)},{errorInstance:new a({body:i,url:e}),timeout:l,signal:!0});let r;if(c&&await c(t),t.headers.get("Content-Type")?.startsWith("application/json"))r=await t.json();else{r=await t.text();try{r=JSON.parse(r||"{}")}catch(e){if(t.ok)throw e;r={error:r}}}if(!t.ok)throw new s({body:i,details:n(r.error)||t.statusText,headers:t.headers,status:t.status,url:e});return r}catch(t){if(t instanceof s)throw t;if(t instanceof a)throw t;throw new s({body:i,cause:t,url:e})}}}}(S,{fetchOptions:i,onRequest:f,onResponse:g,timeout:I});return V({key:u,methods:d,name:p,async request({method:e,params:t}){const n={method:e,params:t},{schedule:i}=function({fn:e,id:t,shouldSplitBatch:r,wait:n=0,sort:i}){const s=async()=>{const t=a();o();const r=t.map(({args:e})=>e);0!==r.length&&e(r).then(e=>{i&&Array.isArray(e)&&e.sort(i);for(let r=0;r<t.length;r++){const{resolve:n}=t[r];n?.([e[r],e])}}).catch(e=>{for(let r=0;r<t.length;r++){const{reject:n}=t[r];n?.(e)}})},o=()=>l.delete(t),a=()=>l.get(t)||[],c=e=>l.set(t,[...a(),e]);return{flush:o,async schedule(e){const{promise:t,resolve:i,reject:o}=function(){let e=()=>{},t=()=>{};return{promise:new Promise((r,n)=>{e=r,t=n}),resolve:e,reject:t}}(),l=r?.([...a().map(({args:e})=>e),e]);return l&&s(),a().length>0?(c({args:e,resolve:i,reject:o}),t):(c({args:e,resolve:i,reject:o}),setTimeout(s,n),t)}}}({id:S,wait:A,shouldSplitBatch:e=>e.length>E,fn:e=>C.request({body:e}),sort:(e,t)=>e.id-t.id}),[{error:s,result:a}]=await(async e=>r?i(e):[await C.request({body:e})])(n);if(y)return{error:s,result:a};if(s)throw new o({body:n,error:s,url:S});return a},retryCount:_,retryDelay:m,timeout:I,type:"http"},{fetchOptions:i,url:S})}}const G={ether:-9,wei:9};var Z=r(7135);function J(e,t="wei"){return(0,Z.J)(e,G[t])}class X extends i.C{constructor({cause:e,message:t}={}){const r=t?.replace("execution reverted: ","")?.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(X,"code",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(X,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class Q extends i.C{constructor({cause:e,maxFeePerGas:t}={}){super(`The fee cap (\`maxFeePerGas\`${t?` = ${J(t)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:e,name:"FeeCapTooHighError"})}}Object.defineProperty(Q,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});class ee extends i.C{constructor({cause:e,maxFeePerGas:t}={}){super(`The fee cap (\`maxFeePerGas\`${t?` = ${J(t)}`:""} gwei) cannot be lower than the block base fee.`,{cause:e,name:"FeeCapTooLowError"})}}Object.defineProperty(ee,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/});class te extends i.C{constructor({cause:e,nonce:t}={}){super(`Nonce provided for the transaction ${t?`(${t}) `:""}is higher than the next one expected.`,{cause:e,name:"NonceTooHighError"})}}Object.defineProperty(te,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/});class re extends i.C{constructor({cause:e,nonce:t}={}){super([`Nonce provided for the transaction ${t?`(${t}) `:""}is lower than the current nonce of the account.`,"Try increasing the nonce or find the latest nonce with `getTransactionCount`."].join("\n"),{cause:e,name:"NonceTooLowError"})}}Object.defineProperty(re,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/});class ne extends i.C{constructor({cause:e,nonce:t}={}){super(`Nonce provided for the transaction ${t?`(${t}) `:""}exceeds the maximum allowed nonce.`,{cause:e,name:"NonceMaxValueError"})}}Object.defineProperty(ne,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/});class ie extends i.C{constructor({cause:e}={}){super(["The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account."].join("\n"),{cause:e,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."],name:"InsufficientFundsError"})}}Object.defineProperty(ie,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds|exceeds transaction sender account balance/});class se extends i.C{constructor({cause:e,gas:t}={}){super(`The amount of gas ${t?`(${t}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:e,name:"IntrinsicGasTooHighError"})}}Object.defineProperty(se,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/});class oe extends i.C{constructor({cause:e,gas:t}={}){super(`The amount of gas ${t?`(${t}) `:""}provided for the transaction is too low.`,{cause:e,name:"IntrinsicGasTooLowError"})}}Object.defineProperty(oe,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/});class ae extends i.C{constructor({cause:e}){super("The transaction type is not supported for this chain.",{cause:e,name:"TransactionTypeNotSupportedError"})}}Object.defineProperty(ae,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/});class ce extends i.C{constructor({cause:e,maxPriorityFeePerGas:t,maxFeePerGas:r}={}){super([`The provided tip (\`maxPriorityFeePerGas\`${t?` = ${J(t)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${r?` = ${J(r)} gwei`:""}).`].join("\n"),{cause:e,name:"TipAboveFeeCapError"})}}function le(e,t={}){const{key:r="fallback",name:n="Fallback",rank:i=!1,shouldThrow:s=ue,retryCount:o,retryDelay:a}=t;return({chain:t,pollingInterval:c=4e3,timeout:l,...u})=>{let h=e,d=()=>{};const p=V({key:r,name:n,async request({method:e,params:r}){let n;const i=async(o=0)=>{const a=h[o]({...u,chain:t,retryCount:0,timeout:l});try{const t=await a.request({method:e,params:r});return d({method:e,params:r,response:t,transport:a,status:"success"}),t}catch(c){if(d({error:c,method:e,params:r,transport:a,status:"error"}),s(c))throw c;if(o===h.length-1)throw c;if(n??=h.slice(o+1).some(r=>{const{include:n,exclude:i}=r({chain:t}).config.methods||{};return n?n.includes(e):!i||!i.includes(e)}),!n)throw c;return i(o+1)}};return i()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:e=>d=e,transports:h.map(e=>e({chain:t,retryCount:0}))});if(i){const e="object"==typeof i?i:{};!function({chain:e,interval:t=4e3,onTransports:r,ping:n,sampleCount:i=10,timeout:s=1e3,transports:o,weights:a={}}){const{stability:c=.7,latency:l=.3}=a,u=[],h=async()=>{const a=await Promise.all(o.map(async t=>{const r=t({chain:e,retryCount:0,timeout:s}),i=Date.now();let o,a;try{await(n?n({transport:r}):r.request({method:"net_listening"})),a=1}catch{a=0}finally{o=Date.now()}return{latency:o-i,success:a}}));u.push(a),u.length>i&&u.shift();const d=Math.max(...u.map(e=>Math.max(...e.map(({latency:e})=>e)))),p=o.map((e,t)=>{const r=u.map(e=>e[t].latency),n=1-r.reduce((e,t)=>e+t,0)/r.length/d,i=u.map(e=>e[t].success),s=i.reduce((e,t)=>e+t,0)/i.length;return 0===s?[0,t]:[l*n+c*s,t]}).sort((e,t)=>t[0]-e[0]);r(p.map(([,e])=>o[e])),await q(t),h()};h()}({chain:t,interval:e.interval??c,onTransports:e=>h=e,ping:e.ping,sampleCount:e.sampleCount,timeout:e.timeout,transports:h,weights:e.weights})}return p}}function ue(e){return!(!("code"in e)||"number"!=typeof e.code||e.code!==A.code&&e.code!==C.code&&!X.nodeMessage.test(e.message)&&5e3!==e.code)}Object.defineProperty(ce,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/}),i.C;var he=r(4376),de=r(7508),pe=r(6056),fe=r(2571);function ge(e,t){const r=new URL("https://rpc.walletconnect.org/v1/");return r.searchParams.set("chainId",e),r.searchParams.set("projectId",t),r.toString()}const me=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],ye={extendRpcUrlWithProjectId(e,t){let r=!1;try{r="rpc.walletconnect.org"===new URL(e).host}catch(e){r=!1}if(r){const r=new URL(e);return r.searchParams.has("projectId")||r.searchParams.set("projectId",t),r.toString()}return e},isCaipNetwork:e=>"chainNamespace"in e&&"caipNetworkId"in e,getChainNamespace(e){return this.isCaipNetwork(e)?e.chainNamespace:he.o.CHAIN.EVM},getCaipNetworkId(e){return this.isCaipNetwork(e)?e.caipNetworkId:`${he.o.CHAIN.EVM}:${e.id}`},getDefaultRpcUrl(e,t,r){const n=e.rpcUrls?.default?.http?.[0];return me.includes(t)?ge(t,r):n||""},extendCaipNetwork(e,{customNetworkImageUrls:t,projectId:r,customRpcUrls:n}){const i=this.getChainNamespace(e),s=this.getCaipNetworkId(e),o=e.rpcUrls?.default?.http?.[0],a=this.getDefaultRpcUrl(e,s,r),c=e?.rpcUrls?.chainDefault?.http?.[0]||o,l=n?.[s]?.map(e=>e.url)||[],u=[...l,...a?[a]:[]],h=[...l];return c&&!h.includes(c)&&h.push(c),{...e,chainNamespace:i,caipNetworkId:s,assets:{imageId:fe.L.NetworkImageIds[e.id],imageUrl:t?.[e.id]},rpcUrls:{...e.rpcUrls,default:{http:u},chainDefault:{http:h}}}},extendCaipNetworks:(e,{customNetworkImageUrls:t,projectId:r,customRpcUrls:n})=>e.map(e=>ye.extendCaipNetwork(e,{customNetworkImageUrls:t,customRpcUrls:n,projectId:r})),getViemTransport(e,t,r){const n=[];return r?.forEach(e=>{n.push(Y(e.url,e.config))}),me.includes(e.caipNetworkId)&&n.push(Y(ge(e.caipNetworkId,t),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),e?.rpcUrls?.default?.http?.forEach(e=>{n.push(Y(e))}),le(n)},extendWagmiTransports(e,t,r){return me.includes(e.caipNetworkId)?le([r,Y(this.getDefaultRpcUrl(e,e.caipNetworkId,t))]):r},getUnsupportedNetwork:e=>({id:e.split(":")[1],caipNetworkId:e,name:he.o.UNSUPPORTED_NETWORK_NAME,chainNamespace:e.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}),getCaipNetworkFromStorage(e){const t=de.i.getActiveCaipNetworkId(),r=pe.W.getAllRequestedCaipNetworks(),n=Array.from(pe.W.state.chains?.keys()||[]),i=t?.split(":")[0],s=!!i&&n.includes(i),o=r?.find(e=>e.caipNetworkId===t);return s&&!o&&t?this.getUnsupportedNetwork(t):o||e||r?.[0]}}},5884:(e,t,r)=>{r.d(t,{aG:()=>y});var n=r(8126),i=r(4707),s=r(4376),o=r(2944),a=r(5940),c=r(8249),l=r(5595),u=r(6056),h=r(2733);const d={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},p={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},f={providers:o.tM,selectedProvider:null,error:null,purchaseCurrency:d,paymentCurrency:p,purchaseCurrencies:[d],paymentCurrencies:[],quotesLoading:!1},g=(0,n.BX)(f),m={state:g,subscribe:e=>(0,n.B1)(g,()=>e(g)),subscribeKey:(e,t)=>(0,i.u$)(g,e,t),setSelectedProvider(e){if(e&&"meld"===e.name){const t=u.W.state.activeChain,r=t===s.o.CHAIN.SOLANA?"SOL":"USDC",n=t?u.W.state.chains.get(t)?.accountState?.address??"":"",i=new URL(e.url);i.searchParams.append("publicKey",o.Db),i.searchParams.append("destinationCurrencyCode",r),i.searchParams.append("walletAddress",n),i.searchParams.append("externalCustomerId",h.H.state.projectId),g.selectedProvider={...e,url:i.toString()}}else g.selectedProvider=e},setOnrampProviders(e){if(Array.isArray(e)&&e.every(e=>"string"==typeof e)){const t=e,r=o.tM.filter(e=>t.includes(e.name));g.providers=r}else g.providers=[]},setPurchaseCurrency(e){g.purchaseCurrency=e},setPaymentCurrency(e){g.paymentCurrency=e},setPurchaseAmount(e){y.state.purchaseAmount=e},setPaymentAmount(e){y.state.paymentAmount=e},async getAvailableCurrencies(){const e=await l.T.getOnrampOptions();g.purchaseCurrencies=e.purchaseCurrencies,g.paymentCurrencies=e.paymentCurrencies,g.paymentCurrency=e.paymentCurrencies[0]||p,g.purchaseCurrency=e.purchaseCurrencies[0]||d,await c.N.fetchCurrencyImages(e.paymentCurrencies.map(e=>e.id)),await c.N.fetchTokenImages(e.purchaseCurrencies.map(e=>e.symbol))},async getQuote(){g.quotesLoading=!0;try{const e=await l.T.getOnrampQuote({purchaseCurrency:g.purchaseCurrency,paymentCurrency:g.paymentCurrency,amount:g.paymentAmount?.toString()||"0",network:g.purchaseCurrency?.symbol});return g.quotesLoading=!1,g.purchaseAmount=Number(e?.purchaseAmount.amount),e}catch(e){return g.error=e.message,g.quotesLoading=!1,null}finally{g.quotesLoading=!1}},resetState(){g.selectedProvider=null,g.error=null,g.purchaseCurrency=d,g.paymentCurrency=p,g.purchaseCurrencies=[d],g.paymentCurrencies=[],g.paymentAmount=void 0,g.purchaseAmount=void 0,g.quotesLoading=!1}},y=(0,a.X)(m)},5905:(e,t,r)=>{async function n(...e){const t=await fetch(...e);if(!t.ok)throw new Error(`HTTP status code: ${t.status}`,{cause:t});return t}r.d(t,{Z:()=>i});class i{constructor({baseUrl:e,clientId:t}){this.baseUrl=e,this.clientId=t}async get({headers:e,signal:t,cache:r,...i}){const s=this.createUrl(i);return(await n(s,{method:"GET",headers:e,signal:t,cache:r})).json()}async getBlob({headers:e,signal:t,...r}){const i=this.createUrl(r);return(await n(i,{method:"GET",headers:e,signal:t})).blob()}async post({body:e,headers:t,signal:r,...i}){const s=this.createUrl(i);return(await n(s,{method:"POST",headers:t,body:e?JSON.stringify(e):void 0,signal:r})).json()}async put({body:e,headers:t,signal:r,...i}){const s=this.createUrl(i);return(await n(s,{method:"PUT",headers:t,body:e?JSON.stringify(e):void 0,signal:r})).json()}async delete({body:e,headers:t,signal:r,...i}){const s=this.createUrl(i);return(await n(s,{method:"DELETE",headers:t,body:e?JSON.stringify(e):void 0,signal:r})).json()}createUrl({path:e,params:t}){const r=new URL(e,this.baseUrl);return t&&Object.entries(t).forEach(([e,t])=>{t&&r.searchParams.append(e,t)}),this.clientId&&r.searchParams.append("clientId",this.clientId),r}}},5910:(e,t,r)=>{r.d(t,{C:()=>n});const n={validateCaipAddress(e){if(3!==e.split(":")?.length)throw new Error("Invalid CAIP Address");return e},parseCaipAddress(e){const t=e.split(":");if(3!==t.length)throw new Error(`Invalid CAIP-10 address: ${e}`);const[r,n,i]=t;if(!r||!n||!i)throw new Error(`Invalid CAIP-10 address: ${e}`);return{chainNamespace:r,chainId:n,address:i}},parseCaipNetworkId(e){const t=e.split(":");if(2!==t.length)throw new Error(`Invalid CAIP-2 network id: ${e}`);const[r,n]=t;if(!r||!n)throw new Error(`Invalid CAIP-2 network id: ${e}`);return{chainNamespace:r,chainId:n}}}},5940:(e,t,r)=>{r.d(t,{A:()=>d,X:()=>f});var n=r(8126),i=r(4707),s=r(6742),o=r(5905),a=r(2733);const c=Object.freeze({enabled:!0,events:[]}),l=new o.Z({baseUrl:s.w.getAnalyticsUrl(),clientId:null}),u=(0,n.BX)({...c}),h={state:u,subscribeKey:(e,t)=>(0,i.u$)(u,e,t),async sendError(e,t){if(!u.enabled)return;const r=Date.now();if(u.events.filter(e=>{const t=new Date(e.properties.timestamp||"").getTime();return r-t<6e4}).length>=5)return;const n={type:"error",event:t,properties:{errorType:e.name,errorMessage:e.message,stackTrace:e.stack,timestamp:(new Date).toISOString()}};u.events.push(n);try{if("undefined"==typeof window)return;const{projectId:r,sdkType:n,sdkVersion:i}=a.H.state;await l.post({path:"/e",params:{projectId:r,st:n,sv:i||"html-wagmi-4.2.2"},body:{eventId:s.w.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:(new Date).toISOString(),props:{type:"error",event:t,errorType:e.name,errorMessage:e.message,stackTrace:e.stack}}})}catch{}},enable(){u.enabled=!0},disable(){u.enabled=!1},clearEvents(){u.events=[]}};class d extends Error{constructor(e,t,r){super(e),this.name="AppKitError",this.category=t,this.originalError=r,Object.setPrototypeOf(this,d.prototype);let n=!1;if(r instanceof Error&&"string"==typeof r.stack&&r.stack){const e=r.stack,t=e.indexOf("\n");if(t>-1){const r=e.substring(t+1);this.stack=`${this.name}: ${this.message}\n${r}`,n=!0}}n||(Error.captureStackTrace?Error.captureStackTrace(this,d):this.stack||(this.stack=`${this.name}: ${this.message}`))}}function p(e,t){const r=e instanceof d?e:new d(e instanceof Error?e.message:String(e),t,e);throw h.sendError(r,r.category),r}function f(e,t="INTERNAL_SDK_ERROR"){const r={};return Object.keys(e).forEach(n=>{const i=e[n];if("function"==typeof i){let e=i;e="AsyncFunction"===i.constructor.name?async(...e)=>{try{return await i(...e)}catch(e){return p(e,t)}}:(...e)=>{try{return i(...e)}catch(e){return p(e,t)}},r[n]=e}else r[n]=i}),r}},5992:(e,t,r)=>{var n=r(1786);e.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},6010:(e,t,r)=>{r.d(t,{a:()=>A});var n=r(8126),i=r(4707),s=r(3495),o=r(4376),a=r(3096),c=r(152),l=r(4496),u=r(5574),h=r(7508),d=r(5940),p=r(8249),f=r(6056),g=r(2733),m=r(8508),y=r(8996);const w=Object.fromEntries(s.P.map(e=>[e,void 0])),b=Object.fromEntries(s.P.map(e=>[e,!0])),v=(0,n.BX)({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:w,filterByNamespaceMap:b}),E={state:v,subscribe:e=>(0,n.B1)(v,()=>{e(v)}),subscribeKey:(e,t)=>(0,i.u$)(v,e,t),initialize(e){e.forEach(e=>{const t=h.i.getConnectedConnectorId(e);t&&A.setConnectorId(t,e)})},setActiveConnector(e){e&&(v.activeConnector=(0,n.KR)(e))},setConnectors(e){e.filter(e=>!v.allConnectors.some(t=>t.id===e.id&&A.getConnectorName(t.name)===A.getConnectorName(e.name)&&t.chain===e.chain)).forEach(e=>{"MULTI_CHAIN"!==e.type&&v.allConnectors.push((0,n.KR)(e))});const t=A.getEnabledNamespaces(),r=A.getEnabledConnectors(t);v.connectors=A.mergeMultiChainConnectors(r)},filterByNamespaces(e){Object.keys(v.filterByNamespaceMap).forEach(e=>{v.filterByNamespaceMap[e]=!1}),e.forEach(e=>{v.filterByNamespaceMap[e]=!0}),A.updateConnectorsForEnabledNamespaces()},filterByNamespace(e,t){v.filterByNamespaceMap[e]=t,A.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const e=A.getEnabledNamespaces(),t=A.getEnabledConnectors(e),r=A.areAllNamespacesEnabled();v.connectors=A.mergeMultiChainConnectors(t),r?p.N.clearFilterByNamespaces():p.N.filterByNamespaces(e)},getEnabledNamespaces:()=>Object.entries(v.filterByNamespaceMap).filter(([e,t])=>t).map(([e])=>e),getEnabledConnectors:e=>v.allConnectors.filter(t=>e.includes(t.chain)),areAllNamespacesEnabled:()=>Object.values(v.filterByNamespaceMap).every(e=>e),mergeMultiChainConnectors(e){const t=A.generateConnectorMapByName(e),r=[];return t.forEach(e=>{const t=e[0],n=t?.id===o.o.CONNECTOR_ID.AUTH;e.length>1&&t?r.push({name:t.name,imageUrl:t.imageUrl,imageId:t.imageId,connectors:[...e],type:n?"AUTH":"MULTI_CHAIN",chain:"eip155",id:t?.id||""}):t&&r.push(t)}),r},generateConnectorMapByName(e){const t=new Map;return e.forEach(e=>{const{name:r}=e,n=A.getConnectorName(r);if(!n)return;const i=t.get(n)||[];i.find(t=>t.chain===e.chain)||i.push(e),t.set(n,i)}),t},getConnectorName:e=>e&&{"Trust Wallet":"Trust"}[e]||e,getUniqueConnectorsByName(e){const t=[];return e.forEach(e=>{t.find(t=>t.chain===e.chain)||t.push(e)}),t},addConnector(e){if(e.id===o.o.CONNECTOR_ID.AUTH){const t=e,r=(0,n.P9)(g.H.state),i=y.W.getSnapshot().themeMode,s=y.W.getSnapshot().themeVariables;t?.provider?.syncDappData?.({metadata:r.metadata,sdkVersion:r.sdkVersion,projectId:r.projectId,sdkType:r.sdkType}),t?.provider?.syncTheme({themeMode:i,themeVariables:s,w3mThemeVariables:(0,a.o)(s,i)}),A.setConnectors([e])}else A.setConnectors([e])},getAuthConnector(e){const t=e||f.W.state.activeChain,r=v.connectors.find(e=>e.id===o.o.CONNECTOR_ID.AUTH);if(r)return r?.connectors?.length?r.connectors.find(e=>e.chain===t):r},getAnnouncedConnectorRdns:()=>v.connectors.filter(e=>"ANNOUNCED"===e.type).map(e=>e.info?.rdns),getConnectorById:e=>v.allConnectors.find(t=>t.id===e),getConnector({id:e,rdns:t,namespace:r}){const n=r||f.W.state.activeChain;return v.allConnectors.filter(e=>e.chain===n).find(r=>r.explorerId===e||r.info?.rdns===t)},syncIfAuthConnector(e){if("ID_AUTH"!==e.id)return;const t=e,r=(0,n.P9)(g.H.state),i=y.W.getSnapshot().themeMode,s=y.W.getSnapshot().themeVariables;t?.provider?.syncDappData?.({metadata:r.metadata,sdkVersion:r.sdkVersion,sdkType:r.sdkType,projectId:r.projectId}),t.provider.syncTheme({themeMode:i,themeVariables:s,w3mThemeVariables:(0,a.o)(s,i)})},getConnectorsByNamespace(e){const t=v.allConnectors.filter(t=>t.chain===e);return A.mergeMultiChainConnectors(t)},canSwitchToSmartAccount:e=>f.W.checkIfSmartAccountEnabled()&&(0,l.lj)(e)===c.Vl.ACCOUNT_TYPES.EOA,selectWalletConnector(e){const t=A.getConnector({id:e.id,rdns:e.rdns});u.W.handleMobileDeeplinkRedirect(t?.explorerId||e.id,f.W.state.activeChain),t?m.I.push("ConnectingExternal",{connector:t,wallet:e}):m.I.push("ConnectingWalletConnect",{wallet:e})},getConnectors:e=>e?A.getConnectorsByNamespace(e):A.mergeMultiChainConnectors(v.allConnectors),setFilterByNamespace(e){v.filterByNamespace=e,v.connectors=A.getConnectors(e),p.N.setFilterByNamespace(e)},setConnectorId(e,t){e&&(v.activeConnectorIds={...v.activeConnectorIds,[t]:e},h.i.setConnectedConnectorId(t,e))},removeConnectorId(e){v.activeConnectorIds={...v.activeConnectorIds,[e]:void 0},h.i.deleteConnectedConnectorId(e)},getConnectorId(e){if(e)return v.activeConnectorIds[e]},isConnected:e=>e?Boolean(v.activeConnectorIds[e]):Object.values(v.activeConnectorIds).some(e=>Boolean(e)),resetConnectorIds(){v.activeConnectorIds={...w}}},A=(0,d.X)(E)},6036:(e,t,r)=>{r.d(t,{IP:()=>o,T8:()=>i,Ud:()=>s,Ws:()=>n});const n={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections",DISCONNECTED_CONNECTOR_IDS:"@appkit/disconnected_connector_ids",HISTORY_TRANSACTIONS_CACHE:"@appkit/history_transactions_cache",TOKEN_PRICE_CACHE:"@appkit/token_price_cache",RECENT_EMAILS:"@appkit/recent_emails"};function i(e){if(!e)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${e}:connected_connector_id`}const s={setItem(e,t){o()&&void 0!==t&&localStorage.setItem(e,t)},getItem(e){if(o())return localStorage.getItem(e)||void 0},removeItem(e){o()&&localStorage.removeItem(e)},clear(){o()&&localStorage.clear()}};function o(){return"undefined"!=typeof window&&"undefined"!=typeof localStorage}},6056:(e,t,r)=>{r.d(t,{W:()=>I});var n=r(8126),i=r(4707),s=r(3495),o=r(4376),a=r(2944),c=r(6742),l=r(7508),u=r(5940),h=r(3450),d=r(1211),p=r(6010),f=r(184),g=r(6396),m=r(2733),y=r(8467),w=r(8508),b=r(8351);const v={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,user:void 0,preferredAccountType:void 0},E={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},A=(0,n.BX)({chains:(0,i.zC)(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),_={state:A,subscribe:e=>(0,n.B1)(A,()=>{e(A)}),subscribeKey:(e,t)=>(0,i.u$)(A,e,t),subscribeChainProp(e,t,r){let i;return(0,n.B1)(A.chains,()=>{const n=r||A.activeChain;if(n){const r=A.chains.get(n)?.[e];i!==r&&(i=r,t(r))}})},initialize(e,t,r){const{chainId:i,namespace:s}=l.i.getActiveNetworkProps(),o=t?.find(e=>e.id.toString()===i?.toString()),a=e.find(e=>e?.namespace===s)||e?.[0],c=e.map(e=>e.namespace).filter(e=>void 0!==e),u=m.H.state.enableEmbedded?new Set([...c]):new Set([...t?.map(e=>e.chainNamespace)??[]]);0!==e?.length&&a||(A.noAdapters=!0),A.noAdapters||(A.activeChain=a?.namespace,A.activeCaipNetwork=o,I.setChainNetworkData(a?.namespace,{caipNetwork:o}),A.activeChain&&y.z.set({activeChain:a?.namespace})),u.forEach(e=>{const i=t?.filter(t=>t.chainNamespace===e),s=l.i.getPreferredAccountTypes()||{},o={...m.H.state.defaultAccountTypes,...s};I.state.chains.set(e,{namespace:e,networkState:(0,n.BX)({...E,caipNetwork:i?.[0]}),accountState:(0,n.BX)({...v,preferredAccountType:o[e]}),caipNetworks:i??[],...r}),I.setRequestedCaipNetworks(i??[],e)})},removeAdapter(e){if(A.activeChain===e){const t=Array.from(A.chains.entries()).find(([t])=>t!==e);if(t){const e=t[1]?.caipNetworks?.[0];e&&I.setActiveCaipNetwork(e)}}A.chains.delete(e)},addAdapter(e,{networkControllerClient:t,connectionControllerClient:r},n){if(!e.namespace)throw new Error("ChainController:addAdapter - adapter must have a namespace");A.chains.set(e.namespace,{namespace:e.namespace,networkState:{...E,caipNetwork:n[0]},accountState:v,caipNetworks:n,connectionControllerClient:r,networkControllerClient:t}),I.setRequestedCaipNetworks(n?.filter(t=>t.chainNamespace===e.namespace)??[],e.namespace)},addNetwork(e){const t=A.chains.get(e.chainNamespace);if(t){const r=[...t.caipNetworks||[]];t.caipNetworks?.find(t=>t.id===e.id)||r.push(e),A.chains.set(e.chainNamespace,{...t,caipNetworks:r}),I.setRequestedCaipNetworks(r,e.chainNamespace),p.a.filterByNamespace(e.chainNamespace,!0)}},removeNetwork(e,t){const r=A.chains.get(e);if(r){const n=A.activeCaipNetwork?.id===t,i=[...r.caipNetworks?.filter(e=>e.id!==t)||[]];n&&r?.caipNetworks?.[0]&&I.setActiveCaipNetwork(r.caipNetworks[0]),A.chains.set(e,{...r,caipNetworks:i}),I.setRequestedCaipNetworks(i||[],e),0===i.length&&p.a.filterByNamespace(e,!1)}},setAdapterNetworkState(e,t){const r=A.chains.get(e);r&&(r.networkState={...r.networkState||E,...t},A.chains.set(e,r))},setChainAccountData(e,t,r=!0){if(!e)throw new Error("Chain is required to update chain account data");const n=A.chains.get(e);if(n){const r={...n.accountState||v,...t};A.chains.set(e,{...n,accountState:r}),1!==A.chains.size&&A.activeChain!==e||(t.caipAddress&&(A.activeCaipAddress=t.caipAddress),h.U.replaceState(r))}},setChainNetworkData(e,t){if(!e)return;const r=A.chains.get(e);if(r){const n={...r.networkState||E,...t};A.chains.set(e,{...r,networkState:n})}},setAccountProp(e,t,r,n=!0){I.setChainAccountData(r,{[e]:t},n)},setActiveNamespace(e){A.activeChain=e;const t=e?A.chains.get(e):void 0,r=t?.networkState?.caipNetwork;r?.id&&e&&(A.activeCaipAddress=t?.accountState?.caipAddress,A.activeCaipNetwork=r,I.setChainNetworkData(e,{caipNetwork:r}),l.i.setActiveCaipNetworkId(r?.caipNetworkId),y.z.set({activeChain:e,selectedNetworkId:r?.caipNetworkId}))},setActiveCaipNetwork(e){if(!e)return;A.activeChain!==e.chainNamespace&&I.setIsSwitchingNamespace(!0);const t=A.chains.get(e.chainNamespace);A.activeChain=e.chainNamespace,A.activeCaipNetwork=e,I.setChainNetworkData(e.chainNamespace,{caipNetwork:e}),A.activeCaipAddress=t?.accountState?.address?`${e.chainNamespace}:${e.id}:${t?.accountState?.address}`:void 0,I.setAccountProp("caipAddress",A.activeCaipAddress,e.chainNamespace),t&&h.U.replaceState(t.accountState),b.R.resetSend(),y.z.set({activeChain:A.activeChain,selectedNetworkId:A.activeCaipNetwork?.caipNetworkId}),l.i.setActiveCaipNetworkId(e.caipNetworkId),I.checkIfSupportedNetwork(e.chainNamespace)||!m.H.state.enableNetworkSwitch||m.H.state.allowUnsupportedChain||d.x.state.wcBasic||I.showUnsupportedChainUI()},addCaipNetwork(e){if(!e)return;const t=A.chains.get(e.chainNamespace);t&&t?.caipNetworks?.push(e)},async switchActiveNamespace(e){if(!e)return;const t=e!==I.state.activeChain,r=I.getNetworkData(e)?.caipNetwork,n=I.getCaipNetworkByNamespace(e,r?.id);t&&n&&await I.switchActiveNetwork(n)},async switchActiveNetwork(e){const t=I.state.activeChain;if(!t)throw new Error("ChainController:switchActiveNetwork - namespace is required");const r=I.state.chains.get(t),n=!r?.caipNetworks?.some(e=>e.id===A.activeCaipNetwork?.id),i=I.getNetworkControllerClient(e.chainNamespace);if(i){try{await i.switchCaipNetwork(e),n&&g.W.close()}catch(e){w.I.goBack()}f.E.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:e.caipNetworkId}})}},getNetworkControllerClient(e){const t=e||A.activeChain;if(!t)throw new Error("ChainController:getNetworkControllerClient - chain is required");const r=A.chains.get(t);if(!r)throw new Error("Chain adapter not found");if(!r.networkControllerClient)throw new Error("NetworkController client not set");return r.networkControllerClient},getConnectionControllerClient(e){const t=e||A.activeChain;if(!t)throw new Error("Chain is required to get connection controller client");const r=A.chains.get(t);if(!r?.connectionControllerClient)throw new Error("ConnectionController client not set");return r.connectionControllerClient},getNetworkProp(e,t){const r=A.chains.get(t)?.networkState;if(r)return r[e]},getRequestedCaipNetworks(e){const t=A.chains.get(e),{approvedCaipNetworkIds:r=[],requestedCaipNetworks:n=[]}=t?.networkState||{};return c.w.sortRequestedNetworks(r,n).filter(e=>e?.id)},getAllRequestedCaipNetworks(){const e=[];return A.chains.forEach(t=>{if(!t.namespace)throw new Error("ChainController:getAllRequestedCaipNetworks - chainAdapter must have a namespace");const r=I.getRequestedCaipNetworks(t.namespace);e.push(...r)}),e},setRequestedCaipNetworks(e,t){I.setAdapterNetworkState(t,{requestedCaipNetworks:e});const r=I.getAllRequestedCaipNetworks().map(e=>e.chainNamespace),n=Array.from(new Set(r));p.a.filterByNamespaces(n)},getAllApprovedCaipNetworkIds(){const e=[];return A.chains.forEach(t=>{if(!t.namespace)throw new Error("ChainController:getAllApprovedCaipNetworkIds - chainAdapter must have a namespace");const r=I.getApprovedCaipNetworkIds(t.namespace);e.push(...r)}),e},getActiveCaipNetwork:e=>e?A.chains.get(e)?.networkState?.caipNetwork:A.activeCaipNetwork,getActiveCaipAddress:()=>A.activeCaipAddress,getApprovedCaipNetworkIds(e){const t=A.chains.get(e);return t?.networkState?.approvedCaipNetworkIds||[]},async setApprovedCaipNetworksData(e){const t=I.getNetworkControllerClient(),r=await(t?.getApprovedCaipNetworksData());I.setAdapterNetworkState(e,{approvedCaipNetworkIds:r?.approvedCaipNetworkIds,supportsAllNetworks:r?.supportsAllNetworks})},checkIfSupportedNetwork(e,t){const r=t||A.activeCaipNetwork?.caipNetworkId,n=I.getRequestedCaipNetworks(e);return!n.length||n?.some(e=>e.caipNetworkId===r)},checkIfSupportedChainId(e){if(!A.activeChain)return!0;const t=I.getRequestedCaipNetworks(A.activeChain);return t?.some(t=>t.id===e)},setSmartAccountEnabledNetworks(e,t){I.setAdapterNetworkState(t,{smartAccountEnabledNetworks:e})},checkIfSmartAccountEnabled(){const e=s.L.caipNetworkIdToNumber(A.activeCaipNetwork?.caipNetworkId),t=A.activeChain;if(!t||!e)return!1;const r=I.getNetworkProp("smartAccountEnabledNetworks",t);return Boolean(r?.includes(Number(e)))},showUnsupportedChainUI(){g.W.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const e=A.activeCaipNetwork;return Boolean(e?.chainNamespace&&a.oU.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(e.chainNamespace))},resetNetwork(e){I.setAdapterNetworkState(e,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0})},resetAccount(e){const t=e;if(!t)throw new Error("Chain is required to set account prop");const r=I.state.chains.get(t)?.accountState?.preferredAccountType,n=m.H.state.defaultAccountTypes[t];A.activeCaipAddress=void 0,I.setChainAccountData(t,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountType:n||r,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,user:void 0,status:"disconnected"}),p.a.removeConnectorId(t)},setIsSwitchingNamespace(e){A.isSwitchingNamespace=e},getFirstCaipNetworkSupportsAuthConnector(){const e=[];let t;if(A.chains.forEach(t=>{o.o.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(e=>e===t.namespace)&&t.namespace&&e.push(t.namespace)}),e.length>0){const r=e[0];return t=r?A.chains.get(r)?.caipNetworks?.[0]:void 0,t}},getAccountData(e){const t=e||A.activeChain;if(t)return I.state.chains.get(t)?.accountState},getNetworkData(e){const t=e||A.activeChain;if(t)return I.state.chains.get(t)?.networkState},getCaipNetworkByNamespace(e,t){if(!e)return;const r=I.state.chains.get(e),n=r?.caipNetworks?.find(e=>e.id===t);return n||r?.networkState?.caipNetwork||r?.caipNetworks?.[0]},getRequestedCaipNetworkIds(){const e=p.a.state.filterByNamespace;return(e?[A.chains.get(e)]:Array.from(A.chains.values())).flatMap(e=>e?.caipNetworks||[]).map(e=>e.caipNetworkId)},getCaipNetworks:e=>e?I.getRequestedCaipNetworks(e):I.getAllRequestedCaipNetworks(),setLastConnectedSIWECaipNetwork(e){A.lastConnectedSIWECaipNetwork=e},getLastConnectedSIWECaipNetwork:()=>A.lastConnectedSIWECaipNetwork},I=(0,u.X)(_)},6092:(e,t,r)=>{r.d(t,{g:()=>p});var n=r(4376),i=r(6056),s=r(1211),o=r(6010),a=r(8249),c=r(2733),l=r(6742),u=r(7508),h=r(5306),d=r(5042);const p={getConnectorsByType(e,t,r){const{customWallets:n}=c.H.state,i=u.i.getRecentWallets(),s=d.A.filterOutDuplicateWallets(t),o=d.A.filterOutDuplicateWallets(r),a=e.filter(e=>"MULTI_CHAIN"===e.type),l=e.filter(e=>"ANNOUNCED"===e.type),h=e.filter(e=>"INJECTED"===e.type);return{custom:n,recent:i,external:e.filter(e=>"EXTERNAL"===e.type),multiChain:a,announced:l,injected:h,recommended:s,featured:o}},showConnector(e){const t=e.info?.rdns,r=Boolean(t)&&a.N.state.excludedWallets.some(e=>Boolean(e.rdns)&&e.rdns===t),n=Boolean(e.name)&&a.N.state.excludedWallets.some(t=>h.y.isLowerCaseMatch(t.name,e.name));if("INJECTED"===e.type){if("Browser Wallet"===e.name){if(!l.w.isMobile())return!1;if(l.w.isMobile()&&!t&&!s.x.checkInstalled())return!1}if(r||n)return!1}return"ANNOUNCED"!==e.type&&"EXTERNAL"!==e.type||!r&&!n},getIsConnectedWithWC:()=>Array.from(i.W.state.chains.values()).some(e=>o.a.getConnectorId(e.namespace)===n.o.CONNECTOR_ID.WALLET_CONNECT),getConnectorTypeOrder({recommended:e,featured:t,custom:r,recent:n,announced:i,injected:s,multiChain:o,external:a,overriddenConnectors:l=c.H.state.features?.connectorTypeOrder??[]}){const u=[{type:"walletConnect",isEnabled:c.H.state.enableWalletConnect},{type:"recent",isEnabled:n.length>0},{type:"injected",isEnabled:[...s,...i,...o].length>0},{type:"featured",isEnabled:t.length>0},{type:"custom",isEnabled:r&&r.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:e.length>0}].filter(e=>e.isEnabled),h=new Set(u.map(e=>e.type)),d=l.filter(e=>h.has(e)).map(e=>({type:e,isEnabled:!0})),p=u.filter(({type:e})=>!d.some(({type:t})=>t===e));return Array.from(new Set([...d,...p].map(({type:e})=>e)))},getAuthName:({email:e,socialUsername:t,socialProvider:r})=>t?r&&"discord"===r&&t.endsWith("0")?t.slice(0,-1):t:e.length>30?`${e.slice(0,-3)}...`:e,async fetchProviderData(e){try{if("Browser Wallet"===e.name&&!l.w.isMobile())return{accounts:[],chainId:void 0};if(e.id===n.o.CONNECTOR_ID.AUTH)return{accounts:[],chainId:void 0};const[t,r]=await Promise.all([e.provider?.request({method:"eth_accounts"}),e.provider?.request({method:"eth_chainId"}).then(e=>Number(e))]);return{accounts:t,chainId:r}}catch(t){return console.warn(`Failed to fetch provider data for ${e.name}`,t),{accounts:[],chainId:void 0}}}}},6109:(e,t,r)=>{r.d(t,{JX:()=>l,RF:()=>c,W5:()=>d,ck:()=>f,ds:()=>u,fD:()=>p});var n=r(2618),i=r(3096);let s,o,a;function c(e,t){s=document.createElement("style"),o=document.createElement("style"),a=document.createElement("style"),s.textContent=h(e).core.cssText,o.textContent=h(e).dark.cssText,a.textContent=h(e).light.cssText,document.head.appendChild(s),document.head.appendChild(o),document.head.appendChild(a),l(t)}function l(e){o&&a&&("light"===e?(o.removeAttribute("media"),a.media="enabled"):(a.removeAttribute("media"),o.media="enabled"))}function u(e){s&&o&&a&&(s.textContent=h(e).core.cssText,o.textContent=h(e).dark.cssText,a.textContent=h(e).light.cssText)}function h(e){return{core:n.AH`
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --w3m-modal-width: 360px;
        --w3m-color-mix-strength: ${(0,n.iz)(e?.["--w3m-color-mix-strength"]?`${e["--w3m-color-mix-strength"]}%`:"0%")};
        --w3m-font-family: ${(0,n.iz)(e?.["--w3m-font-family"]||"Inter, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;")};
        --w3m-font-size-master: ${(0,n.iz)(e?.["--w3m-font-size-master"]||"10px")};
        --w3m-border-radius-master: ${(0,n.iz)(e?.["--w3m-border-radius-master"]||"4px")};
        --w3m-z-index: ${(0,n.iz)(e?.["--w3m-z-index"]||999)};

        --wui-font-family: var(--w3m-font-family);

        --wui-font-size-mini: calc(var(--w3m-font-size-master) * 0.8);
        --wui-font-size-micro: var(--w3m-font-size-master);
        --wui-font-size-tiny: calc(var(--w3m-font-size-master) * 1.2);
        --wui-font-size-small: calc(var(--w3m-font-size-master) * 1.4);
        --wui-font-size-paragraph: calc(var(--w3m-font-size-master) * 1.6);
        --wui-font-size-medium: calc(var(--w3m-font-size-master) * 1.8);
        --wui-font-size-large: calc(var(--w3m-font-size-master) * 2);
        --wui-font-size-title-6: calc(var(--w3m-font-size-master) * 2.2);
        --wui-font-size-medium-title: calc(var(--w3m-font-size-master) * 2.4);
        --wui-font-size-2xl: calc(var(--w3m-font-size-master) * 4);

        --wui-border-radius-5xs: var(--w3m-border-radius-master);
        --wui-border-radius-4xs: calc(var(--w3m-border-radius-master) * 1.5);
        --wui-border-radius-3xs: calc(var(--w3m-border-radius-master) * 2);
        --wui-border-radius-xxs: calc(var(--w3m-border-radius-master) * 3);
        --wui-border-radius-xs: calc(var(--w3m-border-radius-master) * 4);
        --wui-border-radius-s: calc(var(--w3m-border-radius-master) * 5);
        --wui-border-radius-m: calc(var(--w3m-border-radius-master) * 7);
        --wui-border-radius-l: calc(var(--w3m-border-radius-master) * 9);
        --wui-border-radius-3xl: calc(var(--w3m-border-radius-master) * 20);

        --wui-font-weight-light: 400;
        --wui-font-weight-regular: 500;
        --wui-font-weight-medium: 600;
        --wui-font-weight-bold: 700;

        --wui-letter-spacing-2xl: -1.6px;
        --wui-letter-spacing-medium-title: -0.96px;
        --wui-letter-spacing-title-6: -0.88px;
        --wui-letter-spacing-large: -0.8px;
        --wui-letter-spacing-medium: -0.72px;
        --wui-letter-spacing-paragraph: -0.64px;
        --wui-letter-spacing-small: -0.56px;
        --wui-letter-spacing-tiny: -0.48px;
        --wui-letter-spacing-micro: -0.2px;
        --wui-letter-spacing-mini: -0.16px;

        --wui-spacing-0: 0px;
        --wui-spacing-4xs: 2px;
        --wui-spacing-3xs: 4px;
        --wui-spacing-xxs: 6px;
        --wui-spacing-2xs: 7px;
        --wui-spacing-xs: 8px;
        --wui-spacing-1xs: 10px;
        --wui-spacing-s: 12px;
        --wui-spacing-m: 14px;
        --wui-spacing-l: 16px;
        --wui-spacing-2l: 18px;
        --wui-spacing-xl: 20px;
        --wui-spacing-xxl: 24px;
        --wui-spacing-2xl: 32px;
        --wui-spacing-3xl: 40px;
        --wui-spacing-4xl: 90px;
        --wui-spacing-5xl: 95px;

        --wui-icon-box-size-xxs: 14px;
        --wui-icon-box-size-xs: 20px;
        --wui-icon-box-size-sm: 24px;
        --wui-icon-box-size-md: 32px;
        --wui-icon-box-size-mdl: 36px;
        --wui-icon-box-size-lg: 40px;
        --wui-icon-box-size-2lg: 48px;
        --wui-icon-box-size-xl: 64px;

        --wui-icon-size-inherit: inherit;
        --wui-icon-size-xxs: 10px;
        --wui-icon-size-xs: 12px;
        --wui-icon-size-sm: 14px;
        --wui-icon-size-md: 16px;
        --wui-icon-size-mdl: 18px;
        --wui-icon-size-lg: 20px;
        --wui-icon-size-xl: 24px;
        --wui-icon-size-xxl: 28px;

        --wui-wallet-image-size-inherit: inherit;
        --wui-wallet-image-size-sm: 40px;
        --wui-wallet-image-size-md: 56px;
        --wui-wallet-image-size-lg: 80px;

        --wui-visual-size-size-inherit: inherit;
        --wui-visual-size-sm: 40px;
        --wui-visual-size-md: 55px;
        --wui-visual-size-lg: 80px;

        --wui-box-size-md: 100px;
        --wui-box-size-lg: 120px;

        --wui-ease-out-power-2: cubic-bezier(0, 0, 0.22, 1);
        --wui-ease-out-power-1: cubic-bezier(0, 0, 0.55, 1);

        --wui-ease-in-power-3: cubic-bezier(0.66, 0, 1, 1);
        --wui-ease-in-power-2: cubic-bezier(0.45, 0, 1, 1);
        --wui-ease-in-power-1: cubic-bezier(0.3, 0, 1, 1);

        --wui-ease-inout-power-1: cubic-bezier(0.45, 0, 0.55, 1);

        --wui-duration-lg: 200ms;
        --wui-duration-md: 125ms;
        --wui-duration-sm: 75ms;

        --wui-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --wui-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --wui-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --wui-width-network-sm: 36px;
        --wui-width-network-md: 48px;
        --wui-width-network-lg: 86px;

        --wui-height-network-sm: 40px;
        --wui-height-network-md: 54px;
        --wui-height-network-lg: 96px;

        --wui-icon-size-network-xs: 12px;
        --wui-icon-size-network-sm: 16px;
        --wui-icon-size-network-md: 24px;
        --wui-icon-size-network-lg: 42px;

        --wui-color-inherit: inherit;

        --wui-color-inverse-100: #fff;
        --wui-color-inverse-000: #000;

        --wui-cover: rgba(20, 20, 20, 0.8);

        --wui-color-modal-bg: var(--wui-color-modal-bg-base);

        --wui-color-accent-100: var(--wui-color-accent-base-100);
        --wui-color-accent-090: var(--wui-color-accent-base-090);
        --wui-color-accent-080: var(--wui-color-accent-base-080);

        --wui-color-success-100: var(--wui-color-success-base-100);
        --wui-color-success-125: var(--wui-color-success-base-125);

        --wui-color-warning-100: var(--wui-color-warning-base-100);

        --wui-color-error-100: var(--wui-color-error-base-100);
        --wui-color-error-125: var(--wui-color-error-base-125);

        --wui-color-blue-100: var(--wui-color-blue-base-100);
        --wui-color-blue-90: var(--wui-color-blue-base-90);

        --wui-icon-box-bg-error-100: var(--wui-icon-box-bg-error-base-100);
        --wui-icon-box-bg-blue-100: var(--wui-icon-box-bg-blue-base-100);
        --wui-icon-box-bg-success-100: var(--wui-icon-box-bg-success-base-100);
        --wui-icon-box-bg-inverse-100: var(--wui-icon-box-bg-inverse-base-100);

        --wui-all-wallets-bg-100: var(--wui-all-wallets-bg-100);

        --wui-avatar-border: var(--wui-avatar-border-base);

        --wui-thumbnail-border: var(--wui-thumbnail-border-base);

        --wui-wallet-button-bg: var(--wui-wallet-button-bg-base);

        --wui-box-shadow-blue: var(--wui-color-accent-glass-020);
      }

      @supports (background: color-mix(in srgb, white 50%, black)) {
        :root {
          --wui-color-modal-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-modal-bg-base)
          );

          --wui-box-shadow-blue: color-mix(in srgb, var(--wui-color-accent-100) 20%, transparent);

          --wui-color-accent-100: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 100%,
            transparent
          );
          --wui-color-accent-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-glass-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-020: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 20%,
            transparent
          );
          --wui-color-accent-glass-015: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 15%,
            transparent
          );
          --wui-color-accent-glass-010: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 10%,
            transparent
          );
          --wui-color-accent-glass-005: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 5%,
            transparent
          );
          --wui-color-accent-002: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 2%,
            transparent
          );

          --wui-color-fg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-100)
          );
          --wui-color-fg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-125)
          );
          --wui-color-fg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-150)
          );
          --wui-color-fg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-175)
          );
          --wui-color-fg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-200)
          );
          --wui-color-fg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-225)
          );
          --wui-color-fg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-250)
          );
          --wui-color-fg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-275)
          );
          --wui-color-fg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-300)
          );
          --wui-color-fg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-325)
          );
          --wui-color-fg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-350)
          );

          --wui-color-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-100)
          );
          --wui-color-bg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-125)
          );
          --wui-color-bg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-150)
          );
          --wui-color-bg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-175)
          );
          --wui-color-bg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-200)
          );
          --wui-color-bg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-225)
          );
          --wui-color-bg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-250)
          );
          --wui-color-bg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-275)
          );
          --wui-color-bg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-300)
          );
          --wui-color-bg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-325)
          );
          --wui-color-bg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-350)
          );

          --wui-color-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-100)
          );
          --wui-color-success-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-125)
          );

          --wui-color-warning-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-warning-base-100)
          );

          --wui-color-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-100)
          );
          --wui-color-blue-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-100)
          );
          --wui-color-blue-90: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-90)
          );
          --wui-color-error-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-125)
          );

          --wui-icon-box-bg-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-error-base-100)
          );
          --wui-icon-box-bg-accent-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-blue-base-100)
          );
          --wui-icon-box-bg-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-success-base-100)
          );
          --wui-icon-box-bg-inverse-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-inverse-base-100)
          );

          --wui-all-wallets-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-all-wallets-bg-100)
          );

          --wui-avatar-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-avatar-border-base)
          );

          --wui-thumbnail-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-thumbnail-border-base)
          );

          --wui-wallet-button-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-wallet-button-bg-base)
          );
        }
      }
    `,light:n.AH`
      :root {
        --w3m-color-mix: ${(0,n.iz)(e?.["--w3m-color-mix"]||"#fff")};
        --w3m-accent: ${(0,n.iz)((0,i.o)(e,"dark")["--w3m-accent"])};
        --w3m-default: #fff;

        --wui-color-modal-bg-base: ${(0,n.iz)((0,i.o)(e,"dark")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(230, 100%, 67%, 1);
        --wui-color-blueberry-090: hsla(231, 76%, 61%, 1);
        --wui-color-blueberry-080: hsla(230, 59%, 55%, 1);
        --wui-color-blueberry-050: hsla(231, 100%, 70%, 0.1);

        --wui-color-fg-100: #e4e7e7;
        --wui-color-fg-125: #d0d5d5;
        --wui-color-fg-150: #a8b1b1;
        --wui-color-fg-175: #a8b0b0;
        --wui-color-fg-200: #949e9e;
        --wui-color-fg-225: #868f8f;
        --wui-color-fg-250: #788080;
        --wui-color-fg-275: #788181;
        --wui-color-fg-300: #6e7777;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #363636;

        --wui-color-bg-100: #141414;
        --wui-color-bg-125: #191a1a;
        --wui-color-bg-150: #1e1f1f;
        --wui-color-bg-175: #222525;
        --wui-color-bg-200: #272a2a;
        --wui-color-bg-225: #2c3030;
        --wui-color-bg-250: #313535;
        --wui-color-bg-275: #363b3b;
        --wui-color-bg-300: #3b4040;
        --wui-color-bg-325: #252525;
        --wui-color-bg-350: #ffffff;

        --wui-color-success-base-100: #26d962;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f25a67;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 217, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 217, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 217, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 217, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 217, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 217, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 217, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 217, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 217, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 217, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(242, 90, 103, 0.01);
        --wui-color-error-glass-002: rgba(242, 90, 103, 0.02);
        --wui-color-error-glass-005: rgba(242, 90, 103, 0.05);
        --wui-color-error-glass-010: rgba(242, 90, 103, 0.1);
        --wui-color-error-glass-015: rgba(242, 90, 103, 0.15);
        --wui-color-error-glass-020: rgba(242, 90, 103, 0.2);
        --wui-color-error-glass-025: rgba(242, 90, 103, 0.25);
        --wui-color-error-glass-030: rgba(242, 90, 103, 0.3);
        --wui-color-error-glass-060: rgba(242, 90, 103, 0.6);
        --wui-color-error-glass-080: rgba(242, 90, 103, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-color-gray-glass-001: rgba(255, 255, 255, 0.01);
        --wui-color-gray-glass-002: rgba(255, 255, 255, 0.02);
        --wui-color-gray-glass-005: rgba(255, 255, 255, 0.05);
        --wui-color-gray-glass-010: rgba(255, 255, 255, 0.1);
        --wui-color-gray-glass-015: rgba(255, 255, 255, 0.15);
        --wui-color-gray-glass-020: rgba(255, 255, 255, 0.2);
        --wui-color-gray-glass-025: rgba(255, 255, 255, 0.25);
        --wui-color-gray-glass-030: rgba(255, 255, 255, 0.3);
        --wui-color-gray-glass-060: rgba(255, 255, 255, 0.6);
        --wui-color-gray-glass-080: rgba(255, 255, 255, 0.8);
        --wui-color-gray-glass-090: rgba(255, 255, 255, 0.9);

        --wui-color-dark-glass-100: rgba(42, 42, 42, 1);

        --wui-icon-box-bg-error-base-100: #3c2426;
        --wui-icon-box-bg-blue-base-100: #20303f;
        --wui-icon-box-bg-success-base-100: #1f3a28;
        --wui-icon-box-bg-inverse-base-100: #243240;

        --wui-all-wallets-bg-100: #222b35;

        --wui-avatar-border-base: #252525;

        --wui-thumbnail-border-base: #252525;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --w3m-card-embedded-shadow-color: rgb(17 17 18 / 25%);
      }
    `,dark:n.AH`
      :root {
        --w3m-color-mix: ${(0,n.iz)(e?.["--w3m-color-mix"]||"#000")};
        --w3m-accent: ${(0,n.iz)((0,i.o)(e,"light")["--w3m-accent"])};
        --w3m-default: #000;

        --wui-color-modal-bg-base: ${(0,n.iz)((0,i.o)(e,"light")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(231, 100%, 70%, 1);
        --wui-color-blueberry-090: hsla(231, 97%, 72%, 1);
        --wui-color-blueberry-080: hsla(231, 92%, 74%, 1);

        --wui-color-fg-100: #141414;
        --wui-color-fg-125: #2d3131;
        --wui-color-fg-150: #474d4d;
        --wui-color-fg-175: #636d6d;
        --wui-color-fg-200: #798686;
        --wui-color-fg-225: #828f8f;
        --wui-color-fg-250: #8b9797;
        --wui-color-fg-275: #95a0a0;
        --wui-color-fg-300: #9ea9a9;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #d0d0d0;

        --wui-color-bg-100: #ffffff;
        --wui-color-bg-125: #f5fafa;
        --wui-color-bg-150: #f3f8f8;
        --wui-color-bg-175: #eef4f4;
        --wui-color-bg-200: #eaf1f1;
        --wui-color-bg-225: #e5eded;
        --wui-color-bg-250: #e1e9e9;
        --wui-color-bg-275: #dce7e7;
        --wui-color-bg-300: #d8e3e3;
        --wui-color-bg-325: #f3f3f3;
        --wui-color-bg-350: #202020;

        --wui-color-success-base-100: #26b562;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f05142;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 181, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 181, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 181, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 181, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 181, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 181, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 181, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 181, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 181, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 181, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(240, 81, 66, 0.01);
        --wui-color-error-glass-002: rgba(240, 81, 66, 0.02);
        --wui-color-error-glass-005: rgba(240, 81, 66, 0.05);
        --wui-color-error-glass-010: rgba(240, 81, 66, 0.1);
        --wui-color-error-glass-015: rgba(240, 81, 66, 0.15);
        --wui-color-error-glass-020: rgba(240, 81, 66, 0.2);
        --wui-color-error-glass-025: rgba(240, 81, 66, 0.25);
        --wui-color-error-glass-030: rgba(240, 81, 66, 0.3);
        --wui-color-error-glass-060: rgba(240, 81, 66, 0.6);
        --wui-color-error-glass-080: rgba(240, 81, 66, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-icon-box-bg-error-base-100: #f4dfdd;
        --wui-icon-box-bg-blue-base-100: #d9ecfb;
        --wui-icon-box-bg-success-base-100: #daf0e4;
        --wui-icon-box-bg-inverse-base-100: #dcecfc;

        --wui-all-wallets-bg-100: #e8f1fa;

        --wui-avatar-border-base: #f3f4f4;

        --wui-thumbnail-border-base: #eaefef;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --wui-color-gray-glass-001: rgba(0, 0, 0, 0.01);
        --wui-color-gray-glass-002: rgba(0, 0, 0, 0.02);
        --wui-color-gray-glass-005: rgba(0, 0, 0, 0.05);
        --wui-color-gray-glass-010: rgba(0, 0, 0, 0.1);
        --wui-color-gray-glass-015: rgba(0, 0, 0, 0.15);
        --wui-color-gray-glass-020: rgba(0, 0, 0, 0.2);
        --wui-color-gray-glass-025: rgba(0, 0, 0, 0.25);
        --wui-color-gray-glass-030: rgba(0, 0, 0, 0.3);
        --wui-color-gray-glass-060: rgba(0, 0, 0, 0.6);
        --wui-color-gray-glass-080: rgba(0, 0, 0, 0.8);
        --wui-color-gray-glass-090: rgba(0, 0, 0, 0.9);

        --wui-color-dark-glass-100: rgba(233, 233, 233, 1);

        --w3m-card-embedded-shadow-color: rgb(224 225 233 / 25%);
      }
    `}}const d=n.AH`
  *,
  *::after,
  *::before,
  :host {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    font-family: var(--wui-font-family);
    backface-visibility: hidden;
  }
`,p=n.AH`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    transition:
      color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      background-color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1),
      box-shadow var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: background-color, color, border, box-shadow, border-radius;
    outline: none;
    border: none;
    column-gap: var(--wui-spacing-3xs);
    background-color: transparent;
    text-decoration: none;
  }

  wui-flex {
    transition: border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: border-radius;
  }

  button:disabled > wui-wallet-image,
  button:disabled > wui-all-wallets-image,
  button:disabled > wui-network-image,
  button:disabled > wui-image,
  button:disabled > wui-transaction-visual,
  button:disabled > wui-logo {
    filter: grayscale(1);
  }

  @media (hover: hover) and (pointer: fine) {
    button:hover:enabled {
      background-color: var(--wui-color-gray-glass-005);
    }

    button:active:enabled {
      background-color: var(--wui-color-gray-glass-010);
    }
  }

  button:disabled > wui-icon-box {
    opacity: 0.5;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,f=n.AH`
  .wui-color-inherit {
    color: var(--wui-color-inherit);
  }

  .wui-color-accent-100 {
    color: var(--wui-color-accent-100);
  }

  .wui-color-error-100 {
    color: var(--wui-color-error-100);
  }

  .wui-color-blue-100 {
    color: var(--wui-color-blue-100);
  }

  .wui-color-blue-90 {
    color: var(--wui-color-blue-90);
  }

  .wui-color-error-125 {
    color: var(--wui-color-error-125);
  }

  .wui-color-success-100 {
    color: var(--wui-color-success-100);
  }

  .wui-color-success-125 {
    color: var(--wui-color-success-125);
  }

  .wui-color-inverse-100 {
    color: var(--wui-color-inverse-100);
  }

  .wui-color-inverse-000 {
    color: var(--wui-color-inverse-000);
  }

  .wui-color-fg-100 {
    color: var(--wui-color-fg-100);
  }

  .wui-color-fg-200 {
    color: var(--wui-color-fg-200);
  }

  .wui-color-fg-300 {
    color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    color: var(--wui-color-fg-350);
  }

  .wui-bg-color-inherit {
    background-color: var(--wui-color-inherit);
  }

  .wui-bg-color-blue-100 {
    background-color: var(--wui-color-accent-100);
  }

  .wui-bg-color-error-100 {
    background-color: var(--wui-color-error-100);
  }

  .wui-bg-color-error-125 {
    background-color: var(--wui-color-error-125);
  }

  .wui-bg-color-success-100 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-success-125 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-inverse-100 {
    background-color: var(--wui-color-inverse-100);
  }

  .wui-bg-color-inverse-000 {
    background-color: var(--wui-color-inverse-000);
  }

  .wui-bg-color-fg-100 {
    background-color: var(--wui-color-fg-100);
  }

  .wui-bg-color-fg-200 {
    background-color: var(--wui-color-fg-200);
  }

  .wui-bg-color-fg-300 {
    background-color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    background-color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    background-color: var(--wui-color-fg-350);
  }
`},6210:(e,t,r)=>{r.d(t,{v:()=>a});const n=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],i=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],s=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}];var o=r(4376);const a={getERC20Abi:e=>o.o.USDT_CONTRACT_ADDRESSES.includes(e)?s:n,getSwapAbi:()=>i}},6279:function(e){e.exports=function(e,t,r){e=e||{};var n=t.prototype,i={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function s(e,t,r,i){return n.fromToBase(e,t,r,i)}r.en.relativeTime=i,n.fromToBase=function(t,n,s,o,a){for(var c,l,u,h=s.$locale().relativeTime||i,d=e.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],p=d.length,f=0;f<p;f+=1){var g=d[f];g.d&&(c=o?r(t).diff(s,g.d,!0):s.diff(t,g.d,!0));var m=(e.rounding||Math.round)(Math.abs(c));if(u=c>0,m<=g.r||!g.r){m<=1&&f>0&&(g=d[f-1]);var y=h[g.l];a&&(m=a(""+m)),l="string"==typeof y?y.replace("%d",m):y(m,n,g.l,u);break}}if(n)return l;var w=u?h.future:h.past;return"function"==typeof w?w(l):w.replace("%s",l)},n.to=function(e,t){return s(e,t,this,!0)},n.from=function(e,t){return s(e,t,this)};var o=function(e){return e.$u?r.utc():r()};n.toNow=function(e){return this.to(o(this),e)},n.fromNow=function(e){return this.from(o(this),e)}}},6360:(e,t,r)=>{r.d(t,{W:()=>f});var n=r(8126),i=r(152),s=r(4496),o=r(5940),a=r(5595),c=r(6056),l=r(184),u=r(2733),h=r(1871);const d=(0,n.BX)({transactions:[],transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),p={state:d,subscribe:e=>(0,n.B1)(d,()=>e(d)),setLastNetworkInView(e){d.lastNetworkInView=e},async fetchTransactions(e){if(!e)throw new Error("Transactions can't be fetched without an accountAddress");d.loading=!0;try{const t=await a.T.fetchTransactions({account:e,cursor:d.next,chainId:c.W.state.activeCaipNetwork?.caipNetworkId}),r=f.filterSpamTransactions(t.data),n=f.filterByConnectedChain(r),i=[...d.transactions,...n];d.loading=!1,d.transactions=i,d.transactionsByYear=f.groupTransactionsByYearAndMonth(d.transactionsByYear,n),d.empty=0===i.length,d.next=t.next?t.next:void 0}catch(t){const r=c.W.state.activeChain;l.E.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:e,projectId:u.H.state.projectId,cursor:d.next,isSmartAccount:(0,s.lj)(r)===i.Vl.ACCOUNT_TYPES.SMART_ACCOUNT}}),h.P.showError("Failed to fetch transactions"),d.loading=!1,d.empty=!0,d.next=void 0}},groupTransactionsByYearAndMonth(e={},t=[]){const r=e;return t.forEach(e=>{const t=new Date(e.metadata.minedAt).getFullYear(),n=new Date(e.metadata.minedAt).getMonth(),i=r[t]??{},s=(i[n]??[]).filter(t=>t.id!==e.id);r[t]={...i,[n]:[...s,e].sort((e,t)=>new Date(t.metadata.minedAt).getTime()-new Date(e.metadata.minedAt).getTime())}}),r},filterSpamTransactions:e=>e.filter(e=>!e.transfers.every(e=>!0===e.nft_info?.flags.is_spam)),filterByConnectedChain(e){const t=c.W.state.activeCaipNetwork?.caipNetworkId;return e.filter(e=>e.metadata.chain===t)},clearCursor(){d.next=void 0},resetTransactions(){d.transactions=[],d.transactionsByYear={},d.lastNetworkInView=void 0,d.loading=!1,d.empty=!1,d.next=void 0}},f=(0,o.X)(p,"API_ERROR")},6396:(e,t,r)=>{r.d(t,{W:()=>w});var n=r(8126),i=r(4707),s=r(6742),o=r(8751),a=r(5940),c=r(8249),l=r(6056),u=r(1211),h=r(6010),d=r(184),p=r(2733),f=r(8467),g=r(8508);const m=(0,n.BX)({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),y={state:m,subscribe:e=>(0,n.B1)(m,()=>e(m)),subscribeKey:(e,t)=>(0,i.u$)(m,e,t),async open(e){const t=e?.namespace,r=l.W.state.activeChain,n=t&&t!==r,i=l.W.getAccountData(e?.namespace)?.caipAddress;if(u.x.state.wcBasic?c.N.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1}):await c.N.prefetch(),h.a.setFilterByNamespace(e?.namespace),w.setLoading(!0,t),t&&n){const e=l.W.getNetworkData(t)?.caipNetwork||l.W.getRequestedCaipNetworks(t)[0];e&&o.L.onSwitchNetwork({network:e,ignoreSwitchConfirmation:!0})}else{const t=l.W.state.noAdapters;p.H.state.manualWCControl||t&&!i?s.w.isMobile()?g.I.reset("AllWallets"):g.I.reset("ConnectingWalletConnectBasic"):e?.view?g.I.reset(e.view,e.data):i?g.I.reset("Account"):g.I.reset("Connect")}m.open=!0,f.z.set({open:!0}),d.E.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:Boolean(i)}})},close(){const e=p.H.state.enableEmbedded,t=Boolean(l.W.state.activeCaipAddress);m.open&&d.E.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:t}}),m.open=!1,g.I.reset("Connect"),w.clearLoading(),e?t?g.I.replace("Account"):g.I.push("Connect"):f.z.set({open:!1}),u.x.resetUri()},setLoading(e,t){t&&m.loadingNamespaceMap.set(t,e),m.loading=e,f.z.set({loading:e})},clearLoading(){m.loadingNamespaceMap.clear(),m.loading=!1,f.z.set({loading:!1})},shake(){m.shake||(m.shake=!0,setTimeout(()=>{m.shake=!1},500))}},w=(0,a.X)(y)},6409:(e,t,r)=>{r.d(t,{Q:()=>c});const n=/^0x(?:[A-Fa-f0-9]{64})$/u,i=/^0x(?:[a-fA-F0-9]{62,})$/u;var s=r(152),o=r(6508);const a=3e4,c={checkIfAllowedToTriggerEmail(){const e=o.o.get(s.s1.LAST_EMAIL_LOGIN_TIME);if(e){const t=Date.now()-Number(e);if(t<a){const e=Math.ceil((a-t)/1e3);throw new Error(`Please try again after ${e} seconds`)}}},getTimeToNextEmailLogin(){const e=o.o.get(s.s1.LAST_EMAIL_LOGIN_TIME);if(e){const t=Date.now()-Number(e);if(t<a)return Math.ceil((a-t)/1e3)}return 0},checkIfRequestExists:e=>s.Vl.NOT_SAFE_RPC_METHODS.includes(e.method)||s.Vl.SAFE_RPC_METHODS.includes(e.method),getResponseType:e=>"string"==typeof e&&(e?.match(n)||e?.match(i))?s.s1.RPC_RESPONSE_TYPE_TX:s.s1.RPC_RESPONSE_TYPE_OBJECT,checkIfRequestIsSafe:e=>s.Vl.SAFE_RPC_METHODS.includes(e.method),isClient:"undefined"!=typeof window}},6508:(e,t,r)=>{r.d(t,{o:()=>s});var n=r(152),i=r(6409);const s={set(e,t){i.Q.isClient&&localStorage.setItem(`${n.s1.STORAGE_KEY}${e}`,t)},get:e=>i.Q.isClient?localStorage.getItem(`${n.s1.STORAGE_KEY}${e}`):null,delete(e,t){i.Q.isClient&&(t?localStorage.removeItem(e):localStorage.removeItem(`${n.s1.STORAGE_KEY}${e}`))}}},6601:(e,t,r)=>{r.d(t,{A:()=>Mv});var n={};r.r(n),r.d(n,{identity:()=>$s});var i={};r.r(i),r.d(i,{base2:()=>zs});var s={};r.r(s),r.d(s,{base8:()=>qs});var o={};r.r(o),r.d(o,{base10:()=>Fs});var a={};r.r(a),r.d(a,{base16:()=>Hs,base16upper:()=>Ks});var c={};r.r(c),r.d(c,{base32:()=>Vs,base32hex:()=>Js,base32hexpad:()=>Qs,base32hexpadupper:()=>eo,base32hexupper:()=>Xs,base32pad:()=>Gs,base32padupper:()=>Zs,base32upper:()=>Ys,base32z:()=>to});var l={};r.r(l),r.d(l,{base36:()=>ro,base36upper:()=>no});var u={};r.r(u),r.d(u,{base58btc:()=>io,base58flickr:()=>so});var h={};r.r(h),r.d(h,{base64:()=>oo,base64pad:()=>ao,base64url:()=>co,base64urlpad:()=>lo});var d={};r.r(d),r.d(d,{base256emoji:()=>fo});var p={};r.r(p),r.d(p,{sha256:()=>Mo,sha512:()=>Lo});var f={};r.r(f),r.d(f,{identity:()=>Wo});var g={};r.r(g),r.d(g,{code:()=>$o,decode:()=>qo,encode:()=>zo,name:()=>jo});var m={};r.r(m),r.d(m,{code:()=>Vo,decode:()=>Go,encode:()=>Yo,name:()=>Ko});var y=r(7007),w=r.n(y),b=r(8900);class v{}class E extends v{constructor(e){super()}}const A=b.FIVE_SECONDS,_="heartbeat_pulse";class I extends E{constructor(e){super(e),this.events=new y.EventEmitter,this.interval=A,this.interval=e?.interval||A}static async init(e){const t=new I(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),(0,b.toMiliseconds)(this.interval))}pulse(){this.events.emit(_)}}const S=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,C=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,k=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function N(e,t){if(!("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t))return t;!function(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}(e)}function x(e,t={}){if("string"!=typeof e)return e;if('"'===e[0]&&'"'===e[e.length-1]&&-1===e.indexOf("\\"))return e.slice(1,-1);const r=e.trim();if(r.length<=9)switch(r.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!k.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(S.test(e)||C.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,N)}return JSON.parse(e)}catch(r){if(t.strict)throw r;return e}}var T=r(8287).Buffer;function O(e,...t){try{return(r=e(...t))&&"function"==typeof r.then?r:Promise.resolve(r)}catch(e){return Promise.reject(e)}var r}function P(e){if(function(e){const t=typeof e;return null===e||"object"!==t&&"function"!==t}(e))return String(e);if(function(e){const t=Object.getPrototypeOf(e);return!t||t.isPrototypeOf(Object)}(e)||Array.isArray(e))return JSON.stringify(e);if("function"==typeof e.toJSON)return P(e.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const R="base64:";function U(e){return e&&e.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function B(...e){return U(e.join(":"))}function M(e){return(e=U(e))?e+":":""}const L=()=>{const e=new Map;return{name:"memory",getInstance:()=>e,hasItem:t=>e.has(t),getItem:t=>e.get(t)??null,getItemRaw:t=>e.get(t)??null,setItem(t,r){e.set(t,r)},setItemRaw(t,r){e.set(t,r)},removeItem(t){e.delete(t)},getKeys:()=>[...e.keys()],clear(){e.clear()},dispose(){e.clear()}}};function D(e={}){const t={mounts:{"":e.driver||L()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=e=>{for(const r of t.mountpoints)if(e.startsWith(r))return{base:r,relativeKey:e.slice(r.length),driver:t.mounts[r]};return{base:"",relativeKey:e,driver:t.mounts[""]}},n=(e,r)=>t.mountpoints.filter(t=>t.startsWith(e)||r&&e.startsWith(t)).map(r=>({relativeBase:e.length>r.length?e.slice(r.length):void 0,mountpoint:r,driver:t.mounts[r]})),i=(e,r)=>{if(t.watching){r=U(r);for(const n of t.watchListeners)n(e,r)}},s=async()=>{if(t.watching){for(const e in t.unwatch)await t.unwatch[e]();t.unwatch={},t.watching=!1}},o=(e,t,n)=>{const i=new Map,s=e=>{let t=i.get(e.base);return t||(t={driver:e.driver,base:e.base,items:[]},i.set(e.base,t)),t};for(const n of e){const e="string"==typeof n,i=U(e?n:n.key),o=e?void 0:n.value,a=e||!n.options?t:{...t,...n.options},c=r(i);s(c).items.push({key:i,value:o,relativeKey:c.relativeKey,options:a})}return Promise.all([...i.values()].map(e=>n(e))).then(e=>e.flat())},a={hasItem(e,t={}){e=U(e);const{relativeKey:n,driver:i}=r(e);return O(i.hasItem,n,t)},getItem(e,t={}){e=U(e);const{relativeKey:n,driver:i}=r(e);return O(i.getItem,n,t).then(e=>x(e))},getItems:(e,t={})=>o(e,t,e=>e.driver.getItems?O(e.driver.getItems,e.items.map(e=>({key:e.relativeKey,options:e.options})),t).then(t=>t.map(t=>({key:B(e.base,t.key),value:x(t.value)}))):Promise.all(e.items.map(t=>O(e.driver.getItem,t.relativeKey,t.options).then(e=>({key:t.key,value:x(e)}))))),getItemRaw(e,t={}){e=U(e);const{relativeKey:n,driver:i}=r(e);return i.getItemRaw?O(i.getItemRaw,n,t):O(i.getItem,n,t).then(e=>function(e){return"string"!=typeof e?e:e.startsWith(R)?(t=e.slice(7),globalThis.Buffer?T.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))):e;var t}(e))},async setItem(e,t,n={}){if(void 0===t)return a.removeItem(e);e=U(e);const{relativeKey:s,driver:o}=r(e);o.setItem&&(await O(o.setItem,s,P(t),n),o.watch||i("update",e))},async setItems(e,t){await o(e,t,async e=>{if(e.driver.setItems)return O(e.driver.setItems,e.items.map(e=>({key:e.relativeKey,value:P(e.value),options:e.options})),t);e.driver.setItem&&await Promise.all(e.items.map(t=>O(e.driver.setItem,t.relativeKey,P(t.value),t.options)))})},async setItemRaw(e,t,n={}){if(void 0===t)return a.removeItem(e,n);e=U(e);const{relativeKey:s,driver:o}=r(e);if(o.setItemRaw)await O(o.setItemRaw,s,t,n);else{if(!o.setItem)return;await O(o.setItem,s,function(e){return"string"==typeof e?e:R+(t=e,globalThis.Buffer?T.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t)));var t}(t),n)}o.watch||i("update",e)},async removeItem(e,t={}){"boolean"==typeof t&&(t={removeMeta:t}),e=U(e);const{relativeKey:n,driver:s}=r(e);s.removeItem&&(await O(s.removeItem,n,t),(t.removeMeta||t.removeMata)&&await O(s.removeItem,n+"$",t),s.watch||i("remove",e))},async getMeta(e,t={}){"boolean"==typeof t&&(t={nativeOnly:t}),e=U(e);const{relativeKey:n,driver:i}=r(e),s=Object.create(null);if(i.getMeta&&Object.assign(s,await O(i.getMeta,n,t)),!t.nativeOnly){const e=await O(i.getItem,n+"$",t).then(e=>x(e));e&&"object"==typeof e&&("string"==typeof e.atime&&(e.atime=new Date(e.atime)),"string"==typeof e.mtime&&(e.mtime=new Date(e.mtime)),Object.assign(s,e))}return s},setMeta(e,t,r={}){return this.setItem(e+"$",t,r)},removeMeta(e,t={}){return this.removeItem(e+"$",t)},async getKeys(e,t={}){e=M(e);const r=n(e,!0);let i=[];const s=[];let o=!0;for(const e of r){e.driver.flags?.maxDepth||(o=!1);const r=await O(e.driver.getKeys,e.relativeBase,t);for(const t of r){const r=e.mountpoint+U(t);i.some(e=>r.startsWith(e))||s.push(r)}i=[e.mountpoint,...i.filter(t=>!t.startsWith(e.mountpoint))]}const a=void 0!==t.maxDepth&&!o;return s.filter(r=>(!a||function(e,t){if(void 0===t)return!0;let r=0,n=e.indexOf(":");for(;n>-1;)r++,n=e.indexOf(":",n+1);return r<=t}(r,t.maxDepth))&&function(e,t){return t?e.startsWith(t)&&"$"!==e[e.length-1]:"$"!==e[e.length-1]}(r,e))},async clear(e,t={}){e=M(e),await Promise.all(n(e,!1).map(async e=>{if(e.driver.clear)return O(e.driver.clear,e.relativeBase,t);if(e.driver.removeItem){const r=await e.driver.getKeys(e.relativeBase||"",t);return Promise.all(r.map(r=>e.driver.removeItem(r,t)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(e=>j(e)))},watch:async e=>(await(async()=>{if(!t.watching){t.watching=!0;for(const e in t.mounts)t.unwatch[e]=await W(t.mounts[e],i,e)}})(),t.watchListeners.push(e),async()=>{t.watchListeners=t.watchListeners.filter(t=>t!==e),0===t.watchListeners.length&&await s()}),async unwatch(){t.watchListeners=[],await s()},mount(e,r){if((e=M(e))&&t.mounts[e])throw new Error(`already mounted at ${e}`);return e&&(t.mountpoints.push(e),t.mountpoints.sort((e,t)=>t.length-e.length)),t.mounts[e]=r,t.watching&&Promise.resolve(W(r,i,e)).then(r=>{t.unwatch[e]=r}).catch(console.error),a},async unmount(e,r=!0){(e=M(e))&&t.mounts[e]&&(t.watching&&e in t.unwatch&&(t.unwatch[e]?.(),delete t.unwatch[e]),r&&await j(t.mounts[e]),t.mountpoints=t.mountpoints.filter(t=>t!==e),delete t.mounts[e])},getMount(e=""){e=U(e)+":";const t=r(e);return{driver:t.driver,base:t.base}},getMounts:(e="",t={})=>(e=U(e),n(e,t.parents).map(e=>({driver:e.driver,base:e.mountpoint}))),keys:(e,t={})=>a.getKeys(e,t),get:(e,t={})=>a.getItem(e,t),set:(e,t,r={})=>a.setItem(e,t,r),has:(e,t={})=>a.hasItem(e,t),del:(e,t={})=>a.removeItem(e,t),remove:(e,t={})=>a.removeItem(e,t)};return a}function W(e,t,r){return e.watch?e.watch((e,n)=>t(e,r+n)):()=>{}}async function j(e){"function"==typeof e.dispose&&await O(e.dispose)}function $(e){return new Promise((t,r)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>r(e.error)})}function z(e,t){let r;return(n,i)=>(()=>{if(r)return r;const n=indexedDB.open(e);return n.onupgradeneeded=()=>n.result.createObjectStore(t),r=$(n),r.then(e=>{e.onclose=()=>r=void 0},()=>{}),r})().then(e=>i(e.transaction(t,n).objectStore(t)))}let q;function F(){return q||(q=z("keyval-store","keyval")),q}function H(e,t=F()){return t("readonly",t=>$(t.get(e)))}var K=r(3554),V=(e={})=>{const t=e.base&&e.base.length>0?`${e.base}:`:"",r=e=>t+e;let n;return e.dbName&&e.storeName&&(n=z(e.dbName,e.storeName)),{name:"idb-keyval",options:e,hasItem:async e=>!(typeof await H(r(e),n)>"u"),getItem:async e=>await H(r(e),n)??null,setItem:(e,t)=>function(e,t,r=F()){return r("readwrite",r=>(r.put(t,e),$(r.transaction)))}(r(e),t,n),removeItem:e=>function(e,t=F()){return t("readwrite",t=>(t.delete(e),$(t.transaction)))}(r(e),n),getKeys:()=>function(e=F()){return e("readonly",e=>{if(e.getAllKeys)return $(e.getAllKeys());const t=[];return function(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},$(e.transaction)}(e,e=>t.push(e.key)).then(()=>t)})}(n),clear:()=>function(e=F()){return e("readwrite",e=>(e.clear(),$(e.transaction)))}(n)}};class Y{constructor(){this.indexedDb=D({driver:V({dbName:"WALLET_CONNECT_V2_INDEXED_DB",storeName:"keyvaluestorage"})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const t=await this.indexedDb.getItem(e);if(null!==t)return t}async setItem(e,t){await this.indexedDb.setItem(e,(0,K.h)(t))}async removeItem(e){await this.indexedDb.removeItem(e)}}var G=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof r.g<"u"?r.g:typeof self<"u"?self:{},Z={exports:{}};function J(e){var t;return[e[0],(0,K.j)(null!=(t=e[1])?t:"")]}!function(){let e;function t(){}e=t,e.prototype.getItem=function(e){return this.hasOwnProperty(e)?String(this[e]):null},e.prototype.setItem=function(e,t){this[e]=String(t)},e.prototype.removeItem=function(e){delete this[e]},e.prototype.clear=function(){const e=this;Object.keys(e).forEach(function(t){e[t]=void 0,delete e[t]})},e.prototype.key=function(e){return e=e||0,Object.keys(this)[e]},e.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof G<"u"&&G.localStorage?Z.exports=G.localStorage:typeof window<"u"&&window.localStorage?Z.exports=window.localStorage:Z.exports=new t}();class X{constructor(){this.localStorage=Z.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(J)}async getItem(e){const t=this.localStorage.getItem(e);if(null!==t)return(0,K.j)(t)}async setItem(e,t){this.localStorage.setItem(e,(0,K.h)(t))}async removeItem(e){this.localStorage.removeItem(e)}}class Q{constructor(){this.initialized=!1,this.setInitialized=e=>{this.storage=e,this.initialized=!0};const e=new X;this.storage=e;try{(async(e,t,r)=>{const n="wc_storage_version",i=await t.getItem(n);if(i&&i>=1)return void r(t);const s=await e.getKeys();if(!s.length)return void r(t);const o=[];for(;s.length;){const r=s.shift();if(!r)continue;const n=r.toLowerCase();if(n.includes("wc@")||n.includes("walletconnect")||n.includes("wc_")||n.includes("wallet_connect")){const n=await e.getItem(r);await t.setItem(r,n),o.push(r)}}await t.setItem(n,1),r(t),(async(e,t)=>{t.length&&t.forEach(async t=>{await e.removeItem(t)})})(e,o)})(e,new Y,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}}var ee=r(9838),te=Object.defineProperty,re=(e,t,r)=>((e,t,r)=>t in e?te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class ne extends v{constructor(e){super(),this.opts=e,re(this,"protocol","wc"),re(this,"version",2)}}var ie=Object.defineProperty;class se extends v{constructor(e,t){super(),this.core=e,this.logger=t,((e,t,r)=>{((e,t,r)=>{t in e?ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r)})(this,"records",new Map)}}class oe{constructor(e,t){this.logger=e,this.core=t}}class ae extends v{constructor(e,t){super(),this.relayer=e,this.logger=t}}class ce extends v{constructor(e){super()}}class le{constructor(e,t,r,n){this.core=e,this.logger=t,this.name=r}}Object.defineProperty;class ue extends v{constructor(e,t){super(),this.relayer=e,this.logger=t}}class he extends v{constructor(e,t){super(),this.core=e,this.logger=t}}class de{constructor(e,t,r){this.core=e,this.logger=t,this.store=r}}class pe{constructor(e,t){this.projectId=e,this.logger=t}}class fe{constructor(e,t,r){this.core=e,this.logger=t,this.telemetryEnabled=r}}var ge=Object.defineProperty,me=(e,t,r)=>((e,t,r)=>t in e?ge(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);w();class ye{constructor(e){this.opts=e,me(this,"protocol","wc"),me(this,"version",2)}}y.EventEmitter;class we{constructor(e){this.client=e}}function be(e,...t){if(!function(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function ve(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}const Ee="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,Ae=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);function _e(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}(e)),be(e),e}class Ie{clone(){return this._cloneInto()}}function Se(e=32){if(Ee&&"function"==typeof Ee.getRandomValues)return Ee.getRandomValues(new Uint8Array(e));if(Ee&&"function"==typeof Ee.randomBytes)return Ee.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}class Ce extends Ie{constructor(e,t,r,n){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Ae(this.buffer)}update(e){ve(this);const{view:t,buffer:r,blockLen:n}=this,i=(e=_e(e)).length;for(let s=0;s<i;){const o=Math.min(n-this.pos,i-s);if(o===n){const t=Ae(e);for(;n<=i-s;s+=n)this.process(t,s);continue}r.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===n&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ve(this),function(e,t){be(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:n,isLE:i}=this;let{pos:s}=this;t[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>n-s&&(this.process(r,0),s=0);for(let e=s;e<n;e++)t[e]=0;(function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,l=n?0:4;e.setUint32(t+c,o,n),e.setUint32(t+l,a,n)})(r,n-8,BigInt(8*this.length),i),this.process(r,0);const o=Ae(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)o.setUint32(4*e,l[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:s,pos:o}=this;return e.length=n,e.pos=o,e.finished=i,e.destroyed=s,n%t&&e.buffer.set(r),e}}const ke=BigInt(2**32-1),Ne=BigInt(32);function xe(e,t=!1){return t?{h:Number(e&ke),l:Number(e>>Ne&ke)}:{h:0|Number(e>>Ne&ke),l:0|Number(e&ke)}}const Te=function(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let i=0;i<e.length;i++){const{h:s,l:o}=xe(e[i],t);[r[i],n[i]]=[s,o]}return[r,n]},Oe=(e,t,r)=>e>>>r,Pe=(e,t,r)=>e<<32-r|t>>>r,Re=(e,t,r)=>e>>>r|t<<32-r,Ue=(e,t,r)=>e<<32-r|t>>>r,Be=(e,t,r)=>e<<64-r|t>>>r-32,Me=(e,t,r)=>e>>>r-32|t<<64-r,Le=function(e,t,r,n){const i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:0|i}},De=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),We=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,je=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),$e=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0,ze=(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0,qe=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0),[Fe,He]=Te(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),Ke=new Uint32Array(80),Ve=new Uint32Array(80);class Ye extends Ce{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:r,Bl:n,Ch:i,Cl:s,Dh:o,Dl:a,Eh:c,El:l,Fh:u,Fl:h,Gh:d,Gl:p,Hh:f,Hl:g}=this;return[e,t,r,n,i,s,o,a,c,l,u,h,d,p,f,g]}set(e,t,r,n,i,s,o,a,c,l,u,h,d,p,f,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|s,this.Dh=0|o,this.Dl=0|a,this.Eh=0|c,this.El=0|l,this.Fh=0|u,this.Fl=0|h,this.Gh=0|d,this.Gl=0|p,this.Hh=0|f,this.Hl=0|g}process(e,t){for(let r=0;r<16;r++,t+=4)Ke[r]=e.getUint32(t),Ve[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|Ke[e-15],r=0|Ve[e-15],n=Re(t,r,1)^Re(t,r,8)^Oe(t,r,7),i=Ue(t,r,1)^Ue(t,r,8)^Pe(t,r,7),s=0|Ke[e-2],o=0|Ve[e-2],a=Re(s,o,19)^Be(s,o,61)^Oe(s,o,6),c=Ue(s,o,19)^Me(s,o,61)^Pe(s,o,6),l=je(i,c,Ve[e-7],Ve[e-16]),u=$e(l,n,a,Ke[e-7],Ke[e-16]);Ke[e]=0|u,Ve[e]=0|l}let{Ah:r,Al:n,Bh:i,Bl:s,Ch:o,Cl:a,Dh:c,Dl:l,Eh:u,El:h,Fh:d,Fl:p,Gh:f,Gl:g,Hh:m,Hl:y}=this;for(let e=0;e<80;e++){const t=Re(u,h,14)^Re(u,h,18)^Be(u,h,41),w=Ue(u,h,14)^Ue(u,h,18)^Me(u,h,41),b=u&d^~u&f,v=qe(y,w,h&p^~h&g,He[e],Ve[e]),E=ze(v,m,t,b,Fe[e],Ke[e]),A=0|v,_=Re(r,n,28)^Be(r,n,34)^Be(r,n,39),I=Ue(r,n,28)^Me(r,n,34)^Me(r,n,39),S=r&i^r&o^i&o,C=n&s^n&a^s&a;m=0|f,y=0|g,f=0|d,g=0|p,d=0|u,p=0|h,({h:u,l:h}=Le(0|c,0|l,0|E,0|A)),c=0|o,l=0|a,o=0|i,a=0|s,i=0|r,s=0|n;const k=De(A,I,C);r=We(k,E,_,S),n=0|k}({h:r,l:n}=Le(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:s}=Le(0|this.Bh,0|this.Bl,0|i,0|s)),({h:o,l:a}=Le(0|this.Ch,0|this.Cl,0|o,0|a)),({h:c,l}=Le(0|this.Dh,0|this.Dl,0|c,0|l)),({h:u,l:h}=Le(0|this.Eh,0|this.El,0|u,0|h)),({h:d,l:p}=Le(0|this.Fh,0|this.Fl,0|d,0|p)),({h:f,l:g}=Le(0|this.Gh,0|this.Gl,0|f,0|g)),({h:m,l:y}=Le(0|this.Hh,0|this.Hl,0|m,0|y)),this.set(r,n,i,s,o,a,c,l,u,h,d,p,f,g,m,y)}roundClean(){Ke.fill(0),Ve.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Ge=function(e){const t=t=>e().update(_e(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}(()=>new Ye),Ze=BigInt(0),Je=BigInt(1),Xe=BigInt(2);function Qe(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function et(e){if(!Qe(e))throw new Error("Uint8Array expected")}function tt(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}const rt=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function nt(e){et(e);let t="";for(let r=0;r<e.length;r++)t+=rt[e[r]];return t}function it(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?Ze:BigInt("0x"+e)}function st(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function ot(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let t=0,i=0;t<r;t++,i+=2){const r=st(e.charCodeAt(i)),s=st(e.charCodeAt(i+1));if(void 0===r||void 0===s){const t=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+i)}n[t]=16*r+s}return n}function at(e){return et(e),it(nt(Uint8Array.from(e).reverse()))}function ct(e,t){return ot(e.toString(16).padStart(2*t,"0"))}function lt(e,t){return ct(e,t).reverse()}function ut(e,t,r){let n;if("string"==typeof t)try{n=ot(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!Qe(t))throw new Error(e+" must be hex string or Uint8Array");n=Uint8Array.from(t)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(e+" of length "+r+" expected, got "+i);return n}function ht(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];et(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}const dt=e=>"bigint"==typeof e&&Ze<=e;function pt(e,t,r,n){if(!function(e,t,r){return dt(e)&&dt(t)&&dt(r)&&t<=e&&e<r}(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}const ft=e=>(Xe<<BigInt(e-1))-Je,gt={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||Qe(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function mt(e,t,r={}){const n=(t,r,n)=>{const i=gt[r];if("function"!=typeof i)throw new Error("invalid validator function");const s=e[t];if(!(n&&void 0===s||i(s,e)))throw new Error("param "+String(t)+" is invalid. Expected "+r+", got "+s)};for(const[e,r]of Object.entries(t))n(e,r,!1);for(const[e,t]of Object.entries(r))n(e,t,!0);return e}function yt(e){const t=new WeakMap;return(r,...n)=>{const i=t.get(r);if(void 0!==i)return i;const s=e(r,...n);return t.set(r,s),s}}const wt=BigInt(0),bt=BigInt(1),vt=BigInt(2),Et=BigInt(3),At=BigInt(4),_t=BigInt(5),It=BigInt(8);function St(e,t){const r=e%t;return r>=wt?r:t+r}function Ct(e,t,r){if(t<wt)throw new Error("invalid exponent, negatives unsupported");if(r<=wt)throw new Error("invalid modulus");if(r===bt)return wt;let n=bt;for(;t>wt;)t&bt&&(n=n*e%r),e=e*e%r,t>>=bt;return n}function kt(e,t,r){let n=e;for(;t-- >wt;)n*=n,n%=r;return n}function Nt(e,t){if(e===wt)throw new Error("invert: expected non-zero number");if(t<=wt)throw new Error("invert: expected positive modulus, got "+t);let r=St(e,t),n=t,i=wt,s=bt;for(;r!==wt;){const e=n%r,t=i-s*(n/r);n=r,r=e,i=s,s=t}if(n!==bt)throw new Error("invert: does not exist");return St(i,t)}const xt=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Tt(e,t){const r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function Ot(e,t,r=!1,n={}){if(e<=wt)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:i,nByteLength:s}=Tt(e,t);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:e,isLE:r,BITS:i,BYTES:s,MASK:ft(i),ZERO:wt,ONE:bt,create:t=>St(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return wt<=t&&t<e},is0:e=>e===wt,isOdd:e=>(e&bt)===bt,neg:t=>St(-t,e),eql:(e,t)=>e===t,sqr:t=>St(t*t,e),add:(t,r)=>St(t+r,e),sub:(t,r)=>St(t-r,e),mul:(t,r)=>St(t*r,e),pow:(e,t)=>function(e,t,r){if(r<wt)throw new Error("invalid exponent, negatives unsupported");if(r===wt)return e.ONE;if(r===bt)return t;let n=e.ONE,i=t;for(;r>wt;)r&bt&&(n=e.mul(n,i)),i=e.sqr(i),r>>=bt;return n}(a,e,t),div:(t,r)=>St(t*Nt(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>Nt(t,e),sqrt:n.sqrt||(t=>(o||(o=function(e){if(e%At===Et){const t=(e+bt)/At;return function(e,r){const n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw new Error("Cannot find square root");return n}}if(e%It===_t){const t=(e-_t)/It;return function(e,r){const n=e.mul(r,vt),i=e.pow(n,t),s=e.mul(r,i),o=e.mul(e.mul(s,vt),i),a=e.mul(s,e.sub(o,e.ONE));if(!e.eql(e.sqr(a),r))throw new Error("Cannot find square root");return a}}return function(e){const t=(e-bt)/vt;let r,n,i;for(r=e-bt,n=0;r%vt===wt;r/=vt,n++);for(i=vt;i<e&&Ct(i,t,e)!==e-bt;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(1===n){const t=(e+bt)/At;return function(e,r){const n=e.pow(r,t);if(!e.eql(e.sqr(n),r))throw new Error("Cannot find square root");return n}}const s=(r+bt)/vt;return function(e,o){if(e.pow(o,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let a=n,c=e.pow(e.mul(e.ONE,i),r),l=e.pow(o,s),u=e.pow(o,r);for(;!e.eql(u,e.ONE);){if(e.eql(u,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(u);t<a&&!e.eql(r,e.ONE);t++)r=e.sqr(r);const r=e.pow(c,bt<<BigInt(a-t-1));c=e.sqr(r),l=e.mul(l,r),u=e.mul(u,c),a=t}return l}}(e)}(e)),o(a,t))),invertBatch:e=>function(e,t){const r=new Array(t.length),n=t.reduce((t,n,i)=>e.is0(n)?t:(r[i]=t,e.mul(t,n)),e.ONE),i=e.inv(n);return t.reduceRight((t,n,i)=>e.is0(n)?t:(r[i]=e.mul(t,r[i]),e.mul(t,n)),i),r}(a,e),cmov:(e,t,r)=>r?t:e,toBytes:e=>r?lt(e,s):ct(e,s),fromBytes:e=>{if(e.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+e.length);return r?at(e):function(e){return it(nt(e))}(e)}});return Object.freeze(a)}const Pt=BigInt(0),Rt=BigInt(1);function Ut(e,t){const r=t.negate();return e?r:t}function Bt(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Mt(e,t){return Bt(e,t),{windows:Math.ceil(t/e)+1,windowSize:2**(e-1)}}const Lt=new WeakMap,Dt=new WeakMap;function Wt(e){return Dt.get(e)||1}const jt=BigInt(0),$t=BigInt(1),zt=BigInt(2),qt=BigInt(8),Ft={zip215:!0};BigInt(0),BigInt(1);const Ht=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Kt=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const Vt=BigInt(1),Yt=BigInt(2);BigInt(3);const Gt=BigInt(5),Zt=BigInt(8);const Jt=Ot(Ht,void 0,!0),Xt=function(e){const t=function(e){const t=function(e){return function(e){mt(e,xt.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}(e.Fp),mt(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Tt(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}(e);return mt(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}(e),{Fp:r,n,prehash:i,hash:s,randomBytes:o,nByteLength:a,h:c}=t,l=zt<<BigInt(8*a)-$t,u=r.create,h=Ot(t.n,t.nBitLength),d=t.uvRatio||((e,t)=>{try{return{isValid:!0,value:r.sqrt(e*r.inv(t))}}catch{return{isValid:!1,value:jt}}}),p=t.adjustScalarBytes||(e=>e),f=t.domain||((e,t,r)=>{if(tt("phflag",r),t.length||r)throw new Error("Contexts/pre-hash are not supported");return e});function g(e,t){pt("coordinate "+e,t,jt,l)}function m(e){if(!(e instanceof b))throw new Error("ExtendedPoint expected")}const y=yt((e,t)=>{const{ex:n,ey:i,ez:s}=e,o=e.is0();null==t&&(t=o?qt:r.inv(s));const a=u(n*t),c=u(i*t),l=u(s*t);if(o)return{x:jt,y:$t};if(l!==$t)throw new Error("invZ was invalid");return{x:a,y:c}}),w=yt(e=>{const{a:r,d:n}=t;if(e.is0())throw new Error("bad point: ZERO");const{ex:i,ey:s,ez:o,et:a}=e,c=u(i*i),l=u(s*s),h=u(o*o),d=u(h*h),p=u(c*r);if(u(h*u(p+l))!==u(d+u(n*u(c*l))))throw new Error("bad point: equation left != right (1)");if(u(i*s)!==u(o*a))throw new Error("bad point: equation left != right (2)");return!0});class b{constructor(e,t,r,n){this.ex=e,this.ey=t,this.ez=r,this.et=n,g("x",e),g("y",t),g("z",r),g("t",n),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof b)throw new Error("extended point not allowed");const{x:t,y:r}=e||{};return g("x",t),g("y",r),new b(t,r,$t,u(t*r))}static normalizeZ(e){const t=r.invertBatch(e.map(e=>e.ez));return e.map((e,r)=>e.toAffine(t[r])).map(b.fromAffine)}static msm(e,t){return function(e,t,r,n){if(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw new Error("invalid point at index "+r)})}(r,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+r)})}(n,t),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=e.ZERO,s=function(e){let t;for(t=0;e>Ze;e>>=Je,t+=1);return t}(BigInt(r.length)),o=s>12?s-3:s>4?s-2:s?2:1,a=(1<<o)-1,c=new Array(a+1).fill(i);let l=i;for(let e=Math.floor((t.BITS-1)/o)*o;e>=0;e-=o){c.fill(i);for(let t=0;t<n.length;t++){const i=n[t],s=Number(i>>BigInt(e)&BigInt(a));c[s]=c[s].add(r[t])}let t=i;for(let e=c.length-1,r=i;e>0;e--)r=r.add(c[e]),t=t.add(r);if(l=l.add(t),0!==e)for(let e=0;e<o;e++)l=l.double()}return l}(b,h,e,t)}_setWindowSize(e){A.setWindowSize(this,e)}assertValidity(){w(this)}equals(e){m(e);const{ex:t,ey:r,ez:n}=this,{ex:i,ey:s,ez:o}=e,a=u(t*o),c=u(i*n),l=u(r*o),h=u(s*n);return a===c&&l===h}is0(){return this.equals(b.ZERO)}negate(){return new b(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:e}=t,{ex:r,ey:n,ez:i}=this,s=u(r*r),o=u(n*n),a=u(zt*u(i*i)),c=u(e*s),l=r+n,h=u(u(l*l)-s-o),d=c+o,p=d-a,f=c-o,g=u(h*p),m=u(d*f),y=u(h*f),w=u(p*d);return new b(g,m,w,y)}add(e){m(e);const{a:r,d:n}=t,{ex:i,ey:s,ez:o,et:a}=this,{ex:c,ey:l,ez:h,et:d}=e;if(r===BigInt(-1)){const e=u((s-i)*(l+c)),t=u((s+i)*(l-c)),r=u(t-e);if(r===jt)return this.double();const n=u(o*zt*d),p=u(a*zt*h),f=p+n,g=t+e,m=p-n,y=u(f*r),w=u(g*m),v=u(f*m),E=u(r*g);return new b(y,w,E,v)}const p=u(i*c),f=u(s*l),g=u(a*n*d),y=u(o*h),w=u((i+s)*(c+l)-p-f),v=y-g,E=y+g,A=u(f-r*p),_=u(w*v),I=u(E*A),S=u(w*A),C=u(v*E);return new b(_,I,C,S)}subtract(e){return this.add(e.negate())}wNAF(e){return A.wNAFCached(this,e,b.normalizeZ)}multiply(e){const t=e;pt("scalar",t,$t,n);const{p:r,f:i}=this.wNAF(t);return b.normalizeZ([r,i])[0]}multiplyUnsafe(e,t=b.ZERO){const r=e;return pt("scalar",r,jt,n),r===jt?E:this.is0()||r===$t?this:A.wNAFCachedUnsafe(this,r,b.normalizeZ,t)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return A.unsafeLadder(this,n).is0()}toAffine(e){return y(this,e)}clearCofactor(){const{h:e}=t;return e===$t?this:this.multiplyUnsafe(e)}static fromHex(e,n=!1){const{d:i,a:s}=t,o=r.BYTES;e=ut("pointHex",e,o),tt("zip215",n);const a=e.slice(),c=e[o-1];a[o-1]=-129&c;const h=at(a),p=n?l:r.ORDER;pt("pointHex.y",h,jt,p);const f=u(h*h),g=u(f-$t),m=u(i*f-s);let{isValid:y,value:w}=d(g,m);if(!y)throw new Error("Point.fromHex: invalid y coordinate");const v=(w&$t)===$t,E=!!(128&c);if(!n&&w===jt&&E)throw new Error("Point.fromHex: x=0 and x_0=1");return E!==v&&(w=u(-w)),b.fromAffine({x:w,y:h})}static fromPrivateKey(e){return S(e).point}toRawBytes(){const{x:e,y:t}=this.toAffine(),n=lt(t,r.BYTES);return n[n.length-1]|=e&$t?128:0,n}toHex(){return nt(this.toRawBytes())}}b.BASE=new b(t.Gx,t.Gy,$t,u(t.Gx*t.Gy)),b.ZERO=new b(jt,$t,$t,jt);const{BASE:v,ZERO:E}=b,A=function(e,t){return{constTimeNegate:Ut,hasPrecomputes:e=>1!==Wt(e),unsafeLadder(t,r,n=e.ZERO){let i=t;for(;r>Pt;)r&Rt&&(n=n.add(i)),i=i.double(),r>>=Rt;return n},precomputeWindow(e,r){const{windows:n,windowSize:i}=Mt(r,t),s=[];let o=e,a=o;for(let e=0;e<n;e++){a=o,s.push(a);for(let e=1;e<i;e++)a=a.add(o),s.push(a);o=a.double()}return s},wNAF(r,n,i){const{windows:s,windowSize:o}=Mt(r,t);let a=e.ZERO,c=e.BASE;const l=BigInt(2**r-1),u=2**r,h=BigInt(r);for(let e=0;e<s;e++){const t=e*o;let r=Number(i&l);i>>=h,r>o&&(r-=u,i+=Rt);const s=t,d=t+Math.abs(r)-1,p=e%2!=0,f=r<0;0===r?c=c.add(Ut(p,n[s])):a=a.add(Ut(f,n[d]))}return{p:a,f:c}},wNAFUnsafe(r,n,i,s=e.ZERO){const{windows:o,windowSize:a}=Mt(r,t),c=BigInt(2**r-1),l=2**r,u=BigInt(r);for(let e=0;e<o;e++){const t=e*a;if(i===Pt)break;let r=Number(i&c);if(i>>=u,r>a&&(r-=l,i+=Rt),0===r)continue;let o=n[t+Math.abs(r)-1];r<0&&(o=o.negate()),s=s.add(o)}return s},getPrecomputes(e,t,r){let n=Lt.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&Lt.set(t,r(n))),n},wNAFCached(e,t,r){const n=Wt(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)},wNAFCachedUnsafe(e,t,r,n){const i=Wt(e);return 1===i?this.unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)},setWindowSize(e,r){Bt(r,t),Dt.set(e,r),Lt.delete(e)}}}(b,8*a);function _(e){return St(e,n)}function I(e){return _(at(e))}function S(e){const t=r.BYTES;e=ut("private key",e,t);const n=ut("hashed private key",s(e),2*t),i=p(n.slice(0,t)),o=n.slice(t,2*t),a=I(i),c=v.multiply(a),l=c.toRawBytes();return{head:i,prefix:o,scalar:a,point:c,pointBytes:l}}function C(e=new Uint8Array,...t){const r=ht(...t);return I(s(f(r,ut("context",e),!!i)))}const k=Ft;return v._setWindowSize(8),{CURVE:t,getPublicKey:function(e){return S(e).pointBytes},sign:function(e,t,s={}){e=ut("message",e),i&&(e=i(e));const{prefix:o,scalar:a,pointBytes:c}=S(t),l=C(s.context,o,e),u=v.multiply(l).toRawBytes(),h=_(l+C(s.context,u,c,e)*a);return pt("signature.s",h,jt,n),ut("result",ht(u,lt(h,r.BYTES)),2*r.BYTES)},verify:function(e,t,n,s=k){const{context:o,zip215:a}=s,c=r.BYTES;e=ut("signature",e,2*c),t=ut("message",t),n=ut("publicKey",n,c),void 0!==a&&tt("zip215",a),i&&(t=i(t));const l=at(e.slice(c,2*c));let u,h,d;try{u=b.fromHex(n,a),h=b.fromHex(e.slice(0,c),a),d=v.multiplyUnsafe(l)}catch{return!1}if(!a&&u.isSmallOrder())return!1;const p=C(o,h.toRawBytes(),u.toRawBytes(),t);return h.add(u.multiplyUnsafe(p)).subtract(d).clearCofactor().equals(b.ZERO)},ExtendedPoint:b,utils:{getExtendedPublicKey:S,randomPrivateKey:()=>o(r.BYTES),precompute:(e=8,t=b.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}}({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Jt,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Zt,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Ge,randomBytes:Se,adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},uvRatio:function(e,t){const r=Ht,n=St(t*t*t,r),i=function(e){const t=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=Ht,o=e*e%s*e%s,a=kt(o,Yt,s)*o%s,c=kt(a,Vt,s)*e%s,l=kt(c,Gt,s)*c%s,u=kt(l,t,s)*l%s,h=kt(u,r,s)*u%s,d=kt(h,n,s)*h%s,p=kt(d,i,s)*d%s,f=kt(p,i,s)*d%s,g=kt(f,t,s)*l%s;return{pow_p_5_8:kt(g,Yt,s)*e%s,b2:o}}(e*St(n*n*t,r)).pow_p_5_8;let s=St(e*n*i,r);const o=St(t*s*s,r),a=s,c=St(s*Kt,r),l=o===e,u=o===St(-e,r),h=o===St(-e*Kt,r);return l&&(s=a),(u||h)&&(s=c),((e,t)=>(St(e,t)&bt)===bt)(s,r)&&(s=St(-s,r)),{isValid:l||u,value:s}}}),Qt=".",er="base64url",tr="utf8",rr="utf8",nr="did",ir="key",sr="base58btc";function or(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function ar(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?or(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function cr(e,t){t||(t=e.reduce((e,t)=>e+t.length,0));const r=ar(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return or(r)}var lr=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var p=s-i;p!==s&&0===o[p];)p++;for(var f=new Uint8Array(n+(s-p)),g=n;p!==s;)f[g++]=o[p++];return f}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*u+1>>>0,l=new Uint8Array(o);i!==s;){for(var h=t[i],d=0,p=o-1;(0!==h||d<n)&&-1!==p;p--,d++)h+=256*l[p]>>>0,l[p]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}for(var f=o-n;f!==o&&0===l[f];)f++;for(var g=c.repeat(r);f<o;++f)g+=e.charAt(l[f]);return g},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const ur=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class hr{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class dr{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return fr(this,e)}}class pr{constructor(e){this.decoders=e}or(e){return fr(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const fr=(e,t)=>new pr({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class gr{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new hr(e,t,r),this.decoder=new dr(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const mr=({name:e,prefix:t,encode:r,decode:n})=>new gr(e,t,r,n),yr=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=lr(r,t);return mr({prefix:e,name:t,encode:n,decode:e=>ur(i(e))})},wr=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>mr({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let t=0;t<s;++t){const s=i[e[t]];if(void 0===s)throw new SyntaxError(`Non-${n} character`);c=c<<r|s,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),br=mr({prefix:"\0",name:"identity",encode:e=>(e=>(new TextDecoder).decode(e))(e),decode:e=>(e=>(new TextEncoder).encode(e))(e)});var vr=Object.freeze({__proto__:null,identity:br});const Er=wr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ar=Object.freeze({__proto__:null,base2:Er});const _r=wr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Ir=Object.freeze({__proto__:null,base8:_r});const Sr=yr({prefix:"9",name:"base10",alphabet:"0123456789"});var Cr=Object.freeze({__proto__:null,base10:Sr});const kr=wr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Nr=wr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var xr=Object.freeze({__proto__:null,base16:kr,base16upper:Nr});const Tr=wr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Or=wr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Pr=wr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Rr=wr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ur=wr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Br=wr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Mr=wr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Lr=wr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Dr=wr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Wr=Object.freeze({__proto__:null,base32:Tr,base32upper:Or,base32pad:Pr,base32padupper:Rr,base32hex:Ur,base32hexupper:Br,base32hexpad:Mr,base32hexpadupper:Lr,base32z:Dr});const jr=yr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),$r=yr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var zr=Object.freeze({__proto__:null,base36:jr,base36upper:$r});const qr=yr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Fr=yr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Hr=Object.freeze({__proto__:null,base58btc:qr,base58flickr:Fr});const Kr=wr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Vr=wr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Yr=wr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Gr=wr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Zr=Object.freeze({__proto__:null,base64:Kr,base64pad:Vr,base64url:Yr,base64urlpad:Gr});const Jr=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Xr=Jr.reduce((e,t,r)=>(e[r]=t,e),[]),Qr=Jr.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]),en=mr({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+Xr[t],"")},decode:function(e){const t=[];for(const r of e){const e=Qr[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var tn=Object.freeze({__proto__:null,base256emoji:en}),rn=128,nn=-128,sn=Math.pow(2,31),on=128,an=127,cn=Math.pow(2,7),ln=Math.pow(2,14),un=Math.pow(2,21),hn=Math.pow(2,28),dn=Math.pow(2,35),pn=Math.pow(2,42),fn=Math.pow(2,49),gn=Math.pow(2,56),mn=Math.pow(2,63),yn={encode:function e(t,r,n){r=r||[];for(var i=n=n||0;t>=sn;)r[n++]=255&t|rn,t/=128;for(;t&nn;)r[n++]=255&t|rn,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},decode:function e(t,r){var n,i=0,s=(r=r||0,0),o=r,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],i+=s<28?(n&an)<<s:(n&an)*Math.pow(2,s),s+=7}while(n>=on);return e.bytes=o-r,i},encodingLength:function(e){return e<cn?1:e<ln?2:e<un?3:e<hn?4:e<dn?5:e<pn?6:e<fn?7:e<gn?8:e<mn?9:10}},wn=yn;const bn=(e,t,r=0)=>(wn.encode(e,t,r),t),vn=e=>wn.encodingLength(e),En=(e,t)=>{const r=t.byteLength,n=vn(e),i=n+vn(r),s=new Uint8Array(i+r);return bn(e,s,0),bn(r,s,n),s.set(t,i),new An(e,r,t,s)};class An{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const _n=({name:e,code:t,encode:r})=>new In(e,t,r);class In{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?En(this.code,t):t.then(e=>En(this.code,e))}throw Error("Unknown type, must be binary type")}}const Sn=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Cn=_n({name:"sha2-256",code:18,encode:Sn("SHA-256")}),kn=_n({name:"sha2-512",code:19,encode:Sn("SHA-512")});Object.freeze({__proto__:null,sha256:Cn,sha512:kn});const Nn=ur,xn={code:0,name:"identity",encode:Nn,digest:e=>En(0,Nn(e))};Object.freeze({__proto__:null,identity:xn}),new TextEncoder,new TextDecoder;const Tn={...vr,...Ar,...Ir,...Cr,...xr,...Wr,...zr,...Hr,...Zr,...tn};function On(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Pn=On("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>(new TextEncoder).encode(e.substring(1))),Rn=On("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{const t=ar((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Un={utf8:Pn,"utf-8":Pn,hex:Tn.base16,latin1:Rn,ascii:Rn,binary:Rn,...Tn};function Bn(e,t="utf8"){const r=Un[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function Mn(e,t="utf8"){const r=Un[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):or(globalThis.Buffer.from(e,"utf-8"))}function Ln(e){return(0,K.j)(Bn(Mn(e,er),tr))}function Dn(e){return Bn(Mn((0,K.h)(e),tr),er)}function Wn(e){const t="z"+Bn(cr([Mn("K36",sr),e]),sr);return[nr,ir,t].join(":")}function jn(e){return Bn(e,er)}function $n(e){const t=e.split(Qt),r=Ln(t[0]),n=Ln(t[1]),i=function(e){return Mn(e,er)}(t[2]);return{header:r,payload:n,signature:i,data:Mn(t.slice(0,2).join(Qt),rr)}}function zn(e=Se(32)){const t=Xt.getPublicKey(e);return{secretKey:cr([e,t]),publicKey:t}}var qn=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},Fn=function(e,t,r){this.name=e,this.version=t,this.os=r,this.type="browser"},Hn=function(e){this.version=e,this.type="node",this.name="node",this.os=process.platform},Kn=function(e,t,r,n){this.name=e,this.version=t,this.os=r,this.bot=n,this.type="bot-device"},Vn=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},Yn=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},Gn=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Zn=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],Jn=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Xn(e){var t=function(e){return""!==e&&Zn.reduce(function(t,r){var n=r[0],i=r[1];if(t)return t;var s=i.exec(e);return!!s&&[n,s]},!1)}(e);if(!t)return null;var r=t[0],n=t[1];if("searchbot"===r)return new Vn;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<3&&(i=qn(qn([],i,!0),function(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}(3-i.length),!0)):i=[];var s=i.join("."),o=function(e){for(var t=0,r=Jn.length;t<r;t++){var n=Jn[t],i=n[0];if(n[1].exec(e))return i}return null}(e),a=Gn.exec(e);return a&&a[1]?new Kn(r,s,o,a[1]):new Fn(r,s,o)}var Qn=r(8196),ei=r(2063);const ti="2.31.0";let ri=({docsBaseUrl:e,docsPath:t="",docsSlug:r})=>t?`${e??"https://viem.sh"}${t}${r?`#${r}`:""}`:void 0,ni=`viem@${ti}`;class ii extends Error{constructor(e,t={}){const r=t.cause instanceof ii?t.cause.details:t.cause?.message?t.cause.message:t.details,n=t.cause instanceof ii&&t.cause.docsPath||t.docsPath,i=ri?.({...t,docsPath:n});super([e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...ni?[`Version: ${ni}`]:[]].join("\n"),t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=n,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=ti}walk(e){return si(this,e)}}function si(e,t){return t?.(e)?e:e&&"object"==typeof e&&"cause"in e&&void 0!==e.cause?si(e.cause,t):t?null:e}function oi(e,{strict:t=!0}={}){return!!e&&"string"==typeof e&&(t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x"))}class ai extends ii{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function ci(e,{dir:t,size:r=32}={}){return"string"==typeof e?function(e,{dir:t,size:r=32}={}){if(null===r)return e;const n=e.replace("0x","");if(n.length>2*r)throw new ai({size:Math.ceil(n.length/2),targetSize:r,type:"hex"});return`0x${n["right"===t?"padEnd":"padStart"](2*r,"0")}`}(e,{dir:t,size:r}):function(e,{dir:t,size:r=32}={}){if(null===r)return e;if(e.length>r)throw new ai({size:e.length,targetSize:r,type:"bytes"});const n=new Uint8Array(r);for(let i=0;i<r;i++){const s="right"===t;n[s?i:r-i-1]=e[s?i:e.length-i-1]}return n}(e,{dir:t,size:r})}class li extends ii{constructor({max:e,min:t,signed:r,size:n,value:i}){super(`Number "${i}" is not in safe ${n?`${8*n}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class ui extends ii{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function hi(e){return oi(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}function di(e,{size:t}){if(hi(e)>t)throw new ui({givenSize:hi(e),maxSize:t})}function pi(e,t={}){const{signed:r}=t;t.size&&di(e,{size:t.size});const n=BigInt(e);if(!r)return n;const i=(e.length-2)/2;return n<=(1n<<8n*BigInt(i)-1n)-1n?n:n-BigInt(`0x${"f".padStart(2*i,"f")}`)-1n}const fi=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function gi(e,t={}){return"number"==typeof e||"bigint"==typeof e?yi(e,t):"string"==typeof e?function(e,t={}){return mi(wi.encode(e),t)}(e,t):"boolean"==typeof e?function(e,t={}){const r=`0x${Number(e)}`;return"number"==typeof t.size?(di(r,{size:t.size}),ci(r,{size:t.size})):r}(e,t):mi(e,t)}function mi(e,t={}){let r="";for(let t=0;t<e.length;t++)r+=fi[e[t]];const n=`0x${r}`;return"number"==typeof t.size?(di(n,{size:t.size}),ci(n,{dir:"right",size:t.size})):n}function yi(e,t={}){const{signed:r,size:n}=t,i=BigInt(e);let s;n?s=r?(1n<<8n*BigInt(n)-1n)-1n:2n**(8n*BigInt(n))-1n:"number"==typeof e&&(s=BigInt(Number.MAX_SAFE_INTEGER));const o="bigint"==typeof s&&r?-s-1n:0;if(s&&i>s||i<o){const t="bigint"==typeof e?"n":"";throw new li({max:s?`${s}${t}`:void 0,min:`${o}${t}`,signed:r,size:n,value:`${e}${t}`})}const a=`0x${(r&&i<0?(1n<<BigInt(8*n))+BigInt(i):i).toString(16)}`;return n?ci(a,{size:n}):a}const wi=new TextEncoder,bi=new TextEncoder;const vi={zero:48,nine:57,A:65,F:70,a:97,f:102};function Ei(e){return e>=vi.zero&&e<=vi.nine?e-vi.zero:e>=vi.A&&e<=vi.F?e-(vi.A-10):e>=vi.a&&e<=vi.f?e-(vi.a-10):void 0}function Ai(e,t={}){let r=e;t.size&&(di(r,{size:t.size}),r=ci(r,{dir:"right",size:t.size}));let n=r.slice(2);n.length%2&&(n=`0${n}`);const i=n.length/2,s=new Uint8Array(i);for(let e=0,t=0;e<i;e++){const r=Ei(n.charCodeAt(t++)),i=Ei(n.charCodeAt(t++));if(void 0===r||void 0===i)throw new ii(`Invalid byte sequence ("${n[t-2]}${n[t-1]}" in "${n}").`);s[e]=16*r+i}return s}function _i(e,t={}){const r=bi.encode(e);return"number"==typeof t.size?(di(r,{size:t.size}),ci(r,{dir:"right",size:t.size})):r}var Ii=r(7238);function Si(e,t){const r=t||"hex",n=(0,Ii.lY)(oi(e,{strict:!1})?function(e,t={}){return"number"==typeof e||"bigint"==typeof e?function(e,t){return Ai(yi(e,t))}(e,t):"boolean"==typeof e?function(e,t={}){const r=new Uint8Array(1);return r[0]=Number(e),"number"==typeof t.size?(di(r,{size:t.size}),ci(r,{size:t.size})):r}(e,t):oi(e)?Ai(e,t):_i(e,t)}(e):e);return"bytes"===r?n:gi(n)}class Ci extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const t=super.get(e);return super.has(e)&&void 0!==t&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){const e=this.keys().next().value;e&&this.delete(e)}return this}}const ki=new Ci(8192);function Ni(e){if(0===e||1===e)return e;if(27===e)return 0;if(28===e)return 1;throw new Error("Invalid yParityOrV value")}async function xi({hash:e,signature:t}){return function(e){return function(e,t){if(ki.has(`${e}.${t}`))return ki.get(`${e}.${t}`);const r=t?`${t}${e.toLowerCase()}`:e.substring(2).toLowerCase(),n=Si(_i(r),"bytes"),i=(t?r.substring(`${t}0x`.length):r).split("");for(let e=0;e<40;e+=2)n[e>>1]>>4>=8&&i[e]&&(i[e]=i[e].toUpperCase()),(15&n[e>>1])>=8&&i[e+1]&&(i[e+1]=i[e+1].toUpperCase());const s=`0x${i.join("")}`;return ki.set(`${e}.${t}`,s),s}(`0x${Si(`0x${e.substring(4)}`).substring(26)}`)}(await async function({hash:e,signature:t}){const n=oi(e)?e:gi(e),{secp256k1:i}=await r.e(8983).then(r.bind(r,8983)),s=(()=>{if("object"==typeof t&&"r"in t&&"s"in t){const{r:e,s:r,v:n,yParity:s}=t,o=Ni(Number(s??n));return new i.Signature(pi(e),pi(r)).addRecoveryBit(o)}const e=oi(t)?t:gi(t);if(65!==hi(e))throw new Error("invalid signature length");const r=Ni(function(e,t={}){return Number(pi(e,t))}(`0x${e.slice(130)}`));return i.Signature.fromCompact(e.substring(2,130)).addRecoveryBit(r)})();return`0x${s.recoverPublicKey(n.substring(2)).toHex(!1)}`}({hash:e,signature:t}))}var Ti=r(1307);function Oi(e){return`${e<0?"-":""}0x${Math.abs(e).toString(16).padStart(2,"0")}`}class Pi{constructor(e,t){this.type=e,this.data=t}}class Ri extends Error{constructor(e){super(e);const t=Object.create(Ri.prototype);Object.setPrototypeOf(this,t),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:Ri.name})}}const Ui=4294967295;function Bi(e,t,r){const n=Math.floor(r/4294967296),i=r;e.setUint32(t,n),e.setUint32(t+4,i)}function Mi(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}const Li={type:-1,encode:function(e){return e instanceof Date?function({sec:e,nsec:t}){if(e>=0&&t>=0&&e<=17179869183){if(0===t&&e<=4294967295){const t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e),t}{const r=e/4294967296,n=4294967295&e,i=new Uint8Array(8),s=new DataView(i.buffer);return s.setUint32(0,t<<2|3&r),s.setUint32(4,n),i}}{const r=new Uint8Array(12),n=new DataView(r.buffer);return n.setUint32(0,t),Bi(n,4,e),r}}(function(e){const t=e.getTime(),r=Math.floor(t/1e3),n=1e6*(t-1e3*r),i=Math.floor(n/1e9);return{sec:r+i,nsec:n-1e9*i}}(e)):null},decode:function(e){const t=function(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:{const e=t.getUint32(0);return{sec:4294967296*(3&e)+t.getUint32(4),nsec:e>>>2}}case 12:return{sec:Mi(t,4),nsec:t.getUint32(0)};default:throw new Ri(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${e.length}`)}}(e);return new Date(1e3*t.sec+t.nsec/1e6)}};class Di{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(Li)}register({type:e,encode:t,decode:r}){if(e>=0)this.encoders[e]=t,this.decoders[e]=r;else{const n=-1-e;this.builtInEncoders[n]=t,this.builtInDecoders[n]=r}}tryToEncode(e,t){for(let r=0;r<this.builtInEncoders.length;r++){const n=this.builtInEncoders[r];if(null!=n){const i=n(e,t);if(null!=i)return new Pi(-1-r,i)}}for(let r=0;r<this.encoders.length;r++){const n=this.encoders[r];if(null!=n){const i=n(e,t);if(null!=i)return new Pi(r,i)}}return e instanceof Pi?e:null}decode(e,t,r){const n=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return n?n(e,t,r):new Pi(t,e)}}Di.defaultCodec=new Di;const Wi=new TextEncoder;function ji(e,t,r){let n=t;const i=n+r,s=[];let o="";for(;n<i;){const t=e[n++];if(128&t)if(192==(224&t)){const r=63&e[n++];s.push((31&t)<<6|r)}else if(224==(240&t)){const r=63&e[n++],i=63&e[n++];s.push((31&t)<<12|r<<6|i)}else if(240==(248&t)){let r=(7&t)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++];r>65535&&(r-=65536,s.push(r>>>10&1023|55296),r=56320|1023&r),s.push(r)}else s.push(t);else s.push(t);s.length>=4096&&(o+=String.fromCharCode(...s),s.length=0)}return s.length>0&&(o+=String.fromCharCode(...s)),o}const $i=new TextDecoder;function zi(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):function(e){return e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer}(e)?new Uint8Array(e):Uint8Array.from(e)}const qi="array",Fi="map_key",Hi="map_value",Ki=e=>{if("string"==typeof e||"number"==typeof e)return e;throw new Ri("The type of key must be string or number but "+typeof e)};class Vi{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const t=this.getUninitializedStateFromPool();t.type=qi,t.position=0,t.size=e,t.array=new Array(e)}pushMapState(e){const t=this.getUninitializedStateFromPool();t.type=Fi,t.readCount=0,t.size=e,t.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===qi){const t=e;t.size=0,t.array=void 0,t.position=0,t.type=void 0}if(e.type===Fi||e.type===Hi){const t=e;t.size=0,t.map=void 0,t.readCount=0,t.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const Yi=new DataView(new ArrayBuffer(0)),Gi=new Uint8Array(Yi.buffer);try{Yi.getInt8(0)}catch(na){if(!(na instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const Zi=new RangeError("Insufficient data"),Ji=new class{constructor(e=16,t=16){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=t,this.caches=[];for(let e=0;e<this.maxKeyLength;e++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,t,r){const n=this.caches[r-1];e:for(const i of n){const n=i.bytes;for(let i=0;i<r;i++)if(n[i]!==e[t+i])continue e;return i.str}return null}store(e,t){const r=this.caches[e.length-1],n={bytes:e,str:t};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=n:r.push(n)}decode(e,t,r){const n=this.find(e,t,r);if(null!=n)return this.hit++,n;this.miss++;const i=ji(e,t,r),s=Uint8Array.prototype.slice.call(e,t,t+r);return this.store(s,i),i}};class Xi{constructor(e){this.totalPos=0,this.pos=0,this.view=Yi,this.bytes=Gi,this.headByte=-1,this.stack=new Vi,this.entered=!1,this.extensionCodec=e?.extensionCodec??Di.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??Ui,this.maxBinLength=e?.maxBinLength??Ui,this.maxArrayLength=e?.maxArrayLength??Ui,this.maxMapLength=e?.maxMapLength??Ui,this.maxExtLength=e?.maxExtLength??Ui,this.keyDecoder=void 0!==e?.keyDecoder?e.keyDecoder:Ji,this.mapKeyConverter=e?.mapKeyConverter??Ki}clone(){return new Xi({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=-1,this.stack.reset()}setBuffer(e){const t=zi(e);this.bytes=t,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.pos=0}appendBuffer(e){if(-1!==this.headByte||this.hasRemaining(1)){const t=this.bytes.subarray(this.pos),r=zi(e),n=new Uint8Array(t.length+r.length);n.set(t),n.set(r,t.length),this.setBuffer(n)}else this.setBuffer(e)}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:t,pos:r}=this;return new RangeError(`Extra ${t.byteLength-r} of ${t.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){const t=this.clone();return void(yield*t.decodeMulti(e))}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let t,r=!1;for await(const n of e){if(r)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(n);try{t=this.doDecodeSync(),r=!0}catch(e){if(!(e instanceof RangeError))throw e}this.totalPos+=this.pos}if(r){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return t}const{headByte:n,pos:i,totalPos:s}=this;throw new RangeError(`Insufficient data in parsing ${Oi(n)} at ${s} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,t){if(this.entered){const r=this.clone();return void(yield*r.decodeMultiAsync(e,t))}try{this.entered=!0;let r=t,n=-1;for await(const i of e){if(t&&0===n)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),r&&(n=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),0!==--n;);}catch(e){if(!(e instanceof RangeError))throw e}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let t;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){const r=e-128;if(0!==r){this.pushMapState(r),this.complete();continue e}t={}}else if(e<160){const r=e-144;if(0!==r){this.pushArrayState(r),this.complete();continue e}t=[]}else{const r=e-160;t=this.decodeString(r,0)}else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.useBigInt64?this.readU64AsBigInt():this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.useBigInt64?this.readI64AsBigInt():this.readI64();else if(217===e){const e=this.lookU8();t=this.decodeString(e,1)}else if(218===e){const e=this.lookU16();t=this.decodeString(e,2)}else if(219===e){const e=this.lookU32();t=this.decodeString(e,4)}else if(220===e){const e=this.readU16();if(0!==e){this.pushArrayState(e),this.complete();continue e}t=[]}else if(221===e){const e=this.readU32();if(0!==e){this.pushArrayState(e),this.complete();continue e}t=[]}else if(222===e){const e=this.readU16();if(0!==e){this.pushMapState(e),this.complete();continue e}t={}}else if(223===e){const e=this.readU32();if(0!==e){this.pushMapState(e),this.complete();continue e}t={}}else if(196===e){const e=this.lookU8();t=this.decodeBinary(e,1)}else if(197===e){const e=this.lookU16();t=this.decodeBinary(e,2)}else if(198===e){const e=this.lookU32();t=this.decodeBinary(e,4)}else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e){const e=this.lookU8();t=this.decodeExtension(e,1)}else if(200===e){const e=this.lookU16();t=this.decodeExtension(e,2)}else{if(201!==e)throw new Ri(`Unrecognized type byte: ${Oi(e)}`);{const e=this.lookU32();t=this.decodeExtension(e,4)}}this.complete();const r=this.stack;for(;r.length>0;){const e=r.top();if(e.type===qi){if(e.array[e.position]=t,e.position++,e.position!==e.size)continue e;t=e.array,r.release(e)}else{if(e.type===Fi){if("__proto__"===t)throw new Ri("The key __proto__ is not allowed");e.key=this.mapKeyConverter(t),e.type=Hi;continue e}if(e.map[e.key]=t,e.readCount++,e.readCount!==e.size){e.key=null,e.type=Fi;continue e}t=e.map,r.release(e)}}return t}}readHeadByte(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=-1}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new Ri(`Unrecognized array type byte: ${Oi(e)}`)}}pushMapState(e){if(e>this.maxMapLength)throw new Ri(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new Ri(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,t){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,t):this.decodeBinary(e,t)}decodeUtf8String(e,t){if(e>this.maxStrLength)throw new Ri(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+t+e)throw Zi;const r=this.pos+t;let n;return n=this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?this.keyDecoder.decode(this.bytes,r,e):function(e,t,r){return r>200?function(e,t,r){const n=e.subarray(t,t+r);return $i.decode(n)}(e,t,r):ji(e,t,r)}(this.bytes,r,e),this.pos+=t+e,n}stateIsMapKey(){return this.stack.length>0&&this.stack.top().type===Fi}decodeBinary(e,t){if(e>this.maxBinLength)throw new Ri(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+t))throw Zi;const r=this.pos+t,n=this.bytes.subarray(r,r+e);return this.pos+=t+e,n}decodeExtension(e,t){if(e>this.maxExtLength)throw new Ri(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+t),n=this.decodeBinary(e,t+1);return this.extensionCodec.decode(n,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=(t=this.view,r=this.pos,4294967296*t.getUint32(r)+t.getUint32(r+4));var t,r;return this.pos+=8,e}readI64(){const e=Mi(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}}class Qi{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??Di.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??100,this.initialBufferSize=e?.initialBufferSize??2048,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new Qi({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,t){if(t>this.maxDepth)throw new Error(`Too deep objects in depth ${t}`);null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.useBigInt64&&"bigint"==typeof e?this.encodeBigInt64(e):this.encodeObject(e,t)}ensureBufferSizeToWrite(e){const t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)}resizeBuffer(e){const t=new ArrayBuffer(e),r=new Uint8Array(t),n=new DataView(t);r.set(this.bytes),this.view=n,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){!1===e?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error(`Too long string: ${e} bytes in UTF-8`);this.writeU8(219),this.writeU32(e)}}encodeString(e){const t=function(e){const t=e.length;let r=0,n=0;for(;n<t;){let i=e.charCodeAt(n++);if(4294967168&i)if(4294965248&i){if(i>=55296&&i<=56319&&n<t){const t=e.charCodeAt(n);56320==(64512&t)&&(++n,i=((1023&i)<<10)+(1023&t)+65536)}r+=4294901760&i?4:3}else r+=2;else r++}return r}(e);var r,n,i;this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),r=e,n=this.bytes,i=this.pos,r.length>50?function(e,t,r){Wi.encodeInto(e,t.subarray(r))}(r,n,i):function(e,t,r){const n=e.length;let i=r,s=0;for(;s<n;){let r=e.charCodeAt(s++);if(4294967168&r){if(4294965248&r){if(r>=55296&&r<=56319&&s<n){const t=e.charCodeAt(s);56320==(64512&t)&&(++s,r=((1023&r)<<10)+(1023&t)+65536)}4294901760&r?(t[i++]=r>>18&7|240,t[i++]=r>>12&63|128,t[i++]=r>>6&63|128):(t[i++]=r>>12&15|224,t[i++]=r>>6&63|128)}else t[i++]=r>>6&31|192;t[i++]=63&r|128}else t[i++]=r}}(r,n,i),this.pos+=t}encodeObject(e,t){const r=this.extensionCodec.tryToEncode(e,this.context);if(null!=r)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`);this.encodeMap(e,t)}}encodeBinary(e){const t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error(`Too large binary: ${t}`);this.writeU8(198),this.writeU32(t)}const r=zi(e);this.writeU8a(r)}encodeArray(e,t){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else{if(!(r<4294967296))throw new Error(`Too large array: ${r}`);this.writeU8(221),this.writeU32(r)}for(const r of e)this.doEncode(r,t+1)}countWithoutUndefined(e,t){let r=0;for(const n of t)void 0!==e[n]&&r++;return r}encodeMap(e,t){const r=Object.keys(e);this.sortKeys&&r.sort();const n=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(n<16)this.writeU8(128+n);else if(n<65536)this.writeU8(222),this.writeU16(n);else{if(!(n<4294967296))throw new Error(`Too large map object: ${n}`);this.writeU8(223),this.writeU32(n)}for(const n of r){const r=e[n];this.ignoreUndefined&&void 0===r||(this.encodeString(n),this.doEncode(r,t+1))}}encodeExtension(e){if("function"==typeof e.data){const t=e.data(this.pos+6),r=t.length;if(r>=4294967296)throw new Error(`Too large extension object: ${r}`);return this.writeU8(201),this.writeU32(r),this.writeI8(e.type),void this.writeU8a(t)}const t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error(`Too large extension object: ${t}`);this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),function(e,t,r){const n=r/4294967296,i=r;e.setUint32(t,n),e.setUint32(t+4,i)}(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),Bi(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}}function es(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function ts(e,t){return!!Array.isArray(t)&&(0===t.length||(e?t.every(e=>"string"==typeof e):t.every(e=>Number.isSafeInteger(e))))}function rs(e){if("function"!=typeof e)throw new Error("function expected");return!0}function ns(e,t){if("string"!=typeof t)throw new Error(`${e}: string expected`);return!0}function is(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function ss(e){if(!Array.isArray(e))throw new Error("array expected")}function os(e,t){if(!ts(!0,t))throw new Error(`${e}: array of strings expected`)}function as(e,t){if(!ts(!1,t))throw new Error(`${e}: array of numbers expected`)}function cs(...e){const t=e=>e,r=(e,t)=>r=>e(t(r));return{encode:e.map(e=>e.encode).reduceRight(r,t),decode:e.map(e=>e.decode).reduce(r,t)}}function ls(e){const t="string"==typeof e?e.split(""):e,r=t.length;os("alphabet",t);const n=new Map(t.map((e,t)=>[e,t]));return{encode:n=>(ss(n),n.map(n=>{if(!Number.isSafeInteger(n)||n<0||n>=r)throw new Error(`alphabet.encode: digit index outside alphabet "${n}". Allowed: ${e}`);return t[n]})),decode:t=>(ss(t),t.map(t=>{ns("alphabet.decode",t);const r=n.get(t);if(void 0===r)throw new Error(`Unknown letter: "${t}". Allowed: ${e}`);return r}))}}function us(e=""){return ns("join",e),{encode:t=>(os("join.decode",t),t.join(e)),decode:t=>(ns("join.decode",t),t.split(e))}}function hs(e,t="="){return is(e),ns("padding",t),{encode(r){for(os("padding.encode",r);r.length*e%8;)r.push(t);return r},decode(r){os("padding.decode",r);let n=r.length;if(n*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;n>0&&r[n-1]===t;n--)if((n-1)*e%8==0)throw new Error("padding: invalid, string has too much padding");return r.slice(0,n)}}}function ds(e){return rs(e),{encode:e=>e,decode:t=>e(t)}}function ps(e,t,r){if(t<2)throw new Error(`convertRadix: invalid from=${t}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: invalid to=${r}, base cannot be less than 2`);if(ss(e),!e.length)return[];let n=0;const i=[],s=Array.from(e,e=>{if(is(e),e<0||e>=t)throw new Error(`invalid integer: ${e}`);return e}),o=s.length;for(;;){let e=0,a=!0;for(let i=n;i<o;i++){const o=s[i],c=t*e,l=c+o;if(!Number.isSafeInteger(l)||c/t!==e||l-o!==c)throw new Error("convertRadix: carry overflow");const u=l/r;e=l%r;const h=Math.floor(u);if(s[i]=h,!Number.isSafeInteger(h)||h*r+e!==l)throw new Error("convertRadix: carry overflow");a&&(h?a=!1:n=i)}if(i.push(e),a)break}for(let t=0;t<e.length-1&&0===e[t];t++)i.push(0);return i.reverse()}const fs=(e,t)=>0===t?e:fs(t,e%t),gs=(e,t)=>e+(t-fs(e,t)),ms=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function ys(e,t,r,n){if(ss(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(gs(t,r)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${r} carryBits=${gs(t,r)}`);let i=0,s=0;const o=ms[t],a=ms[r]-1,c=[];for(const n of e){if(is(n),n>=o)throw new Error(`convertRadix2: invalid data word=${n} from=${t}`);if(i=i<<t|n,s+t>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${t}`);for(s+=t;s>=r;s-=r)c.push((i>>s-r&a)>>>0);const e=ms[s];if(void 0===e)throw new Error("invalid carry");i&=e-1}if(i=i<<r-s&a,!n&&s>=t)throw new Error("Excess padding");if(!n&&i>0)throw new Error(`Non-zero padding: ${i}`);return n&&s>0&&c.push(i>>>0),c}function ws(e,t=!1){if(is(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(gs(8,e)>32||gs(e,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!es(r))throw new Error("radix2.encode input should be Uint8Array");return ys(Array.from(r),8,e,!t)},decode:r=>(as("radix2.decode",r),Uint8Array.from(ys(r,e,8,t)))}}function bs(e){return rs(e),function(...t){try{return e.apply(null,t)}catch(e){}}}cs(ws(4),ls("0123456789ABCDEF"),us(""));const vs=cs(ws(5),ls("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),hs(5),us("")),Es=(cs(ws(5),ls("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),us("")),cs(ws(5),ls("0123456789ABCDEFGHIJKLMNOPQRSTUV"),hs(5),us("")),cs(ws(5),ls("0123456789ABCDEFGHIJKLMNOPQRSTUV"),us("")),cs(ws(5),ls("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),us(""),ds(e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))),(()=>"function"==typeof Uint8Array.from([]).toBase64&&"function"==typeof Uint8Array.fromBase64)()),As=(Es||cs(ws(6),ls("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),hs(6),us("")),cs(ws(6),ls("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),us("")),Es||cs(ws(6),ls("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),hs(6),us("")),cs(ws(6),ls("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),us("")),e=>{return cs((is(t=58),{encode:e=>{if(!es(e))throw new Error("radix.encode input should be Uint8Array");return ps(Array.from(e),256,t)},decode:e=>(as("radix.decode",e),Uint8Array.from(ps(e,t,256)))}),ls(e),us(""));var t}),_s=(As("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),As("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),As("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz"),cs(ls("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),us(""))),Is=[996825010,642813549,513874426,1027748829,705979059];function Ss(e){const t=e>>25;let r=(33554431&e)<<5;for(let e=0;e<Is.length;e++)1==(t>>e&1)&&(r^=Is[e]);return r}function Cs(e,t,r=1){const n=e.length;let i=1;for(let t=0;t<n;t++){const r=e.charCodeAt(t);if(r<33||r>126)throw new Error(`Invalid prefix (${e})`);i=Ss(i)^r>>5}i=Ss(i);for(let t=0;t<n;t++)i=Ss(i)^31&e.charCodeAt(t);for(let e of t)i=Ss(i)^e;for(let e=0;e<6;e++)i=Ss(i);return i^=r,_s.encode(ys([i%ms[30]],30,5,!1))}function ks(e){const t="bech32"===e?1:734539939,r=ws(5),n=r.decode,i=r.encode,s=bs(n);function o(e,r,n=90){ns("bech32.encode prefix",e),es(r)&&(r=Array.from(r)),as("bech32.encode",r);const i=e.length;if(0===i)throw new TypeError(`Invalid prefix length ${i}`);const s=i+7+r.length;if(!1!==n&&s>n)throw new TypeError(`Length ${s} exceeds limit ${n}`);const o=e.toLowerCase(),a=Cs(o,r,t);return`${o}1${_s.encode(r)}${a}`}function a(e,r=90){ns("bech32.decode input",e);const n=e.length;if(n<8||!1!==r&&n>r)throw new TypeError(`invalid string length: ${n} (${e}). Expected (8..${r})`);const i=e.toLowerCase();if(e!==i&&e!==e.toUpperCase())throw new Error("String must be lowercase or uppercase");const s=i.lastIndexOf("1");if(0===s||-1===s)throw new Error('Letter "1" must be present between prefix and data only');const o=i.slice(0,s),a=i.slice(s+1);if(a.length<6)throw new Error("Data must be at least 6 characters long");const c=_s.decode(a).slice(0,-6),l=Cs(o,c,t);if(!a.endsWith(l))throw new Error(`Invalid checksum in ${e}: expected "${l}"`);return{prefix:o,words:c}}return{encode:o,decode:a,encodeFromBytes:function(e,t){return o(e,i(t))},decodeToBytes:function(e){const{prefix:t,words:r}=a(e,!1);return{prefix:t,words:r,bytes:n(r)}},decodeUnsafe:bs(a),fromWords:n,fromWordsUnsafe:s,toWords:i}}ks("bech32"),ks("bech32m");function Ns(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function xs(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?Ns(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Ts(e,t){t||(t=e.reduce((e,t)=>e+t.length,0));const r=xs(t);let n=0;for(const t of e)r.set(t,n),n+=t.length;return Ns(r)}(()=>"function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex)()||cs(ws(4),ls("0123456789abcdef"),us(""),ds(e=>{if("string"!=typeof e||e.length%2!=0)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()}));const Os=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var p=s-i;p!==s&&0===o[p];)p++;for(var f=new Uint8Array(n+(s-p)),g=n;p!==s;)f[g++]=o[p++];return f}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*u+1>>>0,l=new Uint8Array(o);i!==s;){for(var h=t[i],d=0,p=o-1;(0!==h||d<n)&&-1!==p;p--,d++)h+=256*l[p]>>>0,l[p]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}for(var f=o-n;f!==o&&0===l[f];)f++;for(var g=c.repeat(r);f<o;++f)g+=e.charAt(l[f]);return g},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}},Ps=(new Uint8Array(0),e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")});class Rs{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Us{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Ms(this,e)}}class Bs{constructor(e){this.decoders=e}or(e){return Ms(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ms=(e,t)=>new Bs({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Ls{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new Rs(e,t,r),this.decoder=new Us(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ds=({name:e,prefix:t,encode:r,decode:n})=>new Ls(e,t,r,n),Ws=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=Os(r,t);return Ds({prefix:e,name:t,encode:n,decode:e=>Ps(i(e))})},js=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Ds({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let t=0;t<s;++t){const s=i[e[t]];if(void 0===s)throw new SyntaxError(`Non-${n} character`);c=c<<r|s,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),$s=Ds({prefix:"\0",name:"identity",encode:e=>{return t=e,(new TextDecoder).decode(t);var t},decode:e=>(e=>(new TextEncoder).encode(e))(e)}),zs=js({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),qs=js({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Fs=Ws({prefix:"9",name:"base10",alphabet:"0123456789"}),Hs=js({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ks=js({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Vs=js({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ys=js({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Gs=js({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Zs=js({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Js=js({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Xs=js({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Qs=js({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),eo=js({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),to=js({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),ro=Ws({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),no=Ws({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),io=Ws({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),so=Ws({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),oo=js({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ao=js({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),co=js({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),lo=js({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),uo=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),ho=uo.reduce((e,t,r)=>(e[r]=t,e),[]),po=uo.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]),fo=Ds({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+ho[t],"")},decode:function(e){const t=[];for(const r of e){const e=po[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var go=128,mo=-128,yo=Math.pow(2,31),wo=Math.pow(2,7),bo=Math.pow(2,14),vo=Math.pow(2,21),Eo=Math.pow(2,28),Ao=Math.pow(2,35),_o=Math.pow(2,42),Io=Math.pow(2,49),So=Math.pow(2,56),Co=Math.pow(2,63);const ko=function e(t,r,n){r=r||[];for(var i=n=n||0;t>=yo;)r[n++]=255&t|go,t/=128;for(;t&mo;)r[n++]=255&t|go,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},No=function(e){return e<wo?1:e<bo?2:e<vo?3:e<Eo?4:e<Ao?5:e<_o?6:e<Io?7:e<So?8:e<Co?9:10},xo=(e,t,r=0)=>(ko(e,t,r),t),To=e=>No(e),Oo=(e,t)=>{const r=t.byteLength,n=To(e),i=n+To(r),s=new Uint8Array(i+r);return xo(e,s,0),xo(r,s,n),s.set(t,i),new Po(e,r,t,s)};class Po{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const Ro=({name:e,code:t,encode:r})=>new Uo(e,t,r);class Uo{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Oo(this.code,t):t.then(e=>Oo(this.code,e))}throw Error("Unknown type, must be binary type")}}const Bo=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Mo=Ro({name:"sha2-256",code:18,encode:Bo("SHA-256")}),Lo=Ro({name:"sha2-512",code:19,encode:Bo("SHA-512")}),Do=Ps,Wo={code:0,name:"identity",encode:Do,digest:e=>Oo(0,Do(e))},jo="raw",$o=85,zo=e=>Ps(e),qo=e=>Ps(e),Fo=new TextEncoder,Ho=new TextDecoder,Ko="json",Vo=512,Yo=e=>Fo.encode(JSON.stringify(e)),Go=e=>JSON.parse(Ho.decode(e));Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"),Symbol.for("@ipld/js-cid/CID");const Zo={...n,...i,...s,...o,...a,...c,...l,...u,...h,...d};function Jo(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Xo=Jo("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>(new TextEncoder).encode(e.substring(1))),Qo=Jo("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{const t=xs((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),ea={utf8:Xo,"utf-8":Xo,hex:Zo.base16,latin1:Qo,ascii:Qo,binary:Qo,...Zo};function ta(e,t="utf8"){const r=ea[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Ns(globalThis.Buffer.from(e,"utf-8"))}function ra(e,t="utf8"){const r=ea[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(e).substring(1):globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8")}function na(e,t,r="string"){if(!e[t]||typeof e[t]!==r)throw new Error(`Missing or invalid "${t}" param`)}const ia={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var sa=r(2493),oa=r(8287).Buffer;function aa(e){const[t,r]=e.split(":");return{namespace:t,reference:r}}function ca(e,t){return e.includes(":")?[e]:t.chains||[]}var la=Object.defineProperty,ua=Object.defineProperties,ha=Object.getOwnPropertyDescriptors,da=Object.getOwnPropertySymbols,pa=Object.prototype.hasOwnProperty,fa=Object.prototype.propertyIsEnumerable,ga=(e,t,r)=>t in e?la(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ma=(e,t)=>{for(var r in t||(t={}))pa.call(t,r)&&ga(e,r,t[r]);if(da)for(var r of da(t))fa.call(t,r)&&ga(e,r,t[r]);return e},ya=(e,t,r)=>ga(e,"symbol"!=typeof t?t+"":t,r);const wa="react-native",ba="browser",va="js";function Ea(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Aa(){return!(0,Qn.getDocument)()&&!!(0,Qn.getNavigator)()&&"ReactNative"===navigator.product}function _a(){return!Ea()&&!!(0,Qn.getNavigator)()&&!!(0,Qn.getDocument)()}function Ia(){return Aa()?wa:Ea()?"node":_a()?ba:"unknown"}function Sa(){var e;try{return Aa()&&typeof r.g<"u"&&typeof(null==r.g?void 0:r.g.Application)<"u"?null==(e=r.g.Application)?void 0:e.applicationId:void 0}catch{return}}function Ca(){return(0,ei.g)()||{name:"",description:"",url:"",icons:[""]}}function ka(e,t,n){const i=function(){if(Ia()===wa&&typeof r.g<"u"&&typeof(null==r.g?void 0:r.g.Platform)<"u"){const{OS:e,Version:t}=r.g.Platform;return[e,t].join("-")}const e=t?Xn(t):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new Yn:"undefined"!=typeof navigator?Xn(navigator.userAgent):"undefined"!=typeof process&&process.version?new Hn(process.version.slice(1)):null;var t;if(null===e)return"unknown";const n=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[n,e.name,e.version].join("-"):[n,e.version].join("-")}(),s=function(){var e;const t=Ia();return t===ba?[t,(null==(e=(0,Qn.getLocation)())?void 0:e.host)||"unknown"].join(":"):t}();return[[e,t].join("-"),[va,n].join("-"),i,s].join("/")}function Na(e,t){return e.filter(e=>t.includes(e)).length===e.length}function xa(e){return Object.fromEntries(e.entries())}function Ta(e){return new Map(Object.entries(e))}function Oa(e=b.FIVE_MINUTES,t){const r=(0,b.toMiliseconds)(e||b.FIVE_MINUTES);let n,i,s,o;return{resolve:e=>{s&&n&&(clearTimeout(s),n(e),o=Promise.resolve(e))},reject:e=>{s&&i&&(clearTimeout(s),i(e))},done:()=>new Promise((e,a)=>{if(o)return e(o);s=setTimeout(()=>{const e=new Error(t);o=Promise.reject(e),a(e)},r),n=e,i=a})}}function Pa(e,t,r){return new Promise(async(n,i)=>{const s=setTimeout(()=>i(new Error(r)),t);try{n(await e)}catch(e){i(e)}clearTimeout(s)})}function Ra(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function Ua(e){const[t,r]=e.split(":"),n={id:void 0,topic:void 0};if("topic"===t&&"string"==typeof r)n.topic=r;else{if("id"!==t||!Number.isInteger(Number(r)))throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);n.id=Number(r)}return n}function Ba(e,t){return(0,b.fromMiliseconds)((t||Date.now())+(0,b.toMiliseconds)(e))}function Ma(e){return Date.now()>=(0,b.toMiliseconds)(e)}function La(e,t){return`${e}${t?`:${t}`:""}`}function Da(e=[],t=[]){return[...new Set([...e,...t])]}function Wa(e,t){if(!e.includes(t))return null;const r=e.split(/([&,?,=])/),n=r.indexOf(t);return r[n+2]}function ja(){return typeof crypto<"u"&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function $a(){return typeof process<"u"&&"true"===process.env.IS_VITEST}function za(e){return oa.from(e,"base64").toString("utf-8")}class qa{constructor({limit:e}){ya(this,"limit"),ya(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const e=this.set.values().next().value;e&&this.set.delete(e)}this.set.add(e)}}has(e){return this.set.has(e)}}const Fa=BigInt(2**32-1),Ha=BigInt(32);function Ka(e,t=!1){return t?{h:Number(e&Fa),l:Number(e>>Ha&Fa)}:{h:0|Number(e>>Ha&Fa),l:0|Number(e&Fa)}}function Va(e,t=!1){const r=e.length;let n=new Uint32Array(r),i=new Uint32Array(r);for(let s=0;s<r;s++){const{h:r,l:o}=Ka(e[s],t);[n[s],i[s]]=[r,o]}return[n,i]}const Ya=(e,t,r)=>e>>>r,Ga=(e,t,r)=>e<<32-r|t>>>r,Za=(e,t,r)=>e>>>r|t<<32-r,Ja=(e,t,r)=>e<<32-r|t>>>r,Xa=(e,t,r)=>e<<64-r|t>>>r-32,Qa=(e,t,r)=>e>>>r-32|t<<64-r,ec=(e,t)=>t,tc=(e,t)=>e;function rc(e,t,r,n){const i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:0|i}}const nc=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),ic=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,sc=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),oc=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0,ac=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0),cc=(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0,lc="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function uc(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function hc(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function dc(e,...t){if(!uc(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function pc(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.createHasher");hc(e.outputLen),hc(e.blockLen)}function fc(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function gc(e,t){dc(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function mc(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function yc(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function wc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function bc(e,t){return e<<32-t|e>>>t}const vc=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Ec(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}const Ac=vc?e=>e:e=>Ec(e),_c=vc?e=>e:function(e){for(let t=0;t<e.length;t++)e[t]=Ec(e[t]);return e},Ic="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,Sc=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Cc(e){if(dc(e),Ic)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=Sc[e[r]];return t}function kc(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function Nc(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);if(Ic)return Uint8Array.fromHex(e);const t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let t=0,i=0;t<r;t++,i+=2){const r=kc(e.charCodeAt(i)),s=kc(e.charCodeAt(i+1));if(void 0===r||void 0===s){const t=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+i)}n[t]=16*r+s}return n}function xc(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e)),dc(e),e}function Tc(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];dc(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}class Oc{}function Pc(e){const t=t=>e().update(xc(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function Rc(e=32){if(lc&&"function"==typeof lc.getRandomValues)return lc.getRandomValues(new Uint8Array(e));if(lc&&"function"==typeof lc.randomBytes)return Uint8Array.from(lc.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}const Uc=BigInt(0),Bc=BigInt(1),Mc=BigInt(2),Lc=BigInt(7),Dc=BigInt(256),Wc=BigInt(113),jc=[],$c=[],zc=[];for(let e=0,t=Bc,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],jc.push(2*(5*n+r)),$c.push((e+1)*(e+2)/2%64);let i=Uc;for(let e=0;e<7;e++)t=(t<<Bc^(t>>Lc)*Wc)%Dc,t&Mc&&(i^=Bc<<(Bc<<BigInt(e))-Bc);zc.push(i)}const qc=Va(zc,!0),Fc=qc[0],Hc=qc[1],Kc=(e,t,r)=>r>32?((e,t,r)=>t<<r-32|e>>>64-r)(e,t,r):((e,t,r)=>e<<r|t>>>32-r)(e,t,r),Vc=(e,t,r)=>r>32?((e,t,r)=>e<<r-32|t>>>64-r)(e,t,r):((e,t,r)=>t<<r|e>>>32-r)(e,t,r);class Yc extends Oc{constructor(e,t,r,n=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=n,this.rounds=i,hc(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=mc(this.state)}clone(){return this._cloneInto()}keccak(){_c(this.state32),function(e,t=24){const r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){const n=(t+8)%10,i=(t+2)%10,s=r[i],o=r[i+1],a=Kc(s,o,1)^r[n],c=Vc(s,o,1)^r[n+1];for(let r=0;r<50;r+=10)e[t+r]^=a,e[t+r+1]^=c}let t=e[2],i=e[3];for(let r=0;r<24;r++){const n=$c[r],s=Kc(t,i,n),o=Vc(t,i,n),a=jc[r];t=e[a],i=e[a+1],e[a]=s,e[a+1]=o}for(let t=0;t<50;t+=10){for(let n=0;n<10;n++)r[n]=e[t+n];for(let n=0;n<10;n++)e[t+n]^=~r[(n+2)%10]&r[(n+4)%10]}e[0]^=Fc[n],e[1]^=Hc[n]}yc(r)}(this.state32,this.rounds),_c(this.state32),this.posOut=0,this.pos=0}update(e){fc(this),dc(e=xc(e));const{blockLen:t,state:r}=this,n=e.length;for(let i=0;i<n;){const s=Math.min(t-this.pos,n-i);for(let t=0;t<s;t++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:n}=this;e[r]^=t,!!(128&t)&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){fc(this,!1),dc(e),this.finish();const t=this.state,{blockLen:r}=this;for(let n=0,i=e.length;n<i;){this.posOut>=r&&this.keccak();const s=Math.min(r-this.posOut,i-n);e.set(t.subarray(this.posOut,this.posOut+s),n),this.posOut+=s,n+=s}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return hc(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(gc(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,yc(this.state)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:n,rounds:i,enableXOF:s}=this;return e||(e=new Yc(t,r,n,s,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=n,e.enableXOF=s,e.destroyed=this.destroyed,e}}const Gc=Pc(()=>new Yc(136,1,32));function Zc(e,t,r){return e&t^~e&r}function Jc(e,t,r){return e&t^e&r^t&r}class Xc extends Oc{constructor(e,t,r,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=n,this.buffer=new Uint8Array(e),this.view=wc(this.buffer)}update(e){fc(this),dc(e=xc(e));const{view:t,buffer:r,blockLen:n}=this,i=e.length;for(let s=0;s<i;){const o=Math.min(n-this.pos,i-s);if(o===n){const t=wc(e);for(;n<=i-s;s+=n)this.process(t,s);continue}r.set(e.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===n&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){fc(this),gc(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:n,isLE:i}=this;let{pos:s}=this;t[s++]=128,yc(this.buffer.subarray(s)),this.padOffset>n-s&&(this.process(r,0),s=0);for(let e=s;e<n;e++)t[e]=0;(function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,l=n?0:4;e.setUint32(t+c,o,n),e.setUint32(t+l,a,n)})(r,n-8,BigInt(8*this.length),i),this.process(r,0);const o=wc(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)o.setUint32(4*e,l[e],i)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:s,pos:o}=this;return e.destroyed=s,e.finished=i,e.length=n,e.pos=o,n%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}const Qc=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),el=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),tl=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),rl=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),nl=new Uint32Array(64);class il extends Xc{constructor(e=32){super(64,e,8,!1),this.A=0|Qc[0],this.B=0|Qc[1],this.C=0|Qc[2],this.D=0|Qc[3],this.E=0|Qc[4],this.F=0|Qc[5],this.G=0|Qc[6],this.H=0|Qc[7]}get(){const{A:e,B:t,C:r,D:n,E:i,F:s,G:o,H:a}=this;return[e,t,r,n,i,s,o,a]}set(e,t,r,n,i,s,o,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|s,this.G=0|o,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)nl[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=nl[e-15],r=nl[e-2],n=bc(t,7)^bc(t,18)^t>>>3,i=bc(r,17)^bc(r,19)^r>>>10;nl[e]=i+nl[e-7]+n+nl[e-16]|0}let{A:r,B:n,C:i,D:s,E:o,F:a,G:c,H:l}=this;for(let e=0;e<64;e++){const t=l+(bc(o,6)^bc(o,11)^bc(o,25))+Zc(o,a,c)+rl[e]+nl[e]|0,u=(bc(r,2)^bc(r,13)^bc(r,22))+Jc(r,n,i)|0;l=c,c=a,a=o,o=s+t|0,s=i,i=n,n=r,r=t+u|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,s=s+this.D|0,o=o+this.E|0,a=a+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(r,n,i,s,o,a,c,l)}roundClean(){yc(nl)}destroy(){this.set(0,0,0,0,0,0,0,0),yc(this.buffer)}}const sl=Va(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),ol=sl[0],al=sl[1],cl=new Uint32Array(80),ll=new Uint32Array(80);class ul extends Xc{constructor(e=64){super(128,e,16,!1),this.Ah=0|tl[0],this.Al=0|tl[1],this.Bh=0|tl[2],this.Bl=0|tl[3],this.Ch=0|tl[4],this.Cl=0|tl[5],this.Dh=0|tl[6],this.Dl=0|tl[7],this.Eh=0|tl[8],this.El=0|tl[9],this.Fh=0|tl[10],this.Fl=0|tl[11],this.Gh=0|tl[12],this.Gl=0|tl[13],this.Hh=0|tl[14],this.Hl=0|tl[15]}get(){const{Ah:e,Al:t,Bh:r,Bl:n,Ch:i,Cl:s,Dh:o,Dl:a,Eh:c,El:l,Fh:u,Fl:h,Gh:d,Gl:p,Hh:f,Hl:g}=this;return[e,t,r,n,i,s,o,a,c,l,u,h,d,p,f,g]}set(e,t,r,n,i,s,o,a,c,l,u,h,d,p,f,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|s,this.Dh=0|o,this.Dl=0|a,this.Eh=0|c,this.El=0|l,this.Fh=0|u,this.Fl=0|h,this.Gh=0|d,this.Gl=0|p,this.Hh=0|f,this.Hl=0|g}process(e,t){for(let r=0;r<16;r++,t+=4)cl[r]=e.getUint32(t),ll[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|cl[e-15],r=0|ll[e-15],n=Za(t,r,1)^Za(t,r,8)^Ya(t,0,7),i=Ja(t,r,1)^Ja(t,r,8)^Ga(t,r,7),s=0|cl[e-2],o=0|ll[e-2],a=Za(s,o,19)^Xa(s,o,61)^Ya(s,0,6),c=Ja(s,o,19)^Qa(s,o,61)^Ga(s,o,6),l=sc(i,c,ll[e-7],ll[e-16]),u=oc(l,n,a,cl[e-7],cl[e-16]);cl[e]=0|u,ll[e]=0|l}let{Ah:r,Al:n,Bh:i,Bl:s,Ch:o,Cl:a,Dh:c,Dl:l,Eh:u,El:h,Fh:d,Fl:p,Gh:f,Gl:g,Hh:m,Hl:y}=this;for(let e=0;e<80;e++){const t=Za(u,h,14)^Za(u,h,18)^Xa(u,h,41),w=Ja(u,h,14)^Ja(u,h,18)^Qa(u,h,41),b=u&d^~u&f,v=ac(y,w,h&p^~h&g,al[e],ll[e]),E=cc(v,m,t,b,ol[e],cl[e]),A=0|v,_=Za(r,n,28)^Xa(r,n,34)^Xa(r,n,39),I=Ja(r,n,28)^Qa(r,n,34)^Qa(r,n,39),S=r&i^r&o^i&o,C=n&s^n&a^s&a;m=0|f,y=0|g,f=0|d,g=0|p,d=0|u,p=0|h,({h:u,l:h}=rc(0|c,0|l,0|E,0|A)),c=0|o,l=0|a,o=0|i,a=0|s,i=0|r,s=0|n;const k=nc(A,I,C);r=ic(k,E,_,S),n=0|k}({h:r,l:n}=rc(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:s}=rc(0|this.Bh,0|this.Bl,0|i,0|s)),({h:o,l:a}=rc(0|this.Ch,0|this.Cl,0|o,0|a)),({h:c,l}=rc(0|this.Dh,0|this.Dl,0|c,0|l)),({h:u,l:h}=rc(0|this.Eh,0|this.El,0|u,0|h)),({h:d,l:p}=rc(0|this.Fh,0|this.Fl,0|d,0|p)),({h:f,l:g}=rc(0|this.Gh,0|this.Gl,0|f,0|g)),({h:m,l:y}=rc(0|this.Hh,0|this.Hl,0|m,0|y)),this.set(r,n,i,s,o,a,c,l,u,h,d,p,f,g,m,y)}roundClean(){yc(cl,ll)}destroy(){yc(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class hl extends ul{constructor(){super(48),this.Ah=0|el[0],this.Al=0|el[1],this.Bh=0|el[2],this.Bl=0|el[3],this.Ch=0|el[4],this.Cl=0|el[5],this.Dh=0|el[6],this.Dl=0|el[7],this.Eh=0|el[8],this.El=0|el[9],this.Fh=0|el[10],this.Fl=0|el[11],this.Gh=0|el[12],this.Gl=0|el[13],this.Hh=0|el[14],this.Hl=0|el[15]}}const dl=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class pl extends ul{constructor(){super(32),this.Ah=0|dl[0],this.Al=0|dl[1],this.Bh=0|dl[2],this.Bl=0|dl[3],this.Ch=0|dl[4],this.Cl=0|dl[5],this.Dh=0|dl[6],this.Dl=0|dl[7],this.Eh=0|dl[8],this.El=0|dl[9],this.Fh=0|dl[10],this.Fl=0|dl[11],this.Gh=0|dl[12],this.Gl=0|dl[13],this.Hh=0|dl[14],this.Hl=0|dl[15]}}const fl=Pc(()=>new il),gl=Pc(()=>new ul),ml=Pc(()=>new hl),yl=Pc(()=>new pl),wl=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),bl=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),vl=new Uint32Array(32);function El(e,t,r,n,i,s){const o=i[s],a=i[s+1];let c=vl[2*e],l=vl[2*e+1],u=vl[2*t],h=vl[2*t+1],d=vl[2*r],p=vl[2*r+1],f=vl[2*n],g=vl[2*n+1],m=nc(c,u,o);l=ic(m,l,h,a),c=0|m,({Dh:g,Dl:f}={Dh:g^l,Dl:f^c}),({Dh:g,Dl:f}={Dh:ec(0,f),Dl:tc(g)}),({h:p,l:d}=rc(p,d,g,f)),({Bh:h,Bl:u}={Bh:h^p,Bl:u^d}),({Bh:h,Bl:u}={Bh:Za(h,u,24),Bl:Ja(h,u,24)}),vl[2*e]=c,vl[2*e+1]=l,vl[2*t]=u,vl[2*t+1]=h,vl[2*r]=d,vl[2*r+1]=p,vl[2*n]=f,vl[2*n+1]=g}function Al(e,t,r,n,i,s){const o=i[s],a=i[s+1];let c=vl[2*e],l=vl[2*e+1],u=vl[2*t],h=vl[2*t+1],d=vl[2*r],p=vl[2*r+1],f=vl[2*n],g=vl[2*n+1],m=nc(c,u,o);l=ic(m,l,h,a),c=0|m,({Dh:g,Dl:f}={Dh:g^l,Dl:f^c}),({Dh:g,Dl:f}={Dh:Za(g,f,16),Dl:Ja(g,f,16)}),({h:p,l:d}=rc(p,d,g,f)),({Bh:h,Bl:u}={Bh:h^p,Bl:u^d}),({Bh:h,Bl:u}={Bh:Xa(h,u,63),Bl:Qa(h,u,63)}),vl[2*e]=c,vl[2*e+1]=l,vl[2*t]=u,vl[2*t+1]=h,vl[2*r]=d,vl[2*r+1]=p,vl[2*n]=f,vl[2*n+1]=g}class _l extends Oc{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,hc(e),hc(t),this.blockLen=e,this.outputLen=t,this.buffer=new Uint8Array(e),this.buffer32=mc(this.buffer)}update(e){fc(this),dc(e=xc(e));const{blockLen:t,buffer:r,buffer32:n}=this,i=e.length,s=e.byteOffset,o=e.buffer;for(let a=0;a<i;){this.pos===t&&(_c(n),this.compress(n,0,!1),_c(n),this.pos=0);const c=Math.min(t-this.pos,i-a),l=s+a;if(c===t&&!(l%4)&&a+c<i){const e=new Uint32Array(o,l,Math.floor((i-a)/4));_c(e);for(let r=0;a+t<i;r+=n.length,a+=t)this.length+=t,this.compress(e,r,!1);_c(e);continue}r.set(e.subarray(a,a+c),this.pos),this.pos+=c,this.length+=c,a+=c}return this}digestInto(e){fc(this),gc(e,this);const{pos:t,buffer32:r}=this;this.finished=!0,yc(this.buffer.subarray(t)),_c(r),this.compress(r,0,!0),_c(r);const n=mc(e);this.get().forEach((e,t)=>n[t]=Ac(e))}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){const{buffer:t,length:r,finished:n,destroyed:i,outputLen:s,pos:o}=this;return e||(e=new this.constructor({dkLen:s})),e.set(...this.get()),e.buffer.set(t),e.destroyed=i,e.finished=n,e.length=r,e.pos=o,e.outputLen=s,e}clone(){return this._cloneInto()}}class Il extends _l{constructor(e={}){const t=void 0===e.dkLen?64:e.dkLen;super(128,t),this.v0l=0|bl[0],this.v0h=0|bl[1],this.v1l=0|bl[2],this.v1h=0|bl[3],this.v2l=0|bl[4],this.v2h=0|bl[5],this.v3l=0|bl[6],this.v3h=0|bl[7],this.v4l=0|bl[8],this.v4h=0|bl[9],this.v5l=0|bl[10],this.v5h=0|bl[11],this.v6l=0|bl[12],this.v6h=0|bl[13],this.v7l=0|bl[14],this.v7h=0|bl[15],function(e,t={},r,n,i){if(hc(r),e<0||e>r)throw new Error("outputLen bigger than keyLen");const{key:s,salt:o,personalization:a}=t;if(void 0!==s&&(s.length<1||s.length>r))throw new Error("key length must be undefined or 1.."+r);if(void 0!==o&&o.length!==n)throw new Error("salt must be undefined or "+n);if(void 0!==a&&a.length!==i)throw new Error("personalization must be undefined or "+i)}(t,e,64,16,16);let{key:r,personalization:n,salt:i}=e,s=0;if(void 0!==r&&(r=xc(r),s=r.length),this.v0l^=this.outputLen|s<<8|65536|1<<24,void 0!==i){i=xc(i);const e=mc(i);this.v4l^=Ac(e[0]),this.v4h^=Ac(e[1]),this.v5l^=Ac(e[2]),this.v5h^=Ac(e[3])}if(void 0!==n){n=xc(n);const e=mc(n);this.v6l^=Ac(e[0]),this.v6h^=Ac(e[1]),this.v7l^=Ac(e[2]),this.v7h^=Ac(e[3])}if(void 0!==r){const e=new Uint8Array(this.blockLen);e.set(r),this.update(e)}}get(){let{v0l:e,v0h:t,v1l:r,v1h:n,v2l:i,v2h:s,v3l:o,v3h:a,v4l:c,v4h:l,v5l:u,v5h:h,v6l:d,v6h:p,v7l:f,v7h:g}=this;return[e,t,r,n,i,s,o,a,c,l,u,h,d,p,f,g]}set(e,t,r,n,i,s,o,a,c,l,u,h,d,p,f,g){this.v0l=0|e,this.v0h=0|t,this.v1l=0|r,this.v1h=0|n,this.v2l=0|i,this.v2h=0|s,this.v3l=0|o,this.v3h=0|a,this.v4l=0|c,this.v4h=0|l,this.v5l=0|u,this.v5h=0|h,this.v6l=0|d,this.v6h=0|p,this.v7l=0|f,this.v7h=0|g}compress(e,t,r){this.get().forEach((e,t)=>vl[t]=e),vl.set(bl,16);let{h:n,l:i}=Ka(BigInt(this.length));vl[24]=bl[8]^i,vl[25]=bl[9]^n,r&&(vl[28]=~vl[28],vl[29]=~vl[29]);let s=0;const o=wl;for(let r=0;r<12;r++)El(0,4,8,12,e,t+2*o[s++]),Al(0,4,8,12,e,t+2*o[s++]),El(1,5,9,13,e,t+2*o[s++]),Al(1,5,9,13,e,t+2*o[s++]),El(2,6,10,14,e,t+2*o[s++]),Al(2,6,10,14,e,t+2*o[s++]),El(3,7,11,15,e,t+2*o[s++]),Al(3,7,11,15,e,t+2*o[s++]),El(0,5,10,15,e,t+2*o[s++]),Al(0,5,10,15,e,t+2*o[s++]),El(1,6,11,12,e,t+2*o[s++]),Al(1,6,11,12,e,t+2*o[s++]),El(2,7,8,13,e,t+2*o[s++]),Al(2,7,8,13,e,t+2*o[s++]),El(3,4,9,14,e,t+2*o[s++]),Al(3,4,9,14,e,t+2*o[s++]);this.v0l^=vl[0]^vl[16],this.v0h^=vl[1]^vl[17],this.v1l^=vl[2]^vl[18],this.v1h^=vl[3]^vl[19],this.v2l^=vl[4]^vl[20],this.v2h^=vl[5]^vl[21],this.v3l^=vl[6]^vl[22],this.v3h^=vl[7]^vl[23],this.v4l^=vl[8]^vl[24],this.v4h^=vl[9]^vl[25],this.v5l^=vl[10]^vl[26],this.v5h^=vl[11]^vl[27],this.v6l^=vl[12]^vl[28],this.v6h^=vl[13]^vl[29],this.v7l^=vl[14]^vl[30],this.v7h^=vl[15]^vl[31],yc(vl)}destroy(){this.destroyed=!0,yc(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Sl=function(e){const t=(t,r)=>e(r).update(xc(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}(e=>new Il(e));function Cl(e){const t=`Ethereum Signed Message:\n${e.length}`,r=(new TextEncoder).encode(t+e);return"0x"+oa.from(Gc(r)).toString("hex")}function kl(e){const t=new Uint8Array(oa.from(e,"base64")),r=Array.from("TransactionData::").map(e=>e.charCodeAt(0)),n=new Uint8Array(r.length+t.length);n.set(r),n.set(t,r.length);const i=Sl(n,{dkLen:32});return Ti.A.encode(i)}function Nl(e){const t=new Uint8Array(fl(function(e){if(e instanceof Uint8Array)return e;if(Array.isArray(e))return new Uint8Array(e);if("object"==typeof e&&null!=e&&e.data)return new Uint8Array(Object.values(e.data));if("object"==typeof e&&e)return new Uint8Array(Object.values(e));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}(e)));return Ti.A.encode(t)}function xl(e){const t=(r=oa.from(e,"base64"),new Xi(undefined).decode(r)).txn;var r;if(!t)throw new Error("Invalid signed transaction: missing 'txn' field");const n=(a=t,new Qi(void 0).encodeSharedRef(a)),i=oa.from("TX"),s=oa.concat([i,oa.from(n)]),o=yl(s);var a;return vs.encode(o).replace(/=+$/,"")}function Tl(e){const t=[];let r=BigInt(e);for(;r>=BigInt(128);)t.push(Number(r&BigInt(127)|BigInt(128))),r>>=BigInt(7);return t.push(Number(r)),oa.from(t)}function Ol(e){const t=oa.from(e.signed.bodyBytes,"base64"),r=oa.from(e.signed.authInfoBytes,"base64"),n=oa.from(e.signature.signature,"base64"),i=[];i.push(oa.from([10])),i.push(Tl(t.length)),i.push(t),i.push(oa.from([18])),i.push(Tl(r.length)),i.push(r),i.push(oa.from([26])),i.push(Tl(n.length)),i.push(n);const s=oa.concat(i),o=fl(s);return oa.from(o).toString("hex").toUpperCase()}var Pl=Object.defineProperty,Rl=Object.defineProperties,Ul=Object.getOwnPropertyDescriptors,Bl=Object.getOwnPropertySymbols,Ml=Object.prototype.hasOwnProperty,Ll=Object.prototype.propertyIsEnumerable,Dl=(e,t,r)=>t in e?Pl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const Wl=e=>e?.split(":"),jl=e=>{const t=e&&Wl(e);if(t)return t[2]+":"+t[3]},$l=e=>{const t=e&&Wl(e);if(t)return t.pop()};async function zl(e){const{cacao:t,projectId:r}=e,{s:n,p:i}=t,s=ql(i,i.iss),o=$l(i.iss);return await async function(e,t,r,n,i,s){switch(r.t){case"eip191":return await async function(e,t,r){return(await xi({hash:Cl(t),signature:r})).toLowerCase()===e.toLowerCase()}(e,t,r.s);case"eip1271":return await async function(e,t,r,n,i,s){const o=aa(n);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const o="0x1626ba7e",a="0000000000000000000000000000000000000000000000000000000000000040",c=r.substring(2),l=(c.length/2).toString(16).padStart(64,"0"),u=o+(t.startsWith("0x")?t:Cl(t)).substring(2)+a+l+c,h=await fetch(`${s||"https://rpc.walletconnect.org/v1"}/?chainId=${n}&projectId=${i}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:Date.now()+Math.floor(1e3*Math.random()),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:u},"latest"]})}),{result:d}=await h.json();return!!d&&d.slice(0,o.length).toLowerCase()===o.toLowerCase()}catch(e){return console.error("isValidEip1271Signature: ",e),!1}}(e,t,r.s,n,i,s);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}(o,s,n,jl(i.iss),r)}const ql=(e,t)=>{const r=`${e.domain} wants you to sign in with your Ethereum account:`,n=$l(t);if(!e.aud&&!e.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let i=e.statement||void 0;const s=`URI: ${e.aud||e.uri}`,o=`Version: ${e.version}`,a=`Chain ID: ${(e=>{const t=e&&Wl(e);if(t)return e.includes("did:pkh:")?t[3]:t[1]})(t)}`,c=`Nonce: ${e.nonce}`,l=`Issued At: ${e.iat}`,u=e.exp?`Expiration Time: ${e.exp}`:void 0,h=e.nbf?`Not Before: ${e.nbf}`:void 0,d=e.requestId?`Request ID: ${e.requestId}`:void 0,p=e.resources?`Resources:${e.resources.map(e=>`\n- ${e}`).join("")}`:void 0,f=Jl(e.resources);return f&&(i=function(e="",t){Fl(t);const r="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(r))return e;const n=[];let i=0;return Object.keys(t.att).forEach(e=>{const r=Object.keys(t.att[e]).map(e=>({ability:e.split("/")[0],action:e.split("/")[1]}));r.sort((e,t)=>e.action.localeCompare(t.action));const s={};r.forEach(e=>{s[e.ability]||(s[e.ability]=[]),s[e.ability].push(e.action)});const o=Object.keys(s).map(t=>(i++,`(${i}) '${t}': '${s[t].join("', '")}' for '${e}'.`));n.push(o.join(", ").replace(".,","."))}),`${e?e+" ":""}${r}${n.join(" ")}`}(i,Vl(f))),[r,n,"",i,"",s,o,a,c,l,u,h,d,p].filter(e=>null!=e).join("\n")};function Fl(e){if(!e)throw new Error("No recap provided, value is undefined");if(!e.att)throw new Error("No `att` property found");const t=Object.keys(e.att);if(null==t||!t.length)throw new Error("No resources found in `att` property");t.forEach(t=>{const r=e.att[t];if(Array.isArray(r))throw new Error(`Resource must be an object: ${t}`);if("object"!=typeof r)throw new Error(`Resource must be an object: ${t}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${t}`);Object.keys(r).forEach(e=>{const t=r[e];if(!Array.isArray(t))throw new Error(`Ability limits ${e} must be an array of objects, found: ${t}`);if(!t.length)throw new Error(`Value of ${e} is empty array, must be an array with objects`);t.forEach(t=>{if("object"!=typeof t)throw new Error(`Ability limits (${e}) must be an array of objects, found: ${t}`)})})})}function Hl(e,t,r={}){t=t?.sort((e,t)=>e.localeCompare(t));const n=t.map(t=>({[`${e}/${t}`]:[r]}));return Object.assign({},...n)}function Kl(e){return Fl(e),`urn:recap:${function(e){return oa.from(JSON.stringify(e)).toString("base64")}(e).replace(/=/g,"")}`}function Vl(e){const t=function(e){return JSON.parse(oa.from(e,"base64").toString("utf-8"))}(e.replace("urn:recap:",""));return Fl(t),t}function Yl(e,t){const r=function(e,t){Fl(e),Fl(t);const r=Object.keys(e.att).concat(Object.keys(t.att)).sort((e,t)=>e.localeCompare(t)),n={att:{}};return r.forEach(r=>{var i,s;Object.keys((null==(i=e.att)?void 0:i[r])||{}).concat(Object.keys((null==(s=t.att)?void 0:s[r])||{})).sort((e,t)=>e.localeCompare(t)).forEach(i=>{var s,o;n.att[r]=((e,t)=>Rl(e,Ul(t)))(((e,t)=>{for(var r in t||(t={}))Ml.call(t,r)&&Dl(e,r,t[r]);if(Bl)for(var r of Bl(t))Ll.call(t,r)&&Dl(e,r,t[r]);return e})({},n.att[r]),{[i]:(null==(s=e.att[r])?void 0:s[i])||(null==(o=t.att[r])?void 0:o[i])})})}),n}(Vl(e),Vl(t));return Kl(r)}function Gl(e){var t;const r=Vl(e);Fl(r);const n=null==(t=r.att)?void 0:t.eip155;return n?Object.keys(n).map(e=>e.split("/")[1]):[]}function Zl(e){const t=Vl(e);Fl(t);const r=[];return Object.values(t.att).forEach(e=>{Object.values(e).forEach(e=>{var t;null!=(t=e?.[0])&&t.chains&&r.push(e[0].chains)})}),[...new Set(r.flat())]}function Jl(e){if(!e)return;const t=e?.[e.length-1];return function(e){return e&&e.includes("urn:recap:")}(t)?t:void 0}function Xl(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function Ql(e){if("boolean"!=typeof e)throw new Error(`boolean expected, not ${e}`)}function eu(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function tu(e,...t){if(!Xl(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function ru(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function nu(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function iu(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}const su=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function ou(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e);else{if(!Xl(e))throw new Error("Uint8Array expected, got "+typeof e);e=lu(e)}return e}function au(e,t,r=!0){if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(r&&!function(e){return e.byteOffset%4==0}(t))throw new Error("invalid output, must be aligned");return t}function cu(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,l=n?0:4;e.setUint32(t+c,o,n),e.setUint32(t+l,a,n)}function lu(e){return Uint8Array.from(e)}const uu=e=>Uint8Array.from(e.split("").map(e=>e.charCodeAt(0))),hu=uu("expand 16-byte k"),du=uu("expand 32-byte k"),pu=nu(hu),fu=nu(du);function gu(e,t){return e<<t|e>>>32-t}function mu(e){return e.byteOffset%4==0}const yu=2**32-1,wu=new Uint32Array,bu=(e,t)=>255&e[t++]|(255&e[t++])<<8;class vu{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,tu(e=ou(e),32);const t=bu(e,0),r=bu(e,2),n=bu(e,4),i=bu(e,6),s=bu(e,8),o=bu(e,10),a=bu(e,12),c=bu(e,14);this.r[0]=8191&t,this.r[1]=8191&(t>>>13|r<<3),this.r[2]=7939&(r>>>10|n<<6),this.r[3]=8191&(n>>>7|i<<9),this.r[4]=255&(i>>>4|s<<12),this.r[5]=s>>>1&8190,this.r[6]=8191&(s>>>14|o<<2),this.r[7]=8065&(o>>>11|a<<5),this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127;for(let t=0;t<8;t++)this.pad[t]=bu(e,16+2*t)}process(e,t,r=!1){const n=r?0:2048,{h:i,r:s}=this,o=s[0],a=s[1],c=s[2],l=s[3],u=s[4],h=s[5],d=s[6],p=s[7],f=s[8],g=s[9],m=bu(e,t+0),y=bu(e,t+2),w=bu(e,t+4),b=bu(e,t+6),v=bu(e,t+8),E=bu(e,t+10),A=bu(e,t+12),_=bu(e,t+14);let I=i[0]+(8191&m),S=i[1]+(8191&(m>>>13|y<<3)),C=i[2]+(8191&(y>>>10|w<<6)),k=i[3]+(8191&(w>>>7|b<<9)),N=i[4]+(8191&(b>>>4|v<<12)),x=i[5]+(v>>>1&8191),T=i[6]+(8191&(v>>>14|E<<2)),O=i[7]+(8191&(E>>>11|A<<5)),P=i[8]+(8191&(A>>>8|_<<8)),R=i[9]+(_>>>5|n),U=0,B=U+I*o+S*(5*g)+C*(5*f)+k*(5*p)+N*(5*d);U=B>>>13,B&=8191,B+=x*(5*h)+T*(5*u)+O*(5*l)+P*(5*c)+R*(5*a),U+=B>>>13,B&=8191;let M=U+I*a+S*o+C*(5*g)+k*(5*f)+N*(5*p);U=M>>>13,M&=8191,M+=x*(5*d)+T*(5*h)+O*(5*u)+P*(5*l)+R*(5*c),U+=M>>>13,M&=8191;let L=U+I*c+S*a+C*o+k*(5*g)+N*(5*f);U=L>>>13,L&=8191,L+=x*(5*p)+T*(5*d)+O*(5*h)+P*(5*u)+R*(5*l),U+=L>>>13,L&=8191;let D=U+I*l+S*c+C*a+k*o+N*(5*g);U=D>>>13,D&=8191,D+=x*(5*f)+T*(5*p)+O*(5*d)+P*(5*h)+R*(5*u),U+=D>>>13,D&=8191;let W=U+I*u+S*l+C*c+k*a+N*o;U=W>>>13,W&=8191,W+=x*(5*g)+T*(5*f)+O*(5*p)+P*(5*d)+R*(5*h),U+=W>>>13,W&=8191;let j=U+I*h+S*u+C*l+k*c+N*a;U=j>>>13,j&=8191,j+=x*o+T*(5*g)+O*(5*f)+P*(5*p)+R*(5*d),U+=j>>>13,j&=8191;let $=U+I*d+S*h+C*u+k*l+N*c;U=$>>>13,$&=8191,$+=x*a+T*o+O*(5*g)+P*(5*f)+R*(5*p),U+=$>>>13,$&=8191;let z=U+I*p+S*d+C*h+k*u+N*l;U=z>>>13,z&=8191,z+=x*c+T*a+O*o+P*(5*g)+R*(5*f),U+=z>>>13,z&=8191;let q=U+I*f+S*p+C*d+k*h+N*u;U=q>>>13,q&=8191,q+=x*l+T*c+O*a+P*o+R*(5*g),U+=q>>>13,q&=8191;let F=U+I*g+S*f+C*p+k*d+N*h;U=F>>>13,F&=8191,F+=x*u+T*l+O*c+P*a+R*o,U+=F>>>13,F&=8191,U=(U<<2)+U|0,U=U+B|0,B=8191&U,U>>>=13,M+=U,i[0]=B,i[1]=M,i[2]=L,i[3]=D,i[4]=W,i[5]=j,i[6]=$,i[7]=z,i[8]=q,i[9]=F}finalize(){const{h:e,pad:t}=this,r=new Uint16Array(10);let n=e[1]>>>13;e[1]&=8191;for(let t=2;t<10;t++)e[t]+=n,n=e[t]>>>13,e[t]&=8191;e[0]+=5*n,n=e[0]>>>13,e[0]&=8191,e[1]+=n,n=e[1]>>>13,e[1]&=8191,e[2]+=n,r[0]=e[0]+5,n=r[0]>>>13,r[0]&=8191;for(let t=1;t<10;t++)r[t]=e[t]+n,n=r[t]>>>13,r[t]&=8191;r[9]-=8192;let i=(1^n)-1;for(let e=0;e<10;e++)r[e]&=i;i=~i;for(let t=0;t<10;t++)e[t]=e[t]&i|r[t];e[0]=65535&(e[0]|e[1]<<13),e[1]=65535&(e[1]>>>3|e[2]<<10),e[2]=65535&(e[2]>>>6|e[3]<<7),e[3]=65535&(e[3]>>>9|e[4]<<4),e[4]=65535&(e[4]>>>12|e[5]<<1|e[6]<<14),e[5]=65535&(e[6]>>>2|e[7]<<11),e[6]=65535&(e[7]>>>5|e[8]<<8),e[7]=65535&(e[8]>>>8|e[9]<<5);let s=e[0]+t[0];e[0]=65535&s;for(let r=1;r<8;r++)s=(e[r]+t[r]|0)+(s>>>16)|0,e[r]=65535&s;iu(r)}update(e){ru(this),tu(e=ou(e));const{buffer:t,blockLen:r}=this,n=e.length;for(let i=0;i<n;){const s=Math.min(r-this.pos,n-i);if(s!==r)t.set(e.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(t,0,!1),this.pos=0);else for(;r<=n-i;i+=r)this.process(e,i)}return this}destroy(){iu(this.h,this.r,this.buffer,this.pad)}digestInto(e){ru(this),function(e,t){tu(e);const r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;const{buffer:t,h:r}=this;let{pos:n}=this;if(n){for(t[n++]=1;n<16;n++)t[n]=0;this.process(t,0,!0)}this.finalize();let i=0;for(let t=0;t<8;t++)e[i++]=r[t]>>>0,e[i++]=r[t]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}}const Eu=function(e){const t=(t,r)=>e(r).update(ou(t)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}(e=>new vu(e)),Au=function(e){const{allowShortKeys:t,extendNonceFn:r,counterLength:n,counterRight:i,rounds:s}=function(e,t){if(null==t||"object"!=typeof t)throw new Error("options must be defined");return Object.assign({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t)}(0,{counterRight:!1,counterLength:4,allowShortKeys:!1});return eu(n),eu(s),Ql(i),Ql(t),(o,a,c,l,u=0)=>{tu(o),tu(a),tu(c);const h=c.length;if(void 0===l&&(l=new Uint8Array(h)),tu(l),eu(u),u<0||u>=yu)throw new Error("arx: counter overflow");if(l.length<h)throw new Error(`arx: output (${l.length}) is shorter than data (${h})`);const d=[];let p,f,g=o.length;if(32===g)d.push(p=lu(o)),f=fu;else{if(16!==g||!t)throw new Error(`arx: invalid 32-byte key, got length=${g}`);p=new Uint8Array(32),p.set(o),p.set(o,16),f=pu,d.push(p)}mu(a)||d.push(a=lu(a));const m=nu(p);if(r){if(24!==a.length)throw new Error("arx: extended nonce must be 24 bytes");r(f,m,nu(a.subarray(0,16)),m),a=a.subarray(16)}const y=16-n;if(y!==a.length)throw new Error(`arx: nonce must be ${y} or 16 bytes`);if(12!==y){const e=new Uint8Array(12);e.set(a,i?0:12-a.length),a=e,d.push(a)}const w=nu(a);return function(e,t,r,n,i,s,o,a){const c=i.length,l=new Uint8Array(64),u=nu(l),h=mu(i)&&mu(s),d=h?nu(i):wu,p=h?nu(s):wu;for(let f=0;f<c;o++){if(e(t,r,n,u,o,a),o>=yu)throw new Error("arx: counter overflow");const g=Math.min(64,c-f);if(h&&64===g){const e=f/4;if(f%4!=0)throw new Error("arx: invalid block position");for(let t,r=0;r<16;r++)t=e+r,p[t]=d[t]^u[r];f+=64;continue}for(let e,t=0;t<g;t++)e=f+t,s[e]=i[e]^l[t];f+=g}}(e,f,m,w,c,l,u,s),iu(...d),l}}(function(e,t,r,n,i,s=20){let o=e[0],a=e[1],c=e[2],l=e[3],u=t[0],h=t[1],d=t[2],p=t[3],f=t[4],g=t[5],m=t[6],y=t[7],w=i,b=r[0],v=r[1],E=r[2],A=o,_=a,I=c,S=l,C=u,k=h,N=d,x=p,T=f,O=g,P=m,R=y,U=w,B=b,M=v,L=E;for(let e=0;e<s;e+=2)A=A+C|0,U=gu(U^A,16),T=T+U|0,C=gu(C^T,12),A=A+C|0,U=gu(U^A,8),T=T+U|0,C=gu(C^T,7),_=_+k|0,B=gu(B^_,16),O=O+B|0,k=gu(k^O,12),_=_+k|0,B=gu(B^_,8),O=O+B|0,k=gu(k^O,7),I=I+N|0,M=gu(M^I,16),P=P+M|0,N=gu(N^P,12),I=I+N|0,M=gu(M^I,8),P=P+M|0,N=gu(N^P,7),S=S+x|0,L=gu(L^S,16),R=R+L|0,x=gu(x^R,12),S=S+x|0,L=gu(L^S,8),R=R+L|0,x=gu(x^R,7),A=A+k|0,L=gu(L^A,16),P=P+L|0,k=gu(k^P,12),A=A+k|0,L=gu(L^A,8),P=P+L|0,k=gu(k^P,7),_=_+N|0,U=gu(U^_,16),R=R+U|0,N=gu(N^R,12),_=_+N|0,U=gu(U^_,8),R=R+U|0,N=gu(N^R,7),I=I+x|0,B=gu(B^I,16),T=T+B|0,x=gu(x^T,12),I=I+x|0,B=gu(B^I,8),T=T+B|0,x=gu(x^T,7),S=S+C|0,M=gu(M^S,16),O=O+M|0,C=gu(C^O,12),S=S+C|0,M=gu(M^S,8),O=O+M|0,C=gu(C^O,7);let D=0;n[D++]=o+A|0,n[D++]=a+_|0,n[D++]=c+I|0,n[D++]=l+S|0,n[D++]=u+C|0,n[D++]=h+k|0,n[D++]=d+N|0,n[D++]=p+x|0,n[D++]=f+T|0,n[D++]=g+O|0,n[D++]=m+P|0,n[D++]=y+R|0,n[D++]=w+U|0,n[D++]=b+B|0,n[D++]=v+M|0,n[D++]=E+L|0}),_u=new Uint8Array(16),Iu=(e,t)=>{e.update(t);const r=t.length%16;r&&e.update(_u.subarray(r))},Su=new Uint8Array(32);function Cu(e,t,r,n,i){const s=e(t,r,Su),o=Eu.create(s);i&&Iu(o,i),Iu(o,n);const a=function(e,t,r){Ql(r);const n=new Uint8Array(16),i=function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}(n);return cu(i,0,BigInt(t),r),cu(i,8,BigInt(e),r),n}(n.length,i?i.length:0,!0);o.update(a);const c=o.digest();return iu(s,a),c}const ku=((e,t)=>{function r(r,...n){if(tu(r),!su)throw new Error("Non little-endian hardware is not yet supported");if(void 0!==e.nonceLength){const t=n[0];if(!t)throw new Error("nonce / iv required");e.varSizeNonce?tu(t):tu(t,e.nonceLength)}const i=e.tagLength;i&&void 0!==n[1]&&tu(n[1]);const s=t(r,...n),o=(e,t)=>{if(void 0!==t){if(2!==e)throw new Error("cipher output not supported");tu(t)}};let a=!1;return{encrypt(e,t){if(a)throw new Error("cannot encrypt() twice with same key + nonce");return a=!0,tu(e),o(s.encrypt.length,t),s.encrypt(e,t)},decrypt(e,t){if(tu(e),i&&e.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return o(s.decrypt.length,t),s.decrypt(e,t)}}}return Object.assign(r,e),r})({blockSize:64,nonceLength:12,tagLength:16},(Nu=Au,(e,t,r)=>({encrypt(n,i){const s=n.length;(i=au(s+16,i,!1)).set(n);const o=i.subarray(0,-16);Nu(e,t,o,o,1);const a=Cu(Nu,e,t,o,r);return i.set(a,s),iu(a),i},decrypt(n,i){i=au(n.length-16,i,!1);const s=n.subarray(0,-16),o=n.subarray(-16),a=Cu(Nu,e,t,s,r);if(!function(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}(o,a))throw new Error("invalid tag");return i.set(n.subarray(0,-16)),Nu(e,t,i,i,1),iu(a),i}})));var Nu;class xu extends Oc{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,pc(e);const r=xc(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?e.create().update(r).digest():r);for(let e=0;e<i.length;e++)i[e]^=54;this.iHash.update(i),this.oHash=e.create();for(let e=0;e<i.length;e++)i[e]^=106;this.oHash.update(i),yc(i)}update(e){return fc(this),this.iHash.update(e),this}digestInto(e){fc(this),dc(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:r,finished:n,destroyed:i,blockLen:s,outputLen:o}=this;return e.finished=n,e.destroyed=i,e.blockLen=s,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Tu=(e,t,r)=>new xu(e,t).update(r).digest();Tu.create=(e,t)=>new xu(e,t);const Ou=Uint8Array.from([0]),Pu=Uint8Array.of(),Ru=fl,Uu=BigInt(0),Bu=BigInt(1);function Mu(e,t){if("boolean"!=typeof t)throw new Error(e+" boolean expected, got "+t)}function Lu(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function Du(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?Uu:BigInt("0x"+e)}function Wu(e){return Du(Cc(e))}function ju(e){return dc(e),Du(Cc(Uint8Array.from(e).reverse()))}function $u(e,t){return Nc(e.toString(16).padStart(2*t,"0"))}function zu(e,t){return $u(e,t).reverse()}function qu(e,t,r){let n;if("string"==typeof t)try{n=Nc(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!uc(t))throw new Error(e+" must be hex string or Uint8Array");n=Uint8Array.from(t)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(e+" of length "+r+" expected, got "+i);return n}const Fu=e=>"bigint"==typeof e&&Uu<=e;function Hu(e,t,r,n){if(!function(e,t,r){return Fu(e)&&Fu(t)&&Fu(r)&&t<=e&&e<r}(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}const Ku=e=>(Bu<<BigInt(e))-Bu;function Vu(e,t,r={}){if(!e||"object"!=typeof e)throw new Error("expected valid options object");function n(t,r,n){const i=e[t];if(n&&void 0===i)return;const s=typeof i;if(s!==r||null===i)throw new Error(`param "${t}" is invalid: expected ${r}, got ${s}`)}Object.entries(t).forEach(([e,t])=>n(e,t,!1)),Object.entries(r).forEach(([e,t])=>n(e,t,!0))}function Yu(e){const t=new WeakMap;return(r,...n)=>{const i=t.get(r);if(void 0!==i)return i;const s=e(r,...n);return t.set(r,s),s}}const Gu=BigInt(0),Zu=BigInt(1),Ju=BigInt(2),Xu=BigInt(3),Qu=BigInt(4),eh=BigInt(5),th=BigInt(8);function rh(e,t){const r=e%t;return r>=Gu?r:t+r}function nh(e,t,r){let n=e;for(;t-- >Gu;)n*=n,n%=r;return n}function ih(e,t){if(e===Gu)throw new Error("invert: expected non-zero number");if(t<=Gu)throw new Error("invert: expected positive modulus, got "+t);let r=rh(e,t),n=t,i=Gu,s=Zu;for(;r!==Gu;){const e=n%r,t=i-s*(n/r);n=r,r=e,i=s,s=t}if(n!==Zu)throw new Error("invert: does not exist");return rh(i,t)}function sh(e,t){const r=(e.ORDER+Zu)/Qu,n=e.pow(t,r);if(!e.eql(e.sqr(n),t))throw new Error("Cannot find square root");return n}function oh(e,t){const r=(e.ORDER-eh)/th,n=e.mul(t,Ju),i=e.pow(n,r),s=e.mul(t,i),o=e.mul(e.mul(s,Ju),i),a=e.mul(s,e.sub(o,e.ONE));if(!e.eql(e.sqr(a),t))throw new Error("Cannot find square root");return a}const ah=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ch(e,t,r=!1){const n=new Array(t.length).fill(r?e.ZERO:void 0),i=t.reduce((t,r,i)=>e.is0(r)?t:(n[i]=t,e.mul(t,r)),e.ONE),s=e.inv(i);return t.reduceRight((t,r,i)=>e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r)),s),n}function lh(e,t){const r=(e.ORDER-Zu)/Ju,n=e.pow(t,r),i=e.eql(n,e.ONE),s=e.eql(n,e.ZERO),o=e.eql(n,e.neg(e.ONE));if(!i&&!s&&!o)throw new Error("invalid Legendre symbol result");return i?1:s?0:-1}function uh(e,t,r=!1,n={}){if(e<=Gu)throw new Error("invalid field: expected ORDER > 0, got "+e);let i,s;if("object"==typeof t&&null!=t){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");const e=t;e.BITS&&(i=e.BITS),e.sqrt&&(s=e.sqrt),"boolean"==typeof e.isLE&&(r=e.isLE)}else"number"==typeof t&&(i=t),n.sqrt&&(s=n.sqrt);const{nBitLength:o,nByteLength:a}=function(e,t){void 0!==t&&hc(t);const r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}(e,i);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c;const l=Object.freeze({ORDER:e,isLE:r,BITS:o,BYTES:a,MASK:Ku(o),ZERO:Gu,ONE:Zu,create:t=>rh(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return Gu<=t&&t<e},is0:e=>e===Gu,isValidNot0:e=>!l.is0(e)&&l.isValid(e),isOdd:e=>(e&Zu)===Zu,neg:t=>rh(-t,e),eql:(e,t)=>e===t,sqr:t=>rh(t*t,e),add:(t,r)=>rh(t+r,e),sub:(t,r)=>rh(t-r,e),mul:(t,r)=>rh(t*r,e),pow:(e,t)=>function(e,t,r){if(r<Gu)throw new Error("invalid exponent, negatives unsupported");if(r===Gu)return e.ONE;if(r===Zu)return t;let n=e.ONE,i=t;for(;r>Gu;)r&Zu&&(n=e.mul(n,i)),i=e.sqr(i),r>>=Zu;return n}(l,e,t),div:(t,r)=>rh(t*ih(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>ih(t,e),sqrt:s||(t=>(c||(c=function(e){return e%Qu===Xu?sh:e%th===eh?oh:function(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let t=e-Zu,r=0;for(;t%Ju===Gu;)t/=Ju,r++;let n=Ju;const i=uh(e);for(;1===lh(i,n);)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===r)return sh;let s=i.pow(n,t);const o=(t+Zu)/Ju;return function(e,n){if(e.is0(n))return n;if(1!==lh(e,n))throw new Error("Cannot find square root");let i=r,a=e.mul(e.ONE,s),c=e.pow(n,t),l=e.pow(n,o);for(;!e.eql(c,e.ONE);){if(e.is0(c))return e.ZERO;let t=1,r=e.sqr(c);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===i)throw new Error("Cannot find square root");const n=Zu<<BigInt(i-t-1),s=e.pow(a,n);i=t,a=e.sqr(s),c=e.mul(c,a),l=e.mul(l,s)}return l}}(e)}(e)),c(l,t))),toBytes:e=>r?zu(e,a):$u(e,a),fromBytes:e=>{if(e.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+e.length);return r?ju(e):Wu(e)},invertBatch:e=>ch(l,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(l)}function hh(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function dh(e){const t=hh(e);return t+Math.ceil(t/2)}const ph=BigInt(0),fh=BigInt(1);function gh(e,t){const r=t.negate();return e?r:t}function mh(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function yh(e,t){mh(e,t);const r=2**e;return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1),mask:Ku(e),maxNumber:r,shiftBy:BigInt(e)}}function wh(e,t,r){const{windowSize:n,mask:i,maxNumber:s,shiftBy:o}=r;let a=Number(e&i),c=e>>o;a>n&&(a-=s,c+=fh);const l=t*n;return{nextN:c,offset:l+Math.abs(a)-1,isZero:0===a,isNeg:a<0,isNegF:t%2!=0,offsetF:l}}const bh=new WeakMap,vh=new WeakMap;function Eh(e){return vh.get(e)||1}function Ah(e){if(e!==ph)throw new Error("invalid wNAF")}function _h(e,t){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return function(e){Vu(e,ah.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"}))}(t),t}return uh(e)}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const Ih=BigInt(0),Sh=BigInt(1),Ch=BigInt(2);BigInt(0);const kh=BigInt(1),Nh=BigInt(2),xh=BigInt(3),Th=BigInt(5),Oh=BigInt(8),Ph={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:Oh,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function Rh(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}const Uh=(()=>{const e=Ph.p;return function(e){const t=function(e){return Vu(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})}(e),{P:r,type:n,adjustScalarBytes:i,powPminus2:s,randomBytes:o}=t,a="x25519"===n;if(!a&&"x448"!==n)throw new Error("invalid type");const c=o||Rc,l=a?255:448,u=a?32:56,h=BigInt(a?9:5),d=BigInt(a?121665:39081),p=a?Ch**BigInt(254):Ch**BigInt(447),f=a?BigInt(8)*Ch**BigInt(251)-Sh:BigInt(4)*Ch**BigInt(445)-Sh,g=p+f+Sh,m=e=>rh(e,r),y=w(h);function w(e){return zu(m(e),u)}function b(e,t){const n=function(e,t){Hu("u",e,Ih,r),Hu("scalar",t,p,g);const n=t,i=e;let o=Sh,a=Ih,c=e,u=Sh,h=Ih;for(let e=BigInt(l-1);e>=Ih;e--){const t=n>>e&Sh;h^=t,({x_2:o,x_3:c}=E(h,o,c)),({x_2:a,x_3:u}=E(h,a,u)),h=t;const r=o+a,s=m(r*r),l=o-a,p=m(l*l),f=s-p,g=c+u,y=m((c-u)*r),w=m(g*l),b=y+w,v=y-w;c=m(b*b),u=m(i*m(v*v)),o=m(s*p),a=m(f*(s+m(d*f)))}({x_2:o,x_3:c}=E(h,o,c)),({x_2:a,x_3:u}=E(h,a,u));const f=s(a);return m(o*f)}(function(e){const t=qu("u coordinate",e,u);return a&&(t[31]&=127),m(ju(t))}(t),function(e){return ju(i(qu("scalar",e,u)))}(e));if(n===Ih)throw new Error("invalid private or public key received");return w(n)}function v(e){return b(e,y)}function E(e,t,r){const n=m(e*(t-r));return{x_2:t=m(t-n),x_3:r=m(r+n)}}return{scalarMult:b,scalarMultBase:v,getSharedSecret:(e,t)=>b(e,t),getPublicKey:e=>v(e),utils:{randomPrivateKey:()=>c(u)},GuBytes:y.slice()}}({P:e,type:"x25519",powPminus2:t=>{const{pow_p_5_8:r,b2:n}=function(e){const t=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=Ph.p,o=e*e%s*e%s,a=nh(o,Nh,s)*o%s,c=nh(a,kh,s)*e%s,l=nh(c,Th,s)*c%s,u=nh(l,t,s)*l%s,h=nh(u,r,s)*u%s,d=nh(h,n,s)*h%s,p=nh(d,i,s)*d%s,f=nh(p,i,s)*d%s,g=nh(f,t,s)*l%s;return{pow_p_5_8:nh(g,Nh,s)*e%s,b2:o}}(t);return rh(nh(r,xh,e)*n,e)},adjustScalarBytes:Rh})})();function Bh(e){void 0!==e.lowS&&Mu("lowS",e.lowS),void 0!==e.prehash&&Mu("prehash",e.prehash)}class Mh extends Error{constructor(e=""){super(e)}}const Lh={Err:Mh,_tlv:{encode:(e,t)=>{const{Err:r}=Lh;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");const n=t.length/2,i=Lu(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const s=n>127?Lu(i.length/2|128):"";return Lu(e)+s+i+t},decode(e,t){const{Err:r}=Lh;let n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");const i=t[n++];let s=0;if(128&i){const e=127&i;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");const o=t.subarray(n,n+e);if(o.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===o[0])throw new r("tlv.decode(long): zero leftmost byte");for(const e of o)s=s<<8|e;if(n+=e,s<128)throw new r("tlv.decode(long): not minimal encoding")}else s=i;const o=t.subarray(n,n+s);if(o.length!==s)throw new r("tlv.decode: wrong value length");return{v:o,l:t.subarray(n+s)}}},_int:{encode(e){const{Err:t}=Lh;if(e<Dh)throw new t("integer: negative integers are not allowed");let r=Lu(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){const{Err:t}=Lh;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return Wu(e)}},toSig(e){const{Err:t,_int:r,_tlv:n}=Lh,i=qu("signature",e),{v:s,l:o}=n.decode(48,i);if(o.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,s),{v:l,l:u}=n.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(e){const{_tlv:t,_int:r}=Lh,n=t.encode(2,r.encode(e.r))+t.encode(2,r.encode(e.s));return t.encode(48,n)}},Dh=BigInt(0),Wh=BigInt(1),jh=BigInt(2),$h=BigInt(3),zh=BigInt(4);function qh(e,t,r){const{BYTES:n}=e;return function(i){let s;if("bigint"==typeof i)s=i;else{let r=qu("private key",i);if(t){if(!t.includes(2*r.length))throw new Error("invalid private key");const e=new Uint8Array(n);e.set(r,e.length-r.length),r=e}try{s=e.fromBytes(r)}catch{throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof i}`)}}if(r&&(s=e.create(s)),!e.isValidNot0(s))throw new Error("invalid private key: out of range [1..N-1]");return s}}function Fh(e,t={}){const{Fp:r,Fn:n}=function(e,t,r={}){if(!t||"object"!=typeof t)throw new Error(`expected valid ${e} CURVE object`);for(const e of["p","n","h"]){const r=t[e];if(!("bigint"==typeof r&&r>ph))throw new Error(`CURVE.${e} must be positive bigint`)}const n=_h(t.p,r.Fp),i=_h(t.n,r.Fn),s=["Gx","Gy","a","weierstrass"===e?"b":"d"];for(const e of s)if(!n.isValid(t[e]))throw new Error(`CURVE.${e} must be valid field element of CURVE.Fp`);return{Fp:n,Fn:i}}("weierstrass",e,t),{h:i,n:s}=e;Vu(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:o}=t;if(o&&(!r.is0(e.a)||"bigint"!=typeof o.beta||"function"!=typeof o.splitScalar))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}const c=t.toBytes||function(e,t,n){const{x:i,y:s}=t.toAffine(),o=r.toBytes(i);return Mu("isCompressed",n),n?(a(),Tc(Hh(!r.isOdd(s)),o)):Tc(Uint8Array.of(4),o,r.toBytes(s))},l=t.fromBytes||function(e){dc(e);const t=r.BYTES,n=t+1,i=2*t+1,s=e.length,o=e[0],c=e.subarray(1);if(s!==n||2!==o&&3!==o){if(s===i&&4===o){const e=r.fromBytes(c.subarray(0*t,1*t)),n=r.fromBytes(c.subarray(1*t,2*t));if(!h(e,n))throw new Error("bad point: is not on curve");return{x:e,y:n}}throw new Error(`bad point: got length ${s}, expected compressed=${n} or uncompressed=${i}`)}{const e=r.fromBytes(c);if(!r.isValid(e))throw new Error("bad point: is not on curve, wrong x");const t=u(e);let n;try{n=r.sqrt(t)}catch(e){const t=e instanceof Error?": "+e.message:"";throw new Error("bad point: is not on curve, sqrt error"+t)}return a(),!(1&~o)!==r.isOdd(n)&&(n=r.neg(n)),{x:e,y:n}}},u=function(e,t,r){return function(n){const i=e.sqr(n),s=e.mul(i,n);return e.add(e.add(s,e.mul(n,t)),r)}}(r,e.a,e.b);function h(e,t){const n=r.sqr(t),i=u(e);return r.eql(n,i)}if(!h(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const d=r.mul(r.pow(e.a,$h),zh),p=r.mul(r.sqr(e.b),BigInt(27));if(r.is0(r.add(d,p)))throw new Error("bad curve params: a or b");function f(e,t,n=!1){if(!r.isValid(t)||n&&r.is0(t))throw new Error(`bad point coordinate ${e}`);return t}function g(e){if(!(e instanceof b))throw new Error("ProjectivePoint expected")}const m=Yu((e,t)=>{const{px:n,py:i,pz:s}=e;if(r.eql(s,r.ONE))return{x:n,y:i};const o=e.is0();null==t&&(t=o?r.ONE:r.inv(s));const a=r.mul(n,t),c=r.mul(i,t),l=r.mul(s,t);if(o)return{x:r.ZERO,y:r.ZERO};if(!r.eql(l,r.ONE))throw new Error("invZ was invalid");return{x:a,y:c}}),y=Yu(e=>{if(e.is0()){if(t.allowInfinityPoint&&!r.is0(e.py))return;throw new Error("bad point: ZERO")}const{x:n,y:i}=e.toAffine();if(!r.isValid(n)||!r.isValid(i))throw new Error("bad point: x or y not field elements");if(!h(n,i))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function w(e,t,n,i,s){return n=new b(r.mul(n.px,e),n.py,n.pz),t=gh(i,t),n=gh(s,n),t.add(n)}class b{constructor(e,t,r){this.px=f("x",e),this.py=f("y",t,!0),this.pz=f("z",r),Object.freeze(this)}static fromAffine(e){const{x:t,y:n}=e||{};if(!e||!r.isValid(t)||!r.isValid(n))throw new Error("invalid affine point");if(e instanceof b)throw new Error("projective point not allowed");return r.is0(t)&&r.is0(n)?b.ZERO:new b(t,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){return function(e,t,r){const n=e=>e.pz,i=ch(e.Fp,r.map(n));return r.map((e,t)=>e.toAffine(i[t])).map(e.fromAffine)}(b,0,e)}static fromBytes(e){return dc(e),b.fromHex(e)}static fromHex(e){const t=b.fromAffine(l(qu("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){const r=qh(n,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return b.BASE.multiply(r(e))}static msm(e,t){return function(e,t,r,n){(function(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw new Error("invalid point at index "+r)})})(r,e),function(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+r)})}(n,t);const i=r.length,s=n.length;if(i!==s)throw new Error("arrays of points and scalars must have equal length");const o=e.ZERO,a=function(e){let t;for(t=0;e>Uu;e>>=Bu,t+=1);return t}(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=Ku(c),u=new Array(Number(l)+1).fill(o);let h=o;for(let e=Math.floor((t.BITS-1)/c)*c;e>=0;e-=c){u.fill(o);for(let t=0;t<s;t++){const i=n[t],s=Number(i>>BigInt(e)&l);u[s]=u[s].add(r[t])}let t=o;for(let e=u.length-1,r=o;e>0;e--)r=r.add(u[e]),t=t.add(r);if(h=h.add(t),0!==e)for(let e=0;e<c;e++)h=h.double()}return h}(b,n,e,t)}precompute(e=8,t=!0){return E.setWindowSize(this,e),t||this.multiply($h),this}_setWindowSize(e){this.precompute(e)}assertValidity(){y(this)}hasEvenY(){const{y:e}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(e)}equals(e){g(e);const{px:t,py:n,pz:i}=this,{px:s,py:o,pz:a}=e,c=r.eql(r.mul(t,a),r.mul(s,i)),l=r.eql(r.mul(n,a),r.mul(o,i));return c&&l}negate(){return new b(this.px,r.neg(this.py),this.pz)}double(){const{a:t,b:n}=e,i=r.mul(n,$h),{px:s,py:o,pz:a}=this;let c=r.ZERO,l=r.ZERO,u=r.ZERO,h=r.mul(s,s),d=r.mul(o,o),p=r.mul(a,a),f=r.mul(s,o);return f=r.add(f,f),u=r.mul(s,a),u=r.add(u,u),c=r.mul(t,u),l=r.mul(i,p),l=r.add(c,l),c=r.sub(d,l),l=r.add(d,l),l=r.mul(c,l),c=r.mul(f,c),u=r.mul(i,u),p=r.mul(t,p),f=r.sub(h,p),f=r.mul(t,f),f=r.add(f,u),u=r.add(h,h),h=r.add(u,h),h=r.add(h,p),h=r.mul(h,f),l=r.add(l,h),p=r.mul(o,a),p=r.add(p,p),h=r.mul(p,f),c=r.sub(c,h),u=r.mul(p,d),u=r.add(u,u),u=r.add(u,u),new b(c,l,u)}add(t){g(t);const{px:n,py:i,pz:s}=this,{px:o,py:a,pz:c}=t;let l=r.ZERO,u=r.ZERO,h=r.ZERO;const d=e.a,p=r.mul(e.b,$h);let f=r.mul(n,o),m=r.mul(i,a),y=r.mul(s,c),w=r.add(n,i),v=r.add(o,a);w=r.mul(w,v),v=r.add(f,m),w=r.sub(w,v),v=r.add(n,s);let E=r.add(o,c);return v=r.mul(v,E),E=r.add(f,y),v=r.sub(v,E),E=r.add(i,s),l=r.add(a,c),E=r.mul(E,l),l=r.add(m,y),E=r.sub(E,l),h=r.mul(d,v),l=r.mul(p,y),h=r.add(l,h),l=r.sub(m,h),h=r.add(m,h),u=r.mul(l,h),m=r.add(f,f),m=r.add(m,f),y=r.mul(d,y),v=r.mul(p,v),m=r.add(m,y),y=r.sub(f,y),y=r.mul(d,y),v=r.add(v,y),f=r.mul(m,v),u=r.add(u,f),f=r.mul(E,v),l=r.mul(w,l),l=r.sub(l,f),f=r.mul(w,m),h=r.mul(E,h),h=r.add(h,f),new b(l,u,h)}subtract(e){return this.add(e.negate())}is0(){return this.equals(b.ZERO)}multiply(e){const{endo:r}=t;if(!n.isValidNot0(e))throw new Error("invalid scalar: out of range");let i,s;const o=e=>E.wNAFCached(this,e,b.normalizeZ);if(r){const{k1neg:t,k1:n,k2neg:a,k2:c}=r.splitScalar(e),{p:l,f:u}=o(n),{p:h,f:d}=o(c);s=u.add(d),i=w(r.beta,l,h,t,a)}else{const{p:t,f:r}=o(e);i=t,s=r}return b.normalizeZ([i,s])[0]}multiplyUnsafe(e){const{endo:r}=t,i=this;if(!n.isValid(e))throw new Error("invalid scalar: out of range");if(e===Dh||i.is0())return b.ZERO;if(e===Wh)return i;if(E.hasPrecomputes(this))return this.multiply(e);if(r){const{k1neg:t,k1:n,k2neg:s,k2:o}=r.splitScalar(e),{p1:a,p2:c}=function(e,t,r,n){let i=t,s=e.ZERO,o=e.ZERO;for(;r>ph||n>ph;)r&fh&&(s=s.add(i)),n&fh&&(o=o.add(i)),i=i.double(),r>>=fh,n>>=fh;return{p1:s,p2:o}}(b,i,n,o);return w(r.beta,a,c,t,s)}return E.wNAFCachedUnsafe(i,e)}multiplyAndAddUnsafe(e,t,r){const n=this.multiplyUnsafe(t).add(e.multiplyUnsafe(r));return n.is0()?void 0:n}toAffine(e){return m(this,e)}isTorsionFree(){const{isTorsionFree:e}=t;return i===Wh||(e?e(b,this):E.wNAFCachedUnsafe(this,s).is0())}clearCofactor(){const{clearCofactor:e}=t;return i===Wh?this:e?e(b,this):this.multiplyUnsafe(i)}toBytes(e=!0){return Mu("isCompressed",e),this.assertValidity(),c(b,this,e)}toRawBytes(e=!0){return this.toBytes(e)}toHex(e=!0){return Cc(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}b.BASE=new b(e.Gx,e.Gy,r.ONE),b.ZERO=new b(r.ZERO,r.ONE,r.ZERO),b.Fp=r,b.Fn=n;const v=n.BITS,E=function(e,t){return{constTimeNegate:gh,hasPrecomputes:e=>1!==Eh(e),unsafeLadder(t,r,n=e.ZERO){let i=t;for(;r>ph;)r&fh&&(n=n.add(i)),i=i.double(),r>>=fh;return n},precomputeWindow(e,r){const{windows:n,windowSize:i}=yh(r,t),s=[];let o=e,a=o;for(let e=0;e<n;e++){a=o,s.push(a);for(let e=1;e<i;e++)a=a.add(o),s.push(a);o=a.double()}return s},wNAF(r,n,i){let s=e.ZERO,o=e.BASE;const a=yh(r,t);for(let e=0;e<a.windows;e++){const{nextN:t,offset:r,isZero:c,isNeg:l,isNegF:u,offsetF:h}=wh(i,e,a);i=t,c?o=o.add(gh(u,n[h])):s=s.add(gh(l,n[r]))}return Ah(i),{p:s,f:o}},wNAFUnsafe(r,n,i,s=e.ZERO){const o=yh(r,t);for(let e=0;e<o.windows&&i!==ph;e++){const{nextN:t,offset:r,isZero:a,isNeg:c}=wh(i,e,o);if(i=t,!a){const e=n[r];s=s.add(c?e.negate():e)}}return Ah(i),s},getPrecomputes(e,t,r){let n=bh.get(t);return n||(n=this.precomputeWindow(t,e),1!==e&&("function"==typeof r&&(n=r(n)),bh.set(t,n))),n},wNAFCached(e,t,r){const n=Eh(e);return this.wNAF(n,this.getPrecomputes(n,e,r),t)},wNAFCachedUnsafe(e,t,r,n){const i=Eh(e);return 1===i?this.unsafeLadder(e,t,n):this.wNAFUnsafe(i,this.getPrecomputes(i,e,r),t,n)},setWindowSize(e,r){mh(r,t),vh.set(e,r),bh.delete(e)}}}(b,t.endo?Math.ceil(v/2):v);return b}function Hh(e){return Uint8Array.of(e?2:3)}function Kh(e,t,r={}){Vu(t,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const n=t.randomBytes||Rc,i=t.hmac||((e,...r)=>Tu(t.hash,e,Tc(...r))),{Fp:s,Fn:o}=e,{ORDER:a,BITS:c}=o;function l(e){return e>a>>Wh}function u(e,t){if(!o.isValidNot0(t))throw new Error(`invalid signature ${e}: out of range 1..CURVE.n`)}class h{constructor(e,t,r){u("r",e),u("s",t),this.r=e,this.s=t,null!=r&&(this.recovery=r),Object.freeze(this)}static fromCompact(e){const t=o.BYTES,r=qu("compactSignature",e,2*t);return new h(o.fromBytes(r.subarray(0,t)),o.fromBytes(r.subarray(t,2*t)))}static fromDER(e){const{r:t,s:r}=Lh.toSig(qu("DER",e));return new h(t,r)}assertValidity(){}addRecoveryBit(e){return new h(this.r,this.s,e)}recoverPublicKey(t){const r=s.ORDER,{r:n,s:i,recovery:c}=this;if(null==c||![0,1,2,3].includes(c))throw new Error("recovery id invalid");if(a*jh<r&&c>1)throw new Error("recovery id is ambiguous for h>1 curve");const l=2===c||3===c?n+a:n;if(!s.isValid(l))throw new Error("recovery id 2 or 3 invalid");const u=s.toBytes(l),h=e.fromHex(Tc(Hh(!(1&c)),u)),d=o.inv(l),p=m(qu("msgHash",t)),f=o.create(-p*d),g=o.create(i*d),y=e.BASE.multiplyUnsafe(f).add(h.multiplyUnsafe(g));if(y.is0())throw new Error("point at infinify");return y.assertValidity(),y}hasHighS(){return l(this.s)}normalizeS(){return this.hasHighS()?new h(this.r,o.neg(this.s),this.recovery):this}toBytes(e){if("compact"===e)return Tc(o.toBytes(this.r),o.toBytes(this.s));if("der"===e)return Nc(Lh.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Cc(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Cc(this.toBytes("compact"))}}const d=qh(o,r.allowedPrivateKeyLengths,r.wrapPrivateKey),p={isValidPrivateKey(e){try{return d(e),!0}catch{return!1}},normPrivateKeyToScalar:d,randomPrivateKey:()=>{const e=a;return function(e,t,r=!1){const n=e.length,i=hh(t),s=dh(t);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);const o=rh(r?ju(e):Wu(e),t-Zu)+Zu;return r?zu(o,i):$u(o,i)}(n(dh(e)),e)},precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)};function f(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;const n=qu("key",t).length,i=s.BYTES,a=i+1,c=2*i+1;return r.allowedPrivateKeyLengths||o.BYTES===a?void 0:n===a||n===c}const g=t.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");const t=Wu(e),r=8*e.length-c;return r>0?t>>BigInt(r):t},m=t.bits2int_modN||function(e){return o.create(g(e))},y=Ku(c);function w(e){return Hu("num < 2^"+c,e,Dh,y),o.toBytes(e)}const b={lowS:t.lowS,prehash:!1},v={lowS:t.lowS,prehash:!1};return e.BASE.precompute(8),Object.freeze({getPublicKey:function(t,r=!0){return e.fromPrivateKey(t).toBytes(r)},getSharedSecret:function(t,r,n=!0){if(!0===f(t))throw new Error("first arg must be private key");if(!1===f(r))throw new Error("second arg must be public key");return e.fromHex(r).multiply(d(t)).toBytes(n)},sign:function(r,a,c=b){const{seed:u,k2sig:p}=function(r,i,a=b){if(["recovered","canonical"].some(e=>e in a))throw new Error("sign() legacy options not supported");const{hash:c}=t;let{lowS:u,prehash:p,extraEntropy:f}=a;null==u&&(u=!0),r=qu("msgHash",r),Bh(a),p&&(r=qu("prehashed msgHash",c(r)));const y=m(r),v=d(i),E=[w(v),w(y)];if(null!=f&&!1!==f){const e=!0===f?n(s.BYTES):f;E.push(qu("extraEntropy",e))}const A=Tc(...E),_=y;return{seed:A,k2sig:function(t){const r=g(t);if(!o.isValidNot0(r))return;const n=o.inv(r),i=e.BASE.multiply(r).toAffine(),s=o.create(i.x);if(s===Dh)return;const a=o.create(n*o.create(_+s*v));if(a===Dh)return;let c=(i.x===s?0:2)|Number(i.y&Wh),d=a;return u&&l(a)&&(d=function(e){return l(e)?o.neg(e):e}(a),c^=1),new h(s,d,c)}}}(r,a,c);return function(e,t,r){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof r)throw new Error("hmacFn must be a function");const n=e=>new Uint8Array(e),i=e=>Uint8Array.of(e);let s=n(e),o=n(e),a=0;const c=()=>{s.fill(1),o.fill(0),a=0},l=(...e)=>r(o,s,...e),u=(e=n(0))=>{o=l(i(0),e),s=l(),0!==e.length&&(o=l(i(1),e),s=l())},h=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const r=[];for(;e<t;){s=l();const t=s.slice();r.push(t),e+=s.length}return Tc(...r)};return(e,t)=>{let r;for(c(),u(e);!(r=t(h()));)u();return c(),r}}(t.hash.outputLen,o.BYTES,i)(u,p)},verify:function(r,n,i,s=v){const a=r;n=qu("msgHash",n),i=qu("publicKey",i),Bh(s);const{lowS:c,prehash:l,format:u}=s;if("strict"in s)throw new Error("options.strict was renamed to lowS");if(void 0!==u&&!["compact","der","js"].includes(u))throw new Error('format must be "compact", "der" or "js"');const d="string"==typeof a||uc(a),p=!d&&!u&&"object"==typeof a&&null!==a&&"bigint"==typeof a.r&&"bigint"==typeof a.s;if(!d&&!p)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let f,g;try{if(p){if(void 0!==u&&"js"!==u)throw new Error("invalid format");f=new h(a.r,a.s)}if(d){try{"compact"!==u&&(f=h.fromDER(a))}catch(e){if(!(e instanceof Lh.Err))throw e}!f&&"der"!==u&&(f=h.fromCompact(a))}g=e.fromHex(i)}catch{return!1}if(!f||c&&f.hasHighS())return!1;l&&(n=t.hash(n));const{r:y,s:w}=f,b=m(n),E=o.inv(w),A=o.create(b*E),_=o.create(y*E),I=e.BASE.multiplyUnsafe(A).add(g.multiplyUnsafe(_));return!I.is0()&&o.create(I.x)===y},utils:p,Point:e,Signature:h})}function Vh(e){const{CURVE:t,curveOpts:r,ecdsaOpts:n}=function(e){const{CURVE:t,curveOpts:r}=function(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy};return{CURVE:t,curveOpts:{Fp:e.Fp,Fn:uh(t.n,e.nBitLength),allowedPrivateKeyLengths:e.allowedPrivateKeyLengths,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,wrapPrivateKey:e.wrapPrivateKey,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes}}}(e);return{CURVE:t,curveOpts:r,ecdsaOpts:{hash:e.hash,hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN}}}(e);return function(e,t){return Object.assign({},t,{ProjectivePoint:t.Point,CURVE:e})}(e,Kh(Fh(t,r),n,r))}function Yh(e,t){const r=t=>Vh({...e,hash:t});return{...r(t),create:r}}const Gh={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},Zh={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},Jh={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},Xh=uh(Gh.p),Qh=uh(Zh.p),ed=uh(Jh.p),td=Yh({...Gh,Fp:Xh,lowS:!1},fl);Yh({...Zh,Fp:Qh,lowS:!1},ml),Yh({...Jh,Fp:ed,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},gl);const rd=td,nd="base10",id="base16",sd="base64pad",od="base64url",ad="utf8";function cd(){return ra(Rc(32),id)}function ld(e){return ra(Ru(ta(e,id)),id)}function ud(e){return ra(Ru(ta(e,ad)),id)}function hd(e){return ta(`${e}`,nd)}function dd(e){return Number(ra(e,nd))}function pd(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function fd(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),r=(4-t.length%4)%4;return t+"=".repeat(r)}function gd(e){if(2===dd(e.type))return ra(Ts([e.type,e.sealed]),sd);if(1===dd(e.type)){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ra(Ts([e.type,e.senderPublicKey,e.iv,e.sealed]),sd)}return ra(Ts([e.type,e.iv,e.sealed]),sd)}function md(e){const t=ta((e.encoding||sd)===od?fd(e.encoded):e.encoded,sd),r=t.slice(0,1);if(1===dd(r)){const e=33,n=e+12,i=t.slice(1,e),s=t.slice(e,n);return{type:r,sealed:t.slice(n),iv:s,senderPublicKey:i}}if(2===dd(r))return{type:r,sealed:t.slice(1),iv:Rc(12)};const n=t.slice(1,13);return{type:r,sealed:t.slice(13),iv:n}}function yd(e){const t=e?.type||0;if(1===t){if(typeof e?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function wd(e){return 1===e.type&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}function bd(e){return 2===e.type}function vd(e){return e?.relay||{protocol:"irn"}}function Ed(e){const t=ia[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}function Ad(e,t="-"){const r={},n="relay"+t;return Object.keys(e).forEach(t=>{if(t.startsWith(n)){const i=t.replace(n,""),s=e[t];r[i]=s}}),r}function _d(e){if(!e.includes("wc:")){const t=za(e);null!=t&&t.includes("wc:")&&(e=t)}const t=(e=(e=e.includes("wc://")?e.replace("wc://",""):e).includes("wc:")?e.replace("wc:",""):e).indexOf(":"),r=-1!==e.indexOf("?")?e.indexOf("?"):void 0,n=e.substring(0,t),i=e.substring(t+1,r).split("@"),s=typeof r<"u"?e.substring(r):"",o=new URLSearchParams(s),a={};o.forEach((e,t)=>{a[t]=e});const c="string"==typeof a.methods?a.methods.split(","):void 0;return{protocol:n,topic:Id(i[0]),version:parseInt(i[1],10),symKey:a.symKey,relay:Ad(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function Id(e){return e.startsWith("//")?e.substring(2):e}function Sd(e){const t=new URLSearchParams,r=function(e,t="-"){const r={};return Object.keys(e).forEach(n=>{const i=n,s="relay"+t+i;e[i]&&(r[s]=e[i])}),r}(e.relay);Object.keys(r).sort().forEach(e=>{t.set(e,r[e])}),t.set("symKey",e.symKey),e.expiryTimestamp&&t.set("expiryTimestamp",e.expiryTimestamp.toString()),e.methods&&t.set("methods",e.methods.join(","));const n=t.toString();return`${e.protocol}:${e.topic}@${e.version}?${n}`}function Cd(e,t,r){return`${e}?wc_ev=${r}&topic=${t}`}var kd=Object.defineProperty,Nd=Object.defineProperties,xd=Object.getOwnPropertyDescriptors,Td=Object.getOwnPropertySymbols,Od=Object.prototype.hasOwnProperty,Pd=Object.prototype.propertyIsEnumerable,Rd=(e,t,r)=>t in e?kd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ud=(e,t)=>{for(var r in t||(t={}))Od.call(t,r)&&Rd(e,r,t[r]);if(Td)for(var r of Td(t))Pd.call(t,r)&&Rd(e,r,t[r]);return e},Bd=(e,t)=>Nd(e,xd(t));function Md(e){const t=[];return e.forEach(e=>{const[r,n]=e.split(":");t.push(`${r}:${n}`)}),t}function Ld(e){return e.includes(":")}function Dd(e){return Ld(e)?e.split(":")[0]:e}function Wd(e){var t,r,n;const i={};if(!Kd(e))return i;for(const[s,o]of Object.entries(e)){const e=Ld(s)?[s]:o.chains,a=o.methods||[],c=o.events||[],l=Dd(s);i[l]=Bd(Ud({},i[l]),{chains:Da(e,null==(t=i[l])?void 0:t.chains),methods:Da(a,null==(r=i[l])?void 0:r.methods),events:Da(c,null==(n=i[l])?void 0:n.events)})}return i}function jd(e,t){const r=function(e){const t={};return e?.forEach(e=>{var r;const[n,i]=e.split(":");t[n]||(t[n]={accounts:[],chains:[],events:[],methods:[]}),t[n].accounts.push(e),null==(r=t[n].chains)||r.push(`${n}:${i}`)}),t}(t=t.map(e=>e.replace("did:pkh:","")));for(const[t,n]of Object.entries(r))n.methods?n.methods=Da(n.methods,e):n.methods=e,n.events=["chainChanged","accountsChanged"];return r}const $d={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},zd={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function qd(e,t){const{message:r,code:n}=zd[e];return{message:t?`${r} ${t}`:r,code:n}}function Fd(e,t){const{message:r,code:n}=$d[e];return{message:t?`${r} ${t}`:r,code:n}}function Hd(e,t){return!!Array.isArray(e)&&(!(typeof t<"u"&&e.length)||e.every(t))}function Kd(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function Vd(e){return typeof e>"u"}function Yd(e,t){return!(!t||!Vd(e))||"string"==typeof e&&!!e.trim().length}function Gd(e,t){return!(!t||!Vd(e))||"number"==typeof e&&!isNaN(e)}function Zd(e){return!(!Yd(e,!1)||!e.includes(":"))&&2===e.split(":").length}function Jd(e){let t=!0;return Hd(e)?e.length&&(t=e.every(e=>Yd(e,!1))):t=!1,t}function Xd(e,t){let r=null;return Object.values(e).forEach(e=>{if(r)return;const n=function(e,t){let r=null;return Jd(e?.methods)?Jd(e?.events)||(r=Fd("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=Fd("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}(e,`${t}, namespace`);n&&(r=n)}),r}function Qd(e,t){let r=null;if(e&&Kd(e)){const n=Xd(e,t);n&&(r=n);const i=function(e,t){let r=null;return Object.values(e).forEach(e=>{if(r)return;const n=function(e,t){let r=null;return Hd(e)?e.forEach(e=>{r||function(e){if(Yd(e,!1)&&e.includes(":")){const t=e.split(":");if(3===t.length){const e=t[0]+":"+t[1];return!!t[2]&&Zd(e)}}return!1}(e)||(r=Fd("UNSUPPORTED_ACCOUNTS",`${t}, account ${e} should be a string and conform to "namespace:chainId:address" format`))}):r=Fd("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}(e?.accounts,`${t} namespace`);n&&(r=n)}),r}(e,t);i&&(r=i)}else r=qd("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function ep(e){return Yd(e.protocol,!0)}function tp(e){return typeof e<"u"&&null!==typeof e}function rp(e,t){return!(!Zd(t)||!function(e){const t=[];return Object.values(e).forEach(e=>{t.push(...Md(e.accounts))}),t}(e).includes(t))}function np(e,t,r){let n=null;const i=function(e){const t={};return Object.keys(e).forEach(r=>{var n;r.includes(":")?t[r]=e[r]:null==(n=e[r].chains)||n.forEach(n=>{t[n]={methods:e[r].methods,events:e[r].events}})}),t}(e),s=function(e){const t={};return Object.keys(e).forEach(r=>{if(r.includes(":"))t[r]=e[r];else{const n=Md(e[r].accounts);n?.forEach(n=>{t[n]={accounts:e[r].accounts.filter(e=>e.includes(`${n}:`)),methods:e[r].methods,events:e[r].events}})}}),t}(t),o=Object.keys(i),a=Object.keys(s),c=ip(Object.keys(e)),l=ip(Object.keys(t)),u=c.filter(e=>!l.includes(e));return u.length&&(n=qd("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.\n      Required: ${u.toString()}\n      Received: ${Object.keys(t).toString()}`)),Na(o,a)||(n=qd("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.\n      Required: ${o.toString()}\n      Approved: ${a.toString()}`)),Object.keys(t).forEach(e=>{if(!e.includes(":")||n)return;const i=Md(t[e].accounts);i.includes(e)||(n=qd("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${e}\n        Required: ${e}\n        Approved: ${i.toString()}`))}),o.forEach(e=>{n||(Na(i[e].methods,s[e].methods)?Na(i[e].events,s[e].events)||(n=qd("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${e}`)):n=qd("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${e}`))}),n}function ip(e){return[...new Set(e.map(e=>e.includes(":")?e.split(":")[0]:e))]}function sp(){const e=Ia();return new Promise(t=>{switch(e){case ba:t(_a()&&navigator?.onLine);break;case wa:t(async function(){if(Aa()&&typeof r.g<"u"&&null!=r.g&&r.g.NetInfo){const e=await(null==r.g?void 0:r.g.NetInfo.fetch());return e?.isConnected}return!0}());break;default:t(!0)}})}const op={};class ap{static get(e){return op[e]}static set(e,t){op[e]=t}static delete(e){delete op[e]}}function cp(e){return new Uint8Array(e.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function lp(e){const t=Uint8Array.from(oa.from(e.signature,"hex")),r=function(e){const t=Ti.A.decode(e);if(t.length<33)throw new Error("Too short to contain a public key");return t.slice(1,33)}(e.transaction.address),n=function({publicKey:e,signature:t,payload:r}){var n;const i=cp(r.method),s=128|parseInt((null==(n=r.version)?void 0:n.toString())||"4"),o=function(e){const t=Ti.A.decode(e)[0];return 42===t?0:60===t?2:1}(r.address),a="00"===r.era?new Uint8Array([0]):cp(r.era);if(1!==a.length&&2!==a.length)throw new Error("Invalid era length");const c=parseInt(r.nonce,16),l=new Uint8Array([255&c,c>>8&255]),u=BigInt(`0x${function(e){return e.startsWith("0x")?e.slice(2):e}(r.tip)}`),h=function(e){if(e<BigInt(1)<<BigInt(6))return new Uint8Array([Number(e<<BigInt(2))]);if(e<BigInt(1)<<BigInt(14)){const t=e<<BigInt(2)|BigInt(1);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255))])}if(e<BigInt(1)<<BigInt(30)){const t=e<<BigInt(2)|BigInt(2);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255)),Number(t>>BigInt(16)&BigInt(255)),Number(t>>BigInt(24)&BigInt(255))])}throw new Error("BigInt compact encoding not supported > 2^30")}(u),d=new Uint8Array([0,...e,o,...t,...a,...l,...h,...i]),p=function(e){if(e<64)return new Uint8Array([e<<2]);if(e<16384){const t=e<<2|1;return new Uint8Array([255&t,t>>8&255])}if(e<1<<30){const t=e<<2|2;return new Uint8Array([255&t,t>>8&255,t>>16&255,t>>24&255])}throw new Error("Compact encoding > 2^30 not supported")}(d.length+1);return new Uint8Array([...p,s,...d])}({publicKey:r,signature:t,payload:e.transaction});return function(e){const t=cp(e),r=(0,sa.blake2b)(t,void 0,32);return"0x"+oa.from(r).toString("hex")}(oa.from(n).toString("hex"))}const up="PARSE_ERROR",hp="INVALID_REQUEST",dp="METHOD_NOT_FOUND",pp="INVALID_PARAMS",fp="INTERNAL_ERROR",gp="SERVER_ERROR",mp=[-32700,-32600,-32601,-32602,-32603],yp={[up]:{code:-32700,message:"Parse error"},[hp]:{code:-32600,message:"Invalid Request"},[dp]:{code:-32601,message:"Method not found"},[pp]:{code:-32602,message:"Invalid params"},[fp]:{code:-32603,message:"Internal error"},[gp]:{code:-32e3,message:"Server error"}},wp=gp;function bp(e){return Object.keys(yp).includes(e)?yp[e]:yp[wp]}function vp(e,t,r){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):e}var Ep=r(5682);function Ap(e=3){return Date.now()*Math.pow(10,e)+Math.floor(Math.random()*Math.pow(10,e))}function _p(e=6){return BigInt(Ap(e))}function Ip(e,t,r){return{id:r||Ap(),jsonrpc:"2.0",method:e,params:t}}function Sp(e,t){return{id:e,jsonrpc:"2.0",result:t}}function Cp(e,t,r){return{id:e,jsonrpc:"2.0",error:kp(t,r)}}function kp(e,t){return void 0===e?bp(fp):("string"==typeof e&&(e=Object.assign(Object.assign({},bp(gp)),{message:e})),void 0!==t&&(e.data=t),r=e.code,mp.includes(r)&&(e=function(e){const t=Object.values(yp).find(t=>t.code===e);return t||yp[wp]}(e.code)),e);var r}class Np{}class xp extends Np{constructor(){super()}}class Tp extends xp{constructor(e){super()}}function Op(e,t){const r=function(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(t&&t.length)return t[0]}(e);return void 0!==r&&new RegExp(t).test(r)}function Pp(e){return Op(e,"^https?:")}function Rp(e){return Op(e,"^wss?:")}function Up(e){return"object"==typeof e&&"id"in e&&"jsonrpc"in e&&"2.0"===e.jsonrpc}function Bp(e){return Up(e)&&"method"in e}function Mp(e){return Up(e)&&(Lp(e)||Dp(e))}function Lp(e){return"result"in e}function Dp(e){return"error"in e}class Wp extends Tp{constructor(e){super(e),this.events=new y.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Ip(e.method,e.params||[],e.id||_p().toString()),t)}async requestStrict(e,t){return new Promise(async(r,n)=>{if(!this.connection.connected)try{await this.open()}catch(e){n(e)}this.events.on(`${e.id}`,e=>{Dp(e)?n(e.error):r(e.result)});try{await this.connection.send(e,t)}catch(e){n(e)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Mp(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&3e3===e.code&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),"string"==typeof e&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const jp=e=>e.split("?")[0],$p=typeof WebSocket<"u"?WebSocket:typeof r.g<"u"&&typeof r.g.WebSocket<"u"?r.g.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:r(1591);class zp{constructor(e){if(this.url=e,this.events=new y.EventEmitter,this.registering=!1,!Rp(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{typeof this.socket>"u"?t(new Error("Connection already closed")):(this.socket.onclose=t=>{this.onClose(t),e()},this.socket.close())})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send((0,K.h)(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!Rp(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((e,t)=>{this.events.once("register_error",e=>{this.resetMaxListeners(),t(e)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return t(new Error("WebSocket connection is missing or invalid"));e(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,n)=>{const i=(0,Ep.isReactNative)()?void 0:{rejectUnauthorized:(o=e,!new RegExp("wss?://localhost(:d{2,5})?").test(o))},s=new $p(e,[],i);var o;typeof WebSocket<"u"||typeof r.g<"u"&&typeof r.g.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u"?s.onerror=e=>{const t=e;n(this.emitError(t.error))}:s.on("error",e=>{n(this.emitError(e))}),s.onopen=()=>{this.onOpen(s),t(s)}})}onOpen(e){e.onmessage=e=>this.onPayload(e),e.onclose=e=>this.onClose(e),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t="string"==typeof e.data?(0,K.j)(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const r=this.parseError(t),n=Cp(e,r.message||r.toString());this.events.emit("payload",n)}parseError(e,t=this.url){return vp(e,jp(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}emitError(e){const t=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${jp(this.url)}`));return this.events.emit("register_error",t),t}}var qp=r(8287).Buffer;const Fp="core",Hp=`wc@2:${Fp}:`,Kp={database:":memory:"},Vp="client_ed25519_seed",Yp=b.ONE_DAY,Gp=b.SIX_HOURS,Zp="wss://relay.walletconnect.org",Jp="relayer_message",Xp="relayer_message_ack",Qp="relayer_connection_stalled",ef="relayer_publish",tf="payload",rf="connect",nf="disconnect",sf="error",of="2.21.5",af={link_mode:"link_mode",relay:"relay"},cf="inbound",lf="WALLETCONNECT_LINK_MODE_APPS",uf="subscription_created",hf="subscription_deleted",df=(b.FIVE_SECONDS,{wc_pairingDelete:{req:{ttl:b.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:b.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:b.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:b.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:b.ONE_DAY,prompt:!1,tag:0},res:{ttl:b.ONE_DAY,prompt:!1,tag:0}}}),pf="pairing_create",ff="pairing_delete",gf="history_created",mf="history_updated",yf="history_deleted",wf="expirer_created",bf="expirer_deleted",vf="expirer_expired",Ef="https://verify.walletconnect.org",Af=Ef,_f=`${Af}/v3`,If=["https://verify.walletconnect.com",Ef],Sf="malformed_pairing_uri",Cf="session_approve_started";var kf=function(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(255!==r[o])throw new TypeError(s+" is ambiguous");r[o]=i}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[t]){for(var n=0,i=0;e[t]===c;)n++,t++;for(var s=(e.length-t)*l+1>>>0,o=new Uint8Array(s);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var h=0,d=s-1;(0!==u||h<i)&&-1!==d;d--,h++)u+=a*o[d]>>>0,o[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=h,t++}if(" "!==e[t]){for(var p=s-i;p!==s&&0===o[p];)p++;for(var f=new Uint8Array(n+(s-p)),g=n;p!==s;)f[g++]=o[p++];return f}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,s=t.length;i!==s&&0===t[i];)i++,r++;for(var o=(s-i)*u+1>>>0,l=new Uint8Array(o);i!==s;){for(var h=t[i],d=0,p=o-1;(0!==h||d<n)&&-1!==p;p--,d++)h+=256*l[p]>>>0,l[p]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=d,i++}for(var f=o-n;f!==o&&0===l[f];)f++;for(var g=c.repeat(r);f<o;++f)g+=e.charAt(l[f]);return g},decodeUnsafe:h,decode:function(e){var r=h(e);if(r)return r;throw new Error(`Non-${t} character`)}}};const Nf=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};class xf{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Tf{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Pf(this,e)}}class Of{constructor(e){this.decoders=e}or(e){return Pf(this,e)}decode(e){const t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Pf=(e,t)=>new Of({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Rf{constructor(e,t,r,n){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=n,this.encoder=new xf(e,t,r),this.decoder=new Tf(e,t,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Uf=({name:e,prefix:t,encode:r,decode:n})=>new Rf(e,t,r,n),Bf=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=kf(r,t);return Uf({prefix:e,name:t,encode:n,decode:e=>Nf(i(e))})},Mf=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Uf({prefix:t,name:e,encode:e=>((e,t,r)=>{const n="="===t[t.length-1],i=(1<<r)-1;let s="",o=0,a=0;for(let n=0;n<e.length;++n)for(a=a<<8|e[n],o+=8;o>r;)o-=r,s+=t[i&a>>o];if(o&&(s+=t[i&a<<r-o]),n)for(;s.length*r&7;)s+="=";return s})(e,n,r),decode:t=>((e,t,r,n)=>{const i={};for(let e=0;e<t.length;++e)i[t[e]]=e;let s=e.length;for(;"="===e[s-1];)--s;const o=new Uint8Array(s*r/8|0);let a=0,c=0,l=0;for(let t=0;t<s;++t){const s=i[e[t]];if(void 0===s)throw new SyntaxError(`Non-${n} character`);c=c<<r|s,a+=r,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o})(t,n,r,e)}),Lf=Uf({prefix:"\0",name:"identity",encode:e=>(e=>(new TextDecoder).decode(e))(e),decode:e=>(e=>(new TextEncoder).encode(e))(e)});var Df=Object.freeze({__proto__:null,identity:Lf});const Wf=Mf({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var jf=Object.freeze({__proto__:null,base2:Wf});const $f=Mf({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var zf=Object.freeze({__proto__:null,base8:$f});const qf=Bf({prefix:"9",name:"base10",alphabet:"0123456789"});var Ff=Object.freeze({__proto__:null,base10:qf});const Hf=Mf({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Kf=Mf({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Vf=Object.freeze({__proto__:null,base16:Hf,base16upper:Kf});const Yf=Mf({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Gf=Mf({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Zf=Mf({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Jf=Mf({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Xf=Mf({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Qf=Mf({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),eg=Mf({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),tg=Mf({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),rg=Mf({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var ng=Object.freeze({__proto__:null,base32:Yf,base32upper:Gf,base32pad:Zf,base32padupper:Jf,base32hex:Xf,base32hexupper:Qf,base32hexpad:eg,base32hexpadupper:tg,base32z:rg});const ig=Bf({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),sg=Bf({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var og=Object.freeze({__proto__:null,base36:ig,base36upper:sg});const ag=Bf({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),cg=Bf({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var lg=Object.freeze({__proto__:null,base58btc:ag,base58flickr:cg});const ug=Mf({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),hg=Mf({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),dg=Mf({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),pg=Mf({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var fg=Object.freeze({__proto__:null,base64:ug,base64pad:hg,base64url:dg,base64urlpad:pg});const gg=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),mg=gg.reduce((e,t,r)=>(e[r]=t,e),[]),yg=gg.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]),wg=Uf({prefix:"🚀",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+mg[t],"")},decode:function(e){const t=[];for(const r of e){const e=yg[r.codePointAt(0)];if(void 0===e)throw new Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var bg=Object.freeze({__proto__:null,base256emoji:wg}),vg=128,Eg=-128,Ag=Math.pow(2,31),_g=128,Ig=127,Sg=Math.pow(2,7),Cg=Math.pow(2,14),kg=Math.pow(2,21),Ng=Math.pow(2,28),xg=Math.pow(2,35),Tg=Math.pow(2,42),Og=Math.pow(2,49),Pg=Math.pow(2,56),Rg=Math.pow(2,63),Ug={encode:function e(t,r,n){r=r||[];for(var i=n=n||0;t>=Ag;)r[n++]=255&t|vg,t/=128;for(;t&Eg;)r[n++]=255&t|vg,t>>>=7;return r[n]=0|t,e.bytes=n-i+1,r},decode:function e(t,r){var n,i=0,s=(r=r||0,0),o=r,a=t.length;do{if(o>=a)throw e.bytes=0,new RangeError("Could not decode varint");n=t[o++],i+=s<28?(n&Ig)<<s:(n&Ig)*Math.pow(2,s),s+=7}while(n>=_g);return e.bytes=o-r,i},encodingLength:function(e){return e<Sg?1:e<Cg?2:e<kg?3:e<Ng?4:e<xg?5:e<Tg?6:e<Og?7:e<Pg?8:e<Rg?9:10}},Bg=Ug;const Mg=(e,t,r=0)=>(Bg.encode(e,t,r),t),Lg=e=>Bg.encodingLength(e),Dg=(e,t)=>{const r=t.byteLength,n=Lg(e),i=n+Lg(r),s=new Uint8Array(i+r);return Mg(e,s,0),Mg(r,s,n),s.set(t,i),new Wg(e,r,t,s)};class Wg{constructor(e,t,r,n){this.code=e,this.size=t,this.digest=r,this.bytes=n}}const jg=({name:e,code:t,encode:r})=>new $g(e,t,r);class $g{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Dg(this.code,t):t.then(e=>Dg(this.code,e))}throw Error("Unknown type, must be binary type")}}const zg=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),qg=jg({name:"sha2-256",code:18,encode:zg("SHA-256")}),Fg=jg({name:"sha2-512",code:19,encode:zg("SHA-512")});Object.freeze({__proto__:null,sha256:qg,sha512:Fg});const Hg=Nf,Kg={code:0,name:"identity",encode:Hg,digest:e=>Dg(0,Hg(e))};Object.freeze({__proto__:null,identity:Kg}),new TextEncoder,new TextDecoder;const Vg={...Df,...jf,...zf,...Ff,...Vf,...ng,...og,...lg,...fg,...bg};function Yg(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Gg(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const Zg=Gg("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>(new TextEncoder).encode(e.substring(1))),Jg=Gg("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{const t=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?Yg(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Xg={utf8:Zg,"utf-8":Zg,hex:Vg.base16,latin1:Jg,ascii:Jg,binary:Jg,...Vg};var Qg=Object.defineProperty,em=(e,t,r)=>((e,t,r)=>t in e?Qg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class tm{constructor(e,t){this.core=e,this.logger=t,em(this,"keychain",new Map),em(this,"name","keychain"),em(this,"version","0.3"),em(this,"initialized",!1),em(this,"storagePrefix",Hp),em(this,"init",async()=>{if(!this.initialized){const e=await this.getKeyChain();typeof e<"u"&&(this.keychain=e),this.initialized=!0}}),em(this,"has",e=>(this.isInitialized(),this.keychain.has(e))),em(this,"set",async(e,t)=>{this.isInitialized(),this.keychain.set(e,t),await this.persist()}),em(this,"get",e=>{this.isInitialized();const t=this.keychain.get(e);if(typeof t>"u"){const{message:t}=qd("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t}),em(this,"del",async e=>{this.isInitialized(),this.keychain.delete(e),await this.persist()}),this.core=e,this.logger=(0,ee.U5)(t,this.name)}get context(){return(0,ee.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,xa(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Ta(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=qd("NOT_INITIALIZED",this.name);throw new Error(e)}}}var rm=Object.defineProperty,nm=(e,t,r)=>((e,t,r)=>t in e?rm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class im{constructor(e,t,r){this.core=e,this.logger=t,nm(this,"name","crypto"),nm(this,"keychain"),nm(this,"randomSessionIdentifier",cd()),nm(this,"initialized",!1),nm(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),nm(this,"hasKeys",e=>(this.isInitialized(),this.keychain.has(e))),nm(this,"getClientId",async()=>(this.isInitialized(),Wn(zn(await this.getClientSeed()).publicKey))),nm(this,"generateKeyPair",()=>{this.isInitialized();const e=function(){const e=Uh.utils.randomPrivateKey(),t=Uh.getPublicKey(e);return{privateKey:ra(e,id),publicKey:ra(t,id)}}();return this.setPrivateKey(e.publicKey,e.privateKey)}),nm(this,"signJWT",async e=>{this.isInitialized();const t=zn(await this.getClientSeed()),r=this.randomSessionIdentifier,n=Yp;return await async function(e,t,r,n,i=(0,b.fromMiliseconds)(Date.now())){const s={alg:"EdDSA",typ:"JWT"},o={iss:Wn(n.publicKey),sub:e,aud:t,iat:i,exp:i+r},a=function(e){return Mn([Dn(e.header),Dn(e.payload)].join(Qt),rr)}({header:s,payload:o});return function(e){return[Dn(e.header),Dn(e.payload),jn(e.signature)].join(Qt)}({header:s,payload:o,signature:Xt.sign(a,n.secretKey.slice(0,32))})}(r,e,n,t)}),nm(this,"generateSharedKey",(e,t,r)=>{this.isInitialized();const n=function(e,t){const r=Uh.getSharedSecret(ta(e,id),ta(t,id));return ra(((e,t,r,n,i)=>function(e,t,r,n=32){pc(e),hc(n);const i=e.outputLen;if(n>255*i)throw new Error("Length should be <= 255*HashLen");const s=Math.ceil(n/i);void 0===r&&(r=Pu);const o=new Uint8Array(s*i),a=Tu.create(e,t),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let e=0;e<s;e++)Ou[0]=e+1,c.update(0===e?Pu:l).update(r).update(Ou).digestInto(l),o.set(l,i*e),a._cloneInto(c);return a.destroy(),c.destroy(),yc(l,Ou),o.slice(0,n)}(e,function(e,t,r){return pc(e),void 0===r&&(r=new Uint8Array(e.outputLen)),Tu(e,xc(r),xc(t))}(e,t,r),n,i))(Ru,r,void 0,void 0,32),id)}(this.getPrivateKey(e),t);return this.setSymKey(n,r)}),nm(this,"setSymKey",async(e,t)=>{this.isInitialized();const r=t||ld(e);return await this.keychain.set(r,e),r}),nm(this,"deleteKeyPair",async e=>{this.isInitialized(),await this.keychain.del(e)}),nm(this,"deleteSymKey",async e=>{this.isInitialized(),await this.keychain.del(e)}),nm(this,"encode",async(e,t,r)=>{this.isInitialized();const n=yd(r),i=(0,K.h)(t);if(bd(n))return function(e,t){const r=hd(2),n=Rc(12),i=gd({type:r,sealed:ta(e,ad),iv:n});return t===od?pd(i):i}(i,r?.encoding);if(wd(n)){const t=n.senderPublicKey,r=n.receiverPublicKey;e=await this.generateSharedKey(t,r)}const s=this.getSymKey(e),{type:o,senderPublicKey:a}=n;return function(e){const t=hd(typeof e.type<"u"?e.type:0);if(1===dd(t)&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof e.senderPublicKey<"u"?ta(e.senderPublicKey,id):void 0,n=typeof e.iv<"u"?ta(e.iv,id):Rc(12),i=ta(e.symKey,id),s=gd({type:t,sealed:ku(i,n).encrypt(ta(e.message,ad)),iv:n,senderPublicKey:r});return e.encoding===od?pd(s):s}({type:o,symKey:s,message:i,senderPublicKey:a,encoding:r?.encoding})}),nm(this,"decode",async(e,t,r)=>{this.isInitialized();const n=function(e,t){const r=md({encoded:e,encoding:t?.encoding});return yd({type:dd(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ra(r.senderPublicKey,id):void 0,receiverPublicKey:t?.receiverPublicKey})}(t,r);if(bd(n)){const e=function(e,t){const{sealed:r}=md({encoded:e,encoding:t});return ra(r,ad)}(t,r?.encoding);return(0,K.j)(e)}if(wd(n)){const t=n.receiverPublicKey,r=n.senderPublicKey;e=await this.generateSharedKey(t,r)}try{const n=function(e){const t=ta(e.symKey,id),{sealed:r,iv:n}=md({encoded:e.encoded,encoding:e.encoding}),i=ku(t,n).decrypt(r);if(null===i)throw new Error("Failed to decrypt");return ra(i,ad)}({symKey:this.getSymKey(e),encoded:t,encoding:r?.encoding});return(0,K.j)(n)}catch(t){this.logger.error(`Failed to decode message from topic: '${e}', clientId: '${await this.getClientId()}'`),this.logger.error(t)}}),nm(this,"getPayloadType",(e,t=sd)=>dd(md({encoded:e,encoding:t}).type)),nm(this,"getPayloadSenderPublicKey",(e,t=sd)=>{const r=md({encoded:e,encoding:t});return r.senderPublicKey?ra(r.senderPublicKey,id):void 0}),this.core=e,this.logger=(0,ee.U5)(t,this.name),this.keychain=r||new tm(this.core,this.logger)}get context(){return(0,ee.oI)(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Vp)}catch{e=cd(),await this.keychain.set(Vp,e)}return function(e,t="utf8"){const r=Xg[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return"utf8"!==t&&"utf-8"!==t||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${e}`):Yg(globalThis.Buffer.from(e,"utf-8"))}(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=qd("NOT_INITIALIZED",this.name);throw new Error(e)}}}var sm=Object.defineProperty,om=Object.defineProperties,am=Object.getOwnPropertyDescriptors,cm=Object.getOwnPropertySymbols,lm=Object.prototype.hasOwnProperty,um=Object.prototype.propertyIsEnumerable,hm=(e,t,r)=>t in e?sm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,dm=(e,t,r)=>hm(e,"symbol"!=typeof t?t+"":t,r);class pm extends oe{constructor(e,t){super(e,t),this.logger=e,this.core=t,dm(this,"messages",new Map),dm(this,"messagesWithoutClientAck",new Map),dm(this,"name","messages"),dm(this,"version","0.3"),dm(this,"initialized",!1),dm(this,"storagePrefix",Hp),dm(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const e=await this.getRelayerMessages();typeof e<"u"&&(this.messages=e);const t=await this.getRelayerMessagesWithoutClientAck();typeof t<"u"&&(this.messagesWithoutClientAck=t),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}finally{this.initialized=!0}}}),dm(this,"set",async(e,t,r)=>{this.isInitialized();const n=ud(t);let i=this.messages.get(e);if(typeof i>"u"&&(i={}),typeof i[n]<"u")return n;if(i[n]=t,this.messages.set(e,i),r===cf){const r=this.messagesWithoutClientAck.get(e)||{};this.messagesWithoutClientAck.set(e,((e,t)=>om(e,am(t)))(((e,t)=>{for(var r in t||(t={}))lm.call(t,r)&&hm(e,r,t[r]);if(cm)for(var r of cm(t))um.call(t,r)&&hm(e,r,t[r]);return e})({},r),{[n]:t}))}return await this.persist(),n}),dm(this,"get",e=>{this.isInitialized();let t=this.messages.get(e);return typeof t>"u"&&(t={}),t}),dm(this,"getWithoutAck",e=>{this.isInitialized();const t={};for(const r of e){const e=this.messagesWithoutClientAck.get(r)||{};t[r]=Object.values(e)}return t}),dm(this,"has",(e,t)=>(this.isInitialized(),typeof this.get(e)[ud(t)]<"u")),dm(this,"ack",async(e,t)=>{this.isInitialized();const r=this.messagesWithoutClientAck.get(e);typeof r>"u"||(delete r[ud(t)],0===Object.keys(r).length?this.messagesWithoutClientAck.delete(e):this.messagesWithoutClientAck.set(e,r),await this.persist())}),dm(this,"del",async e=>{this.isInitialized(),this.messages.delete(e),this.messagesWithoutClientAck.delete(e),await this.persist()}),this.logger=(0,ee.U5)(e,this.name),this.core=t}get context(){return(0,ee.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,xa(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,xa(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Ta(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?Ta(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=qd("NOT_INITIALIZED",this.name);throw new Error(e)}}}var fm=Object.defineProperty,gm=Object.defineProperties,mm=Object.getOwnPropertyDescriptors,ym=Object.getOwnPropertySymbols,wm=Object.prototype.hasOwnProperty,bm=Object.prototype.propertyIsEnumerable,vm=(e,t,r)=>t in e?fm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Em=(e,t)=>{for(var r in t||(t={}))wm.call(t,r)&&vm(e,r,t[r]);if(ym)for(var r of ym(t))bm.call(t,r)&&vm(e,r,t[r]);return e},Am=(e,t)=>gm(e,mm(t)),_m=(e,t,r)=>vm(e,"symbol"!=typeof t?t+"":t,r);class Im extends ae{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,_m(this,"events",new y.EventEmitter),_m(this,"name","publisher"),_m(this,"queue",new Map),_m(this,"publishTimeout",(0,b.toMiliseconds)(b.ONE_MINUTE)),_m(this,"initialPublishTimeout",(0,b.toMiliseconds)(15*b.ONE_SECOND)),_m(this,"needsTransportRestart",!1),_m(this,"publish",async(e,t,r)=>{var n;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:r}});const i=r?.ttl||Gp,s=vd(r),o=r?.prompt||!1,a=r?.tag||0,c=r?.id||_p().toString(),l={topic:e,message:t,opts:{ttl:i,relay:s,prompt:o,tag:a,id:c,attestation:r?.attestation,tvf:r?.tvf}},u=`Failed to publish payload, please try again. id:${c} tag:${a}`;try{const n=new Promise(async n=>{const s=({id:e})=>{l.opts.id===e&&(this.removeRequestFromQueue(e),this.relayer.events.removeListener(ef,s),n(l))};this.relayer.events.on(ef,s);const u=Pa(new Promise((n,s)=>{this.rpcPublish({topic:e,message:t,ttl:i,prompt:o,tag:a,id:c,attestation:r?.attestation,tvf:r?.tvf}).then(n).catch(e=>{this.logger.warn(e,e?.message),s(e)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${c} tag:${a}`);try{await u,this.events.removeListener(ef,s)}catch(e){this.queue.set(c,Am(Em({},l),{attempt:1})),this.logger.warn(e,e?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:c,topic:e,message:t,opts:r}}),await Pa(n,this.publishTimeout,u)}catch(e){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(e),null!=(n=r?.internal)&&n.throwOnFailedPublish)throw e}finally{this.queue.delete(c)}}),_m(this,"on",(e,t)=>{this.events.on(e,t)}),_m(this,"once",(e,t)=>{this.events.once(e,t)}),_m(this,"off",(e,t)=>{this.events.off(e,t)}),_m(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.relayer=e,this.logger=(0,ee.U5)(t,this.name),this.registerEventListeners()}get context(){return(0,ee.oI)(this.logger)}async rpcPublish(e){var t,r,n,i;const{topic:s,message:o,ttl:a=Gp,prompt:c,tag:l,id:u,attestation:h,tvf:d}=e,p={method:Ed(vd().protocol).publish,params:Em({topic:s,message:o,ttl:a,prompt:c,tag:l,attestation:h},d),id:u};Vd(null==(t=p.params)?void 0:t.prompt)&&(null==(r=p.params)||delete r.prompt),Vd(null==(n=p.params)?void 0:n.tag)&&(null==(i=p.params)||delete i.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:p});const f=await this.relayer.request(p);return this.relayer.events.emit(ef,e),this.logger.debug("Successfully Published Payload"),f}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{const r=e.attempt+1;this.queue.set(t,Am(Em({},e),{attempt:r}));const{topic:n,message:i,opts:s,attestation:o}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${r}`),await this.rpcPublish(Am(Em({},e),{topic:n,message:i,ttl:s.ttl,prompt:s.prompt,tag:s.tag,id:s.id,attestation:o,tvf:s.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(_,()=>{if(this.needsTransportRestart)return this.needsTransportRestart=!1,void this.relayer.events.emit(Qp);this.checkQueue()}),this.relayer.on(Xp,e=>{this.removeRequestFromQueue(e.id.toString())})}}var Sm=Object.defineProperty,Cm=(e,t,r)=>((e,t,r)=>t in e?Sm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class km{constructor(){Cm(this,"map",new Map),Cm(this,"set",(e,t)=>{const r=this.get(e);this.exists(e,t)||this.map.set(e,[...r,t])}),Cm(this,"get",e=>this.map.get(e)||[]),Cm(this,"exists",(e,t)=>this.get(e).includes(t)),Cm(this,"delete",(e,t)=>{if(typeof t>"u")return void this.map.delete(e);if(!this.map.has(e))return;const r=this.get(e);if(!this.exists(e,t))return;const n=r.filter(e=>e!==t);n.length?this.map.set(e,n):this.map.delete(e)}),Cm(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var Nm=Object.defineProperty,xm=Object.defineProperties,Tm=Object.getOwnPropertyDescriptors,Om=Object.getOwnPropertySymbols,Pm=Object.prototype.hasOwnProperty,Rm=Object.prototype.propertyIsEnumerable,Um=(e,t,r)=>t in e?Nm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Bm=(e,t)=>{for(var r in t||(t={}))Pm.call(t,r)&&Um(e,r,t[r]);if(Om)for(var r of Om(t))Rm.call(t,r)&&Um(e,r,t[r]);return e},Mm=(e,t)=>xm(e,Tm(t)),Lm=(e,t,r)=>Um(e,"symbol"!=typeof t?t+"":t,r);class Dm extends ue{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Lm(this,"subscriptions",new Map),Lm(this,"topicMap",new km),Lm(this,"events",new y.EventEmitter),Lm(this,"name","subscription"),Lm(this,"version","0.3"),Lm(this,"pending",new Map),Lm(this,"cached",[]),Lm(this,"initialized",!1),Lm(this,"storagePrefix",Hp),Lm(this,"subscribeTimeout",(0,b.toMiliseconds)(b.ONE_MINUTE)),Lm(this,"initialSubscribeTimeout",(0,b.toMiliseconds)(15*b.ONE_SECOND)),Lm(this,"clientId"),Lm(this,"batchSubscribeTopicsLimit",500),Lm(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),Lm(this,"subscribe",async(e,t)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{const r=vd(t),n={topic:e,relay:r,transportType:t?.transportType};this.pending.set(e,n);const i=await this.rpcSubscribe(e,r,t);return"string"==typeof i&&(this.onSubscribe(i,n),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}})),i}catch(e){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(e),e}}),Lm(this,"unsubscribe",async(e,t)=>{this.isInitialized(),typeof t?.id<"u"?await this.unsubscribeById(e,t.id,t):await this.unsubscribeByTopic(e,t)}),Lm(this,"isSubscribed",e=>new Promise(t=>{t(this.topicMap.topics.includes(e))})),Lm(this,"isKnownTopic",e=>new Promise(t=>{t(this.topicMap.topics.includes(e)||this.pending.has(e)||this.cached.some(t=>t.topic===e))})),Lm(this,"on",(e,t)=>{this.events.on(e,t)}),Lm(this,"once",(e,t)=>{this.events.once(e,t)}),Lm(this,"off",(e,t)=>{this.events.off(e,t)}),Lm(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),Lm(this,"start",async()=>{await this.onConnect()}),Lm(this,"stop",async()=>{await this.onDisconnect()}),Lm(this,"restart",async()=>{await this.restore(),await this.onRestart()}),Lm(this,"checkPending",async()=>{if(!(0!==this.pending.size||this.initialized&&this.relayer.connected))return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}),Lm(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(_,async()=>{await this.checkPending()}),this.events.on(uf,async e=>{const t=uf;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(hf,async e=>{const t=hf;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}),this.relayer=e,this.logger=(0,ee.U5)(t,this.name),this.clientId=""}get context(){return(0,ee.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let r=!1;try{r=this.getSubscription(e).topic===t}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const r=this.topicMap.get(e);await Promise.all(r.map(async r=>await this.unsubscribeById(e,r,t)))}async unsubscribeById(e,t,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{const n=vd(r);await this.restartToComplete({topic:e,id:t,relay:n}),await this.rpcUnsubscribe(e,t,n);const i=Fd("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(e){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(e),e}}async rpcSubscribe(e,t,r){var n;(!r||r?.transportType===af.relay)&&await this.restartToComplete({topic:e,id:e,relay:t});const i={method:Ed(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});const s=null==(n=r?.internal)?void 0:n.throwOnFailedPublish;try{const t=await this.getSubscriptionId(e);if(r?.transportType===af.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(i).catch(e=>this.logger.warn(e))},(0,b.toMiliseconds)(b.ONE_SECOND)),t;const n=new Promise(async t=>{const r=n=>{n.topic===e&&(this.events.removeListener(uf,r),t(n.id))};this.events.on(uf,r);try{const n=await Pa(new Promise((e,t)=>{this.relayer.request(i).catch(e=>{this.logger.warn(e,e?.message),t(e)}).then(e)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(uf,r),t(n)}catch{}}),o=await Pa(n,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!o&&s)throw new Error(`Subscribing to ${e} failed, please try again`);return o?t:null}catch(e){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Qp),s)throw e}return null}async rpcBatchSubscribe(e){if(!e.length)return;const t={method:Ed(e[0].relay.protocol).batchSubscribe,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{await await Pa(new Promise(e=>{this.relayer.request(t).catch(e=>this.logger.warn(e)).then(e)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(Qp)}}async rpcBatchFetchMessages(e){if(!e.length)return;const t={method:Ed(e[0].relay.protocol).batchFetchMessages,params:{topics:e.map(e=>e.topic)}};let r;this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{r=await await Pa(new Promise((e,r)=>{this.relayer.request(t).catch(e=>{this.logger.warn(e),r(e)}).then(e)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(Qp)}return r}rpcUnsubscribe(e,t,r){const n={method:Ed(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(e,t){this.setSubscription(e,Mm(Bm({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(e=>{this.setSubscription(e.id,Bm({},e)),this.pending.delete(e.topic)})}async onUnsubscribe(e,t,r){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,Bm({},t)),this.topicMap.set(t.topic,e),this.events.emit(uf,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:t}=qd("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(hf,Mm(Bm({},r),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit("subscription_sync")}async onRestart(){if(this.cached.length){const e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const t=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(t)}}this.events.emit("subscription_resubscribed")}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:e}=qd("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async e=>Mm(Bm({},e),{id:await this.getSubscriptionId(e.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(await function(e){return new Promise(t=>setTimeout(t,e))}((0,b.toMiliseconds)(b.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(t.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=qd("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return ud(e+await this.getClientId())}}var Wm=Object.defineProperty,jm=Object.getOwnPropertySymbols,$m=Object.prototype.hasOwnProperty,zm=Object.prototype.propertyIsEnumerable,qm=(e,t,r)=>t in e?Wm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Fm=(e,t)=>{for(var r in t||(t={}))$m.call(t,r)&&qm(e,r,t[r]);if(jm)for(var r of jm(t))zm.call(t,r)&&qm(e,r,t[r]);return e},Hm=(e,t,r)=>qm(e,"symbol"!=typeof t?t+"":t,r);class Km extends ce{constructor(e){super(e),Hm(this,"protocol","wc"),Hm(this,"version",2),Hm(this,"core"),Hm(this,"logger"),Hm(this,"events",new y.EventEmitter),Hm(this,"provider"),Hm(this,"messages"),Hm(this,"subscriber"),Hm(this,"publisher"),Hm(this,"name","relayer"),Hm(this,"transportExplicitlyClosed",!1),Hm(this,"initialized",!1),Hm(this,"connectionAttemptInProgress",!1),Hm(this,"relayUrl"),Hm(this,"projectId"),Hm(this,"packageName"),Hm(this,"bundleId"),Hm(this,"hasExperiencedNetworkDisruption",!1),Hm(this,"pingTimeout"),Hm(this,"heartBeatTimeout",(0,b.toMiliseconds)(b.THIRTY_SECONDS+b.FIVE_SECONDS)),Hm(this,"reconnectTimeout"),Hm(this,"connectPromise"),Hm(this,"reconnectInProgress",!1),Hm(this,"requestsInFlight",[]),Hm(this,"connectTimeout",(0,b.toMiliseconds)(15*b.ONE_SECOND)),Hm(this,"request",async e=>{var t,r;this.logger.debug("Publishing Request Payload");const n=e.id||_p().toString();await this.toEstablishConnection();try{this.logger.trace({id:n,method:e.method,topic:null==(t=e.params)?void 0:t.topic},"relayer.request - publishing...");const i=`${n}:${(null==(r=e.params)?void 0:r.tag)||""}`;this.requestsInFlight.push(i);const s=await this.provider.request(e);return this.requestsInFlight=this.requestsInFlight.filter(e=>e!==i),s}catch(e){throw this.logger.debug(`Failed to Publish Request: ${n}`),e}}),Hm(this,"resetPingTimeout",()=>{Ea()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var e,t,r,n;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),null==(n=null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.terminate)||n.call(r)}catch(e){this.logger.warn(e,e?.message)}},this.heartBeatTimeout))}),Hm(this,"onPayloadHandler",e=>{this.onProviderPayload(e),this.resetPingTimeout()}),Hm(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected 🛜"),this.startPingTimeout(),this.events.emit("relayer_connect")}),Hm(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected 🛑"),this.requestsInFlight=[],this.onProviderDisconnect()}),Hm(this,"onProviderErrorHandler",e=>{this.logger.fatal(`Fatal socket error: ${e.message}`),this.events.emit("relayer_error",e),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),Hm(this,"registerProviderListeners",()=>{this.provider.on(tf,this.onPayloadHandler),this.provider.on(rf,this.onConnectHandler),this.provider.on(nf,this.onDisconnectHandler),this.provider.on(sf,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&"string"!=typeof e.logger?(0,ee.U5)(e.logger,this.name):(0,ee.h6)((0,ee.iP)({level:e.logger||"error"})),this.messages=new pm(this.logger,e.core),this.subscriber=new Dm(this,this.logger),this.publisher=new Im(this,this.logger),this.relayUrl=e?.relayUrl||Zp,this.projectId=e.projectId,Aa()&&typeof r.g<"u"&&typeof(null==r.g?void 0:r.g.Platform)<"u"&&"android"===(null==r.g?void 0:r.g.Platform.OS)?this.packageName=Sa():Aa()&&typeof r.g<"u"&&typeof(null==r.g?void 0:r.g.Platform)<"u"&&"ios"===(null==r.g?void 0:r.g.Platform.OS)&&(this.bundleId=Sa()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e?.message))}get context(){return(0,ee.oI)(this.logger)}get connected(){var e,t,r;return 1===(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)||!1}get connecting(){var e,t,r;return 0===(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)||void 0!==this.connectPromise||!1}async publish(e,t,r){this.isInitialized(),await this.publisher.publish(e,t,r),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:af.relay},"outbound")}async subscribe(e,t){var r,n,i;this.isInitialized(),(null==t||!t.transportType||"relay"===t?.transportType)&&await this.toEstablishConnection();const s=typeof(null==(r=t?.internal)?void 0:r.throwOnFailedPublish)>"u"||(null==(n=t?.internal)?void 0:n.throwOnFailedPublish);let o,a=(null==(i=this.subscriber.topicMap.get(e))?void 0:i[0])||"";const c=t=>{t.topic===e&&(this.subscriber.off(uf,c),o())};return await Promise.all([new Promise(e=>{o=e,this.subscriber.on(uf,c)}),new Promise(async(r,n)=>{a=await this.subscriber.subscribe(e,Fm({internal:{throwOnFailedPublish:s}},t)).catch(e=>{s&&n(e)})||a,r()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Pa(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(this.subscriber.hasAnyTopics){if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,r)=>{await this.connect(e).then(t).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}else this.logger.info("Starting WS connection skipped because the client has no topics to work with.")}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await sp())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(0===e?.length)return void this.logger.trace("Batch message events is empty. Ignoring...");const t=e.sort((e,t)=>e.publishedAt-t.publishedAt);this.logger.debug(`Batch of ${t.length} message events sorted`);for(const e of t)try{await this.onMessageEvent(e)}catch(e){this.logger.warn(e,"Error while processing batch message event: "+e?.message)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){const{topic:r}=e;if(!t.sessionExists){const e={topic:r,expiry:Ba(b.FIVE_MINUTES),relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,e)}this.events.emit(Jp,e),await this.recordMessageEvent(e,cf)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(e,t)=>{const r=()=>{t(new Error("Connection interrupted while trying to connect"))};this.provider.once(nf,r),await Pa(new Promise((e,t)=>{this.provider.connect().then(e).catch(t)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(e=>{t(e)}).finally(()=>{this.provider.off(nf,r),clearTimeout(this.reconnectTimeout)}),await new Promise(async(e,r)=>{const n=()=>{t(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(nf,n),await this.subscriber.start().then(e).catch(r).finally(()=>{this.provider.off(nf,n)})}),this.hasExperiencedNetworkDisruption=!1,e()})}catch(e){await this.subscriber.stop();const t=e;this.logger.warn({},t.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(e=>setTimeout(e,(0,b.toMiliseconds)(1*t))),t++}}startPingTimeout(){var e,t,r,n,i;if(Ea())try{null!=(t=null==(e=this.provider)?void 0:e.connection)&&t.socket&&(null==(i=null==(n=null==(r=this.provider)?void 0:r.connection)?void 0:n.socket)||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(e){this.logger.warn(e,e?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Wp(new zp(function({protocol:e,version:t,relayUrl:r,sdkVersion:n,auth:i,projectId:s,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=r.split("?"),u={auth:i,ua:ka(e,t,n),projectId:s,useOnCloseEvent:o||void 0,packageName:c||void 0,bundleId:a||void 0},h=function(e,t){const r=new URLSearchParams(e);for(const e of Object.keys(t).sort())if(t.hasOwnProperty(e)){const n=t[e];void 0!==n&&r.set(e,n)}return r.toString()}(l[1]||"",u);return l[0]+"?"+h}({sdkVersion:of,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){const{topic:r,message:n}=e;await this.messages.set(r,n,t)}async shouldIgnoreMessageEvent(e){const{topic:t,message:r}=e;if(!r||0===r.length)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;const n=this.messages.has(t,r);return n&&this.logger.warn(`Ignoring duplicate message: ${r}`),n}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Bp(e)){if(!e.method.endsWith("_subscription"))return;const t=e.params,{topic:r,message:n,publishedAt:i,attestation:s}=t.data,o={topic:r,message:n,publishedAt:i,transportType:af.relay,attestation:s};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Fm({type:"event",event:t.id},o)),this.events.emit(t.id,o),await this.acknowledgePayload(e),await this.onMessageEvent(o)}else Mp(e)&&this.events.emit(Xp,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,cf),this.events.emit(Jp,e))}async acknowledgePayload(e){const t=Sp(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(tf,this.onPayloadHandler),this.provider.off(rf,this.onConnectHandler),this.provider.off(nf,this.onDisconnectHandler),this.provider.off(sf,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await sp();(function(e){switch(Ia()){case ba:!function(e){!Aa()&&_a()&&(window.addEventListener("online",()=>e(!0)),window.addEventListener("offline",()=>e(!1)))}(e);break;case wa:!function(e){Aa()&&typeof r.g<"u"&&null!=r.g&&r.g.NetInfo&&r.g?.NetInfo.addEventListener(t=>e(t?.isConnected))}(e)}})(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(e=>this.logger.error(e,e?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(_,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&function(){var e;return!_a()||!(0,Qn.getDocument)()||"visible"===(null==(e=(0,Qn.getDocument)())?void 0:e.visibilityState)}())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(e){this.logger.warn(e,e?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit("relayer_disconnect"),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},(0,b.toMiliseconds)(.1)))))}isInitialized(){if(!this.initialized){const{message:e}=qd("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise)return void await this.connectPromise;await this.connect()}}}function Vm(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function Ym(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const Gm="[object Arguments]",Zm="[object Object]";function Jm(){}function Xm(e){if(!e||"object"!=typeof e)return!1;const t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&"[object Object]"===Object.prototype.toString.call(e)}function Qm(e,t,r,n,i,s,o){const a=o(e,t,r,n,i,s);if(void 0!==a)return a;if(typeof e==typeof t)switch(typeof e){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return e===t;case"number":return e===t||Object.is(e,t);case"object":return ey(e,t,s,o)}return ey(e,t,s,o)}function ey(e,t,r,n){if(Object.is(e,t))return!0;let i=Ym(e),s=Ym(t);if(i===Gm&&(i=Zm),s===Gm&&(s=Zm),i!==s)return!1;switch(i){case"[object String]":return e.toString()===t.toString();case"[object Number]":return function(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}(e.valueOf(),t.valueOf());case"[object Boolean]":case"[object Date]":case"[object Symbol]":return Object.is(e.valueOf(),t.valueOf());case"[object RegExp]":return e.source===t.source&&e.flags===t.flags;case"[object Function]":return e===t}const o=(r=r??new Map).get(e),a=r.get(t);if(null!=o&&null!=a)return o===t;r.set(e,t),r.set(t,e);try{switch(i){case"[object Map]":if(e.size!==t.size)return!1;for(const[i,s]of e.entries())if(!t.has(i)||!Qm(s,t.get(i),i,e,t,r,n))return!1;return!0;case"[object Set]":{if(e.size!==t.size)return!1;const i=Array.from(e.values()),s=Array.from(t.values());for(let o=0;o<i.length;o++){const a=i[o],c=s.findIndex(i=>Qm(a,i,void 0,e,t,r,n));if(-1===c)return!1;s.splice(c,1)}return!0}case"[object Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":case"[object BigUint64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object BigInt64Array]":case"[object Float32Array]":case"[object Float64Array]":if(typeof qp<"u"&&qp.isBuffer(e)!==qp.isBuffer(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!Qm(e[i],t[i],i,e,t,r,n))return!1;return!0;case"[object ArrayBuffer]":return e.byteLength===t.byteLength&&ey(new Uint8Array(e),new Uint8Array(t),r,n);case"[object DataView]":return e.byteLength===t.byteLength&&e.byteOffset===t.byteOffset&&ey(new Uint8Array(e),new Uint8Array(t),r,n);case"[object Error]":return e.name===t.name&&e.message===t.message;case Zm:{if(!(ey(e.constructor,t.constructor,r,n)||Xm(e)&&Xm(t)))return!1;const i=[...Object.keys(e),...Vm(e)],s=[...Object.keys(t),...Vm(t)];if(i.length!==s.length)return!1;for(let s=0;s<i.length;s++){const o=i[s],a=e[o];if(!Object.hasOwn(t,o))return!1;if(!Qm(a,t[o],o,e,t,r,n))return!1}return!0}default:return!1}}finally{r.delete(e),r.delete(t)}}var ty=Object.defineProperty,ry=Object.getOwnPropertySymbols,ny=Object.prototype.hasOwnProperty,iy=Object.prototype.propertyIsEnumerable,sy=(e,t,r)=>t in e?ty(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,oy=(e,t)=>{for(var r in t||(t={}))ny.call(t,r)&&sy(e,r,t[r]);if(ry)for(var r of ry(t))iy.call(t,r)&&sy(e,r,t[r]);return e},ay=(e,t,r)=>sy(e,"symbol"!=typeof t?t+"":t,r);class cy extends le{constructor(e,t,r,n=Hp,i=void 0){super(e,t,r,n),this.core=e,this.logger=t,this.name=r,ay(this,"map",new Map),ay(this,"version","0.3"),ay(this,"cached",[]),ay(this,"initialized",!1),ay(this,"getKey"),ay(this,"storagePrefix",Hp),ay(this,"recentlyDeleted",[]),ay(this,"recentlyDeletedLimit",200),ay(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>{this.getKey&&null!==e&&!Vd(e)?this.map.set(this.getKey(e),e):function(e){var t;return null==(t=e?.proposer)?void 0:t.publicKey}(e)?this.map.set(e.id,e):function(e){return e?.topic}(e)&&this.map.set(e.topic,e)}),this.cached=[],this.initialized=!0)}),ay(this,"set",async(e,t)=>{this.isInitialized(),this.map.has(e)?await this.update(e,t):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:e,value:t}),this.map.set(e,t),await this.persist())}),ay(this,"get",e=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:e}),this.getData(e))),ay(this,"getAll",e=>(this.isInitialized(),e?this.values.filter(t=>Object.keys(e).every(r=>function(e,t){return function(e,t,r){return Qm(e,t,void 0,void 0,void 0,void 0,r)}(e,t,Jm)}(t[r],e[r]))):this.values)),ay(this,"update",async(e,t)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:e,update:t});const r=oy(oy({},this.getData(e)),t);this.map.set(e,r),await this.persist()}),ay(this,"delete",async(e,t)=>{this.isInitialized(),this.map.has(e)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:e,reason:t}),this.map.delete(e),this.addToRecentlyDeleted(e),await this.persist())}),this.logger=(0,ee.U5)(t,this.name),this.storagePrefix=n,this.getKey=i}get context(){return(0,ee.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){const{message:t}=qd("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(t),new Error(t)}const{message:t}=qd("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),new Error(t)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:e}=qd("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=qd("NOT_INITIALIZED",this.name);throw new Error(e)}}}var ly=Object.defineProperty,uy=(e,t,r)=>((e,t,r)=>t in e?ly(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class hy{constructor(e,t){this.core=e,this.logger=t,uy(this,"name","pairing"),uy(this,"version","0.3"),uy(this,"events",new(w())),uy(this,"pairings"),uy(this,"initialized",!1),uy(this,"storagePrefix",Hp),uy(this,"ignoredPayloadTypes",[1]),uy(this,"registeredMethods",[]),uy(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),uy(this,"register",({methods:e})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...e])]}),uy(this,"create",async e=>{this.isInitialized();const t=cd(),r=await this.core.crypto.setSymKey(t),n=Ba(b.FIVE_MINUTES),i={protocol:"irn"},s={topic:r,expiry:n,relay:i,active:!1,methods:e?.methods},o=Sd({protocol:this.core.protocol,version:this.core.version,topic:r,symKey:t,relay:i,expiryTimestamp:n,methods:e?.methods});return this.events.emit(pf,s),this.core.expirer.set(r,n),await this.pairings.set(r,s),await this.core.relayer.subscribe(r,{transportType:e?.transportType}),{topic:r,uri:o}}),uy(this,"pair",async e=>{this.isInitialized();const t=this.core.eventClient.createEvent({properties:{topic:e?.uri,trace:["pairing_started"]}});this.isValidPair(e,t);const{topic:r,symKey:n,relay:i,expiryTimestamp:s,methods:o}=_d(e.uri);let a;if(t.props.properties.topic=r,t.addTrace("pairing_uri_validation_success"),t.addTrace("pairing_uri_not_expired"),this.pairings.keys.includes(r)){if(a=this.pairings.get(r),t.addTrace("existing_pairing"),a.active)throw t.setError("active_pairing_already_exists"),new Error(`Pairing already exists: ${r}. Please try again with a new connection URI.`);t.addTrace("pairing_not_expired")}const c=s||Ba(b.FIVE_MINUTES),l={topic:r,relay:i,expiry:c,active:!1,methods:o};this.core.expirer.set(r,c),await this.pairings.set(r,l),t.addTrace("store_new_pairing"),e.activatePairing&&await this.activate({topic:r}),this.events.emit(pf,l),t.addTrace("emit_inactive_pairing"),this.core.crypto.keychain.has(r)||await this.core.crypto.setSymKey(n,r),t.addTrace("subscribing_pairing_topic");try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{t.setError("no_internet_connection")}try{await this.core.relayer.subscribe(r,{relay:i})}catch(e){throw t.setError("subscribe_pairing_topic_failure"),e}return t.addTrace("subscribe_pairing_topic_success"),l}),uy(this,"activate",async({topic:e})=>{this.isInitialized();const t=Ba(b.FIVE_MINUTES);this.core.expirer.set(e,t),await this.pairings.update(e,{active:!0,expiry:t})}),uy(this,"ping",async e=>{this.isInitialized(),await this.isValidPing(e),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:t}=e;if(this.pairings.keys.includes(t)){const e=await this.sendRequest(t,"wc_pairingPing",{}),{done:r,resolve:n,reject:i}=Oa();this.events.once(La("pairing_ping",e),({error:e})=>{e?i(e):n()}),await r()}}),uy(this,"updateExpiry",async({topic:e,expiry:t})=>{this.isInitialized(),await this.pairings.update(e,{expiry:t})}),uy(this,"updateMetadata",async({topic:e,metadata:t})=>{this.isInitialized(),await this.pairings.update(e,{peerMetadata:t})}),uy(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),uy(this,"disconnect",async e=>{this.isInitialized(),await this.isValidDisconnect(e);const{topic:t}=e;this.pairings.keys.includes(t)&&(await this.sendRequest(t,"wc_pairingDelete",Fd("USER_DISCONNECTED")),await this.deletePairing(t))}),uy(this,"formatUriFromPairing",e=>{this.isInitialized();const{topic:t,relay:r,expiry:n,methods:i}=e,s=this.core.crypto.keychain.get(t);return Sd({protocol:this.core.protocol,version:this.core.version,topic:t,symKey:s,relay:r,expiryTimestamp:n,methods:i})}),uy(this,"sendRequest",async(e,t,r)=>{const n=Ip(t,r),i=await this.core.crypto.encode(e,n),s=df[t].req;return this.core.history.set(e,n),this.core.relayer.publish(e,i,s),n.id}),uy(this,"sendResult",async(e,t,r)=>{const n=Sp(e,r),i=await this.core.crypto.encode(t,n),s=(await this.core.history.get(t,e)).request.method,o=df[s].res;await this.core.relayer.publish(t,i,o),await this.core.history.resolve(n)}),uy(this,"sendError",async(e,t,r)=>{const n=Cp(e,r),i=await this.core.crypto.encode(t,n),s=(await this.core.history.get(t,e)).request.method,o=df[s]?df[s].res:df.unregistered_method.res;await this.core.relayer.publish(t,i,o),await this.core.history.resolve(n)}),uy(this,"deletePairing",async(e,t)=>{await this.core.relayer.unsubscribe(e),await Promise.all([this.pairings.delete(e,Fd("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(e),t?Promise.resolve():this.core.expirer.del(e)])}),uy(this,"cleanup",async()=>{const e=this.pairings.getAll().filter(e=>Ma(e.expiry));await Promise.all(e.map(e=>this.deletePairing(e.topic)))}),uy(this,"onRelayEventRequest",async e=>{const{topic:t,payload:r}=e;switch(r.method){case"wc_pairingPing":return await this.onPairingPingRequest(t,r);case"wc_pairingDelete":return await this.onPairingDeleteRequest(t,r);default:return await this.onUnknownRpcMethodRequest(t,r)}}),uy(this,"onRelayEventResponse",async e=>{const{topic:t,payload:r}=e,n=(await this.core.history.get(t,r.id)).request.method;return"wc_pairingPing"===n?this.onPairingPingResponse(t,r):this.onUnknownRpcMethodResponse(n)}),uy(this,"onPairingPingRequest",async(e,t)=>{const{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult(r,e,!0),this.events.emit("pairing_ping",{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),uy(this,"onPairingPingResponse",(e,t)=>{const{id:r}=t;setTimeout(()=>{Lp(t)?this.events.emit(La("pairing_ping",r),{}):Dp(t)&&this.events.emit(La("pairing_ping",r),{error:t.error})},500)}),uy(this,"onPairingDeleteRequest",async(e,t)=>{const{id:r}=t;try{this.isValidDisconnect({topic:e}),await this.deletePairing(e),this.events.emit(ff,{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),uy(this,"onUnknownRpcMethodRequest",async(e,t)=>{const{id:r,method:n}=t;try{if(this.registeredMethods.includes(n))return;const t=Fd("WC_METHOD_UNSUPPORTED",n);await this.sendError(r,e,t),this.logger.error(t)}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),uy(this,"onUnknownRpcMethodResponse",e=>{this.registeredMethods.includes(e)||this.logger.error(Fd("WC_METHOD_UNSUPPORTED",e))}),uy(this,"isValidPair",(e,t)=>{var r;if(!tp(e)){const{message:r}=qd("MISSING_OR_INVALID",`pair() params: ${e}`);throw t.setError(Sf),new Error(r)}if(!function(e){function t(e){try{return typeof new URL(e)<"u"}catch{return!1}}try{if(Yd(e,!1))return!!t(e)||t(za(e))}catch{}return!1}(e.uri)){const{message:r}=qd("MISSING_OR_INVALID",`pair() uri: ${e.uri}`);throw t.setError(Sf),new Error(r)}const n=_d(e?.uri);if(null==(r=n?.relay)||!r.protocol){const{message:e}=qd("MISSING_OR_INVALID","pair() uri#relay-protocol");throw t.setError(Sf),new Error(e)}if(null==n||!n.symKey){const{message:e}=qd("MISSING_OR_INVALID","pair() uri#symKey");throw t.setError(Sf),new Error(e)}if(null!=n&&n.expiryTimestamp&&(0,b.toMiliseconds)(n?.expiryTimestamp)<Date.now()){t.setError("pairing_expired");const{message:e}=qd("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(e)}}),uy(this,"isValidPing",async e=>{if(!tp(e)){const{message:t}=qd("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidPairingTopic(t)}),uy(this,"isValidDisconnect",async e=>{if(!tp(e)){const{message:t}=qd("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidPairingTopic(t)}),uy(this,"isValidPairingTopic",async e=>{if(!Yd(e,!1)){const{message:t}=qd("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.pairings.keys.includes(e)){const{message:t}=qd("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Ma(this.pairings.get(e).expiry)){await this.deletePairing(e);const{message:t}=qd("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}),this.core=e,this.logger=(0,ee.U5)(t,this.name),this.pairings=new cy(this.core,this.logger,this.name,this.storagePrefix)}get context(){return(0,ee.oI)(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=qd("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Jp,async e=>{const{topic:t,message:r,transportType:n}=e;if(this.pairings.keys.includes(t)&&n!==af.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{const e=await this.core.crypto.decode(t,r);Bp(e)?(this.core.history.set(t,e),await this.onRelayEventRequest({topic:t,payload:e})):Mp(e)&&(await this.core.history.resolve(e),await this.onRelayEventResponse({topic:t,payload:e}),this.core.history.delete(t,e.id)),await this.core.relayer.messages.ack(t,r)}catch(e){this.logger.error(e)}})}registerExpirerEvents(){this.core.expirer.on(vf,async e=>{const{topic:t}=Ua(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}var dy=Object.defineProperty,py=(e,t,r)=>((e,t,r)=>t in e?dy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class fy extends se{constructor(e,t){super(e,t),this.core=e,this.logger=t,py(this,"records",new Map),py(this,"events",new y.EventEmitter),py(this,"name","history"),py(this,"version","0.3"),py(this,"cached",[]),py(this,"initialized",!1),py(this,"storagePrefix",Hp),py(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.records.set(e.id,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),py(this,"set",(e,t,r)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:r}),this.records.has(t.id))return;const n={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:r,expiry:Ba(b.THIRTY_DAYS)};this.records.set(n.id,n),this.persist(),this.events.emit(gf,n)}),py(this,"resolve",async e=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:e}),!this.records.has(e.id))return;const t=await this.getRecord(e.id);typeof t.response>"u"&&(t.response=Dp(e)?{error:e.error}:{result:e.result},this.records.set(t.id,t),this.persist(),this.events.emit(mf,t))}),py(this,"get",async(e,t)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:e,id:t}),await this.getRecord(t))),py(this,"delete",(e,t)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:t}),this.values.forEach(r=>{if(r.topic===e){if(typeof t<"u"&&r.id!==t)return;this.records.delete(r.id),this.events.emit(yf,r)}}),this.persist()}),py(this,"exists",async(e,t)=>(this.isInitialized(),!!this.records.has(t)&&(await this.getRecord(t)).topic===e)),py(this,"on",(e,t)=>{this.events.on(e,t)}),py(this,"once",(e,t)=>{this.events.once(e,t)}),py(this,"off",(e,t)=>{this.events.off(e,t)}),py(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=(0,ee.U5)(t,this.name)}get context(){return(0,ee.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const r={topic:t.topic,request:Ip(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:t}=qd("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(t)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit("history_sync")}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:e}=qd("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(gf,e=>{const t=gf;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(mf,e=>{const t=mf;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(yf,e=>{const t=yf;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(_,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{(0,b.toMiliseconds)(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(yf,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=qd("NOT_INITIALIZED",this.name);throw new Error(e)}}}var gy=Object.defineProperty,my=(e,t,r)=>((e,t,r)=>t in e?gy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class yy extends he{constructor(e,t){super(e,t),this.core=e,this.logger=t,my(this,"expirations",new Map),my(this,"events",new y.EventEmitter),my(this,"name","expirer"),my(this,"version","0.3"),my(this,"cached",[]),my(this,"initialized",!1),my(this,"storagePrefix",Hp),my(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.expirations.set(e.target,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),my(this,"has",e=>{try{const t=this.formatTarget(e);return typeof this.getExpiration(t)<"u"}catch{return!1}}),my(this,"set",(e,t)=>{this.isInitialized();const r=this.formatTarget(e),n={target:r,expiry:t};this.expirations.set(r,n),this.checkExpiry(r,n),this.events.emit(wf,{target:r,expiration:n})}),my(this,"get",e=>{this.isInitialized();const t=this.formatTarget(e);return this.getExpiration(t)}),my(this,"del",e=>{if(this.isInitialized(),this.has(e)){const t=this.formatTarget(e),r=this.getExpiration(t);this.expirations.delete(t),this.events.emit(bf,{target:t,expiration:r})}}),my(this,"on",(e,t)=>{this.events.on(e,t)}),my(this,"once",(e,t)=>{this.events.once(e,t)}),my(this,"off",(e,t)=>{this.events.off(e,t)}),my(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=(0,ee.U5)(t,this.name)}get context(){return(0,ee.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if("string"==typeof e)return function(e){return Ra("topic",e)}(e);if("number"==typeof e)return function(e){return Ra("id",e)}(e);const{message:t}=qd("UNKNOWN_TYPE","Target type: "+typeof e);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit("expirer_sync")}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:e}=qd("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:t}=qd("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(t),new Error(t)}return t}checkExpiry(e,t){const{expiry:r}=t;(0,b.toMiliseconds)(r)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(vf,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(_,()=>this.checkExpirations()),this.events.on(wf,e=>{const t=wf;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(vf,e=>{const t=vf;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(bf,e=>{const t=bf;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=qd("NOT_INITIALIZED",this.name);throw new Error(e)}}}var wy=Object.defineProperty,by=(e,t,r)=>((e,t,r)=>t in e?wy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class vy extends de{constructor(e,t,r){super(e,t,r),this.core=e,this.logger=t,this.store=r,by(this,"name","verify-api"),by(this,"abortController"),by(this,"isDevEnv"),by(this,"verifyUrlV3",_f),by(this,"storagePrefix",Hp),by(this,"version",2),by(this,"publicKey"),by(this,"fetchPromise"),by(this,"init",async()=>{var e;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&(0,b.toMiliseconds)(null==(e=this.publicKey)?void 0:e.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),by(this,"register",async e=>{if(!_a()||this.isDevEnv)return;const t=window.location.origin,{id:r,decryptedId:n}=e,i=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${t}&id=${r}&decryptedId=${n}`;try{const e=(0,Qn.getDocument)(),t=this.startAbortTimer(5*b.ONE_SECOND),n=await new Promise((n,s)=>{const o=()=>{window.removeEventListener("message",c),e.body.removeChild(a),s("attestation aborted")};this.abortController.signal.addEventListener("abort",o);const a=e.createElement("iframe");a.src=i,a.style.display="none",a.addEventListener("error",o,{signal:this.abortController.signal});const c=i=>{if(i.data&&"string"==typeof i.data)try{const s=JSON.parse(i.data);if("verify_attestation"===s.type){if($n(s.attestation).payload.id!==r)return;clearInterval(t),e.body.removeChild(a),this.abortController.signal.removeEventListener("abort",o),window.removeEventListener("message",c),n(null===s.attestation?"":s.attestation)}}catch(e){this.logger.warn(e)}};e.body.appendChild(a),window.addEventListener("message",c,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",n),n}catch(e){this.logger.warn(e)}return""}),by(this,"resolve",async e=>{if(this.isDevEnv)return"";const{attestationId:t,hash:r,encryptedId:n}=e;if(""===t)return void this.logger.debug("resolve: attestationId is empty, skipping");if(t){if($n(t).payload.id!==n)return;const e=await this.isValidJwtAttestation(t);if(e)return e.isVerified?e:void this.logger.warn("resolve: jwt attestation: origin url not verified")}if(!r)return;const i=this.getVerifyUrl(e?.verifyUrl);return this.fetchAttestation(r,i)}),by(this,"fetchAttestation",async(e,t)=>{this.logger.debug(`resolving attestation: ${e} from url: ${t}`);const r=this.startAbortTimer(5*b.ONE_SECOND),n=await fetch(`${t}/attestation/${e}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(r),200===n.status?await n.json():void 0}),by(this,"getVerifyUrl",e=>{let t=e||Af;return If.includes(t)||(this.logger.info(`verify url: ${t}, not included in trusted list, assigning default: ${Af}`),t=Af),t}),by(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const e=this.startAbortTimer(b.FIVE_SECONDS),t=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(e),await t.json()}catch(e){this.logger.warn(e)}}),by(this,"persistPublicKey",async e=>{this.logger.debug("persisting public key to local storage",e),await this.store.setItem(this.storeKey,e),this.publicKey=e}),by(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),by(this,"isValidJwtAttestation",async e=>{const t=await this.getPublicKey();try{if(t)return this.validateAttestation(e,t)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}const r=await this.fetchAndPersistPublicKey();try{if(r)return this.validateAttestation(e,r)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}}),by(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),by(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async e=>{const t=await this.fetchPublicKey();t&&(await this.persistPublicKey(t),e(t))});const e=await this.fetchPromise;return this.fetchPromise=void 0,e}),by(this,"validateAttestation",(e,t)=>{const r=function(e,t){const[r,n,i]=e.split("."),s=oa.from(fd(i),"base64");if(64!==s.length)throw new Error("Invalid signature length");const o=s.slice(0,32),a=s.slice(32,64),c=Ru(`${r}.${n}`),l=function(e){const t=oa.from(e.x,"base64"),r=oa.from(e.y,"base64");return Ts([new Uint8Array([4]),t,r])}(t);if(!rd.verify(Ts([o,a]),c,l))throw new Error("Invalid signature");return $n(e).payload}(e,t.publicKey),n={hasExpired:(0,b.toMiliseconds)(r.exp)<Date.now(),payload:r};if(n.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:n.payload.origin,isScam:n.payload.isScam,isVerified:n.payload.isVerified}}),this.logger=(0,ee.U5)(t,this.name),this.abortController=new AbortController,this.isDevEnv=$a(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return(0,ee.oI)(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,b.toMiliseconds)(e))}}var Ey=Object.defineProperty,Ay=(e,t,r)=>((e,t,r)=>t in e?Ey(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class _y extends pe{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,Ay(this,"context","echo"),Ay(this,"registerDeviceToken",async e=>{const{clientId:t,token:r,notificationType:n,enableEncrypted:i=!1}=e,s=`https://echo.walletconnect.com/${this.projectId}/clients`;await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:t,type:n,token:r,always_raw:i})})}),this.logger=(0,ee.U5)(t,this.context)}}var Iy=Object.defineProperty,Sy=Object.getOwnPropertySymbols,Cy=Object.prototype.hasOwnProperty,ky=Object.prototype.propertyIsEnumerable,Ny=(e,t,r)=>t in e?Iy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,xy=(e,t)=>{for(var r in t||(t={}))Cy.call(t,r)&&Ny(e,r,t[r]);if(Sy)for(var r of Sy(t))ky.call(t,r)&&Ny(e,r,t[r]);return e},Ty=(e,t,r)=>Ny(e,"symbol"!=typeof t?t+"":t,r);class Oy extends fe{constructor(e,t,r=!0){super(e,t,r),this.core=e,this.logger=t,Ty(this,"context","event-client"),Ty(this,"storagePrefix",Hp),Ty(this,"storageVersion",.1),Ty(this,"events",new Map),Ty(this,"shouldPersist",!1),Ty(this,"init",async()=>{if(!$a())try{const e={eventId:ja(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:ka(this.core.relayer.protocol,this.core.relayer.version,of)}}};await this.sendEvent([e])}catch(e){this.logger.warn(e)}}),Ty(this,"createEvent",e=>{const{event:t="ERROR",type:r="",properties:{topic:n,trace:i}}=e,s=ja(),o=this.core.projectId||"",a=Date.now(),c=xy({eventId:s,timestamp:a,props:{event:t,type:r,properties:{topic:n,trace:i}},bundleId:o,domain:this.getAppDomain()},this.setMethods(s));return this.telemetryEnabled&&(this.events.set(s,c),this.shouldPersist=!0),c}),Ty(this,"getEvent",e=>{const{eventId:t,topic:r}=e;if(t)return this.events.get(t);const n=Array.from(this.events.values()).find(e=>e.props.properties.topic===r);return n?xy(xy({},n),this.setMethods(n.eventId)):void 0}),Ty(this,"deleteEvent",e=>{const{eventId:t}=e;this.events.delete(t),this.shouldPersist=!0}),Ty(this,"setEventListeners",()=>{this.core.heartbeat.on(_,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(e=>{(0,b.fromMiliseconds)(Date.now())-(0,b.fromMiliseconds)(e.timestamp)>86400&&(this.events.delete(e.eventId),this.shouldPersist=!0)})})}),Ty(this,"setMethods",e=>({addTrace:t=>this.addTrace(e,t),setError:t=>this.setError(e,t)})),Ty(this,"addTrace",(e,t)=>{const r=this.events.get(e);r&&(r.props.properties.trace.push(t),this.events.set(e,r),this.shouldPersist=!0)}),Ty(this,"setError",(e,t)=>{const r=this.events.get(e);r&&(r.props.type=t,r.timestamp=Date.now(),this.events.set(e,r),this.shouldPersist=!0)}),Ty(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Ty(this,"restore",async()=>{try{const e=await this.core.storage.getItem(this.storageKey)||[];if(!e.length)return;e.forEach(e=>{this.events.set(e.eventId,xy(xy({},e),this.setMethods(e.eventId)))})}catch(e){this.logger.warn(e)}}),Ty(this,"submit",async()=>{if(!this.telemetryEnabled||0===this.events.size)return;const e=[];for(const[t,r]of this.events)r.props.type&&e.push(r);if(0!==e.length)try{if((await this.sendEvent(e)).ok)for(const t of e)this.events.delete(t.eventId),this.shouldPersist=!0}catch(e){this.logger.warn(e)}}),Ty(this,"sendEvent",async e=>{const t=this.getAppDomain()?"":"&sp=desktop";return await fetch(`https://pulse.walletconnect.org/batch?projectId=${this.core.projectId}&st=events_sdk&sv=js-${of}${t}`,{method:"POST",body:JSON.stringify(e)})}),Ty(this,"getAppDomain",()=>Ca().url),this.logger=(0,ee.U5)(t,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var Py=Object.defineProperty,Ry=Object.getOwnPropertySymbols,Uy=Object.prototype.hasOwnProperty,By=Object.prototype.propertyIsEnumerable,My=(e,t,r)=>t in e?Py(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ly=(e,t)=>{for(var r in t||(t={}))Uy.call(t,r)&&My(e,r,t[r]);if(Ry)for(var r of Ry(t))By.call(t,r)&&My(e,r,t[r]);return e},Dy=(e,t,r)=>My(e,"symbol"!=typeof t?t+"":t,r);class Wy extends ne{constructor(e){var t;super(e),Dy(this,"protocol","wc"),Dy(this,"version",2),Dy(this,"name",Fp),Dy(this,"relayUrl"),Dy(this,"projectId"),Dy(this,"customStoragePrefix"),Dy(this,"events",new y.EventEmitter),Dy(this,"logger"),Dy(this,"heartbeat"),Dy(this,"relayer"),Dy(this,"crypto"),Dy(this,"storage"),Dy(this,"history"),Dy(this,"expirer"),Dy(this,"pairing"),Dy(this,"verify"),Dy(this,"echoClient"),Dy(this,"linkModeSupportedApps"),Dy(this,"eventClient"),Dy(this,"initialized",!1),Dy(this,"logChunkController"),Dy(this,"on",(e,t)=>this.events.on(e,t)),Dy(this,"once",(e,t)=>this.events.once(e,t)),Dy(this,"off",(e,t)=>this.events.off(e,t)),Dy(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),Dy(this,"dispatchEnvelope",({topic:e,message:t,sessionExists:r})=>{if(!e||!t)return;const n={topic:e,message:t,publishedAt:Date.now(),transportType:af.link_mode};this.relayer.onLinkMessageEvent(n,{sessionExists:r})});const r=this.getGlobalCore(e?.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(e){console.warn("Failed to copy global core",e)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||Zp,this.customStoragePrefix=null!=e&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const n=(0,ee.iP)({level:"string"==typeof e?.logger&&e.logger?e.logger:"error",name:Fp}),{logger:i,chunkLoggerController:s}=(0,ee.D5)({opts:n,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=s,null!=(t=this.logChunkController)&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var e,t;null!=(e=this.logChunkController)&&e.downloadLogsBlobInBrowser&&(null==(t=this.logChunkController)||t.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=(0,ee.U5)(i,this.name),this.heartbeat=new I,this.crypto=new im(this,this.logger,e?.keychain),this.history=new fy(this,this.logger),this.expirer=new yy(this,this.logger),this.storage=null!=e&&e.storage?e.storage:new Q(Ly(Ly({},Kp),e?.storageOptions)),this.relayer=new Km({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new hy(this,this.logger),this.verify=new vy(this,this.logger,this.storage),this.echoClient=new _y(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new Oy(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const t=new Wy(e);await t.initialize();const r=await t.crypto.getClientId();return await t.storage.setItem("WALLETCONNECT_CLIENT_ID",r),t}get context(){return(0,ee.oI)(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return null==(e=this.logChunkController)?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(lf,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(lf)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const t=`_walletConnectCore_${e}`,r=`${t}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[t]}catch(e){return void console.warn("Failed to get global WalletConnect core",e)}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${(null==(t=e.opts)?void 0:t.customStoragePrefix)||""}`;globalThis[r]=e}catch(e){console.warn("Failed to set global WalletConnect core",e)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&"true"===process.env.DISABLE_GLOBAL_CORE}catch{return!0}}}const jy=Wy,$y="client",zy=`wc@2:${$y}:`,qy=$y,Fy="WALLETCONNECT_DEEPLINK_CHOICE",Hy="Proposal expired",Ky=b.SEVEN_DAYS,Vy={wc_sessionPropose:{req:{ttl:b.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:b.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:b.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:b.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:b.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:b.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:b.ONE_DAY,prompt:!1,tag:1104},res:{ttl:b.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:b.ONE_DAY,prompt:!1,tag:1106},res:{ttl:b.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:b.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:b.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:b.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:b.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:b.ONE_DAY,prompt:!1,tag:1112},res:{ttl:b.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:b.ONE_DAY,prompt:!1,tag:1114},res:{ttl:b.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:b.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:b.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:b.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:b.FIVE_MINUTES,prompt:!1,tag:1119}}},Yy={min:b.FIVE_MINUTES,max:b.SEVEN_DAYS},Gy="IDLE",Zy="ACTIVE",Jy={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},Xy=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],Qy="wc@1.5:auth:",ew=`${Qy}:PUB_KEY`;var tw=Object.defineProperty,rw=Object.defineProperties,nw=Object.getOwnPropertyDescriptors,iw=Object.getOwnPropertySymbols,sw=Object.prototype.hasOwnProperty,ow=Object.prototype.propertyIsEnumerable,aw=(e,t,r)=>t in e?tw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,cw=(e,t)=>{for(var r in t||(t={}))sw.call(t,r)&&aw(e,r,t[r]);if(iw)for(var r of iw(t))ow.call(t,r)&&aw(e,r,t[r]);return e},lw=(e,t)=>rw(e,nw(t)),uw=(e,t,r)=>aw(e,"symbol"!=typeof t?t+"":t,r);class hw extends we{constructor(e){super(e),uw(this,"name","engine"),uw(this,"events",new(w())),uw(this,"initialized",!1),uw(this,"requestQueue",{state:Gy,queue:[]}),uw(this,"sessionRequestQueue",{state:Gy,queue:[]}),uw(this,"emittedSessionRequests",new qa({limit:500})),uw(this,"requestQueueDelay",b.ONE_SECOND),uw(this,"expectedPairingMethodMap",new Map),uw(this,"recentlyDeletedMap",new Map),uw(this,"recentlyDeletedLimit",200),uw(this,"relayMessageCache",[]),uw(this,"pendingSessions",new Map),uw(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Vy)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,b.toMiliseconds)(this.requestQueueDelay)))}),uw(this,"connect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const t=lw(cw({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});await this.isValidConnect(t),t.optionalNamespaces=function(e,t){var r,n,i,s,o,a;const c=Wd(e),l=Wd(t),u={},h=Object.keys(c).concat(Object.keys(l));for(const e of h)u[e]={chains:Da(null==(r=c[e])?void 0:r.chains,null==(n=l[e])?void 0:n.chains),methods:Da(null==(i=c[e])?void 0:i.methods,null==(s=l[e])?void 0:s.methods),events:Da(null==(o=c[e])?void 0:o.events,null==(a=l[e])?void 0:a.events)};return u}(t.requiredNamespaces,t.optionalNamespaces),t.requiredNamespaces={};const{pairingTopic:r,requiredNamespaces:n,optionalNamespaces:i,sessionProperties:s,scopedProperties:o,relays:a}=t;let c,l=r,u=!1;try{if(l){const e=this.client.core.pairing.pairings.get(l);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),u=e.active}}catch(e){throw this.client.logger.error(`connect() -> pairing.get(${l}) failed`),e}if(!l||!u){const{topic:e,uri:t}=await this.client.core.pairing.create();l=e,c=t}if(!l){const{message:e}=qd("NO_MATCHING_KEY",`connect() pairing topic: ${l}`);throw new Error(e)}const h=await this.client.core.crypto.generateKeyPair(),d=Vy.wc_sessionPropose.req.ttl||b.FIVE_MINUTES,p=Ba(d),f=lw(cw(cw({requiredNamespaces:n,optionalNamespaces:i,relays:a??[{protocol:"irn"}],proposer:{publicKey:h,metadata:this.client.metadata},expiryTimestamp:p,pairingTopic:l},s&&{sessionProperties:s}),o&&{scopedProperties:o}),{id:Ap()}),g=La("session_connect",f.id),{reject:m,resolve:y,done:w}=Oa(d,Hy),v=({id:e})=>{e===f.id&&(this.client.events.off("proposal_expire",v),this.pendingSessions.delete(f.id),this.events.emit(g,{error:{message:Hy,code:0}}))};return this.client.events.on("proposal_expire",v),this.events.once(g,({error:e,session:t})=>{this.client.events.off("proposal_expire",v),e?m(e):t&&y(t)}),await this.sendRequest({topic:l,method:"wc_sessionPropose",params:f,throwOnFailedPublish:!0,clientRpcId:f.id}),await this.setProposal(f.id,f),{uri:c,approval:w}}),uw(this,"pair",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(e)}catch(e){throw this.client.logger.error("pair() failed"),e}}),uw(this,"approve",async e=>{var t,r,n;const i=this.client.core.eventClient.createEvent({properties:{topic:null==(t=e?.id)?void 0:t.toString(),trace:[Cf]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(e){throw i.setError("no_internet_connection"),e}try{await this.isValidProposalId(e?.id)}catch(t){throw this.client.logger.error(`approve() -> proposal.get(${e?.id}) failed`),i.setError("proposal_not_found"),t}try{await this.isValidApprove(e)}catch(e){throw this.client.logger.error("approve() -> isValidApprove() failed"),i.setError("session_approve_namespace_validation_failure"),e}const{id:s,relayProtocol:o,namespaces:a,sessionProperties:c,scopedProperties:l,sessionConfig:u}=e,h=this.client.proposal.get(s);this.client.core.eventClient.deleteEvent({eventId:i.eventId});const{pairingTopic:d,proposer:p,requiredNamespaces:f,optionalNamespaces:g}=h;let m=null==(r=this.client.core.eventClient)?void 0:r.getEvent({topic:d});m||(m=null==(n=this.client.core.eventClient)?void 0:n.createEvent({type:Cf,properties:{topic:d,trace:[Cf,"session_namespaces_validation_success"]}}));const y=await this.client.core.crypto.generateKeyPair(),w=p.publicKey,b=await this.client.core.crypto.generateSharedKey(y,w),v=cw(cw(cw({relay:{protocol:o??"irn"},namespaces:a,controller:{publicKey:y,metadata:this.client.metadata},expiry:Ba(Ky)},c&&{sessionProperties:c}),l&&{scopedProperties:l}),u&&{sessionConfig:u}),E=af.relay;m.addTrace("subscribing_session_topic");try{await this.client.core.relayer.subscribe(b,{transportType:E})}catch(e){throw m.setError("subscribe_session_topic_failure"),e}m.addTrace("subscribe_session_topic_success");const A=lw(cw({},v),{topic:b,requiredNamespaces:f,optionalNamespaces:g,pairingTopic:d,acknowledged:!1,self:v.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:y,transportType:af.relay});await this.client.session.set(b,A),m.addTrace("store_session");try{m.addTrace("publishing_session_settle"),await this.sendRequest({topic:b,method:"wc_sessionSettle",params:v,throwOnFailedPublish:!0}).catch(e=>{throw m?.setError("session_settle_publish_failure"),e}),m.addTrace("session_settle_publish_success"),m.addTrace("publishing_session_approve"),await this.sendResult({id:s,topic:d,result:{relay:{protocol:o??"irn"},responderPublicKey:y},throwOnFailedPublish:!0}).catch(e=>{throw m?.setError("session_approve_publish_failure"),e}),m.addTrace("session_approve_publish_success")}catch(e){throw this.client.logger.error(e),this.client.session.delete(b,Fd("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(b),e}return this.client.core.eventClient.deleteEvent({eventId:m.eventId}),await this.client.core.pairing.updateMetadata({topic:d,metadata:p.metadata}),await this.deleteProposal(s),await this.client.core.pairing.activate({topic:d}),await this.setExpiry(b,Ba(Ky)),{topic:b,acknowledged:()=>Promise.resolve(this.client.session.get(b))}}),uw(this,"reject",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(e)}catch(e){throw this.client.logger.error("reject() -> isValidReject() failed"),e}const{id:t,reason:r}=e;let n;try{n=this.client.proposal.get(t).pairingTopic}catch(e){throw this.client.logger.error(`reject() -> proposal.get(${t}) failed`),e}n&&await this.sendError({id:t,topic:n,error:r,rpcOpts:Vy.wc_sessionPropose.reject}),await this.deleteProposal(t)}),uw(this,"update",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(e)}catch(e){throw this.client.logger.error("update() -> isValidUpdate() failed"),e}const{topic:t,namespaces:r}=e,{done:n,resolve:i,reject:s}=Oa(),o=Ap(),a=_p().toString(),c=this.client.session.get(t).namespaces;return this.events.once(La("session_update",o),({error:e})=>{e?s(e):i()}),await this.client.session.update(t,{namespaces:r}),await this.sendRequest({topic:t,method:"wc_sessionUpdate",params:{namespaces:r},throwOnFailedPublish:!0,clientRpcId:o,relayRpcId:a}).catch(e=>{this.client.logger.error(e),this.client.session.update(t,{namespaces:c}),s(e)}),{acknowledged:n}}),uw(this,"extend",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(e)}catch(e){throw this.client.logger.error("extend() -> isValidExtend() failed"),e}const{topic:t}=e,r=Ap(),{done:n,resolve:i,reject:s}=Oa();return this.events.once(La("session_extend",r),({error:e})=>{e?s(e):i()}),await this.setExpiry(t,Ba(Ky)),this.sendRequest({topic:t,method:"wc_sessionExtend",params:{},clientRpcId:r,throwOnFailedPublish:!0}).catch(e=>{s(e)}),{acknowledged:n}}),uw(this,"request",async e=>{this.isInitialized();try{await this.isValidRequest(e)}catch(e){throw this.client.logger.error("request() -> isValidRequest() failed"),e}const{chainId:t,request:n,topic:i,expiry:s=Vy.wc_sessionRequest.req.ttl}=e,o=this.client.session.get(i);o?.transportType===af.relay&&await this.confirmOnlineStateOrThrow();const a=Ap(),c=_p().toString(),{done:l,resolve:u,reject:h}=Oa(s,"Request expired. Please try again.");this.events.once(La("session_request",a),({error:e,result:t})=>{e?h(e):u(t)});const d="wc_sessionRequest",p=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);if(p)return await this.sendRequest({clientRpcId:a,relayRpcId:c,topic:i,method:d,params:{request:lw(cw({},n),{expiryTimestamp:Ba(s)}),chainId:t},expiry:s,throwOnFailedPublish:!0,appLink:p}).catch(e=>h(e)),this.client.events.emit("session_request_sent",{topic:i,request:n,chainId:t,id:a}),await l();const f={request:lw(cw({},n),{expiryTimestamp:Ba(s)}),chainId:t};return await Promise.all([new Promise(async e=>{await this.sendRequest({clientRpcId:a,relayRpcId:c,topic:i,method:d,params:f,expiry:s,throwOnFailedPublish:!0,tvf:this.getTVFParams(a,f)}).catch(e=>h(e)),this.client.events.emit("session_request_sent",{topic:i,request:n,chainId:t,id:a}),e()}),new Promise(async e=>{var t;if(null==(t=o.sessionConfig)||!t.disableDeepLink){const e=await async function(e,t){let r="";try{if(_a()&&(r=localStorage.getItem(t),r))return r;r=await e.getItem(t)}catch(e){console.error(e)}return r}(this.client.core.storage,Fy);await async function({id:e,topic:t,wcDeepLink:n}){var i;try{if(!n)return;const s="string"==typeof n?JSON.parse(n):n,o=s?.href;if("string"!=typeof o)return;const a=function(e,t,r){const n=`requestId=${t}&sessionTopic=${r}`;e.endsWith("/")&&(e=e.slice(0,-1));let i=`${e}`;return i=e.startsWith("https://t.me")?`${i}${e.includes("?")?"&startapp=":"?startapp="}${function(e,t=!1){const r=oa.from(e).toString("base64");return t?r.replace(/[=]/g,""):r}(n,!0)}`:`${i}/wc?${n}`,i}(o,e,t),c=Ia();if(c===ba){if(null==(i=(0,Qn.getDocument)())||!i.hasFocus())return void console.warn("Document does not have focus, skipping deeplink.");!function(e){let t="_self";!function(){try{return window.self!==window.top}catch{return!1}}()?(typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)||e.startsWith("https://")||e.startsWith("http://"))&&(t="_blank"):t="_top",window.open(e,t,"noreferrer noopener")}(a)}else c===wa&&typeof(null==r.g?void 0:r.g.Linking)<"u"&&await r.g.Linking.openURL(a)}catch(e){console.error(e)}}({id:a,topic:i,wcDeepLink:e})}e()}),l()]).then(e=>e[2])}),uw(this,"respond",async e=>{this.isInitialized(),await this.isValidRespond(e);const{topic:t,response:r}=e,{id:n}=r,i=this.client.session.get(t);i.transportType===af.relay&&await this.confirmOnlineStateOrThrow();const s=this.getAppLinkIfEnabled(i.peer.metadata,i.transportType);Lp(r)?await this.sendResult({id:n,topic:t,result:r.result,throwOnFailedPublish:!0,appLink:s}):Dp(r)&&await this.sendError({id:n,topic:t,error:r.error,appLink:s}),this.cleanupAfterResponse(e)}),uw(this,"ping",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(e)}catch(e){throw this.client.logger.error("ping() -> isValidPing() failed"),e}const{topic:t}=e;if(this.client.session.keys.includes(t)){const e=Ap(),r=_p().toString(),{done:n,resolve:i,reject:s}=Oa();this.events.once(La("session_ping",e),({error:e})=>{e?s(e):i()}),await Promise.all([this.sendRequest({topic:t,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:e,relayRpcId:r}),n()])}else this.client.core.pairing.pairings.keys.includes(t)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:t}))}),uw(this,"emit",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(e);const{topic:t,event:r,chainId:n}=e,i=_p().toString(),s=Ap();await this.sendRequest({topic:t,method:"wc_sessionEvent",params:{event:r,chainId:n},throwOnFailedPublish:!0,relayRpcId:i,clientRpcId:s})}),uw(this,"disconnect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(e);const{topic:t}=e;if(this.client.session.keys.includes(t))await this.sendRequest({topic:t,method:"wc_sessionDelete",params:Fd("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:t,emitEvent:!1});else{if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:e}=qd("MISMATCHED_TOPIC",`Session or pairing topic not found: ${t}`);throw new Error(e)}await this.client.core.pairing.disconnect({topic:t})}}),uw(this,"find",e=>(this.isInitialized(),this.client.session.getAll().filter(t=>function(e,t){const{requiredNamespaces:r}=t,n=Object.keys(e.namespaces),i=Object.keys(r);let s=!0;return!!Na(i,n)&&(n.forEach(t=>{const{accounts:n,methods:i,events:o}=e.namespaces[t],a=Md(n),c=r[t];Na(ca(t,c),a)&&Na(c.methods,i)&&Na(c.events,o)||(s=!1)}),s)}(t,e)))),uw(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),uw(this,"authenticate",async(e,t)=>{var r;this.isInitialized(),this.isValidAuthenticate(e);const n=t&&this.client.core.linkModeSupportedApps.includes(t)&&(null==(r=this.client.metadata.redirect)?void 0:r.linkMode),i=n?af.link_mode:af.relay;i===af.relay&&await this.confirmOnlineStateOrThrow();const{chains:s,statement:o="",uri:a,domain:c,nonce:l,type:u,exp:h,nbf:d,methods:p=[],expiry:f}=e,g=[...e.resources||[]],{topic:m,uri:y}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:i});this.client.logger.info({message:"Generated new pairing",pairing:{topic:m,uri:y}});const w=await this.client.core.crypto.generateKeyPair(),b=ld(w);if(await Promise.all([this.client.auth.authKeys.set(ew,{responseTopic:b,publicKey:w}),this.client.auth.pairingTopics.set(b,{topic:b,pairingTopic:m})]),await this.client.core.relayer.subscribe(b,{transportType:i}),this.client.logger.info(`sending request to new pairing topic: ${m}`),p.length>0){const{namespace:e}=aa(s[0]);let t=function(e,t,r){const n=function(e,t,r,n={}){return r?.sort((e,t)=>e.localeCompare(t)),{att:{[e]:Hl(t,r,n)}}}(e,t,r);return Kl(n)}(e,"request",p);Jl(g)&&(t=Yl(t,g.pop())),g.push(t)}const v=f&&f>Vy.wc_sessionAuthenticate.req.ttl?f:Vy.wc_sessionAuthenticate.req.ttl,E={authPayload:{type:u??"caip122",chains:s,statement:o,aud:a,domain:c,version:"1",nonce:l,iat:(new Date).toISOString(),exp:h,nbf:d,resources:g},requester:{publicKey:w,metadata:this.client.metadata},expiryTimestamp:Ba(v)},A={requiredNamespaces:{},optionalNamespaces:{eip155:{chains:s,methods:[...new Set(["personal_sign",...p])],events:["chainChanged","accountsChanged"]}},relays:[{protocol:"irn"}],pairingTopic:m,proposer:{publicKey:w,metadata:this.client.metadata},expiryTimestamp:Ba(Vy.wc_sessionPropose.req.ttl),id:Ap()},{done:_,resolve:I,reject:S}=Oa(v,"Request expired"),C=Ap(),k=La("session_connect",A.id),N=La("session_request",C),x=async({error:e,session:t})=>{this.events.off(N,T),e?S(e):t&&I({session:t})},T=async e=>{var r,n,s;if(await this.deletePendingAuthRequest(C,{message:"fulfilled",code:0}),e.error){const t=Fd("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return e.error.code===t.code?void 0:(this.events.off(k,x),S(e.error.message))}await this.deleteProposal(A.id),this.events.off(k,x);const{cacaos:o,responder:a}=e.result,c=[],l=[];for(const e of o){await zl({cacao:e,projectId:this.client.core.projectId})||(this.client.logger.error(e,"Signature verification failed"),S(Fd("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:t}=e,r=Jl(t.resources),n=[jl(t.iss)],i=$l(t.iss);if(r){const e=Gl(r),t=Zl(r);c.push(...e),n.push(...t)}for(const e of n)l.push(`${e}:${i}`)}const u=await this.client.core.crypto.generateSharedKey(w,a.publicKey);let h;c.length>0&&(h={topic:u,acknowledged:!0,self:{publicKey:w,metadata:this.client.metadata},peer:a,controller:a.publicKey,expiry:Ba(Ky),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:m,namespaces:jd([...new Set(c)],[...new Set(l)]),transportType:i},await this.client.core.relayer.subscribe(u,{transportType:i}),await this.client.session.set(u,h),m&&await this.client.core.pairing.updateMetadata({topic:m,metadata:a.metadata}),h=this.client.session.get(u)),null!=(r=this.client.metadata.redirect)&&r.linkMode&&null!=(n=a.metadata.redirect)&&n.linkMode&&null!=(s=a.metadata.redirect)&&s.universal&&t&&(this.client.core.addLinkModeSupportedApp(a.metadata.redirect.universal),this.client.session.update(u,{transportType:af.link_mode})),I({auths:o,session:h})};let O;this.events.once(k,x),this.events.once(N,T);try{if(n){const e=Ip("wc_sessionAuthenticate",E,C);this.client.core.history.set(m,e);const r=await this.client.core.crypto.encode("",e,{type:2,encoding:od});O=Cd(t,m,r)}else await Promise.all([this.sendRequest({topic:m,method:"wc_sessionAuthenticate",params:E,expiry:e.expiry,throwOnFailedPublish:!0,clientRpcId:C}),this.sendRequest({topic:m,method:"wc_sessionPropose",params:A,expiry:Vy.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:A.id})])}catch(e){throw this.events.off(k,x),this.events.off(N,T),e}return await this.setProposal(A.id,A),await this.setAuthRequest(C,{request:lw(cw({},E),{verifyContext:{}}),pairingTopic:m,transportType:i}),{uri:O??y,response:_}}),uw(this,"approveSessionAuthenticate",async e=>{const{id:t,auths:r}=e,n=this.client.core.eventClient.createEvent({properties:{topic:t.toString(),trace:["authenticated_session_approve_started"]}});try{this.isInitialized()}catch(e){throw n.setError("no_internet_connection"),e}const i=this.getPendingAuthRequest(t);if(!i)throw n.setError("authenticated_session_pending_request_not_found"),new Error(`Could not find pending auth request with id ${t}`);const s=i.transportType||af.relay;s===af.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=ld(o),l={type:1,receiverPublicKey:o,senderPublicKey:a},u=[],h=[];for(const e of r){if(!await zl({cacao:e,projectId:this.client.core.projectId})){n.setError("invalid_cacao");const e=Fd("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:t,topic:c,error:e,encodeOpts:l}),new Error(e.message)}n.addTrace("cacaos_verified");const{p:r}=e,i=Jl(r.resources),s=[jl(r.iss)],o=$l(r.iss);if(i){const e=Gl(i),t=Zl(i);u.push(...e),s.push(...t)}for(const e of s)h.push(`${e}:${o}`)}const d=await this.client.core.crypto.generateSharedKey(a,o);let p;if(n.addTrace("create_authenticated_session_topic"),u?.length>0){p={topic:d,acknowledged:!0,self:{publicKey:a,metadata:this.client.metadata},peer:{publicKey:o,metadata:i.requester.metadata},controller:o,expiry:Ba(Ky),authentication:r,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:i.pairingTopic,namespaces:jd([...new Set(u)],[...new Set(h)]),transportType:s},n.addTrace("subscribing_authenticated_session_topic");try{await this.client.core.relayer.subscribe(d,{transportType:s})}catch(e){throw n.setError("subscribe_authenticated_session_topic_failure"),e}n.addTrace("subscribe_authenticated_session_topic_success"),await this.client.session.set(d,p),n.addTrace("store_authenticated_session"),await this.client.core.pairing.updateMetadata({topic:i.pairingTopic,metadata:i.requester.metadata})}n.addTrace("publishing_authenticated_session_approve");try{await this.sendResult({topic:c,id:t,result:{cacaos:r,responder:{publicKey:a,metadata:this.client.metadata}},encodeOpts:l,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(i.requester.metadata,s)})}catch(e){throw n.setError("authenticated_session_approve_publish_failure"),e}return await this.client.auth.requests.delete(t,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:i.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:n.eventId}),{session:p}}),uw(this,"rejectSessionAuthenticate",async e=>{this.isInitialized();const{id:t,reason:r}=e,n=this.getPendingAuthRequest(t);if(!n)throw new Error(`Could not find pending auth request with id ${t}`);n.transportType===af.relay&&await this.confirmOnlineStateOrThrow();const i=n.requester.publicKey,s=await this.client.core.crypto.generateKeyPair(),o=ld(i),a={type:1,receiverPublicKey:i,senderPublicKey:s};await this.sendError({id:t,topic:o,error:r,encodeOpts:a,rpcOpts:Vy.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(n.requester.metadata,n.transportType)}),await this.client.auth.requests.delete(t,{message:"rejected",code:0}),await this.deleteProposal(t)}),uw(this,"formatAuthMessage",e=>{this.isInitialized();const{request:t,iss:r}=e;return ql(t,r)}),uw(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(0!==this.relayMessageCache.length)for(;this.relayMessageCache.length>0;)try{const e=this.relayMessageCache.shift();e&&await this.onRelayMessage(e)}catch(e){this.client.logger.error(e)}},50)}),uw(this,"cleanupDuplicatePairings",async e=>{if(e.pairingTopic)try{const t=this.client.core.pairing.pairings.get(e.pairingTopic),r=this.client.core.pairing.pairings.getAll().filter(r=>{var n,i;return(null==(n=r.peerMetadata)?void 0:n.url)&&(null==(i=r.peerMetadata)?void 0:i.url)===e.peer.metadata.url&&r.topic&&r.topic!==t.topic});if(0===r.length)return;this.client.logger.info(`Cleaning up ${r.length} duplicate pairing(s)`),await Promise.all(r.map(e=>this.client.core.pairing.disconnect({topic:e.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(e){this.client.logger.error(e)}}),uw(this,"deleteSession",async e=>{var t;const{topic:r,expirerHasDeleted:n=!1,emitEvent:i=!0,id:s=0}=e,{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await this.client.session.delete(r,Fd("USER_DISCONNECTED")),this.addToRecentlyDeleted(r,"session"),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r),this.client.core.storage.removeItem(Fy).catch(e=>this.client.logger.warn(e)),this.getPendingSessionRequests().forEach(e=>{e.topic===r&&this.deletePendingSessionRequest(e.id,Fd("USER_DISCONNECTED"))}),r===(null==(t=this.sessionRequestQueue.queue[0])?void 0:t.topic)&&(this.sessionRequestQueue.state=Gy),i&&this.client.events.emit("session_delete",{id:s,topic:r})}),uw(this,"deleteProposal",async(e,t)=>{if(t)try{const t=this.client.proposal.get(e),r=this.client.core.eventClient.getEvent({topic:t.pairingTopic});r?.setError("proposal_expired")}catch{}await Promise.all([this.client.proposal.delete(e,Fd("USER_DISCONNECTED")),t?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"proposal")}),uw(this,"deletePendingSessionRequest",async(e,t,r=!1)=>{await Promise.all([this.client.pendingRequest.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(t=>t.id!==e),r&&(this.sessionRequestQueue.state=Gy,this.client.events.emit("session_request_expire",{id:e}))}),uw(this,"deletePendingAuthRequest",async(e,t,r=!1)=>{await Promise.all([this.client.auth.requests.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)])}),uw(this,"setExpiry",async(e,t)=>{this.client.session.keys.includes(e)&&(this.client.core.expirer.set(e,t),await this.client.session.update(e,{expiry:t}))}),uw(this,"setProposal",async(e,t)=>{this.client.core.expirer.set(e,Ba(Vy.wc_sessionPropose.req.ttl)),await this.client.proposal.set(e,t)}),uw(this,"setAuthRequest",async(e,t)=>{const{request:r,pairingTopic:n,transportType:i=af.relay}=t;this.client.core.expirer.set(e,r.expiryTimestamp),await this.client.auth.requests.set(e,{authPayload:r.authPayload,requester:r.requester,expiryTimestamp:r.expiryTimestamp,id:e,pairingTopic:n,verifyContext:r.verifyContext,transportType:i})}),uw(this,"setPendingSessionRequest",async e=>{const{id:t,topic:r,params:n,verifyContext:i}=e,s=n.request.expiryTimestamp||Ba(Vy.wc_sessionRequest.req.ttl);this.client.core.expirer.set(t,s),await this.client.pendingRequest.set(t,{id:t,topic:r,params:n,verifyContext:i})}),uw(this,"sendRequest",async e=>{const{topic:t,method:n,params:i,expiry:s,relayRpcId:o,clientRpcId:a,throwOnFailedPublish:c,appLink:l,tvf:u}=e,h=Ip(n,i,a);let d;const p=!!l;try{const e=p?od:sd;d=await this.client.core.crypto.encode(t,h,{encoding:e})}catch(e){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${t} failed`),e}let f;if(Xy.includes(n)){const e=ud(JSON.stringify(h)),t=ud(d);f=await this.client.core.verify.register({id:t,decryptedId:e})}const g=Vy[n].req;if(g.attestation=f,s&&(g.ttl=s),o&&(g.id=o),this.client.core.history.set(t,h),p){const e=Cd(l,t,d);await r.g.Linking.openURL(e,this.client.name)}else{const e=Vy[n].req;s&&(e.ttl=s),o&&(e.id=o),e.tvf=lw(cw({},u),{correlationId:h.id}),c?(e.internal=lw(cw({},e.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(t,d,e)):this.client.core.relayer.publish(t,d,e).catch(e=>this.client.logger.error(e))}return h.id}),uw(this,"sendResult",async e=>{const{id:t,topic:n,result:i,throwOnFailedPublish:s,encodeOpts:o,appLink:a}=e,c=Sp(t,i);let l;const u=a&&typeof(null==r.g?void 0:r.g.Linking)<"u";try{const e=u?od:sd;l=await this.client.core.crypto.encode(n,c,lw(cw({},o||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${n} failed`),e}let h,d;try{h=await this.client.core.history.get(n,t);const e=h.request;try{d=this.getTVFParams(t,e.params,i)}catch(e){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${e?.message}`)}}catch(e){throw this.client.logger.error(`sendResult() -> history.get(${n}, ${t}) failed`),e}if(u){const e=Cd(a,n,l);await r.g.Linking.openURL(e,this.client.name)}else{const e=h.request.method,r=Vy[e].res;r.tvf=lw(cw({},d),{correlationId:t}),s?(r.internal=lw(cw({},r.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,l,r)):this.client.core.relayer.publish(n,l,r).catch(e=>this.client.logger.error(e))}await this.client.core.history.resolve(c)}),uw(this,"sendError",async e=>{const{id:t,topic:n,error:i,encodeOpts:s,rpcOpts:o,appLink:a}=e,c=Cp(t,i);let l;const u=a&&typeof(null==r.g?void 0:r.g.Linking)<"u";try{const e=u?od:sd;l=await this.client.core.crypto.encode(n,c,lw(cw({},s||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${n} failed`),e}let h;try{h=await this.client.core.history.get(n,t)}catch(e){throw this.client.logger.error(`sendError() -> history.get(${n}, ${t}) failed`),e}if(u){const e=Cd(a,n,l);await r.g.Linking.openURL(e,this.client.name)}else{const e=h.request.method,t=o||Vy[e].res;this.client.core.relayer.publish(n,l,t)}await this.client.core.history.resolve(c)}),uw(this,"cleanup",async()=>{const e=[],t=[];this.client.session.getAll().forEach(t=>{let r=!1;Ma(t.expiry)&&(r=!0),this.client.core.crypto.keychain.has(t.topic)||(r=!0),r&&e.push(t.topic)}),this.client.proposal.getAll().forEach(e=>{Ma(e.expiryTimestamp)&&t.push(e.id)}),await Promise.all([...e.map(e=>this.deleteSession({topic:e})),...t.map(e=>this.deleteProposal(e))])}),uw(this,"onProviderMessageEvent",async e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):await this.onRelayMessage(e)}),uw(this,"onRelayEventRequest",async e=>{this.requestQueue.queue.push(e),await this.processRequestsQueue()}),uw(this,"processRequestsQueue",async()=>{if(this.requestQueue.state!==Zy){for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Zy;const e=this.requestQueue.queue.shift();if(e)try{await this.processRequest(e)}catch(e){this.client.logger.warn(e)}}this.requestQueue.state=Gy}else this.client.logger.info("Request queue already active, skipping...")}),uw(this,"processRequest",async e=>{const{topic:t,payload:r,attestation:n,transportType:i,encryptedId:s}=e,o=r.method;if(!this.shouldIgnorePairingRequest({topic:t,requestMethod:o}))switch(o){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:t,payload:r,attestation:n,encryptedId:s});case"wc_sessionSettle":return await this.onSessionSettleRequest(t,r);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(t,r);case"wc_sessionExtend":return await this.onSessionExtendRequest(t,r);case"wc_sessionPing":return await this.onSessionPingRequest(t,r);case"wc_sessionDelete":return await this.onSessionDeleteRequest(t,r);case"wc_sessionRequest":return await this.onSessionRequest({topic:t,payload:r,attestation:n,encryptedId:s,transportType:i});case"wc_sessionEvent":return await this.onSessionEventRequest(t,r);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:t,payload:r,attestation:n,encryptedId:s,transportType:i});default:return this.client.logger.info(`Unsupported request method ${o}`)}}),uw(this,"onRelayEventResponse",async e=>{const{topic:t,payload:r,transportType:n}=e,i=(await this.client.core.history.get(t,r.id)).request.method;switch(i){case"wc_sessionPropose":return this.onSessionProposeResponse(t,r,n);case"wc_sessionSettle":return this.onSessionSettleResponse(t,r);case"wc_sessionUpdate":return this.onSessionUpdateResponse(t,r);case"wc_sessionExtend":return this.onSessionExtendResponse(t,r);case"wc_sessionPing":return this.onSessionPingResponse(t,r);case"wc_sessionRequest":return this.onSessionRequestResponse(t,r);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(t,r);default:return this.client.logger.info(`Unsupported response method ${i}`)}}),uw(this,"onRelayEventUnknownPayload",e=>{const{topic:t}=e,{message:r}=qd("MISSING_OR_INVALID",`Decoded payload on topic ${t} is not identifiable as a JSON-RPC request or a response.`);throw new Error(r)}),uw(this,"shouldIgnorePairingRequest",e=>{const{topic:t,requestMethod:r}=e,n=this.expectedPairingMethodMap.get(t);return!(!n||n.includes(r)||!(n.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0))}),uw(this,"onSessionProposeRequest",async e=>{const{topic:t,payload:r,attestation:n,encryptedId:i}=e,{params:s,id:o}=r;try{const e=this.client.core.eventClient.getEvent({topic:t});0===this.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),e?.setError("proposal_listener_not_found")),this.isValidConnect(cw({},r.params));const a=s.expiryTimestamp||Ba(Vy.wc_sessionPropose.req.ttl),c=cw({id:o,pairingTopic:t,expiryTimestamp:a,attestation:n,encryptedId:i},s);await this.setProposal(o,c);const l=await this.getVerifyContext({attestationId:n,hash:ud(JSON.stringify(r)),encryptedId:i,metadata:c.proposer.metadata});e?.addTrace("emit_session_proposal"),this.client.events.emit("session_proposal",{id:o,params:c,verifyContext:l})}catch(e){await this.sendError({id:o,topic:t,error:e,rpcOpts:Vy.wc_sessionPropose.autoReject}),this.client.logger.error(e)}}),uw(this,"onSessionProposeResponse",async(e,t,r)=>{const{id:n}=t;if(Lp(t)){const{result:i}=t;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:i});const s=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:s});const o=s.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:o});const a=i.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:a});const c=await this.client.core.crypto.generateSharedKey(o,a);this.pendingSessions.set(n,{sessionTopic:c,pairingTopic:e,proposalId:n,publicKey:o});const l=await this.client.core.relayer.subscribe(c,{transportType:r});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:l}),await this.client.core.pairing.activate({topic:e})}else if(Dp(t)){await this.deleteProposal(n);const e=La("session_connect",n);if(0===this.events.listenerCount(e))throw new Error(`emitting ${e} without any listeners, 954`);this.events.emit(e,{error:t.error})}}),uw(this,"onSessionSettleRequest",async(e,t)=>{const{id:r,params:n}=t;try{this.isValidSessionSettleRequest(n);const{relay:r,controller:i,expiry:s,namespaces:o,sessionProperties:a,scopedProperties:c,sessionConfig:l}=t.params,u=[...this.pendingSessions.values()].find(t=>t.sessionTopic===e);if(!u)return this.client.logger.error(`Pending session not found for topic ${e}`);const h=this.client.proposal.get(u.proposalId),d=lw(cw(cw(cw({topic:e,relay:r,expiry:s,namespaces:o,acknowledged:!0,pairingTopic:u.pairingTopic,requiredNamespaces:h.requiredNamespaces,optionalNamespaces:h.optionalNamespaces,controller:i.publicKey,self:{publicKey:u.publicKey,metadata:this.client.metadata},peer:{publicKey:i.publicKey,metadata:i.metadata}},a&&{sessionProperties:a}),c&&{scopedProperties:c}),l&&{sessionConfig:l}),{transportType:af.relay});await this.client.session.set(d.topic,d),await this.setExpiry(d.topic,d.expiry),await this.client.core.pairing.updateMetadata({topic:u.pairingTopic,metadata:d.peer.metadata}),this.client.events.emit("session_connect",{session:d}),this.events.emit(La("session_connect",u.proposalId),{session:d}),this.pendingSessions.delete(u.proposalId),this.deleteProposal(u.proposalId,!1),this.cleanupDuplicatePairings(d),await this.sendResult({id:t.id,topic:e,result:!0})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),uw(this,"onSessionSettleResponse",async(e,t)=>{const{id:r}=t;Lp(t)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(La("session_approve",r),{})):Dp(t)&&(await this.client.session.delete(e,Fd("USER_DISCONNECTED")),this.events.emit(La("session_approve",r),{error:t.error}))}),uw(this,"onSessionUpdateRequest",async(e,t)=>{const{params:r,id:n}=t;try{const t=`${e}_session_update`,i=ap.get(t);if(i&&this.isRequestOutOfSync(i,n))return this.client.logger.warn(`Discarding out of sync request - ${n}`),void this.sendError({id:n,topic:e,error:Fd("INVALID_UPDATE_REQUEST")});this.isValidUpdate(cw({topic:e},r));try{ap.set(t,n),await this.client.session.update(e,{namespaces:r.namespaces}),await this.sendResult({id:n,topic:e,result:!0})}catch(e){throw ap.delete(t),e}this.client.events.emit("session_update",{id:n,topic:e,params:r})}catch(t){await this.sendError({id:n,topic:e,error:t}),this.client.logger.error(t)}}),uw(this,"isRequestOutOfSync",(e,t)=>t.toString().slice(0,-3)<e.toString().slice(0,-3)),uw(this,"onSessionUpdateResponse",(e,t)=>{const{id:r}=t,n=La("session_update",r);if(0===this.events.listenerCount(n))throw new Error(`emitting ${n} without any listeners`);Lp(t)?this.events.emit(La("session_update",r),{}):Dp(t)&&this.events.emit(La("session_update",r),{error:t.error})}),uw(this,"onSessionExtendRequest",async(e,t)=>{const{id:r}=t;try{this.isValidExtend({topic:e}),await this.setExpiry(e,Ba(Ky)),await this.sendResult({id:r,topic:e,result:!0}),this.client.events.emit("session_extend",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),uw(this,"onSessionExtendResponse",(e,t)=>{const{id:r}=t,n=La("session_extend",r);if(0===this.events.listenerCount(n))throw new Error(`emitting ${n} without any listeners`);Lp(t)?this.events.emit(La("session_extend",r),{}):Dp(t)&&this.events.emit(La("session_extend",r),{error:t.error})}),uw(this,"onSessionPingRequest",async(e,t)=>{const{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),uw(this,"onSessionPingResponse",(e,t)=>{const{id:r}=t,n=La("session_ping",r);setTimeout(()=>{if(0===this.events.listenerCount(n))throw new Error(`emitting ${n} without any listeners 2176`);Lp(t)?this.events.emit(La("session_ping",r),{}):Dp(t)&&this.events.emit(La("session_ping",r),{error:t.error})},500)}),uw(this,"onSessionDeleteRequest",async(e,t)=>{const{id:r}=t;try{this.isValidDisconnect({topic:e,reason:t.params}),Promise.all([new Promise(t=>{this.client.core.relayer.once(ef,async()=>{t(await this.deleteSession({topic:e,id:r}))})}),this.sendResult({id:r,topic:e,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:e,error:Fd("USER_DISCONNECTED")})]).catch(e=>this.client.logger.error(e))}catch(e){this.client.logger.error(e)}}),uw(this,"onSessionRequest",async e=>{var t,r,n;const{topic:i,payload:s,attestation:o,encryptedId:a,transportType:c}=e,{id:l,params:u}=s;try{await this.isValidRequest(cw({topic:i},u));const e=this.client.session.get(i),s={id:l,topic:i,params:u,verifyContext:await this.getVerifyContext({attestationId:o,hash:ud(JSON.stringify(Ip("wc_sessionRequest",u,l))),encryptedId:a,metadata:e.peer.metadata,transportType:c})};await this.setPendingSessionRequest(s),c===af.link_mode&&null!=(t=e.peer.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(null==(r=e.peer.metadata.redirect)?void 0:r.universal),null!=(n=this.client.signConfig)&&n.disableRequestQueue?this.emitSessionRequest(s):(this.addSessionRequestToSessionRequestQueue(s),this.processSessionRequestQueue())}catch(e){await this.sendError({id:l,topic:i,error:e}),this.client.logger.error(e)}}),uw(this,"onSessionRequestResponse",(e,t)=>{const{id:r}=t,n=La("session_request",r);if(0===this.events.listenerCount(n))throw new Error(`emitting ${n} without any listeners`);Lp(t)?this.events.emit(La("session_request",r),{result:t.result}):Dp(t)&&this.events.emit(La("session_request",r),{error:t.error})}),uw(this,"onSessionEventRequest",async(e,t)=>{const{id:r,params:n}=t;try{const t=`${e}_session_event_${n.event.name}`,i=ap.get(t);if(i&&this.isRequestOutOfSync(i,r))return void this.client.logger.info(`Discarding out of sync request - ${r}`);this.isValidEmit(cw({topic:e},n)),this.client.events.emit("session_event",{id:r,topic:e,params:n}),ap.set(t,r)}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),uw(this,"onSessionAuthenticateResponse",(e,t)=>{const{id:r}=t;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:t}),Lp(t)?this.events.emit(La("session_request",r),{result:t.result}):Dp(t)&&this.events.emit(La("session_request",r),{error:t.error})}),uw(this,"onSessionAuthenticateRequest",async e=>{var t;const{topic:r,payload:n,attestation:i,encryptedId:s,transportType:o}=e;try{const{requester:e,authPayload:a,expiryTimestamp:c}=n.params,l=await this.getVerifyContext({attestationId:i,hash:ud(JSON.stringify(n)),encryptedId:s,metadata:e.metadata,transportType:o}),u={requester:e,pairingTopic:r,id:n.id,authPayload:a,verifyContext:l,expiryTimestamp:c};await this.setAuthRequest(n.id,{request:u,pairingTopic:r,transportType:o}),o===af.link_mode&&null!=(t=e.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(e.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:r,params:n.params,id:n.id,verifyContext:l})}catch(e){this.client.logger.error(e);const t=n.params.requester.publicKey,i=await this.client.core.crypto.generateKeyPair(),s=this.getAppLinkIfEnabled(n.params.requester.metadata,o),a={type:1,receiverPublicKey:t,senderPublicKey:i};await this.sendError({id:n.id,topic:r,error:e,encodeOpts:a,rpcOpts:Vy.wc_sessionAuthenticate.autoReject,appLink:s})}}),uw(this,"addSessionRequestToSessionRequestQueue",e=>{this.sessionRequestQueue.queue.push(e)}),uw(this,"cleanupAfterResponse",e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Gy,this.processSessionRequestQueue()},(0,b.toMiliseconds)(this.requestQueueDelay))}),uw(this,"cleanupPendingSentRequestsForTopic",({topic:e,error:t})=>{const r=this.client.core.history.pending;r.length>0&&r.filter(t=>t.topic===e&&"wc_sessionRequest"===t.request.method).forEach(e=>{const r=La("session_request",e.request.id);if(0===this.events.listenerCount(r))throw new Error(`emitting ${r} without any listeners`);this.events.emit(La("session_request",e.request.id),{error:t})})}),uw(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===Zy)return void this.client.logger.info("session request queue is already active.");const e=this.sessionRequestQueue.queue[0];if(e)try{this.emitSessionRequest(e)}catch(e){this.client.logger.error(e)}else this.client.logger.info("session request queue is empty.")}),uw(this,"emitSessionRequest",e=>{this.emittedSessionRequests.has(e.id)?this.client.logger.warn({id:e.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${e.id}`):(this.sessionRequestQueue.state=Zy,this.emittedSessionRequests.add(e.id),this.client.events.emit("session_request",e))}),uw(this,"onPairingCreated",e=>{if(e.methods&&this.expectedPairingMethodMap.set(e.topic,e.methods),e.active)return;const t=this.client.proposal.getAll().find(t=>t.pairingTopic===e.topic);t&&this.onSessionProposeRequest({topic:e.topic,payload:Ip("wc_sessionPropose",lw(cw({},t),{requiredNamespaces:t.requiredNamespaces,optionalNamespaces:t.optionalNamespaces,relays:t.relays,proposer:t.proposer,sessionProperties:t.sessionProperties,scopedProperties:t.scopedProperties}),t.id),attestation:t.attestation,encryptedId:t.encryptedId})}),uw(this,"isValidConnect",async e=>{if(!tp(e)){const{message:t}=qd("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw new Error(t)}const{pairingTopic:t,requiredNamespaces:r,optionalNamespaces:n,sessionProperties:i,scopedProperties:s,relays:o}=e;if(Vd(t)||await this.isValidPairingTopic(t),!function(e){let t=!1;return e?e&&Hd(e)&&e.length&&e.forEach(e=>{t=ep(e)}):t=!0,t}(o)){const{message:e}=qd("MISSING_OR_INVALID",`connect() relays: ${o}`);throw new Error(e)}if(!Vd(r)&&0!==Kd(r)){const e="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(e):this.client.logger.warn(e),this.validateNamespaces(r,"requiredNamespaces")}if(!Vd(n)&&0!==Kd(n)&&this.validateNamespaces(n,"optionalNamespaces"),Vd(i)||this.validateSessionProps(i,"sessionProperties"),!Vd(s)){this.validateSessionProps(s,"scopedProperties");const e=Object.keys(r||{}).concat(Object.keys(n||{}));if(!Object.keys(s).every(t=>e.includes(t.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(s)}, required/optional namespaces: ${JSON.stringify(e)}`)}}),uw(this,"validateNamespaces",(e,t)=>{const r=function(e,t,r){let n=null;if(e&&Kd(e)){const i=Xd(e,t);i&&(n=i);const s=function(e,t,r){let n=null;return Object.entries(e).forEach(([e,i])=>{if(n)return;const s=function(e,t,r){let n=null;return Hd(t)&&t.length?t.forEach(e=>{n||Zd(e)||(n=Fd("UNSUPPORTED_CHAINS",`${r}, chain ${e} should be a string and conform to "namespace:chainId" format`))}):Zd(e)||(n=Fd("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}(e,ca(e,i),`${t} ${r}`);s&&(n=s)}),n}(e,t,r);s&&(n=s)}else n=qd("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return n}(e,"connect()",t);if(r)throw new Error(r.message)}),uw(this,"isValidApprove",async e=>{if(!tp(e))throw new Error(qd("MISSING_OR_INVALID",`approve() params: ${e}`).message);const{id:t,namespaces:r,relayProtocol:n,sessionProperties:i,scopedProperties:s}=e;this.checkRecentlyDeleted(t),await this.isValidProposalId(t);const o=this.client.proposal.get(t),a=Qd(r,"approve()");if(a)throw new Error(a.message);const c=np(o.requiredNamespaces,r,"approve()");if(c)throw new Error(c.message);if(!Yd(n,!0)){const{message:e}=qd("MISSING_OR_INVALID",`approve() relayProtocol: ${n}`);throw new Error(e)}if(Vd(i)||this.validateSessionProps(i,"sessionProperties"),!Vd(s)){this.validateSessionProps(s,"scopedProperties");const e=new Set(Object.keys(r));if(!Object.keys(s).every(t=>e.has(t.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(s)}, approved namespaces: ${Array.from(e).join(", ")}`)}}),uw(this,"isValidReject",async e=>{if(!tp(e)){const{message:t}=qd("MISSING_OR_INVALID",`reject() params: ${e}`);throw new Error(t)}const{id:t,reason:r}=e;if(this.checkRecentlyDeleted(t),await this.isValidProposalId(t),!function(e){return!!(e&&"object"==typeof e&&e.code&&Gd(e.code,!1)&&e.message&&Yd(e.message,!1))}(r)){const{message:e}=qd("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(r)}`);throw new Error(e)}}),uw(this,"isValidSessionSettleRequest",e=>{if(!tp(e)){const{message:t}=qd("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw new Error(t)}const{relay:t,controller:r,namespaces:n,expiry:i}=e;if(!ep(t)){const{message:e}=qd("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(e)}const s=function(e){let t=null;return Yd(e?.publicKey,!1)||(t=qd("MISSING_OR_INVALID","onSessionSettleRequest() controller public key should be a string")),t}(r);if(s)throw new Error(s.message);const o=Qd(n,"onSessionSettleRequest()");if(o)throw new Error(o.message);if(Ma(i)){const{message:e}=qd("EXPIRED","onSessionSettleRequest()");throw new Error(e)}}),uw(this,"isValidUpdate",async e=>{if(!tp(e)){const{message:t}=qd("MISSING_OR_INVALID",`update() params: ${e}`);throw new Error(t)}const{topic:t,namespaces:r}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);const n=this.client.session.get(t),i=Qd(r,"update()");if(i)throw new Error(i.message);const s=np(n.requiredNamespaces,r,"update()");if(s)throw new Error(s.message)}),uw(this,"isValidExtend",async e=>{if(!tp(e)){const{message:t}=qd("MISSING_OR_INVALID",`extend() params: ${e}`);throw new Error(t)}const{topic:t}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t)}),uw(this,"isValidRequest",async e=>{if(!tp(e)){const{message:t}=qd("MISSING_OR_INVALID",`request() params: ${e}`);throw new Error(t)}const{topic:t,request:r,chainId:n,expiry:i}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);const{namespaces:s}=this.client.session.get(t);if(!rp(s,n)){const{message:e}=qd("MISSING_OR_INVALID",`request() chainId: ${n}`);throw new Error(e)}if(!function(e){return!(Vd(e)||!Yd(e.method,!1))}(r)){const{message:e}=qd("MISSING_OR_INVALID",`request() ${JSON.stringify(r)}`);throw new Error(e)}if(!function(e,t,r){return!!Yd(r,!1)&&function(e,t){const r=[];return Object.values(e).forEach(e=>{Md(e.accounts).includes(t)&&r.push(...e.methods)}),r}(e,t).includes(r)}(s,n,r.method)){const{message:e}=qd("MISSING_OR_INVALID",`request() method: ${r.method}`);throw new Error(e)}if(i&&!function(e,t){return Gd(e,!1)&&e<=t.max&&e>=t.min}(i,Yy)){const{message:e}=qd("MISSING_OR_INVALID",`request() expiry: ${i}. Expiry must be a number (in seconds) between ${Yy.min} and ${Yy.max}`);throw new Error(e)}}),uw(this,"isValidRespond",async e=>{var t;if(!tp(e)){const{message:t}=qd("MISSING_OR_INVALID",`respond() params: ${e}`);throw new Error(t)}const{topic:r,response:n}=e;try{await this.isValidSessionTopic(r)}catch(r){throw null!=(t=e?.response)&&t.id&&this.cleanupAfterResponse(e),r}if(!function(e){return!(Vd(e)||Vd(e.result)&&Vd(e.error)||!Gd(e.id,!1)||!Yd(e.jsonrpc,!1))}(n)){const{message:e}=qd("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(e)}}),uw(this,"isValidPing",async e=>{if(!tp(e)){const{message:t}=qd("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),uw(this,"isValidEmit",async e=>{if(!tp(e)){const{message:t}=qd("MISSING_OR_INVALID",`emit() params: ${e}`);throw new Error(t)}const{topic:t,event:r,chainId:n}=e;await this.isValidSessionTopic(t);const{namespaces:i}=this.client.session.get(t);if(!rp(i,n)){const{message:e}=qd("MISSING_OR_INVALID",`emit() chainId: ${n}`);throw new Error(e)}if(!function(e){return!(Vd(e)||!Yd(e.name,!1))}(r)){const{message:e}=qd("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(r)}`);throw new Error(e)}if(!function(e,t,r){return!!Yd(r,!1)&&function(e,t){const r=[];return Object.values(e).forEach(e=>{Md(e.accounts).includes(t)&&r.push(...e.events)}),r}(e,t).includes(r)}(i,n,r.name)){const{message:e}=qd("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(r)}`);throw new Error(e)}}),uw(this,"isValidDisconnect",async e=>{if(!tp(e)){const{message:t}=qd("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(t)}const{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),uw(this,"isValidAuthenticate",e=>{const{chains:t,uri:r,domain:n,nonce:i}=e;if(!Array.isArray(t)||0===t.length)throw new Error("chains is required and must be a non-empty array");if(!Yd(r,!1))throw new Error("uri is required parameter");if(!Yd(n,!1))throw new Error("domain is required parameter");if(!Yd(i,!1))throw new Error("nonce is required parameter");if([...new Set(t.map(e=>aa(e).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:s}=aa(t[0]);if("eip155"!==s)throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),uw(this,"getVerifyContext",async e=>{const{attestationId:t,hash:r,encryptedId:n,metadata:i,transportType:s}=e,o={verified:{verifyUrl:i.verifyUrl||Af,validation:"UNKNOWN",origin:i.url||""}};try{if(s===af.link_mode){const e=this.getAppLinkIfEnabled(i,s);return o.verified.validation=e&&new URL(e).origin===new URL(i.url).origin?"VALID":"INVALID",o}const e=await this.client.core.verify.resolve({attestationId:t,hash:r,encryptedId:n,verifyUrl:i.verifyUrl});e&&(o.verified.origin=e.origin,o.verified.isScam=e.isScam,o.verified.validation=e.origin===new URL(i.url).origin?"VALID":"INVALID")}catch(e){this.client.logger.warn(e)}return this.client.logger.debug(`Verify context: ${JSON.stringify(o)}`),o}),uw(this,"validateSessionProps",(e,t)=>{Object.values(e).forEach((r,n)=>{if(null==r){const{message:i}=qd("MISSING_OR_INVALID",`${t} must contain an existing value for each key. Received: ${r} for key ${Object.keys(e)[n]}`);throw new Error(i)}})}),uw(this,"getPendingAuthRequest",e=>{const t=this.client.auth.requests.get(e);return"object"==typeof t?t:void 0}),uw(this,"addToRecentlyDeleted",(e,t)=>{if(this.recentlyDeletedMap.set(e,t),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let e=0;const t=this.recentlyDeletedLimit/2;for(const r of this.recentlyDeletedMap.keys()){if(e++>=t)break;this.recentlyDeletedMap.delete(r)}}}),uw(this,"checkRecentlyDeleted",e=>{const t=this.recentlyDeletedMap.get(e);if(t){const{message:r}=qd("MISSING_OR_INVALID",`Record was recently deleted - ${t}: ${e}`);throw new Error(r)}}),uw(this,"isLinkModeEnabled",(e,t)=>{var n,i,s,o,a,c,l,u,h;return!(!e||t!==af.link_mode)&&!0===(null==(i=null==(n=this.client.metadata)?void 0:n.redirect)?void 0:i.linkMode)&&void 0!==(null==(o=null==(s=this.client.metadata)?void 0:s.redirect)?void 0:o.universal)&&""!==(null==(c=null==(a=this.client.metadata)?void 0:a.redirect)?void 0:c.universal)&&void 0!==(null==(l=e?.redirect)?void 0:l.universal)&&""!==(null==(u=e?.redirect)?void 0:u.universal)&&!0===(null==(h=e?.redirect)?void 0:h.linkMode)&&this.client.core.linkModeSupportedApps.includes(e.redirect.universal)&&typeof(null==r.g?void 0:r.g.Linking)<"u"}),uw(this,"getAppLinkIfEnabled",(e,t)=>{var r;return this.isLinkModeEnabled(e,t)?null==(r=e?.redirect)?void 0:r.universal:void 0}),uw(this,"handleLinkModeMessage",({url:e})=>{if(!e||!e.includes("wc_ev")||!e.includes("topic"))return;const t=Wa(e,"topic")||"",r=decodeURIComponent(Wa(e,"wc_ev")||""),n=this.client.session.keys.includes(t);n&&this.client.session.update(t,{transportType:af.link_mode}),this.client.core.dispatchEnvelope({topic:t,message:r,sessionExists:n})}),uw(this,"registerLinkModeListeners",async()=>{var e;if($a()||Aa()&&null!=(e=this.client.metadata.redirect)&&e.linkMode){const e=null==r.g?void 0:r.g.Linking;if(typeof e<"u"){e.addEventListener("url",this.handleLinkModeMessage,this.client.name);const t=await e.getInitialURL();t&&setTimeout(()=>{this.handleLinkModeMessage({url:t})},50)}}}),uw(this,"getTVFParams",(e,t,r)=>{var n,i,s;if(null==(n=t.request)||!n.method)return{};const o={correlationId:e,rpcMethods:[t.request.method],chainId:t.chainId};try{const e=this.extractTxHashesFromResult(t.request,r);o.txHashes=e,o.contractAddresses=this.isValidContractData(t.request.params)?[null==(s=null==(i=t.request.params)?void 0:i[0])?void 0:s.to]:[]}catch(e){this.client.logger.warn("Error getting TVF params",e)}return o}),uw(this,"isValidContractData",e=>{var t;if(!e)return!1;try{const r=e?.data||(null==(t=e?.[0])?void 0:t.data);if(!r.startsWith("0x"))return!1;const n=r.slice(2);return!!/^[0-9a-fA-F]*$/.test(n)&&n.length%2==0}catch{}return!1}),uw(this,"extractTxHashesFromResult",(e,t)=>{var r;try{if(!t)return[];const n=e.method,i=Jy[n];if("sui_signTransaction"===n)return[kl(t.transactionBytes)];if("near_signTransaction"===n)return[Nl(t)];if("near_signTransactions"===n)return t.map(e=>Nl(e));if("xrpl_signTransactionFor"===n||"xrpl_signTransaction"===n)return[null==(r=t.tx_json)?void 0:r.hash];if("polkadot_signTransaction"===n)return[lp({transaction:e.params.transactionPayload,signature:t.signature})];if("algo_signTxn"===n)return Hd(t)?t.map(e=>xl(e)):[xl(t)];if("cosmos_signDirect"===n)return[Ol(t)];if("string"==typeof t)return[t];const s=t[i.key];if(Hd(s))return"solana_signAllTransactions"===n?s.map(e=>function(e){const t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);const n=r[0];if(0===n)throw new Error("No signatures found");const i=1+64*n;if(r.length<i)throw new Error("Transaction data too short for claimed signature count");if(r.length<100)throw new Error("Transaction too short");const s=oa.from(e,"base64").slice(1,65);return Ti.A.encode(s)}(e)):s;if("string"==typeof s)return[s]}catch(e){this.client.logger.warn("Error extracting tx hashes from result",e)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(const[e,r]of Object.entries(t))for(const t of r)try{await this.onProviderMessageEvent({topic:e,message:t,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${e}, message: ${t}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=qd("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Jp,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:t,message:r,attestation:n,transportType:i}=e,{publicKey:s}=this.client.auth.authKeys.keys.includes(ew)?this.client.auth.authKeys.get(ew):{responseTopic:void 0,publicKey:void 0};try{const e=await this.client.core.crypto.decode(t,r,{receiverPublicKey:s,encoding:i===af.link_mode?od:sd});Bp(e)?(this.client.core.history.set(t,e),await this.onRelayEventRequest({topic:t,payload:e,attestation:n,transportType:i,encryptedId:ud(r)})):Mp(e)?(await this.client.core.history.resolve(e),await this.onRelayEventResponse({topic:t,payload:e,transportType:i}),this.client.core.history.delete(t,e.id)):await this.onRelayEventUnknownPayload({topic:t,payload:e,transportType:i}),await this.client.core.relayer.messages.ack(t,r)}catch(e){this.client.logger.error(e)}}registerExpirerEvents(){this.client.core.expirer.on(vf,async e=>{const{topic:t,id:r}=Ua(e.target);return r&&this.client.pendingRequest.keys.includes(r)?await this.deletePendingSessionRequest(r,qd("EXPIRED"),!0):r&&this.client.auth.requests.keys.includes(r)?await this.deletePendingAuthRequest(r,qd("EXPIRED"),!0):void(t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r})))})}registerPairingEvents(){this.client.core.pairing.events.on(pf,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(ff,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!Yd(e,!1)){const{message:t}=qd("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=qd("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if(Ma(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=qd("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Yd(e,!1)){const{message:t}=qd("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:t}=qd("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if(Ma(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:t}=qd("EXPIRED",`session topic: ${e}`);throw new Error(t)}if(!this.client.core.crypto.keychain.has(e)){const{message:t}=qd("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else{if(!this.client.core.pairing.pairings.keys.includes(e)){if(Yd(e,!1)){const{message:t}=qd("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}{const{message:t}=qd("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}this.isValidPairingTopic(e)}}async isValidProposalId(e){if(!function(e){return"number"==typeof e}(e)){const{message:t}=qd("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=qd("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if(Ma(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:t}=qd("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class dw extends cy{constructor(e,t){super(e,t,"proposal",zy),this.core=e,this.logger=t}}class pw extends cy{constructor(e,t){super(e,t,"session",zy),this.core=e,this.logger=t}}class fw extends cy{constructor(e,t){super(e,t,"request",zy,e=>e.id),this.core=e,this.logger=t}}class gw extends cy{constructor(e,t){super(e,t,"authKeys",Qy,()=>ew),this.core=e,this.logger=t}}class mw extends cy{constructor(e,t){super(e,t,"pairingTopics",Qy),this.core=e,this.logger=t}}class yw extends cy{constructor(e,t){super(e,t,"requests",Qy,e=>e.id),this.core=e,this.logger=t}}var ww=Object.defineProperty,bw=(e,t,r)=>((e,t,r)=>t in e?ww(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class vw{constructor(e,t){this.core=e,this.logger=t,bw(this,"authKeys"),bw(this,"pairingTopics"),bw(this,"requests"),this.authKeys=new gw(this.core,this.logger),this.pairingTopics=new mw(this.core,this.logger),this.requests=new yw(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var Ew=Object.defineProperty,Aw=(e,t,r)=>((e,t,r)=>t in e?Ew(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class _w extends ye{constructor(e){super(e),Aw(this,"protocol","wc"),Aw(this,"version",2),Aw(this,"name",qy),Aw(this,"metadata"),Aw(this,"core"),Aw(this,"logger"),Aw(this,"events",new y.EventEmitter),Aw(this,"engine"),Aw(this,"session"),Aw(this,"proposal"),Aw(this,"pendingRequest"),Aw(this,"auth"),Aw(this,"signConfig"),Aw(this,"on",(e,t)=>this.events.on(e,t)),Aw(this,"once",(e,t)=>this.events.once(e,t)),Aw(this,"off",(e,t)=>this.events.off(e,t)),Aw(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),Aw(this,"removeAllListeners",e=>this.events.removeAllListeners(e)),Aw(this,"connect",async e=>{try{return await this.engine.connect(e)}catch(e){throw this.logger.error(e.message),e}}),Aw(this,"pair",async e=>{try{return await this.engine.pair(e)}catch(e){throw this.logger.error(e.message),e}}),Aw(this,"approve",async e=>{try{return await this.engine.approve(e)}catch(e){throw this.logger.error(e.message),e}}),Aw(this,"reject",async e=>{try{return await this.engine.reject(e)}catch(e){throw this.logger.error(e.message),e}}),Aw(this,"update",async e=>{try{return await this.engine.update(e)}catch(e){throw this.logger.error(e.message),e}}),Aw(this,"extend",async e=>{try{return await this.engine.extend(e)}catch(e){throw this.logger.error(e.message),e}}),Aw(this,"request",async e=>{try{return await this.engine.request(e)}catch(e){throw this.logger.error(e.message),e}}),Aw(this,"respond",async e=>{try{return await this.engine.respond(e)}catch(e){throw this.logger.error(e.message),e}}),Aw(this,"ping",async e=>{try{return await this.engine.ping(e)}catch(e){throw this.logger.error(e.message),e}}),Aw(this,"emit",async e=>{try{return await this.engine.emit(e)}catch(e){throw this.logger.error(e.message),e}}),Aw(this,"disconnect",async e=>{try{return await this.engine.disconnect(e)}catch(e){throw this.logger.error(e.message),e}}),Aw(this,"find",e=>{try{return this.engine.find(e)}catch(e){throw this.logger.error(e.message),e}}),Aw(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(e){throw this.logger.error(e.message),e}}),Aw(this,"authenticate",async(e,t)=>{try{return await this.engine.authenticate(e,t)}catch(e){throw this.logger.error(e.message),e}}),Aw(this,"formatAuthMessage",e=>{try{return this.engine.formatAuthMessage(e)}catch(e){throw this.logger.error(e.message),e}}),Aw(this,"approveSessionAuthenticate",async e=>{try{return await this.engine.approveSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),Aw(this,"rejectSessionAuthenticate",async e=>{try{return await this.engine.rejectSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),this.name=e?.name||qy,this.metadata=function(e){var t,r;const n=Ca();try{return null!=e&&e.url&&n.url&&new URL(e.url).host!==new URL(n.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${e.url} differs from the actual page url:${n.url}. This is probably unintended and can lead to issues.`),e.url=n.url),null!=(t=e?.icons)&&t.length&&e.icons.length>0&&(e.icons=e.icons.filter(e=>""!==e)),((e,t)=>ua(e,ha(t)))(ma(ma({},n),e),{url:e?.url||n.url,name:e?.name||n.name,description:e?.description||n.description,icons:null!=(r=e?.icons)&&r.length&&e.icons.length>0?e.icons:n.icons})}catch(t){return console.warn("Error populating app metadata",t),e||n}}(e?.metadata),this.signConfig=e?.signConfig;const t=typeof e?.logger<"u"&&"string"!=typeof e?.logger?e.logger:(0,ee.h6)((0,ee.iP)({level:e?.logger||"error"}));this.core=e?.core||new jy(e),this.logger=(0,ee.U5)(t,this.name),this.session=new pw(this.core,this.logger),this.proposal=new dw(this.core,this.logger),this.pendingRequest=new fw(this.core,this.logger),this.engine=new hw(this),this.auth=new vw(this.core,this.logger)}static async init(e){const t=new _w(e);return await t.initialize(),t}get context(){return(0,ee.oI)(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var Iw=r(4945),Sw=r.n(Iw),Cw=Object.defineProperty,kw=Object.defineProperties,Nw=Object.getOwnPropertyDescriptors,xw=Object.getOwnPropertySymbols,Tw=Object.prototype.hasOwnProperty,Ow=Object.prototype.propertyIsEnumerable,Pw=(e,t,r)=>t in e?Cw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Rw=(e,t)=>{for(var r in t||(t={}))Tw.call(t,r)&&Pw(e,r,t[r]);if(xw)for(var r of xw(t))Ow.call(t,r)&&Pw(e,r,t[r]);return e},Uw=(e,t)=>kw(e,Nw(t));const Bw={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};class Mw{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new y.EventEmitter,this.isAvailable=!1,this.registering=!1,!Pp(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const t=(0,K.h)(e),r=await(await Sw()(this.url,Uw(Rw({},Bw),{body:t}))).json();this.onPayload({data:r})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!Pp(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((e,t)=>{this.events.once("register_error",e=>{this.resetMaxListeners(),t(e)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return t(new Error("HTTP connection is missing or invalid"));e()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=(0,K.h)({id:1,jsonrpc:"2.0",method:"test",params:[]});await Sw()(e,Uw(Rw({},Bw),{body:t}))}this.onOpen()}catch(e){const t=this.parseError(e);throw this.events.emit("register_error",t),this.onClose(),t}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t="string"==typeof e.data?(0,K.j)(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const r=this.parseError(t),n=Cp(e,r.message||r.toString());this.events.emit("payload",n)}parseError(e,t=this.url){return vp(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}}var Lw=r(8287).Buffer;const Dw="error",Ww="wc@2:universal_provider:",jw="https://rpc.walletconnect.org/v1/",$w="generic",zw=`${jw}bundler`,qw="default_chain_changed";function Fw(e){return null==e||"object"!=typeof e&&"function"!=typeof e}function Hw(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function Kw(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const Vw="[object String]",Yw="[object Number]",Gw="[object Boolean]",Zw="[object Arguments]";function Jw(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Xw(e,t,r,n=new Map,i=void 0){const s=i?.(e,t,r,n);if(null!=s)return s;if(Fw(e))return e;if(n.has(e))return n.get(e);if(Array.isArray(e)){const t=new Array(e.length);n.set(e,t);for(let s=0;s<e.length;s++)t[s]=Xw(e[s],s,r,n,i);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){const t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){const t=new Map;n.set(e,t);for(const[s,o]of e)t.set(s,Xw(o,s,r,n,i));return t}if(e instanceof Set){const t=new Set;n.set(e,t);for(const s of e)t.add(Xw(s,void 0,r,n,i));return t}if(typeof Lw<"u"&&Lw.isBuffer(e))return e.subarray();if(Jw(e)){const t=new(Object.getPrototypeOf(e).constructor)(e.length);n.set(e,t);for(let s=0;s<e.length;s++)t[s]=Xw(e[s],s,r,n,i);return t}if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){const t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return n.set(e,t),Qw(t,e,r,n,i),t}if(typeof File<"u"&&e instanceof File){const t=new File([e],e.name,{type:e.type});return n.set(e,t),Qw(t,e,r,n,i),t}if(e instanceof Blob){const t=new Blob([e],{type:e.type});return n.set(e,t),Qw(t,e,r,n,i),t}if(e instanceof Error){const t=new e.constructor;return n.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,Qw(t,e,r,n,i),t}if("object"==typeof e&&function(e){switch(Kw(e)){case Zw:case"[object Array]":case"[object ArrayBuffer]":case"[object DataView]":case Gw:case"[object Date]":case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Map]":case Yw:case"[object Object]":case"[object RegExp]":case"[object Set]":case Vw:case"[object Symbol]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return!0;default:return!1}}(e)){const t=Object.create(Object.getPrototypeOf(e));return n.set(e,t),Qw(t,e,r,n,i),t}return e}function Qw(e,t,r=e,n,i){const s=[...Object.keys(t),...Hw(t)];for(let o=0;o<s.length;o++){const a=s[o],c=Object.getOwnPropertyDescriptor(e,a);(null==c||c.writable)&&(e[a]=Xw(t[a],a,r,n,i))}}function eb(e){return function(e,t){return function(e,t){return Xw(e,void 0,e,new Map,t)}(e,(r,n,i,s)=>{const o=t?.(r,n,i,s);if(null!=o)return o;if("object"==typeof e)switch(Object.prototype.toString.call(e)){case Yw:case Vw:case Gw:{const t=new e.constructor(e?.valueOf());return Qw(t,e),t}case Zw:{const t={};return Qw(t,e),t.length=e.length,t[Symbol.iterator]=e[Symbol.iterator],t}default:return}})}(e)}function tb(e){return null!==e&&"object"==typeof e&&"[object Arguments]"===Kw(e)}function rb(e){return"object"==typeof e&&null!==e}function nb(){}function ib(e){return Jw(e)}function sb(e){if("object"!=typeof e||null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){const t=e[Symbol.toStringTag];return!(null==t||!Object.getOwnPropertyDescriptor(e,Symbol.toStringTag)?.writable)&&e.toString()===`[object ${t}]`}let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function ob(e,t,r,n){if(Fw(e)&&(e=Object(e)),null==t||"object"!=typeof t)return e;if(n.has(t))return function(e){if(Fw(e))return e;if(Array.isArray(e)||Jw(e)||e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);const t=Object.getPrototypeOf(e),r=t.constructor;if(e instanceof Date||e instanceof Map||e instanceof Set)return new r(e);if(e instanceof RegExp){const t=new r(e);return t.lastIndex=e.lastIndex,t}if(e instanceof DataView)return new r(e.buffer.slice(0));if(e instanceof Error){const t=new r(e.message);return t.stack=e.stack,t.name=e.name,t.cause=e.cause,t}if(typeof File<"u"&&e instanceof File)return new r([e],e.name,{type:e.type,lastModified:e.lastModified});if("object"==typeof e){const r=Object.create(t);return Object.assign(r,e)}return e}(n.get(t));if(n.set(t,e),Array.isArray(t)){t=t.slice();for(let e=0;e<t.length;e++)t[e]=t[e]??void 0}const i=[...Object.keys(t),...Hw(t)];for(let s=0;s<i.length;s++){const o=i[s];let a=t[o],c=e[o];if(tb(a)&&(a={...a}),tb(c)&&(c={...c}),typeof Lw<"u"&&Lw.isBuffer(a)&&(a=eb(a)),Array.isArray(a))if("object"==typeof c&&null!=c){const e=[],t=Reflect.ownKeys(c);for(let r=0;r<t.length;r++){const n=t[r];e[n]=c[n]}c=e}else c=[];const l=r(c,a,o,e,t,n);null!=l?e[o]=l:Array.isArray(a)||rb(c)&&rb(a)?e[o]=ob(c,a,r,n):null==c&&sb(a)?e[o]=ob({},a,r,n):null==c&&ib(a)?e[o]=eb(a):(void 0===c||void 0!==a)&&(e[o]=a)}return e}var ab=Object.defineProperty,cb=Object.defineProperties,lb=Object.getOwnPropertyDescriptors,ub=Object.getOwnPropertySymbols,hb=Object.prototype.hasOwnProperty,db=Object.prototype.propertyIsEnumerable,pb=(e,t,r)=>t in e?ab(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,fb=(e,t)=>{for(var r in t||(t={}))hb.call(t,r)&&pb(e,r,t[r]);if(ub)for(var r of ub(t))db.call(t,r)&&pb(e,r,t[r]);return e},gb=(e,t)=>cb(e,lb(t));function mb(e,t,r){var n;const i=aa(e);return(null==(n=t.rpcMap)?void 0:n[i.reference])||`${jw}?chainId=${i.namespace}:${i.reference}&projectId=${r}`}function yb(e){return e.includes(":")?e.split(":")[1]:e}function wb(e){return e.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function bb(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>{var r,n;return(null==(r=t?.chains)?void 0:r.length)&&(null==(n=t?.chains)?void 0:n.length)>0}))}function vb(e={},t={}){return function(e,...t){return function(e,...t){const r=t.slice(0,-1),n=t[t.length-1];let i=e;for(let e=0;e<r.length;e++)i=ob(i,r[e],n,new Map);return i}(e,...t,nb)}(bb(Eb(e)),bb(Eb(t)))}function Eb(e){var t,r,n,i,s;const o={};if(!Kd(e))return o;for(const[a,c]of Object.entries(e)){const e=Ld(a)?[a]:c.chains,l=c.methods||[],u=c.events||[],h=c.rpcMap||{},d=Dd(a);o[d]=gb(fb(fb({},o[d]),c),{chains:Da(e,null==(t=o[d])?void 0:t.chains),methods:Da(l,null==(r=o[d])?void 0:r.methods),events:Da(u,null==(n=o[d])?void 0:n.events)}),(Kd(h)||Kd((null==(i=o[d])?void 0:i.rpcMap)||{}))&&(o[d].rpcMap=fb(fb({},h),null==(s=o[d])?void 0:s.rpcMap))}return o}function Ab(e){return e.includes(":")?e.split(":")[2]:e}function _b(e){const t={};for(const[r,n]of Object.entries(e)){const e=n.methods||[],i=n.events||[],s=n.accounts||[],o=Ld(r)?[r]:n.chains?n.chains:wb(n.accounts);t[r]={chains:o,methods:e,events:i,accounts:s}}return t}function Ib(e){return"number"==typeof e?e:e.includes("0x")?parseInt(e,16):(e=e.includes(":")?e.split(":")[1]:e,isNaN(Number(e))?e:Number(e))}const Sb={},Cb=e=>Sb[e],kb=(e,t)=>{Sb[e]=t};var Nb=Object.defineProperty,xb=Object.getOwnPropertySymbols,Tb=Object.prototype.hasOwnProperty,Ob=Object.prototype.propertyIsEnumerable,Pb=(e,t,r)=>t in e?Nb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Rb=(e,t)=>{for(var r in t||(t={}))Tb.call(t,r)&&Pb(e,r,t[r]);if(xb)for(var r of xb(t))Ob.call(t,r)&&Pb(e,r,t[r]);return e};const Ub="eip155",Bb=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],Mb=e=>e&&e.startsWith("0x")?BigInt(e).toString(10):e,Lb=e=>e&&e.startsWith("0x")?e:`0x${BigInt(e).toString(16)}`,Db=e=>Object.keys(e).filter(e=>Bb.includes(e)).reduce((t,r)=>(t[r]=e[r],t),{});var Wb=Object.defineProperty,jb=(e,t,r)=>((e,t,r)=>t in e?Wb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class $b{constructor(e){jb(this,"name","polkadot"),jb(this,"client"),jb(this,"httpProviders"),jb(this,"events"),jb(this,"namespace"),jb(this,"chainId"),this.namespace=e.namespace,this.events=Cb("events"),this.client=Cb("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(qw,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const n=yb(t);e[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||mb(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Wp(new Mw(r,Cb("disableProviderPing")))}}var zb=Object.defineProperty,qb=Object.defineProperties,Fb=Object.getOwnPropertyDescriptors,Hb=Object.getOwnPropertySymbols,Kb=Object.prototype.hasOwnProperty,Vb=Object.prototype.propertyIsEnumerable,Yb=(e,t,r)=>t in e?zb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Gb=(e,t)=>{for(var r in t||(t={}))Kb.call(t,r)&&Yb(e,r,t[r]);if(Hb)for(var r of Hb(t))Vb.call(t,r)&&Yb(e,r,t[r]);return e},Zb=(e,t)=>qb(e,Fb(t)),Jb=(e,t,r)=>Yb(e,"symbol"!=typeof t?t+"":t,r);class Xb{constructor(e){Jb(this,"name","eip155"),Jb(this,"client"),Jb(this,"chainId"),Jb(this,"namespace"),Jb(this,"httpProviders"),Jb(this,"events"),this.namespace=e.namespace,this.events=Cb("events"),this.client=Cb("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(qw,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const r=t||mb(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Wp(new Mw(r,Cb("disableProviderPing")))}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const n=parseInt(yb(t));e[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,r;let n=e.request.params?null==(t=e.request.params[0])?void 0:t.chainId:"0x0";n=n.startsWith("0x")?n:`0x${n}`;const i=parseInt(n,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else{if(!this.namespace.methods.includes("wallet_switchEthereumChain"))throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:n}]},chainId:null==(r=this.namespace.chains)?void 0:r[0]}),this.setDefaultChain(`${i}`)}return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,r,n,i,s;const o=null==(r=null==(t=e.request)?void 0:t.params)?void 0:r[0],a=(null==(i=null==(n=e.request)?void 0:n.params)?void 0:i[1])||[];if(!o)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const c=this.client.session.get(e.topic),l=(null==(s=c?.sessionProperties)?void 0:s.capabilities)||{},u=`${o}${a.join(",")}`,h=l?.[u];if(h)return h;let d;try{d=((e,t,r)=>{const{sessionProperties:n={},scopedProperties:i={}}=e,s={};if(!Kd(i)&&!Kd(n))return;const o=Db(n);for(const e of r){const r=Mb(e);if(!r)continue;s[Lb(r)]=o;const n=i?.[`${Ub}:${r}`];if(n){const e=n?.[`${Ub}:${r}:${t}`];s[Lb(r)]=Rb(Rb({},s[Lb(r)]),Db(e||n))}}for(const[e,t]of Object.entries(s))0===Object.keys(t).length&&delete s[e];return Object.keys(s).length>0?s:void 0})(c,o,a)}catch(e){console.warn("Failed to extract capabilities from session",e)}if(d)return d;const p=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:Zb(Gb({},c.sessionProperties||{}),{capabilities:Zb(Gb({},l||{}),{[u]:p})})})}catch(e){console.warn("Failed to update session with capabilities",e)}return p}async getCallStatus(e){var t,r;const n=this.client.session.get(e.topic),i=null==(t=n.sessionProperties)?void 0:t.bundler_name;if(i){const t=this.getBundlerUrl(e.chainId,i);try{return await this.getUserOperationReceipt(t,e)}catch(e){console.warn("Failed to fetch call status from bundler",e,t)}}const s=null==(r=n.sessionProperties)?void 0:r.bundler_url;if(s)try{return await this.getUserOperationReceipt(s,e)}catch(e){console.warn("Failed to fetch call status from custom bundler",e,s)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var r;const n=new URL(e),i=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ip("eth_getUserOperationReceipt",[null==(r=t.request.params)?void 0:r[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,t){return`${zw}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}var Qb=Object.defineProperty,ev=(e,t,r)=>((e,t,r)=>t in e?Qb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class tv{constructor(e){ev(this,"name","solana"),ev(this,"client"),ev(this,"httpProviders"),ev(this,"events"),ev(this,"namespace"),ev(this,"chainId"),this.namespace=e.namespace,this.events=Cb("events"),this.client=Cb("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(qw,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const n=yb(t);e[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||mb(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Wp(new Mw(r,Cb("disableProviderPing")))}}var rv=Object.defineProperty,nv=(e,t,r)=>((e,t,r)=>t in e?rv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class iv{constructor(e){nv(this,"name","cosmos"),nv(this,"client"),nv(this,"httpProviders"),nv(this,"events"),nv(this,"namespace"),nv(this,"chainId"),this.namespace=e.namespace,this.events=Cb("events"),this.client=Cb("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(qw,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const n=yb(t);e[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||mb(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Wp(new Mw(r,Cb("disableProviderPing")))}}var sv=Object.defineProperty,ov=(e,t,r)=>((e,t,r)=>t in e?sv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class av{constructor(e){ov(this,"name","algorand"),ov(this,"client"),ov(this,"httpProviders"),ov(this,"events"),ov(this,"namespace"),ov(this,"chainId"),this.namespace=e.namespace,this.events=Cb("events"),this.client=Cb("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const r=t||mb(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.chainId=e,this.events.emit(qw,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;e[t]=this.createHttpProvider(t,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||mb(e,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new Wp(new Mw(r,Cb("disableProviderPing")))}}var cv=Object.defineProperty,lv=(e,t,r)=>((e,t,r)=>t in e?cv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class uv{constructor(e){lv(this,"name","cip34"),lv(this,"client"),lv(this,"httpProviders"),lv(this,"events"),lv(this,"namespace"),lv(this,"chainId"),this.namespace=e.namespace,this.events=Cb("events"),this.client=Cb("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(qw,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const r=this.getCardanoRPCUrl(t),n=yb(t);e[n]=this.createHttpProvider(n,r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||this.getCardanoRPCUrl(e);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Wp(new Mw(r,Cb("disableProviderPing")))}}var hv=Object.defineProperty,dv=(e,t,r)=>((e,t,r)=>t in e?hv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class pv{constructor(e){dv(this,"name","elrond"),dv(this,"client"),dv(this,"httpProviders"),dv(this,"events"),dv(this,"namespace"),dv(this,"chainId"),this.namespace=e.namespace,this.events=Cb("events"),this.client=Cb("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(qw,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const n=yb(t);e[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||mb(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Wp(new Mw(r,Cb("disableProviderPing")))}}var fv=Object.defineProperty,gv=(e,t,r)=>((e,t,r)=>t in e?fv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class mv{constructor(e){gv(this,"name","multiversx"),gv(this,"client"),gv(this,"httpProviders"),gv(this,"events"),gv(this,"namespace"),gv(this,"chainId"),this.namespace=e.namespace,this.events=Cb("events"),this.client=Cb("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(qw,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;const n=yb(t);e[n]=this.createHttpProvider(n,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||mb(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Wp(new Mw(r,Cb("disableProviderPing")))}}var yv=Object.defineProperty,wv=(e,t,r)=>((e,t,r)=>t in e?yv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class bv{constructor(e){wv(this,"name","near"),wv(this,"client"),wv(this,"httpProviders"),wv(this,"events"),wv(this,"namespace"),wv(this,"chainId"),this.namespace=e.namespace,this.events=Cb("events"),this.client=Cb("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const r=t||mb(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(qw,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var r;e[t]=this.createHttpProvider(t,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||mb(e,this.namespace);return typeof r>"u"?void 0:new Wp(new Mw(r,Cb("disableProviderPing")))}}var vv=Object.defineProperty,Ev=(e,t,r)=>((e,t,r)=>t in e?vv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class Av{constructor(e){Ev(this,"name","tezos"),Ev(this,"client"),Ev(this,"httpProviders"),Ev(this,"events"),Ev(this,"namespace"),Ev(this,"chainId"),this.namespace=e.namespace,this.events=Cb("events"),this.client=Cb("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const r=t||mb(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(qw,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||mb(e,this.namespace);return typeof r>"u"?void 0:new Wp(new Mw(r))}}var _v=Object.defineProperty,Iv=(e,t,r)=>((e,t,r)=>t in e?_v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);class Sv{constructor(e){Iv(this,"name",$w),Iv(this,"client"),Iv(this,"httpProviders"),Iv(this,"events"),Iv(this,"namespace"),Iv(this,"chainId"),this.namespace=e.namespace,this.events=Cb("events"),this.client=Cb("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(qw,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){var e,t;const r={};return null==(t=null==(e=this.namespace)?void 0:e.accounts)||t.forEach(e=>{const t=aa(e);r[`${t.namespace}:${t.reference}`]=this.createHttpProvider(e)}),r}getHttpProvider(e){const t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){const r=t||mb(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Wp(new Mw(r,Cb("disableProviderPing")))}}var Cv=Object.defineProperty,kv=Object.defineProperties,Nv=Object.getOwnPropertyDescriptors,xv=Object.getOwnPropertySymbols,Tv=Object.prototype.hasOwnProperty,Ov=Object.prototype.propertyIsEnumerable,Pv=(e,t,r)=>t in e?Cv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Rv=(e,t)=>{for(var r in t||(t={}))Tv.call(t,r)&&Pv(e,r,t[r]);if(xv)for(var r of xv(t))Ov.call(t,r)&&Pv(e,r,t[r]);return e},Uv=(e,t)=>kv(e,Nv(t)),Bv=(e,t,r)=>Pv(e,"symbol"!=typeof t?t+"":t,r);class Mv{constructor(e){Bv(this,"client"),Bv(this,"namespaces"),Bv(this,"optionalNamespaces"),Bv(this,"sessionProperties"),Bv(this,"scopedProperties"),Bv(this,"events",new(w())),Bv(this,"rpcProviders",{}),Bv(this,"session"),Bv(this,"providerOpts"),Bv(this,"logger"),Bv(this,"uri"),Bv(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof e?.logger<"u"&&"string"!=typeof e?.logger?e.logger:(0,ee.h6)((0,ee.iP)({level:e?.logger||Dw})),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){const t=new Mv(e);return await t.initialize(),t}async request(e,t,r){const[n,i]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:Rv({},e),chainId:`${n}:${i}`,topic:this.session.topic,expiry:r})}sendAsync(e,t,r,n){const i=(new Date).getTime();this.request(e,r,n).then(e=>t(null,Sp(i,e))).catch(e=>t(e,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:null==(e=this.session)?void 0:e.topic,reason:Fd("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:r,response:n}=await this.client.authenticate(e,t);r&&(this.uri=r,this.events.emit("display_uri",r));const i=await n();if(this.session=i.session,this.session){const e=_b(this.session.namespaces);this.namespaces=vb(this.namespaces,e),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){const{uri:t,approval:r}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));const n=await r();this.session=n;const i=_b(n.namespaces);return this.namespaces=vb(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[r,n]=this.validateChain(e),i=this.getProvider(r);i.name===$w?i.setDefaultChain(`${r}:${n}`,t):i.setDefaultChain(n,t)}catch(e){if(!/Please call connect/.test(e.message))throw e}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(Hd(t)){for(const r of t)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await _w.init({core:this.providerOpts.core,logger:this.providerOpts.logger||Dw,relayUrl:this.providerOpts.relayUrl||"wss://relay.walletconnect.org",projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error("Failed to get session",r),new Error(`The provided session: ${null==(t=null==(e=this.providerOpts)?void 0:e.session)?void 0:t.topic} doesn't exist in the Sign client`)}else{const e=this.client.session.getAll();this.session=e[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(e=>Dd(e)))];kb("client",this.client),kb("events",this.events),kb("disableProviderPing",this.disableProviderPing),e.forEach(e=>{if(!this.session)return;const t=function(e,t){const r=Object.keys(t.namespaces).filter(t=>t.includes(e));if(!r.length)return[];const n=[];return r.forEach(e=>{const r=t.namespaces[e].accounts;n.push(...r)}),n}(e,this.session);if(0===t?.length)return;const r=wb(t),n=vb(this.namespaces,this.optionalNamespaces),i=Uv(Rv({},n[e]),{accounts:t,chains:r});switch(e){case"eip155":this.rpcProviders[e]=new Xb({namespace:i});break;case"algorand":this.rpcProviders[e]=new av({namespace:i});break;case"solana":this.rpcProviders[e]=new tv({namespace:i});break;case"cosmos":this.rpcProviders[e]=new iv({namespace:i});break;case"polkadot":this.rpcProviders[e]=new $b({namespace:i});break;case"cip34":this.rpcProviders[e]=new uv({namespace:i});break;case"elrond":this.rpcProviders[e]=new pv({namespace:i});break;case"multiversx":this.rpcProviders[e]=new mv({namespace:i});break;case"near":this.rpcProviders[e]=new bv({namespace:i});break;case"tezos":this.rpcProviders[e]=new Av({namespace:i});break;default:this.rpcProviders[$w]?this.rpcProviders[$w].updateNamespace(i):this.rpcProviders[$w]=new Sv({namespace:i})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;const{topic:r}=e;r===(null==(t=this.session)?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;const{params:r,topic:n}=e;if(n!==(null==(t=this.session)?void 0:t.topic))return;const{event:i}=r;if("accountsChanged"===i.name){const e=i.data;e&&Hd(e)&&this.events.emit("accountsChanged",e.map(Ab))}else if("chainChanged"===i.name){const e=r.chainId,t=r.event.data,n=Dd(e),i=Ib(e)!==Ib(t)?`${n}:${Ib(t)}`:e;this.onChainChanged(i)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var r,n;if(e!==(null==(r=this.session)?void 0:r.topic))return;const{namespaces:i}=t,s=null==(n=this.client)?void 0:n.session.get(e);this.session=Uv(Rv({},s),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===(null==(t=this.session)?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Uv(Rv({},Fd("USER_DISCONNECTED")),{data:e.topic})))}),this.on(qw,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[$w]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace(null==(t=this.session)?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t={},optionalNamespaces:r={},sessionProperties:n,scopedProperties:i}=e;this.optionalNamespaces=vb(t,r),this.sessionProperties=n,this.scopedProperties=i}validateChain(e){const[t,r]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,r];if(t&&!Object.keys(this.namespaces||{}).map(e=>Dd(e)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&r)return[t,r];const n=Dd(Object.keys(this.namespaces)[0]);return[n,this.rpcProviders[n].getDefaultChain()]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,t=!1){if(!this.namespaces)return;const[r,n]=this.validateChain(e);if(!n)return;this.updateNamespaceChain(r,n),this.events.emit("chainChanged",n);const i=this.getProvider(r).getDefaultChain();t||this.getProvider(r).setDefaultChain(n),this.emitAccountsChangedOnChainChange({namespace:r,previousChainId:i,newChainId:e}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:t,newChainId:r}){var n,i;try{if(t===r)return;const s=null==(i=null==(n=this.session)?void 0:n.namespaces[e])?void 0:i.accounts;if(!s)return;const o=s.filter(e=>e.includes(`${r}:`)).map(Ab);if(!Hd(o))return;this.events.emit("accountsChanged",o)}catch(e){this.logger.warn("Failed to emit accountsChanged on chain change",e)}}updateNamespaceChain(e,t){if(!this.namespaces)return;const r=this.namespaces[e]?e:`${e}:${t}`,n={chains:[],methods:[],events:[],defaultChain:t};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=t):this.namespaces[r]=n}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var r;const n=(null==(r=this.session)?void 0:r.topic)||"";await this.client.core.storage.setItem(`${Ww}/${e}${n}`,t)}async getFromStore(e){var t;const r=(null==(t=this.session)?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${Ww}/${e}${r}`)}async deleteFromStore(e){var t;const r=(null==(t=this.session)?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${Ww}/${e}${r}`)}async cleanupStorage(){var e;try{if((null==(e=this.client)?void 0:e.session.length)>0)return;const t=await this.client.core.storage.getKeys();for(const e of t)e.startsWith(Ww)&&await this.client.core.storage.removeItem(e)}catch(e){this.logger.warn("Failed to cleanup storage",e)}}}},6742:(e,t,r)=>{r.d(t,{w:()=>o});var n=r(4376),i=r(2944),s=r(7508);const o={isMobile(){return!!this.isClient()&&Boolean(window?.matchMedia&&"function"==typeof window.matchMedia&&window.matchMedia("(pointer:coarse)")?.matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent))},checkCaipNetwork:(e,t="")=>e?.caipNetworkId.toLocaleLowerCase().includes(t.toLowerCase()),isAndroid(){if(!this.isMobile())return!1;const e=window?.navigator.userAgent.toLowerCase();return o.isMobile()&&e.includes("android")},isIos(){if(!this.isMobile())return!1;const e=window?.navigator.userAgent.toLowerCase();return e.includes("iphone")||e.includes("ipad")},isSafari(){if(!this.isClient())return!1;const e=window?.navigator.userAgent.toLowerCase();return e.includes("safari")},isClient:()=>"undefined"!=typeof window,isPairingExpired:e=>!e||e-Date.now()<=i.oU.TEN_SEC_MS,isAllowedRetry:(e,t=i.oU.ONE_SEC_MS)=>Date.now()-e>=t,copyToClopboard(e){navigator.clipboard.writeText(e)},isIframe(){try{return window?.self!==window?.top}catch(e){return!1}},isSafeApp(){if(o.isClient()&&window.self!==window.top)try{const e=window?.location?.ancestorOrigins?.[0],t="https://app.safe.global";if(e){const r=new URL(e),n=new URL(t);return r.hostname===n.hostname}}catch{return!1}return!1},getPairingExpiry:()=>Date.now()+i.oU.FOUR_MINUTES_MS,getNetworkId:e=>e?.split(":")[1],getPlainAddress:e=>e?.split(":")[2],wait:async e=>new Promise(t=>{setTimeout(t,e)}),debounce(e,t=500){let r;return(...n)=>{r&&clearTimeout(r),r=setTimeout(function(){e(...n)},t)}},isHttpUrl:e=>e.startsWith("http://")||e.startsWith("https://"),formatNativeUrl(e,t,r=null){if(o.isHttpUrl(e))return this.formatUniversalUrl(e,t);let n=e,i=r;n.includes("://")||(n=e.replaceAll("/","").replaceAll(":",""),n=`${n}://`),n.endsWith("/")||(n=`${n}/`),i&&!i?.endsWith("/")&&(i=`${i}/`),this.isTelegram()&&this.isAndroid()&&(t=encodeURIComponent(t));const s=encodeURIComponent(t);return{redirect:`${n}wc?uri=${s}`,redirectUniversalLink:i?`${i}wc?uri=${s}`:void 0,href:n}},formatUniversalUrl(e,t){if(!o.isHttpUrl(e))return this.formatNativeUrl(e,t);let r=e;return r.endsWith("/")||(r=`${r}/`),{redirect:`${r}wc?uri=${encodeURIComponent(t)}`,href:r}},getOpenTargetForPlatform(e){return"popupWindow"===e?e:this.isTelegram()?s.i.getTelegramSocialProvider()?"_top":"_blank":e},openHref(e,t,r){window?.open(e,this.getOpenTargetForPlatform(t),r||"noreferrer noopener")},returnOpenHref(e,t,r){return window?.open(e,this.getOpenTargetForPlatform(t),r||"noreferrer noopener")},isTelegram:()=>"undefined"!=typeof window&&(Boolean(window.TelegramWebviewProxy)||Boolean(window.Telegram)||Boolean(window.TelegramWebviewProxyProto)),isPWA(){if("undefined"==typeof window)return!1;const e=!(!window?.matchMedia||"function"!=typeof window.matchMedia)&&window.matchMedia("(display-mode: standalone)")?.matches,t=window?.navigator?.standalone;return Boolean(e||t)},async preloadImage(e){const t=new Promise((t,r)=>{const n=new Image;n.onload=t,n.onerror=r,n.crossOrigin="anonymous",n.src=e});return Promise.race([t,o.wait(2e3)])},formatBalance(e,t){let r="0.000";if("string"==typeof e){const t=Number(e);if(t){const e=Math.floor(1e3*t)/1e3;e&&(r=e.toString())}}return`${r}${t?` ${t}`:""}`},getApiUrl:()=>n.o.W3M_API_URL,getBlockchainApiUrl:()=>n.o.BLOCKCHAIN_API_RPC_URL,getAnalyticsUrl:()=>n.o.PULSE_API_URL,getUUID:()=>crypto?.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),parseError:e=>"string"==typeof e?e:"string"==typeof e?.issues?.[0]?.message?e.issues[0].message:e instanceof Error?e.message:"Unknown error",sortRequestedNetworks(e,t=[]){const r={};return t&&e&&(e.forEach((e,t)=>{r[e]=t}),t.sort((e,t)=>{const n=r[e.id],i=r[t.id];return void 0!==n&&void 0!==i?n-i:void 0!==n?-1:void 0!==i?1:0})),t},calculateBalance(e){let t=0;for(const r of e)t+=r.value??0;return t},formatTokenBalance(e){const t=e.toFixed(2),[r,n]=t.split(".");return{dollars:r,pennies:n}},isAddress(e,t="eip155"){switch(t){case"eip155":return!(!/^(?:0x)?[0-9a-f]{40}$/iu.test(e)||!/^(?:0x)?[0-9a-f]{40}$/iu.test(e)&&!/^(?:0x)?[0-9A-F]{40}$/iu.test(e));case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(e);default:return!1}},uniqueBy(e,t){const r=new Set;return e.filter(e=>{const n=e[t];return!r.has(n)&&(r.add(n),!0)})},generateSdkVersion:(e,t,r)=>`${t}-${0===e.length?i.oU.ADAPTER_TYPES.UNIVERSAL:e.map(e=>e.adapterType).join(",")}-${r}`,createAccount:(e,t,r,n,i)=>({namespace:e,address:t,type:r,publicKey:n,path:i}),isCaipAddress(e){if("string"!=typeof e)return!1;const t=e.split(":"),r=t[0];return 3===t.filter(Boolean).length&&r in n.o.CHAIN_NAME_MAP},getAccount:e=>e?"string"==typeof e?{address:e,chainId:void 0}:{address:e.address,chainId:e.chainId}:{address:void 0,chainId:void 0},isMac(){const e=window?.navigator.userAgent.toLowerCase();return e.includes("macintosh")&&!e.includes("safari")},formatTelegramSocialLoginUrl(e){const t=`--${encodeURIComponent(window?.location.href)}`,r="state=";if("auth.magic.link"===new URL(e).host){const n="provider_authorization_url=",i=e.substring(e.indexOf(n)+n.length),s=this.injectIntoUrl(decodeURIComponent(i),r,t);return e.replace(i,encodeURIComponent(s))}return this.injectIntoUrl(e,r,t)},injectIntoUrl(e,t,r){const n=e.indexOf(t);if(-1===n)throw new Error(`${t} parameter not found in the URL: ${e}`);const i=e.indexOf("&",n),s=t.length,o=-1!==i?i:e.length;return e.substring(0,n+s)+(e.substring(n+s,o)+r)+e.substring(i)}}},6752:(e,t,r)=>{r.d(t,{JW:()=>S,XX:()=>q,c0:()=>C,ge:()=>$,qy:()=>I,s6:()=>k});const n=globalThis,i=n.trustedTypes,s=i?i.createPolicy("lit-html",{createHTML:e=>e}):void 0,o="$lit$",a=`lit$${Math.random().toFixed(9).slice(2)}$`,c="?"+a,l=`<${c}>`,u=document,h=()=>u.createComment(""),d=e=>null===e||"object"!=typeof e&&"function"!=typeof e,p=Array.isArray,f=e=>p(e)||"function"==typeof e?.[Symbol.iterator],g="[ \t\n\f\r]",m=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,y=/-->/g,w=/>/g,b=RegExp(`>|${g}(?:([^\\s"'>=/]+)(${g}*=${g}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),v=/'/g,E=/"/g,A=/^(?:script|style|textarea|title)$/i,_=e=>(t,...r)=>({_$litType$:e,strings:t,values:r}),I=_(1),S=_(2),C=(_(3),Symbol.for("lit-noChange")),k=Symbol.for("lit-nothing"),N=new WeakMap,x=u.createTreeWalker(u,129);function T(e,t){if(!p(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==s?s.createHTML(t):t}const O=(e,t)=>{const r=e.length-1,n=[];let i,s=2===t?"<svg>":3===t?"<math>":"",c=m;for(let t=0;t<r;t++){const r=e[t];let u,h,d=-1,p=0;for(;p<r.length&&(c.lastIndex=p,h=c.exec(r),null!==h);)p=c.lastIndex,c===m?"!--"===h[1]?c=y:void 0!==h[1]?c=w:void 0!==h[2]?(A.test(h[2])&&(i=RegExp("</"+h[2],"g")),c=b):void 0!==h[3]&&(c=b):c===b?">"===h[0]?(c=i??m,d=-1):void 0===h[1]?d=-2:(d=c.lastIndex-h[2].length,u=h[1],c=void 0===h[3]?b:'"'===h[3]?E:v):c===E||c===v?c=b:c===y||c===w?c=m:(c=b,i=void 0);const f=c===b&&e[t+1].startsWith("/>")?" ":"";s+=c===m?r+l:d>=0?(n.push(u),r.slice(0,d)+o+r.slice(d)+a+f):r+a+(-2===d?t:f)}return[T(e,s+(e[r]||"<?>")+(2===t?"</svg>":3===t?"</math>":"")),n]};class P{constructor({strings:e,_$litType$:t},r){let n;this.parts=[];let s=0,l=0;const u=e.length-1,d=this.parts,[p,f]=O(e,t);if(this.el=P.createElement(p,r),x.currentNode=this.el.content,2===t||3===t){const e=this.el.content.firstChild;e.replaceWith(...e.childNodes)}for(;null!==(n=x.nextNode())&&d.length<u;){if(1===n.nodeType){if(n.hasAttributes())for(const e of n.getAttributeNames())if(e.endsWith(o)){const t=f[l++],r=n.getAttribute(e).split(a),i=/([.?@])?(.*)/.exec(t);d.push({type:1,index:s,name:i[2],strings:r,ctor:"."===i[1]?L:"?"===i[1]?D:"@"===i[1]?W:M}),n.removeAttribute(e)}else e.startsWith(a)&&(d.push({type:6,index:s}),n.removeAttribute(e));if(A.test(n.tagName)){const e=n.textContent.split(a),t=e.length-1;if(t>0){n.textContent=i?i.emptyScript:"";for(let r=0;r<t;r++)n.append(e[r],h()),x.nextNode(),d.push({type:2,index:++s});n.append(e[t],h())}}}else if(8===n.nodeType)if(n.data===c)d.push({type:2,index:s});else{let e=-1;for(;-1!==(e=n.data.indexOf(a,e+1));)d.push({type:7,index:s}),e+=a.length-1}s++}}static createElement(e,t){const r=u.createElement("template");return r.innerHTML=e,r}}function R(e,t,r=e,n){if(t===C)return t;let i=void 0!==n?r._$Co?.[n]:r._$Cl;const s=d(t)?void 0:t._$litDirective$;return i?.constructor!==s&&(i?._$AO?.(!1),void 0===s?i=void 0:(i=new s(e),i._$AT(e,r,n)),void 0!==n?(r._$Co??=[])[n]=i:r._$Cl=i),void 0!==i&&(t=R(e,i._$AS(e,t.values),i,n)),t}class U{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:r}=this._$AD,n=(e?.creationScope??u).importNode(t,!0);x.currentNode=n;let i=x.nextNode(),s=0,o=0,a=r[0];for(;void 0!==a;){if(s===a.index){let t;2===a.type?t=new B(i,i.nextSibling,this,e):1===a.type?t=new a.ctor(i,a.name,a.strings,this,e):6===a.type&&(t=new j(i,this,e)),this._$AV.push(t),a=r[++o]}s!==a?.index&&(i=x.nextNode(),s++)}return x.currentNode=u,n}p(e){let t=0;for(const r of this._$AV)void 0!==r&&(void 0!==r.strings?(r._$AI(e,r,t),t+=r.strings.length-2):r._$AI(e[t])),t++}}class B{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,t,r,n){this.type=2,this._$AH=k,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=r,this.options=n,this._$Cv=n?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===e?.nodeType&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=R(this,e,t),d(e)?e===k||null==e||""===e?(this._$AH!==k&&this._$AR(),this._$AH=k):e!==this._$AH&&e!==C&&this._(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):f(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==k&&d(this._$AH)?this._$AA.nextSibling.data=e:this.T(u.createTextNode(e)),this._$AH=e}$(e){const{values:t,_$litType$:r}=e,n="number"==typeof r?this._$AC(e):(void 0===r.el&&(r.el=P.createElement(T(r.h,r.h[0]),this.options)),r);if(this._$AH?._$AD===n)this._$AH.p(t);else{const e=new U(n,this),r=e.u(this.options);e.p(t),this.T(r),this._$AH=e}}_$AC(e){let t=N.get(e.strings);return void 0===t&&N.set(e.strings,t=new P(e)),t}k(e){p(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let r,n=0;for(const i of e)n===t.length?t.push(r=new B(this.O(h()),this.O(h()),this,this.options)):r=t[n],r._$AI(i),n++;n<t.length&&(this._$AR(r&&r._$AB.nextSibling,n),t.length=n)}_$AR(e=this._$AA.nextSibling,t){for(this._$AP?.(!1,!0,t);e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){void 0===this._$AM&&(this._$Cv=e,this._$AP?.(e))}}class M{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,r,n,i){this.type=1,this._$AH=k,this._$AN=void 0,this.element=e,this.name=t,this._$AM=n,this.options=i,r.length>2||""!==r[0]||""!==r[1]?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=k}_$AI(e,t=this,r,n){const i=this.strings;let s=!1;if(void 0===i)e=R(this,e,t,0),s=!d(e)||e!==this._$AH&&e!==C,s&&(this._$AH=e);else{const n=e;let o,a;for(e=i[0],o=0;o<i.length-1;o++)a=R(this,n[r+o],t,o),a===C&&(a=this._$AH[o]),s||=!d(a)||a!==this._$AH[o],a===k?e=k:e!==k&&(e+=(a??"")+i[o+1]),this._$AH[o]=a}s&&!n&&this.j(e)}j(e){e===k?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class L extends M{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===k?void 0:e}}class D extends M{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==k)}}class W extends M{constructor(e,t,r,n,i){super(e,t,r,n,i),this.type=5}_$AI(e,t=this){if((e=R(this,e,t,0)??k)===C)return;const r=this._$AH,n=e===k&&r!==k||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,i=e!==k&&(r===k||n);n&&this.element.removeEventListener(this.name,this,r),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class j{constructor(e,t,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){R(this,e)}}const $={M:o,P:a,A:c,C:1,L:O,R:U,D:f,V:R,I:B,H:M,N:D,U:W,B:L,F:j},z=n.litHtmlPolyfillSupport;z?.(P,B),(n.litHtmlVersions??=[]).push("3.3.1");const q=(e,t,r)=>{const n=r?.renderBefore??t;let i=n._$litPart$;if(void 0===i){const e=r?.renderBefore??null;n._$litPart$=i=new B(t.insertBefore(h(),e),e,void 0,r??{})}return i._$AI(e),i}},7007:e=>{var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise(function(r,n){function i(r){e.removeListener(t,s),n(r)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}g(e,t,s,{once:!0}),"error"!==t&&function(e,t){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,i)})},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function l(e,t,r,n){var i,s,o,l;if(a(r),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),o=s[t]),void 0===o)o=s[t]=r,++e._eventsCount;else if("function"==typeof o?o=s[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),(i=c(e))>0&&o.length>i&&!o.warned){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=o.length,l=u,console&&console.warn&&console.warn(l)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=u.bind(n);return i.listener=r,n.wrapFn=i,i}function d(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):f(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function f(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function g(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function i(s){n.once&&e.removeEventListener(t,i),r(s)})}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=s[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var l=c.length,u=f(c,l);for(r=0;r<l;++r)n(u[r],this,t)}return!0},s.prototype.addListener=function(e,t){return l(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return l(this,e,t,!0)},s.prototype.once=function(e,t){return a(t),this.on(e,h(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,h(this,e,t)),this},s.prototype.removeListener=function(e,t){var r,n,i,s,o;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){o=r[s].listener,i=s;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,s=Object.keys(r);for(n=0;n<s.length;++n)"removeListener"!==(i=s[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},s.prototype.listeners=function(e){return d(this,e,!0)},s.prototype.rawListeners=function(e){return d(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},s.prototype.listenerCount=p,s.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},7135:(e,t,r)=>{function n(e,t){let r=e.toString();const n=r.startsWith("-");n&&(r=r.slice(1)),r=r.padStart(t,"0");let[i,s]=[r.slice(0,r.length-t),r.slice(r.length-t)];return s=s.replace(/(0+)$/,""),`${n?"-":""}${i||"0"}${s?`.${s}`:""}`}r.d(t,{J:()=>n})},7173:(e,t,r)=>{function n(){return(null===r.g||void 0===r.g?void 0:r.g.crypto)||(null===r.g||void 0===r.g?void 0:r.g.msCrypto)||{}}function i(){const e=n();return e.subtle||e.webkitSubtle}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowserCryptoAvailable=t.getSubtleCrypto=t.getBrowerCrypto=void 0,t.getBrowerCrypto=n,t.getSubtleCrypto=i,t.isBrowserCryptoAvailable=function(){return!!n()&&!!i()}},7238:(e,t,r)=>{r.d(t,{lY:()=>v});var n=r(9271),i=r(2531);const s=BigInt(0),o=BigInt(1),a=BigInt(2),c=BigInt(7),l=BigInt(256),u=BigInt(113),h=[],d=[],p=[];for(let e=0,t=o,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],h.push(2*(5*n+r)),d.push((e+1)*(e+2)/2%64);let i=s;for(let e=0;e<7;e++)t=(t<<o^(t>>c)*u)%l,t&a&&(i^=o<<(o<<BigInt(e))-o);p.push(i)}const f=(0,n.lD)(p,!0),g=f[0],m=f[1],y=(e,t,r)=>r>32?(0,n.WM)(e,t,r):(0,n.P5)(e,t,r),w=(e,t,r)=>r>32?(0,n.im)(e,t,r):(0,n.B4)(e,t,r);class b extends i.Vw{constructor(e,t,r,n=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=n,this.rounds=s,(0,i.Fe)(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=(0,i.DH)(this.state)}clone(){return this._cloneInto()}keccak(){(0,i.fd)(this.state32),function(e,t=24){const r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){const n=(t+8)%10,i=(t+2)%10,s=r[i],o=r[i+1],a=y(s,o,1)^r[n],c=w(s,o,1)^r[n+1];for(let r=0;r<50;r+=10)e[t+r]^=a,e[t+r+1]^=c}let t=e[2],i=e[3];for(let r=0;r<24;r++){const n=d[r],s=y(t,i,n),o=w(t,i,n),a=h[r];t=e[a],i=e[a+1],e[a]=s,e[a+1]=o}for(let t=0;t<50;t+=10){for(let n=0;n<10;n++)r[n]=e[t+n];for(let n=0;n<10;n++)e[t+n]^=~r[(n+2)%10]&r[(n+4)%10]}e[0]^=g[n],e[1]^=m[n]}(0,i.uH)(r)}(this.state32,this.rounds),(0,i.fd)(this.state32),this.posOut=0,this.pos=0}update(e){(0,i.CC)(this),e=(0,i.ZJ)(e),(0,i.DO)(e);const{blockLen:t,state:r}=this,n=e.length;for(let i=0;i<n;){const s=Math.min(t-this.pos,n-i);for(let t=0;t<s;t++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:r,blockLen:n}=this;e[r]^=t,128&t&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){(0,i.CC)(this,!1),(0,i.DO)(e),this.finish();const t=this.state,{blockLen:r}=this;for(let n=0,i=e.length;n<i;){this.posOut>=r&&this.keccak();const s=Math.min(r-this.posOut,i-n);e.set(t.subarray(this.posOut,this.posOut+s),n),this.posOut+=s,n+=s}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return(0,i.Fe)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if((0,i.Ht)(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,(0,i.uH)(this.state)}_cloneInto(e){const{blockLen:t,suffix:r,outputLen:n,rounds:i,enableXOF:s}=this;return e||(e=new b(t,r,n,s,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=n,e.enableXOF=s,e.destroyed=this.destroyed,e}}const v=(()=>{return e=1,t=136,r=32,(0,i.qj)(()=>new b(t,e,r));var e,t,r})()},7323:(e,t,r)=>{r.d(t,{Ng:()=>Tr,J3:()=>D,yq:()=>Ie,ZX:()=>ae,fH:()=>oe,Kt:()=>ce});var n=r(8287),i=r(4305),s=r(9404),o=r.n(s),a=r(3466),c=r.n(a),l=r(8226),u=r(2755),h=r(601);function d(e){return Array.isArray(e)?"%5B"+e.map(d).join("%2C%20")+"%5D":"bigint"==typeof e?`${e}n`:encodeURIComponent(String(null!=e&&null===Object.getPrototypeOf(e)?{...e}:e))}function p([e,t]){return`${e}=${d(t)}`}var f=class extends Error{cause=this.cause;context;constructor(...[e,t]){let r,n;if(t){const{cause:e,...i}=t;e&&(n={cause:e}),Object.keys(i).length>0&&(r=i)}super(function(e,t={}){{let r=`Solana error #${e}; Decode this error by running \`npx @solana/errors decode -- ${e}`;return Object.keys(t).length&&(r+=` '${function(e){const t=Object.entries(e).map(p).join("&");return btoa(t)}(t)}'`),`${r}\``}}(e,r),n),this.context={__code:e,...r},this.name="SolanaError"}};function g(e){return"fixedSize"in e&&"number"==typeof e.fixedSize}function m(e){return 1!==e?.endian}function y(e){return t={fixedSize:e.size,write(t,r,n){e.range&&function(e,t,r,n){if(n<t||n>r)throw new f(8078011,{codecDescription:e,max:r,min:t,value:n})}(e.name,e.range[0],e.range[1],t);const i=new ArrayBuffer(e.size);return e.set(new DataView(i),t,m(e.config)),r.set(new Uint8Array(i),n),n+e.size}},Object.freeze({...t,encode:e=>{const r=new Uint8Array(function(e,t){return"fixedSize"in t?t.fixedSize:t.getSizeFromValue(e)}(e,t));return t.write(e,r,0),r}});var t}function w(e){return t={fixedSize:e.size,read(t,r=0){!function(e,t,r=0){if(t.length-r<=0)throw new f(8078e3,{codecDescription:e})}(e.name,t,r),function(e,t,r,n=0){const i=r.length-n;if(i<t)throw new f(8078001,{bytesLength:i,codecDescription:e,expected:t})}(e.name,e.size,t,r);const n=new DataView(function(e,t,r){const n=e.byteOffset+(t??0),i=r??e.byteLength;return e.buffer.slice(n,n+i)}(t,r,e.size));return[e.get(n,m(e.config)),r+e.size]}},Object.freeze({...t,decode:(e,r=0)=>t.read(e,r)[0]});var t}var b=(e={})=>y({config:e,name:"u64",range:[0n,BigInt("0xffffffffffffffff")],set:(e,t,r)=>e.setBigUint64(0,BigInt(t),r),size:8}),v=(e={})=>function(e,t){if(g(e)!==g(t))throw new f(8078004);if(g(e)&&g(t)&&e.fixedSize!==t.fixedSize)throw new f(8078005,{decoderFixedSize:t.fixedSize,encoderFixedSize:e.fixedSize});if(!g(e)&&!g(t)&&e.maxSize!==t.maxSize)throw new f(8078006,{decoderMaxSize:t.maxSize,encoderMaxSize:e.maxSize});return{...t,...e,decode:t.decode,encode:e.encode,read:t.read,write:e.write}}(b(e),((e={})=>w({config:e,get:(e,t)=>e.getBigUint64(0,t),name:"u64",size:8}))(e)),E=r(2150),A=r(22),_=r.n(A),I=r(1825),S=r(7238),C=r(5143);i.ev.utils.randomPrivateKey;const k=()=>{const e=i.ev.utils.randomPrivateKey(),t=N(e),r=new Uint8Array(64);return r.set(e),r.set(t,32),{publicKey:t,secretKey:r}},N=i.ev.getPublicKey;function x(e){try{return i.ev.ExtendedPoint.fromHex(e),!0}catch{return!1}}const T=(e,t)=>i.ev.sign(e,t.slice(0,32)),O=i.ev.verify,P=e=>n.Buffer.isBuffer(e)?e:e instanceof Uint8Array?n.Buffer.from(e.buffer,e.byteOffset,e.byteLength):n.Buffer.from(e);class R{constructor(e){Object.assign(this,e)}encode(){return n.Buffer.from((0,u.serialize)(U,this))}static decode(e){return(0,u.deserialize)(U,this,e)}static decodeUnchecked(e){return(0,u.deserializeUnchecked)(U,this,e)}}const U=new Map;var B;const M=32;let L=1;class D extends R{constructor(e){if(super({}),this._bn=void 0,function(e){return void 0!==e._bn}(e))this._bn=e._bn;else{if("string"==typeof e){const t=c().decode(e);if(t.length!=M)throw new Error("Invalid public key input");this._bn=new(o())(t)}else this._bn=new(o())(e);if(this._bn.byteLength()>M)throw new Error("Invalid public key input")}}static unique(){const e=new D(L);return L+=1,new D(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return c().encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(n.Buffer);if(e.length===M)return e;const t=n.Buffer.alloc(32);return e.copy(t,32-e.length),t}get[Symbol.toStringTag](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,r){const i=n.Buffer.concat([e.toBuffer(),n.Buffer.from(t),r.toBuffer()]),s=(0,l.sc)(i);return new D(s)}static createProgramAddressSync(e,t){let r=n.Buffer.alloc(0);e.forEach(function(e){if(e.length>32)throw new TypeError("Max seed length exceeded");r=n.Buffer.concat([r,P(e)])}),r=n.Buffer.concat([r,t.toBuffer(),n.Buffer.from("ProgramDerivedAddress")]);const i=(0,l.sc)(r);if(x(i))throw new Error("Invalid seeds, address must fall off the curve");return new D(i)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let r,i=255;for(;0!=i;){try{const s=e.concat(n.Buffer.from([i]));r=this.createProgramAddressSync(s,t)}catch(e){if(e instanceof TypeError)throw e;i--;continue}return[r,i]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){return x(new D(e).toBytes())}}B=D,D.default=new B("11111111111111111111111111111111"),U.set(D,{kind:"struct",fields:[["_bn","u256"]]}),new D("BPFLoader1111111111111111111111111111111111");const W=1232;class j extends Error{constructor(e){super(`Signature ${e} has expired: block height exceeded.`),this.signature=void 0,this.signature=e}}Object.defineProperty(j.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class $ extends Error{constructor(e,t){super(`Transaction was not confirmed in ${t.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${e} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=e}}Object.defineProperty($.prototype,"name",{value:"TransactionExpiredTimeoutError"});class z extends Error{constructor(e){super(`Signature ${e} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=e}}Object.defineProperty(z.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class q{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>256)throw new Error("Account index overflow encountered during compilation");const t=new Map;this.keySegments().flat().forEach((e,r)=>{t.set(e.toBase58(),r)});const r=e=>{const r=t.get(e.toBase58());if(void 0===r)throw new Error("Encountered an unknown instruction account key during compilation");return r};return e.map(e=>({programIdIndex:r(e.programId),accountKeyIndexes:e.keys.map(e=>r(e.pubkey)),data:e.data}))}}const F=(e="publicKey")=>h.av(32,e),H=(e="signature")=>h.av(64,e),K=(e="string")=>{const t=h.w3([h.DH("length"),h.DH("lengthPadding"),h.av(h.cY(h.DH(),-8),"chars")],e),r=t.decode.bind(t),i=t.encode.bind(t),s=t;return s.decode=(e,t)=>r(e,t).chars.toString(),s.encode=(e,t,r)=>{const s={chars:n.Buffer.from(e,"utf8")};return i(s,t,r)},s.alloc=e=>h.DH().span+h.DH().span+n.Buffer.from(e,"utf8").length,s};function V(e,t){const r=e=>{if(e.span>=0)return e.span;if("function"==typeof e.alloc)return e.alloc(t[e.property]);if("count"in e&&"elementLayout"in e){const n=t[e.property];if(Array.isArray(n))return n.length*r(e.elementLayout)}else if("fields"in e)return V({layout:e},t[e.property]);return 0};let n=0;return e.layout.fields.forEach(e=>{n+=r(e)}),n}function Y(e){let t=0,r=0;for(;;){let n=e.shift();if(t|=(127&n)<<7*r,r+=1,!(128&n))break}return t}function G(e,t){let r=t;for(;;){let t=127&r;if(r>>=7,0==r){e.push(t);break}t|=128,e.push(t)}}function Z(e,t){if(!e)throw new Error(t||"Assertion failed")}class J{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const r=new Map,n=e=>{const t=e.toBase58();let n=r.get(t);return void 0===n&&(n={isSigner:!1,isWritable:!1,isInvoked:!1},r.set(t,n)),n},i=n(t);i.isSigner=!0,i.isWritable=!0;for(const t of e){n(t.programId).isInvoked=!0;for(const e of t.keys){const t=n(e.pubkey);t.isSigner||=e.isSigner,t.isWritable||=e.isWritable}}return new J(t,r)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];Z(e.length<=256,"Max static account keys length exceeded");const t=e.filter(([,e])=>e.isSigner&&e.isWritable),r=e.filter(([,e])=>e.isSigner&&!e.isWritable),n=e.filter(([,e])=>!e.isSigner&&e.isWritable),i=e.filter(([,e])=>!e.isSigner&&!e.isWritable),s={numRequiredSignatures:t.length+r.length,numReadonlySignedAccounts:r.length,numReadonlyUnsignedAccounts:i.length};{Z(t.length>0,"Expected at least one writable signer key");const[e]=t[0];Z(e===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}return[s,[...t.map(([e])=>new D(e)),...r.map(([e])=>new D(e)),...n.map(([e])=>new D(e)),...i.map(([e])=>new D(e))]]}extractTableLookup(e){const[t,r]=this.drainKeysFoundInLookupTable(e.state.addresses,e=>!e.isSigner&&!e.isInvoked&&e.isWritable),[n,i]=this.drainKeysFoundInLookupTable(e.state.addresses,e=>!e.isSigner&&!e.isInvoked&&!e.isWritable);if(0!==t.length||0!==n.length)return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:n},{writable:r,readonly:i}]}drainKeysFoundInLookupTable(e,t){const r=new Array,n=new Array;for(const[i,s]of this.keyMetaMap.entries())if(t(s)){const t=new D(i),s=e.findIndex(e=>e.equals(t));s>=0&&(Z(s<256,"Max lookup table index exceeded"),r.push(s),n.push(t),this.keyMetaMap.delete(i))}return[r,n]}}const X="Reached end of buffer unexpectedly";function Q(e){if(0===e.length)throw new Error(X);return e.shift()}function ee(e,...t){const[r]=t;if(2===t.length?r+(t[1]??0)>e.length:r>=e.length)throw new Error(X);return e.splice(...t)}class te{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(e=>new D(e)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(e=>this.indexToProgramIds.set(e.programIdIndex,this.accountKeys[e.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:c().decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new q(this.staticAccountKeys)}static compile(e){const t=J.compile(e.instructions,e.payerKey),[r,n]=t.getMessageComponents(),i=new q(n).compileInstructions(e.instructions).map(e=>({programIdIndex:e.programIdIndex,accounts:e.accountKeyIndexes,data:c().encode(e.data)}));return new te({header:r,accountKeys:n,recentBlockhash:e.recentBlockhash,instructions:i})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;return e>=this.header.numRequiredSignatures?e-t<this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts:e<t-this.header.numReadonlySignedAccounts}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){const e=this.accountKeys.length;let t=[];G(t,e);const r=this.instructions.map(e=>{const{accounts:t,programIdIndex:r}=e,i=Array.from(c().decode(e.data));let s=[];G(s,t.length);let o=[];return G(o,i.length),{programIdIndex:r,keyIndicesCount:n.Buffer.from(s),keyIndices:t,dataLength:n.Buffer.from(o),data:i}});let i=[];G(i,r.length);let s=n.Buffer.alloc(W);n.Buffer.from(i).copy(s);let o=i.length;r.forEach(e=>{const t=h.w3([h.u8("programIdIndex"),h.av(e.keyIndicesCount.length,"keyIndicesCount"),h.O6(h.u8("keyIndex"),e.keyIndices.length,"keyIndices"),h.av(e.dataLength.length,"dataLength"),h.O6(h.u8("userdatum"),e.data.length,"data")]).encode(e,s,o);o+=t}),s=s.slice(0,o);const a=h.w3([h.av(1,"numRequiredSignatures"),h.av(1,"numReadonlySignedAccounts"),h.av(1,"numReadonlyUnsignedAccounts"),h.av(t.length,"keyCount"),h.O6(F("key"),e,"keys"),F("recentBlockhash")]),l={numRequiredSignatures:n.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:n.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:n.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:n.Buffer.from(t),keys:this.accountKeys.map(e=>P(e.toBytes())),recentBlockhash:c().decode(this.recentBlockhash)};let u=n.Buffer.alloc(2048);const d=a.encode(l,u);return s.copy(u,d),u.slice(0,d+s.length)}static from(e){let t=[...e];const r=Q(t);if(r!==(127&r))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const i=Q(t),s=Q(t),o=Y(t);let a=[];for(let e=0;e<o;e++){const e=ee(t,0,M);a.push(new D(n.Buffer.from(e)))}const l=ee(t,0,M),u=Y(t);let h=[];for(let e=0;e<u;e++){const e=Q(t),r=ee(t,0,Y(t)),i=ee(t,0,Y(t)),s=c().encode(n.Buffer.from(i));h.push({programIdIndex:e,accounts:r,data:s})}const d={header:{numRequiredSignatures:r,numReadonlySignedAccounts:i,numReadonlyUnsignedAccounts:s},recentBlockhash:c().encode(n.Buffer.from(l)),accountKeys:a,instructions:h};return new te(d)}}class re{constructor(e){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=e.header,this.staticAccountKeys=e.staticAccountKeys,this.recentBlockhash=e.recentBlockhash,this.compiledInstructions=e.compiledInstructions,this.addressTableLookups=e.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let e=0;for(const t of this.addressTableLookups)e+=t.readonlyIndexes.length+t.writableIndexes.length;return e}getAccountKeys(e){let t;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");t=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)t=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new q(this.staticAccountKeys,t)}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures,r=this.staticAccountKeys.length;return e>=r?e-r<this.addressTableLookups.reduce((e,t)=>e+t.writableIndexes.length,0):e>=this.header.numRequiredSignatures?e-t<r-t-this.header.numReadonlyUnsignedAccounts:e<t-this.header.numReadonlySignedAccounts}resolveAddressTableLookups(e){const t={writable:[],readonly:[]};for(const r of this.addressTableLookups){const n=e.find(e=>e.key.equals(r.accountKey));if(!n)throw new Error(`Failed to find address lookup table account for table key ${r.accountKey.toBase58()}`);for(const e of r.writableIndexes){if(!(e<n.state.addresses.length))throw new Error(`Failed to find address for index ${e} in address lookup table ${r.accountKey.toBase58()}`);t.writable.push(n.state.addresses[e])}for(const e of r.readonlyIndexes){if(!(e<n.state.addresses.length))throw new Error(`Failed to find address for index ${e} in address lookup table ${r.accountKey.toBase58()}`);t.readonly.push(n.state.addresses[e])}}return t}static compile(e){const t=J.compile(e.instructions,e.payerKey),r=new Array,n={writable:new Array,readonly:new Array},i=e.addressLookupTableAccounts||[];for(const e of i){const i=t.extractTableLookup(e);if(void 0!==i){const[e,{writable:t,readonly:s}]=i;r.push(e),n.writable.push(...t),n.readonly.push(...s)}}const[s,o]=t.getMessageComponents(),a=new q(o,n).compileInstructions(e.instructions);return new re({header:s,staticAccountKeys:o,recentBlockhash:e.recentBlockhash,compiledInstructions:a,addressTableLookups:r})}serialize(){const e=Array();G(e,this.staticAccountKeys.length);const t=this.serializeInstructions(),r=Array();G(r,this.compiledInstructions.length);const n=this.serializeAddressTableLookups(),i=Array();G(i,this.addressTableLookups.length);const s=h.w3([h.u8("prefix"),h.w3([h.u8("numRequiredSignatures"),h.u8("numReadonlySignedAccounts"),h.u8("numReadonlyUnsignedAccounts")],"header"),h.av(e.length,"staticAccountKeysLength"),h.O6(F(),this.staticAccountKeys.length,"staticAccountKeys"),F("recentBlockhash"),h.av(r.length,"instructionsLength"),h.av(t.length,"serializedInstructions"),h.av(i.length,"addressTableLookupsLength"),h.av(n.length,"serializedAddressTableLookups")]),o=new Uint8Array(W),a=s.encode({prefix:128,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map(e=>e.toBytes()),recentBlockhash:c().decode(this.recentBlockhash),instructionsLength:new Uint8Array(r),serializedInstructions:t,addressTableLookupsLength:new Uint8Array(i),serializedAddressTableLookups:n},o);return o.slice(0,a)}serializeInstructions(){let e=0;const t=new Uint8Array(W);for(const r of this.compiledInstructions){const n=Array();G(n,r.accountKeyIndexes.length);const i=Array();G(i,r.data.length),e+=h.w3([h.u8("programIdIndex"),h.av(n.length,"encodedAccountKeyIndexesLength"),h.O6(h.u8(),r.accountKeyIndexes.length,"accountKeyIndexes"),h.av(i.length,"encodedDataLength"),h.av(r.data.length,"data")]).encode({programIdIndex:r.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(n),accountKeyIndexes:r.accountKeyIndexes,encodedDataLength:new Uint8Array(i),data:r.data},t,e)}return t.slice(0,e)}serializeAddressTableLookups(){let e=0;const t=new Uint8Array(W);for(const r of this.addressTableLookups){const n=Array();G(n,r.writableIndexes.length);const i=Array();G(i,r.readonlyIndexes.length),e+=h.w3([F("accountKey"),h.av(n.length,"encodedWritableIndexesLength"),h.O6(h.u8(),r.writableIndexes.length,"writableIndexes"),h.av(i.length,"encodedReadonlyIndexesLength"),h.O6(h.u8(),r.readonlyIndexes.length,"readonlyIndexes")]).encode({accountKey:r.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(n),writableIndexes:r.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(i),readonlyIndexes:r.readonlyIndexes},t,e)}return t.slice(0,e)}static deserialize(e){let t=[...e];const r=Q(t),n=127&r;Z(r!==n,"Expected versioned message but received legacy message"),Z(0===n,`Expected versioned message with version 0 but found version ${n}`);const i={numRequiredSignatures:Q(t),numReadonlySignedAccounts:Q(t),numReadonlyUnsignedAccounts:Q(t)},s=[],o=Y(t);for(let e=0;e<o;e++)s.push(new D(ee(t,0,M)));const a=c().encode(ee(t,0,M)),l=Y(t),u=[];for(let e=0;e<l;e++){const e=Q(t),r=ee(t,0,Y(t)),n=Y(t),i=new Uint8Array(ee(t,0,n));u.push({programIdIndex:e,accountKeyIndexes:r,data:i})}const h=Y(t),d=[];for(let e=0;e<h;e++){const e=new D(ee(t,0,M)),r=ee(t,0,Y(t)),n=ee(t,0,Y(t));d.push({accountKey:e,writableIndexes:r,readonlyIndexes:n})}return new re({header:i,staticAccountKeys:s,recentBlockhash:a,compiledInstructions:u,addressTableLookups:d})}}const ne={deserializeMessageVersion(e){const t=e[0],r=127&t;return r===t?"legacy":r},deserialize:e=>{const t=ne.deserializeMessageVersion(e);if("legacy"===t)return te.from(e);if(0===t)return re.deserialize(e);throw new Error(`Transaction message version ${t} deserialization is not supported`)}};let ie=function(e){return e[e.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",e[e.PROCESSED=1]="PROCESSED",e[e.TIMED_OUT=2]="TIMED_OUT",e[e.NONCE_INVALID=3]="NONCE_INVALID",e}({});const se=n.Buffer.alloc(64).fill(0);class oe{constructor(e){this.keys=void 0,this.programId=void 0,this.data=n.Buffer.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:r})=>({pubkey:e.toJSON(),isSigner:t,isWritable:r})),programId:this.programId.toJSON(),data:[...this.data]}}}class ae{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:r}=e;this.minNonceContextSlot=t,this.nonceInfo=r}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:r}=e;this.recentBlockhash=t,this.lastValidBlockHeight=r}else{const{recentBlockhash:t,nonceInfo:r}=e;r&&(this.nonceInfo=r),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(0===e.length)throw new Error("No instructions");return e.forEach(e=>{"instructions"in e?this.instructions=this.instructions.concat(e.instructions):"data"in e&&"programId"in e&&"keys"in e?this.instructions.push(e):this.instructions.push(new oe(e))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t,r;if(this.nonceInfo?(e=this.nonceInfo.nonce,t=this.instructions[0]!=this.nonceInfo.nonceInstruction?[this.nonceInfo.nonceInstruction,...this.instructions]:this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");if(t.length<1&&console.warn("No instructions provided"),this.feePayer)r=this.feePayer;else{if(!(this.signatures.length>0&&this.signatures[0].publicKey))throw new Error("Transaction fee payer required");r=this.signatures[0].publicKey}for(let e=0;e<t.length;e++)if(void 0===t[e].programId)throw new Error(`Transaction instruction index ${e} has undefined program id`);const n=[],i=[];t.forEach(e=>{e.keys.forEach(e=>{i.push({...e})});const t=e.programId.toString();n.includes(t)||n.push(t)}),n.forEach(e=>{i.push({pubkey:new D(e),isSigner:!1,isWritable:!1})});const s=[];i.forEach(e=>{const t=e.pubkey.toString(),r=s.findIndex(e=>e.pubkey.toString()===t);r>-1?(s[r].isWritable=s[r].isWritable||e.isWritable,s[r].isSigner=s[r].isSigner||e.isSigner):s.push(e)}),s.sort(function(e,t){return e.isSigner!==t.isSigner?e.isSigner?-1:1:e.isWritable!==t.isWritable?e.isWritable?-1:1:e.pubkey.toBase58().localeCompare(t.pubkey.toBase58(),"en",{localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"})});const o=s.findIndex(e=>e.pubkey.equals(r));if(o>-1){const[e]=s.splice(o,1);e.isSigner=!0,e.isWritable=!0,s.unshift(e)}else s.unshift({pubkey:r,isSigner:!0,isWritable:!0});for(const e of this.signatures){const t=s.findIndex(t=>t.pubkey.equals(e.publicKey));if(!(t>-1))throw new Error(`unknown signer: ${e.publicKey.toString()}`);s[t].isSigner||(s[t].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."))}let a=0,l=0,u=0;const h=[],d=[];s.forEach(({pubkey:e,isSigner:t,isWritable:r})=>{t?(h.push(e.toString()),a+=1,r||(l+=1)):(d.push(e.toString()),r||(u+=1))});const p=h.concat(d),f=t.map(e=>{const{data:t,programId:r}=e;return{programIdIndex:p.indexOf(r.toString()),accounts:e.keys.map(e=>p.indexOf(e.pubkey.toString())),data:c().encode(t)}});return f.forEach(e=>{Z(e.programIdIndex>=0),e.accounts.forEach(e=>Z(e>=0))}),new te({header:{numRequiredSignatures:a,numReadonlySignedAccounts:l,numReadonlyUnsignedAccounts:u},accountKeys:p,recentBlockhash:e,instructions:f})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((e,r)=>t[r].equals(e.publicKey))||(this.signatures=t.map(e=>({signature:null,publicKey:e}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(0===e.length)throw new Error("No signers");const t=new Set;this.signatures=e.filter(e=>{const r=e.toString();return!t.has(r)&&(t.add(r),!0)}).map(e=>({signature:null,publicKey:e}))}sign(...e){if(0===e.length)throw new Error("No signers");const t=new Set,r=[];for(const n of e){const e=n.publicKey.toString();t.has(e)||(t.add(e),r.push(n))}this.signatures=r.map(e=>({signature:null,publicKey:e.publicKey}));const n=this._compile();this._partialSign(n,...r)}partialSign(...e){if(0===e.length)throw new Error("No signers");const t=new Set,r=[];for(const n of e){const e=n.publicKey.toString();t.has(e)||(t.add(e),r.push(n))}const n=this._compile();this._partialSign(n,...r)}_partialSign(e,...t){const r=e.serialize();t.forEach(e=>{const t=T(r,e.secretKey);this._addSignature(e.publicKey,P(t))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){Z(64===t.length);const r=this.signatures.findIndex(t=>e.equals(t.publicKey));if(r<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[r].signature=n.Buffer.from(t)}verifySignatures(e=!0){return!this._getMessageSignednessErrors(this.serializeMessage(),e)}_getMessageSignednessErrors(e,t){const r={};for(const{signature:n,publicKey:i}of this.signatures)null===n?t&&(r.missing||=[]).push(i):O(n,e,i.toBytes())||(r.invalid||=[]).push(i);return r.invalid||r.missing?r:void 0}serialize(e){const{requireAllSignatures:t,verifySignatures:r}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),n=this.serializeMessage();if(r){const e=this._getMessageSignednessErrors(n,t);if(e){let t="Signature verification failed.";throw e.invalid&&(t+=`\nInvalid signature for public key${1===e.invalid.length?"":"(s)"} [\`${e.invalid.map(e=>e.toBase58()).join("`, `")}\`].`),e.missing&&(t+=`\nMissing signature for public key${1===e.missing.length?"":"(s)"} [\`${e.missing.map(e=>e.toBase58()).join("`, `")}\`].`),new Error(t)}}return this._serialize(n)}_serialize(e){const{signatures:t}=this,r=[];G(r,t.length);const i=r.length+64*t.length+e.length,s=n.Buffer.alloc(i);return Z(t.length<256),n.Buffer.from(r).copy(s,0),t.forEach(({signature:e},t)=>{null!==e&&(Z(64===e.length,"signature has invalid length"),n.Buffer.from(e).copy(s,r.length+64*t))}),e.copy(s,r.length+64*t.length),Z(s.length<=W,`Transaction too large: ${s.length} > 1232`),s}get keys(){return Z(1===this.instructions.length),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return Z(1===this.instructions.length),this.instructions[0].programId}get data(){return Z(1===this.instructions.length),this.instructions[0].data}static from(e){let t=[...e];const r=Y(t);let i=[];for(let e=0;e<r;e++){const e=ee(t,0,64);i.push(c().encode(n.Buffer.from(e)))}return ae.populate(te.from(t),i)}static populate(e,t=[]){const r=new ae;return r.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(r.feePayer=e.accountKeys[0]),t.forEach((t,n)=>{const i={signature:t==c().encode(se)?null:c().decode(t),publicKey:e.accountKeys[n]};r.signatures.push(i)}),e.instructions.forEach(t=>{const n=t.accounts.map(t=>{const n=e.accountKeys[t];return{pubkey:n,isSigner:r.signatures.some(e=>e.publicKey.toString()===n.toString())||e.isAccountSigner(t),isWritable:e.isAccountWritable(t)}});r.instructions.push(new oe({keys:n,programId:e.accountKeys[t.programIdIndex],data:c().decode(t.data)}))}),r._message=e,r._json=r.toJSON(),r}}class ce{get version(){return this.message.version}constructor(e,t){if(this.signatures=void 0,this.message=void 0,void 0!==t)Z(t.length===e.header.numRequiredSignatures,"Expected signatures length to be equal to the number of required signatures"),this.signatures=t;else{const t=[];for(let r=0;r<e.header.numRequiredSignatures;r++)t.push(new Uint8Array(64));this.signatures=t}this.message=e}serialize(){const e=this.message.serialize(),t=Array();G(t,this.signatures.length);const r=h.w3([h.av(t.length,"encodedSignaturesLength"),h.O6(H(),this.signatures.length,"signatures"),h.av(e.length,"serializedMessage")]),n=new Uint8Array(2048),i=r.encode({encodedSignaturesLength:new Uint8Array(t),signatures:this.signatures,serializedMessage:e},n);return n.slice(0,i)}static deserialize(e){let t=[...e];const r=[],n=Y(t);for(let e=0;e<n;e++)r.push(new Uint8Array(ee(t,0,64)));const i=ne.deserialize(new Uint8Array(t));return new ce(i,r)}sign(e){const t=this.message.serialize(),r=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures);for(const n of e){const e=r.findIndex(e=>e.equals(n.publicKey));Z(e>=0,`Cannot sign with non signer key ${n.publicKey.toBase58()}`),this.signatures[e]=T(t,n.secretKey)}}addSignature(e,t){Z(64===t.byteLength,"Signature must be 64 bytes long");const r=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures).findIndex(t=>t.equals(e));Z(r>=0,`Can not add signature; \`${e.toBase58()}\` is not required to sign this transaction`),this.signatures[r]=t}}const le=new D("SysvarC1ock11111111111111111111111111111111"),ue=(new D("SysvarEpochSchedu1e111111111111111111111111"),new D("Sysvar1nstructions1111111111111111111111111"),new D("SysvarRecentB1ockHashes11111111111111111111")),he=new D("SysvarRent111111111111111111111111111111111"),de=(new D("SysvarRewards111111111111111111111111111111"),new D("SysvarS1otHashes111111111111111111111111111"),new D("SysvarS1otHistory11111111111111111111111111"),new D("SysvarStakeHistory1111111111111111111111111"));class pe extends Error{constructor({action:e,signature:t,transactionMessage:r,logs:n}){const i=n?`Logs: \n${JSON.stringify(n.slice(-10),null,2)}. `:"",s="\nCatch the `SendTransactionError` and call `getLogs()` on it for full details.";let o;switch(e){case"send":o=`Transaction ${t} resulted in an error. \n${r}. `+i+s;break;case"simulate":o=`Simulation failed. \nMessage: ${r}. \n`+i+s;break;default:o=`Unknown action '${e}'`}super(o),this.signature=void 0,this.transactionMessage=void 0,this.transactionLogs=void 0,this.signature=t,this.transactionMessage=r,this.transactionLogs=n||void 0}get transactionError(){return{message:this.transactionMessage,logs:Array.isArray(this.transactionLogs)?this.transactionLogs:void 0}}get logs(){const e=this.transactionLogs;if(null==e||"object"!=typeof e||!("then"in e))return e}async getLogs(e){return Array.isArray(this.transactionLogs)||(this.transactionLogs=new Promise((t,r)=>{e.getTransaction(this.signature).then(e=>{if(e&&e.meta&&e.meta.logMessages){const r=e.meta.logMessages;this.transactionLogs=r,t(r)}else r(new Error("Log messages not found"))}).catch(r)})),await this.transactionLogs}}class fe extends Error{constructor({code:e,message:t,data:r},n){super(null!=n?`${n}: ${t}`:t),this.code=void 0,this.data=void 0,this.code=e,this.data=r,this.name="SolanaJSONRPCError"}}async function ge(e,t,r,n){const i=n&&{skipPreflight:n.skipPreflight,preflightCommitment:n.preflightCommitment||n.commitment,maxRetries:n.maxRetries,minContextSlot:n.minContextSlot},s=await e.sendTransaction(t,r,i);let o;if(null!=t.recentBlockhash&&null!=t.lastValidBlockHeight)o=(await e.confirmTransaction({abortSignal:n?.abortSignal,signature:s,blockhash:t.recentBlockhash,lastValidBlockHeight:t.lastValidBlockHeight},n&&n.commitment)).value;else if(null!=t.minNonceContextSlot&&null!=t.nonceInfo){const{nonceInstruction:r}=t.nonceInfo,i=r.keys[0].pubkey;o=(await e.confirmTransaction({abortSignal:n?.abortSignal,minContextSlot:t.minNonceContextSlot,nonceAccountPubkey:i,nonceValue:t.nonceInfo.nonce,signature:s},n&&n.commitment)).value}else null!=n?.abortSignal&&console.warn("sendAndConfirmTransaction(): A transaction with a deprecated confirmation strategy was supplied along with an `abortSignal`. Only transactions having `lastValidBlockHeight` or a combination of `nonceInfo` and `minNonceContextSlot` are abortable."),o=(await e.confirmTransaction(s,n&&n.commitment)).value;if(o.err){if(null!=s)throw new pe({action:"send",signature:s,transactionMessage:`Status: (${JSON.stringify(o)})`});throw new Error(`Transaction ${s} failed (${JSON.stringify(o)})`)}return s}function me(e){return new Promise(t=>setTimeout(t,e))}function ye(e,t){const r=e.layout.span>=0?e.layout.span:V(e,t),i=n.Buffer.alloc(r),s=Object.assign({instruction:e.index},t);return e.layout.encode(s,i),i}const we=h.I0("lamportsPerSignature"),be=h.w3([h.DH("version"),h.DH("state"),F("authorizedPubkey"),F("nonce"),h.w3([we],"feeCalculator")]),ve=be.span;class Ee{constructor(e){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=e.authorizedPubkey,this.nonce=e.nonce,this.feeCalculator=e.feeCalculator}static fromAccountData(e){const t=be.decode(P(e),0);return new Ee({authorizedPubkey:new D(t.authorizedPubkey),nonce:new D(t.nonce).toString(),feeCalculator:t.feeCalculator})}}function Ae(e){const t=(0,h.av)(8,e),r=t.decode.bind(t),n=t.encode.bind(t),i=t,s=v();return i.decode=(e,t)=>{const n=r(e,t);return s.decode(n)},i.encode=(e,t,r)=>{const i=s.encode(e);return n(i,t,r)},i}const _e=Object.freeze({Create:{index:0,layout:h.w3([h.DH("instruction"),h.Wg("lamports"),h.Wg("space"),F("programId")])},Assign:{index:1,layout:h.w3([h.DH("instruction"),F("programId")])},Transfer:{index:2,layout:h.w3([h.DH("instruction"),Ae("lamports")])},CreateWithSeed:{index:3,layout:h.w3([h.DH("instruction"),F("base"),K("seed"),h.Wg("lamports"),h.Wg("space"),F("programId")])},AdvanceNonceAccount:{index:4,layout:h.w3([h.DH("instruction")])},WithdrawNonceAccount:{index:5,layout:h.w3([h.DH("instruction"),h.Wg("lamports")])},InitializeNonceAccount:{index:6,layout:h.w3([h.DH("instruction"),F("authorized")])},AuthorizeNonceAccount:{index:7,layout:h.w3([h.DH("instruction"),F("authorized")])},Allocate:{index:8,layout:h.w3([h.DH("instruction"),h.Wg("space")])},AllocateWithSeed:{index:9,layout:h.w3([h.DH("instruction"),F("base"),K("seed"),h.Wg("space"),F("programId")])},AssignWithSeed:{index:10,layout:h.w3([h.DH("instruction"),F("base"),K("seed"),F("programId")])},TransferWithSeed:{index:11,layout:h.w3([h.DH("instruction"),Ae("lamports"),K("seed"),F("programId")])},UpgradeNonceAccount:{index:12,layout:h.w3([h.DH("instruction")])}});class Ie{constructor(){}static createAccount(e){const t=ye(_e.Create,{lamports:e.lamports,space:e.space,programId:P(e.programId.toBuffer())});return new oe({keys:[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!0,isWritable:!0}],programId:this.programId,data:t})}static transfer(e){let t,r;return"basePubkey"in e?(t=ye(_e.TransferWithSeed,{lamports:BigInt(e.lamports),seed:e.seed,programId:P(e.programId.toBuffer())}),r=[{pubkey:e.fromPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]):(t=ye(_e.Transfer,{lamports:BigInt(e.lamports)}),r=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]),new oe({keys:r,programId:this.programId,data:t})}static assign(e){let t,r;return"basePubkey"in e?(t=ye(_e.AssignWithSeed,{base:P(e.basePubkey.toBuffer()),seed:e.seed,programId:P(e.programId.toBuffer())}),r=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]):(t=ye(_e.Assign,{programId:P(e.programId.toBuffer())}),r=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]),new oe({keys:r,programId:this.programId,data:t})}static createAccountWithSeed(e){const t=ye(_e.CreateWithSeed,{base:P(e.basePubkey.toBuffer()),seed:e.seed,lamports:e.lamports,space:e.space,programId:P(e.programId.toBuffer())});let r=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!1,isWritable:!0}];return e.basePubkey.equals(e.fromPubkey)||r.push({pubkey:e.basePubkey,isSigner:!0,isWritable:!1}),new oe({keys:r,programId:this.programId,data:t})}static createNonceAccount(e){const t=new ae;"basePubkey"in e&&"seed"in e?t.add(Ie.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:ve,programId:this.programId})):t.add(Ie.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,lamports:e.lamports,space:ve,programId:this.programId}));const r={noncePubkey:e.noncePubkey,authorizedPubkey:e.authorizedPubkey};return t.add(this.nonceInitialize(r)),t}static nonceInitialize(e){const t=ye(_e.InitializeNonceAccount,{authorized:P(e.authorizedPubkey.toBuffer())}),r={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:ue,isSigner:!1,isWritable:!1},{pubkey:he,isSigner:!1,isWritable:!1}],programId:this.programId,data:t};return new oe(r)}static nonceAdvance(e){const t=ye(_e.AdvanceNonceAccount),r={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:ue,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:t};return new oe(r)}static nonceWithdraw(e){const t=ye(_e.WithdrawNonceAccount,{lamports:e.lamports});return new oe({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0},{pubkey:ue,isSigner:!1,isWritable:!1},{pubkey:he,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:t})}static nonceAuthorize(e){const t=ye(_e.AuthorizeNonceAccount,{authorized:P(e.newAuthorizedPubkey.toBuffer())});return new oe({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:t})}static allocate(e){let t,r;return"basePubkey"in e?(t=ye(_e.AllocateWithSeed,{base:P(e.basePubkey.toBuffer()),seed:e.seed,space:e.space,programId:P(e.programId.toBuffer())}),r=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]):(t=ye(_e.Allocate,{space:e.space}),r=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]),new oe({keys:r,programId:this.programId,data:t})}}Ie.programId=new D("11111111111111111111111111111111");class Se{constructor(){}static getMinNumSignatures(e){return 2*(Math.ceil(e/Se.chunkSize)+1+1)}static async load(e,t,r,i,s){{const n=await e.getMinimumBalanceForRentExemption(s.length),o=await e.getAccountInfo(r.publicKey,"confirmed");let a=null;if(null!==o){if(o.executable)return console.error("Program load failed, account is already executable"),!1;o.data.length!==s.length&&(a=a||new ae,a.add(Ie.allocate({accountPubkey:r.publicKey,space:s.length}))),o.owner.equals(i)||(a=a||new ae,a.add(Ie.assign({accountPubkey:r.publicKey,programId:i}))),o.lamports<n&&(a=a||new ae,a.add(Ie.transfer({fromPubkey:t.publicKey,toPubkey:r.publicKey,lamports:n-o.lamports})))}else a=(new ae).add(Ie.createAccount({fromPubkey:t.publicKey,newAccountPubkey:r.publicKey,lamports:n>0?n:1,space:s.length,programId:i}));null!==a&&await ge(e,a,[t,r],{commitment:"confirmed"})}const o=h.w3([h.DH("instruction"),h.DH("offset"),h.DH("bytesLength"),h.DH("bytesLengthPadding"),h.O6(h.u8("byte"),h.cY(h.DH(),-8),"bytes")]),a=Se.chunkSize;let c=0,l=s,u=[];for(;l.length>0;){const s=l.slice(0,a),h=n.Buffer.alloc(a+16);o.encode({instruction:0,offset:c,bytes:s,bytesLength:0,bytesLengthPadding:0},h);const d=(new ae).add({keys:[{pubkey:r.publicKey,isSigner:!0,isWritable:!0}],programId:i,data:h});if(u.push(ge(e,d,[t,r],{commitment:"confirmed"})),e._rpcEndpoint.includes("solana.com")){const e=4;await me(1e3/e)}c+=a,l=l.slice(a)}await Promise.all(u);{const s=h.w3([h.DH("instruction")]),o=n.Buffer.alloc(s.span);s.encode({instruction:1},o);const a=(new ae).add({keys:[{pubkey:r.publicKey,isSigner:!0,isWritable:!0},{pubkey:he,isSigner:!1,isWritable:!1}],programId:i,data:o}),c="processed",l=await e.sendTransaction(a,[t,r],{preflightCommitment:c}),{context:u,value:d}=await e.confirmTransaction({signature:l,lastValidBlockHeight:a.lastValidBlockHeight,blockhash:a.recentBlockhash},c);if(d.err)throw new Error(`Transaction ${l} failed (${JSON.stringify(d)})`);for(;;){try{if(await e.getSlot({commitment:c})>u.slot)break}catch{}await new Promise(e=>setTimeout(e,Math.round(200)))}}return!0}}function Ce(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ke,Ne;function xe(){if(Ne)return ke;Ne=1;var e=Object.prototype.toString,t=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};function r(n,i){var s,o,a,c,l,u,h;if(!0===n)return"true";if(!1===n)return"false";switch(typeof n){case"object":if(null===n)return null;if(n.toJSON&&"function"==typeof n.toJSON)return r(n.toJSON(),i);if("[object Array]"===(h=e.call(n))){for(a="[",o=n.length-1,s=0;s<o;s++)a+=r(n[s],!0)+",";return o>-1&&(a+=r(n[s],!0)),a+"]"}if("[object Object]"===h){for(o=(c=t(n).sort()).length,a="",s=0;s<o;)void 0!==(u=r(n[l=c[s]],!1))&&(a&&(a+=","),a+=JSON.stringify(l)+":"+u),s++;return"{"+a+"}"}return JSON.stringify(n);case"function":case"undefined":return i?null:void 0;case"string":return JSON.stringify(n);default:return isFinite(n)?n:null}}return ke=function(e){var t=r(e,!1);if(void 0!==t)return""+t}}Se.chunkSize=932,new D("BPFLoader2111111111111111111111111111111111");var Te=Ce(xe());function Oe(e){let t=0;for(;e>1;)e/=2,t++;return t}class Pe{constructor(e,t,r,n,i){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=e,this.leaderScheduleSlotOffset=t,this.warmup=r,this.firstNormalEpoch=n,this.firstNormalSlot=i}getEpoch(e){return this.getEpochAndSlotIndex(e)[0]}getEpochAndSlotIndex(e){if(e<this.firstNormalSlot){const r=Oe(0===(t=e+32+1)?1:(t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,1+(t|=t>>32)))-Oe(32)-1;return[r,e-(this.getSlotsInEpoch(r)-32)]}{const t=e-this.firstNormalSlot,r=Math.floor(t/this.slotsPerEpoch);return[this.firstNormalEpoch+r,t%this.slotsPerEpoch]}var t}getFirstSlotInEpoch(e){return e<=this.firstNormalEpoch?32*(Math.pow(2,e)-1):(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}getSlotsInEpoch(e){return e<this.firstNormalEpoch?Math.pow(2,e+Oe(32)):this.slotsPerEpoch}}var Re=globalThis.fetch;class Ue extends I.vE{constructor(e,t,r){super(e=>{const r=(0,I.kb)(e,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...t});return this.underlyingSocket="socket"in r?r.socket:r,r},e,t,r),this.underlyingSocket=void 0}call(...e){const t=this.underlyingSocket?.readyState;return 1===t?super.call(...e):Promise.reject(new Error("Tried to call a JSON-RPC method `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}notify(...e){const t=this.underlyingSocket?.readyState;return 1===t?super.notify(...e):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}}class Be{constructor(e){this.key=void 0,this.state=void 0,this.key=e.key,this.state=e.state}isActive(){const e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}static deserialize(e){const t=function(e,t){let r;try{r=e.layout.decode(t)}catch(e){throw new Error("invalid instruction; "+e)}if(r.typeIndex!==e.index)throw new Error(`invalid account data; account type mismatch ${r.typeIndex} != ${e.index}`);return r}(Me,e),r=e.length-56;Z(r>=0,"lookup table is invalid"),Z(r%32==0,"lookup table is invalid");const n=r/32,{addresses:i}=h.w3([h.O6(F(),n,"addresses")]).decode(e.slice(56));return{deactivationSlot:t.deactivationSlot,lastExtendedSlot:t.lastExtendedSlot,lastExtendedSlotStartIndex:t.lastExtendedStartIndex,authority:0!==t.authority.length?new D(t.authority[0]):void 0,addresses:i.map(e=>new D(e))}}}const Me={index:1,layout:h.w3([h.DH("typeIndex"),Ae("deactivationSlot"),h.I0("lastExtendedSlot"),h.u8("lastExtendedStartIndex"),h.u8(),h.O6(F(),h.cY(h.u8(),-1),"authority")])},Le=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i,De=(0,E.au)((0,E.KJ)(D),(0,E.Yj)(),e=>new D(e)),We=(0,E.PV)([(0,E.Yj)(),(0,E.eu)("base64")]),je=(0,E.au)((0,E.KJ)(n.Buffer),We,e=>n.Buffer.from(e[0],"base64"));function $e(e){let t,r;if("string"==typeof e)t=e;else if(e){const{commitment:n,...i}=e;t=n,r=i}return{commitment:t,config:r}}function ze(e){return e.map(e=>"memcmp"in e?{...e,memcmp:{...e.memcmp,encoding:e.memcmp.encoding??"base58"}}:e)}function qe(e){return(0,E.KC)([(0,E.NW)({jsonrpc:(0,E.eu)("2.0"),id:(0,E.Yj)(),result:e}),(0,E.NW)({jsonrpc:(0,E.eu)("2.0"),id:(0,E.Yj)(),error:(0,E.NW)({code:(0,E.L5)(),message:(0,E.Yj)(),data:(0,E.lq)((0,E.bz)())})})])}const Fe=qe((0,E.L5)());function He(e){return(0,E.au)(qe(e),Fe,t=>"error"in t?t:{...t,result:(0,E.vt)(t.result,e)})}function Ke(e){return He((0,E.NW)({context:(0,E.NW)({slot:(0,E.ai)()}),value:e}))}function Ve(e){return(0,E.NW)({context:(0,E.NW)({slot:(0,E.ai)()}),value:e})}function Ye(e,t){return 0===e?new re({header:t.header,staticAccountKeys:t.accountKeys.map(e=>new D(e)),recentBlockhash:t.recentBlockhash,compiledInstructions:t.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:c().decode(e.data)})),addressTableLookups:t.addressTableLookups}):new te(t)}const Ge=(0,E.NW)({foundation:(0,E.ai)(),foundationTerm:(0,E.ai)(),initial:(0,E.ai)(),taper:(0,E.ai)(),terminal:(0,E.ai)()}),Ze=He((0,E.YO)((0,E.me)((0,E.NW)({epoch:(0,E.ai)(),effectiveSlot:(0,E.ai)(),amount:(0,E.ai)(),postBalance:(0,E.ai)(),commission:(0,E.lq)((0,E.me)((0,E.ai)()))})))),Je=(0,E.YO)((0,E.NW)({slot:(0,E.ai)(),prioritizationFee:(0,E.ai)()})),Xe=(0,E.NW)({total:(0,E.ai)(),validator:(0,E.ai)(),foundation:(0,E.ai)(),epoch:(0,E.ai)()}),Qe=(0,E.NW)({epoch:(0,E.ai)(),slotIndex:(0,E.ai)(),slotsInEpoch:(0,E.ai)(),absoluteSlot:(0,E.ai)(),blockHeight:(0,E.lq)((0,E.ai)()),transactionCount:(0,E.lq)((0,E.ai)())}),et=(0,E.NW)({slotsPerEpoch:(0,E.ai)(),leaderScheduleSlotOffset:(0,E.ai)(),warmup:(0,E.zM)(),firstNormalEpoch:(0,E.ai)(),firstNormalSlot:(0,E.ai)()}),tt=(0,E.g1)((0,E.Yj)(),(0,E.YO)((0,E.ai)())),rt=(0,E.me)((0,E.KC)([(0,E.NW)({}),(0,E.Yj)()])),nt=(0,E.NW)({err:rt}),it=(0,E.eu)("receivedSignature"),st=(0,E.NW)({"solana-core":(0,E.Yj)(),"feature-set":(0,E.lq)((0,E.ai)())}),ot=(0,E.NW)({program:(0,E.Yj)(),programId:De,parsed:(0,E.L5)()}),at=(0,E.NW)({programId:De,accounts:(0,E.YO)(De),data:(0,E.Yj)()}),ct=Ke((0,E.NW)({err:(0,E.me)((0,E.KC)([(0,E.NW)({}),(0,E.Yj)()])),logs:(0,E.me)((0,E.YO)((0,E.Yj)())),accounts:(0,E.lq)((0,E.me)((0,E.YO)((0,E.me)((0,E.NW)({executable:(0,E.zM)(),owner:(0,E.Yj)(),lamports:(0,E.ai)(),data:(0,E.YO)((0,E.Yj)()),rentEpoch:(0,E.lq)((0,E.ai)())}))))),unitsConsumed:(0,E.lq)((0,E.ai)()),returnData:(0,E.lq)((0,E.me)((0,E.NW)({programId:(0,E.Yj)(),data:(0,E.PV)([(0,E.Yj)(),(0,E.eu)("base64")])}))),innerInstructions:(0,E.lq)((0,E.me)((0,E.YO)((0,E.NW)({index:(0,E.ai)(),instructions:(0,E.YO)((0,E.KC)([ot,at]))}))))})),lt=Ke((0,E.NW)({byIdentity:(0,E.g1)((0,E.Yj)(),(0,E.YO)((0,E.ai)())),range:(0,E.NW)({firstSlot:(0,E.ai)(),lastSlot:(0,E.ai)()})})),ut=He(Ge),ht=He(Xe),dt=He(Je),pt=He(Qe),ft=He(et),gt=He(tt),mt=He((0,E.ai)()),yt=Ke((0,E.NW)({total:(0,E.ai)(),circulating:(0,E.ai)(),nonCirculating:(0,E.ai)(),nonCirculatingAccounts:(0,E.YO)(De)})),wt=(0,E.NW)({amount:(0,E.Yj)(),uiAmount:(0,E.me)((0,E.ai)()),decimals:(0,E.ai)(),uiAmountString:(0,E.lq)((0,E.Yj)())}),bt=Ke((0,E.YO)((0,E.NW)({address:De,amount:(0,E.Yj)(),uiAmount:(0,E.me)((0,E.ai)()),decimals:(0,E.ai)(),uiAmountString:(0,E.lq)((0,E.Yj)())}))),vt=Ke((0,E.YO)((0,E.NW)({pubkey:De,account:(0,E.NW)({executable:(0,E.zM)(),owner:De,lamports:(0,E.ai)(),data:je,rentEpoch:(0,E.ai)()})}))),Et=(0,E.NW)({program:(0,E.Yj)(),parsed:(0,E.L5)(),space:(0,E.ai)()}),At=Ke((0,E.YO)((0,E.NW)({pubkey:De,account:(0,E.NW)({executable:(0,E.zM)(),owner:De,lamports:(0,E.ai)(),data:Et,rentEpoch:(0,E.ai)()})}))),_t=Ke((0,E.YO)((0,E.NW)({lamports:(0,E.ai)(),address:De}))),It=(0,E.NW)({executable:(0,E.zM)(),owner:De,lamports:(0,E.ai)(),data:je,rentEpoch:(0,E.ai)()}),St=(0,E.NW)({pubkey:De,account:It}),Ct=(0,E.au)((0,E.KC)([(0,E.KJ)(n.Buffer),Et]),(0,E.KC)([We,Et]),e=>Array.isArray(e)?(0,E.vt)(e,je):e),kt=(0,E.NW)({executable:(0,E.zM)(),owner:De,lamports:(0,E.ai)(),data:Ct,rentEpoch:(0,E.ai)()}),Nt=(0,E.NW)({pubkey:De,account:kt}),xt=(0,E.NW)({state:(0,E.KC)([(0,E.eu)("active"),(0,E.eu)("inactive"),(0,E.eu)("activating"),(0,E.eu)("deactivating")]),active:(0,E.ai)(),inactive:(0,E.ai)()}),Tt=He((0,E.YO)((0,E.NW)({signature:(0,E.Yj)(),slot:(0,E.ai)(),err:rt,memo:(0,E.me)((0,E.Yj)()),blockTime:(0,E.lq)((0,E.me)((0,E.ai)()))}))),Ot=He((0,E.YO)((0,E.NW)({signature:(0,E.Yj)(),slot:(0,E.ai)(),err:rt,memo:(0,E.me)((0,E.Yj)()),blockTime:(0,E.lq)((0,E.me)((0,E.ai)()))}))),Pt=(0,E.NW)({subscription:(0,E.ai)(),result:Ve(It)}),Rt=(0,E.NW)({pubkey:De,account:It}),Ut=(0,E.NW)({subscription:(0,E.ai)(),result:Ve(Rt)}),Bt=(0,E.NW)({parent:(0,E.ai)(),slot:(0,E.ai)(),root:(0,E.ai)()}),Mt=(0,E.NW)({subscription:(0,E.ai)(),result:Bt}),Lt=(0,E.KC)([(0,E.NW)({type:(0,E.KC)([(0,E.eu)("firstShredReceived"),(0,E.eu)("completed"),(0,E.eu)("optimisticConfirmation"),(0,E.eu)("root")]),slot:(0,E.ai)(),timestamp:(0,E.ai)()}),(0,E.NW)({type:(0,E.eu)("createdBank"),parent:(0,E.ai)(),slot:(0,E.ai)(),timestamp:(0,E.ai)()}),(0,E.NW)({type:(0,E.eu)("frozen"),slot:(0,E.ai)(),timestamp:(0,E.ai)(),stats:(0,E.NW)({numTransactionEntries:(0,E.ai)(),numSuccessfulTransactions:(0,E.ai)(),numFailedTransactions:(0,E.ai)(),maxTransactionsPerEntry:(0,E.ai)()})}),(0,E.NW)({type:(0,E.eu)("dead"),slot:(0,E.ai)(),timestamp:(0,E.ai)(),err:(0,E.Yj)()})]),Dt=(0,E.NW)({subscription:(0,E.ai)(),result:Lt}),Wt=(0,E.NW)({subscription:(0,E.ai)(),result:Ve((0,E.KC)([nt,it]))}),jt=(0,E.NW)({subscription:(0,E.ai)(),result:(0,E.ai)()}),$t=(0,E.NW)({pubkey:(0,E.Yj)(),gossip:(0,E.me)((0,E.Yj)()),tpu:(0,E.me)((0,E.Yj)()),rpc:(0,E.me)((0,E.Yj)()),version:(0,E.me)((0,E.Yj)())}),zt=(0,E.NW)({votePubkey:(0,E.Yj)(),nodePubkey:(0,E.Yj)(),activatedStake:(0,E.ai)(),epochVoteAccount:(0,E.zM)(),epochCredits:(0,E.YO)((0,E.PV)([(0,E.ai)(),(0,E.ai)(),(0,E.ai)()])),commission:(0,E.ai)(),lastVote:(0,E.ai)(),rootSlot:(0,E.me)((0,E.ai)())}),qt=He((0,E.NW)({current:(0,E.YO)(zt),delinquent:(0,E.YO)(zt)})),Ft=(0,E.KC)([(0,E.eu)("processed"),(0,E.eu)("confirmed"),(0,E.eu)("finalized")]),Ht=(0,E.NW)({slot:(0,E.ai)(),confirmations:(0,E.me)((0,E.ai)()),err:rt,confirmationStatus:(0,E.lq)(Ft)}),Kt=Ke((0,E.YO)((0,E.me)(Ht))),Vt=He((0,E.ai)()),Yt=(0,E.NW)({accountKey:De,writableIndexes:(0,E.YO)((0,E.ai)()),readonlyIndexes:(0,E.YO)((0,E.ai)())}),Gt=(0,E.NW)({signatures:(0,E.YO)((0,E.Yj)()),message:(0,E.NW)({accountKeys:(0,E.YO)((0,E.Yj)()),header:(0,E.NW)({numRequiredSignatures:(0,E.ai)(),numReadonlySignedAccounts:(0,E.ai)(),numReadonlyUnsignedAccounts:(0,E.ai)()}),instructions:(0,E.YO)((0,E.NW)({accounts:(0,E.YO)((0,E.ai)()),data:(0,E.Yj)(),programIdIndex:(0,E.ai)()})),recentBlockhash:(0,E.Yj)(),addressTableLookups:(0,E.lq)((0,E.YO)(Yt))})}),Zt=(0,E.NW)({pubkey:De,signer:(0,E.zM)(),writable:(0,E.zM)(),source:(0,E.lq)((0,E.KC)([(0,E.eu)("transaction"),(0,E.eu)("lookupTable")]))}),Jt=(0,E.NW)({accountKeys:(0,E.YO)(Zt),signatures:(0,E.YO)((0,E.Yj)())}),Xt=(0,E.NW)({parsed:(0,E.L5)(),program:(0,E.Yj)(),programId:De}),Qt=(0,E.NW)({accounts:(0,E.YO)(De),data:(0,E.Yj)(),programId:De}),er=(0,E.KC)([Qt,Xt]),tr=(0,E.KC)([(0,E.NW)({parsed:(0,E.L5)(),program:(0,E.Yj)(),programId:(0,E.Yj)()}),(0,E.NW)({accounts:(0,E.YO)((0,E.Yj)()),data:(0,E.Yj)(),programId:(0,E.Yj)()})]),rr=(0,E.au)(er,tr,e=>"accounts"in e?(0,E.vt)(e,Qt):(0,E.vt)(e,Xt)),nr=(0,E.NW)({signatures:(0,E.YO)((0,E.Yj)()),message:(0,E.NW)({accountKeys:(0,E.YO)(Zt),instructions:(0,E.YO)(rr),recentBlockhash:(0,E.Yj)(),addressTableLookups:(0,E.lq)((0,E.me)((0,E.YO)(Yt)))})}),ir=(0,E.NW)({accountIndex:(0,E.ai)(),mint:(0,E.Yj)(),owner:(0,E.lq)((0,E.Yj)()),programId:(0,E.lq)((0,E.Yj)()),uiTokenAmount:wt}),sr=(0,E.NW)({writable:(0,E.YO)(De),readonly:(0,E.YO)(De)}),or=(0,E.NW)({err:rt,fee:(0,E.ai)(),innerInstructions:(0,E.lq)((0,E.me)((0,E.YO)((0,E.NW)({index:(0,E.ai)(),instructions:(0,E.YO)((0,E.NW)({accounts:(0,E.YO)((0,E.ai)()),data:(0,E.Yj)(),programIdIndex:(0,E.ai)()}))})))),preBalances:(0,E.YO)((0,E.ai)()),postBalances:(0,E.YO)((0,E.ai)()),logMessages:(0,E.lq)((0,E.me)((0,E.YO)((0,E.Yj)()))),preTokenBalances:(0,E.lq)((0,E.me)((0,E.YO)(ir))),postTokenBalances:(0,E.lq)((0,E.me)((0,E.YO)(ir))),loadedAddresses:(0,E.lq)(sr),computeUnitsConsumed:(0,E.lq)((0,E.ai)()),costUnits:(0,E.lq)((0,E.ai)())}),ar=(0,E.NW)({err:rt,fee:(0,E.ai)(),innerInstructions:(0,E.lq)((0,E.me)((0,E.YO)((0,E.NW)({index:(0,E.ai)(),instructions:(0,E.YO)(rr)})))),preBalances:(0,E.YO)((0,E.ai)()),postBalances:(0,E.YO)((0,E.ai)()),logMessages:(0,E.lq)((0,E.me)((0,E.YO)((0,E.Yj)()))),preTokenBalances:(0,E.lq)((0,E.me)((0,E.YO)(ir))),postTokenBalances:(0,E.lq)((0,E.me)((0,E.YO)(ir))),loadedAddresses:(0,E.lq)(sr),computeUnitsConsumed:(0,E.lq)((0,E.ai)()),costUnits:(0,E.lq)((0,E.ai)())}),cr=(0,E.KC)([(0,E.eu)(0),(0,E.eu)("legacy")]),lr=(0,E.NW)({pubkey:(0,E.Yj)(),lamports:(0,E.ai)(),postBalance:(0,E.me)((0,E.ai)()),rewardType:(0,E.me)((0,E.Yj)()),commission:(0,E.lq)((0,E.me)((0,E.ai)()))}),ur=He((0,E.me)((0,E.NW)({blockhash:(0,E.Yj)(),previousBlockhash:(0,E.Yj)(),parentSlot:(0,E.ai)(),transactions:(0,E.YO)((0,E.NW)({transaction:Gt,meta:(0,E.me)(or),version:(0,E.lq)(cr)})),rewards:(0,E.lq)((0,E.YO)(lr)),blockTime:(0,E.me)((0,E.ai)()),blockHeight:(0,E.me)((0,E.ai)())}))),hr=He((0,E.me)((0,E.NW)({blockhash:(0,E.Yj)(),previousBlockhash:(0,E.Yj)(),parentSlot:(0,E.ai)(),rewards:(0,E.lq)((0,E.YO)(lr)),blockTime:(0,E.me)((0,E.ai)()),blockHeight:(0,E.me)((0,E.ai)())}))),dr=He((0,E.me)((0,E.NW)({blockhash:(0,E.Yj)(),previousBlockhash:(0,E.Yj)(),parentSlot:(0,E.ai)(),transactions:(0,E.YO)((0,E.NW)({transaction:Jt,meta:(0,E.me)(or),version:(0,E.lq)(cr)})),rewards:(0,E.lq)((0,E.YO)(lr)),blockTime:(0,E.me)((0,E.ai)()),blockHeight:(0,E.me)((0,E.ai)())}))),pr=He((0,E.me)((0,E.NW)({blockhash:(0,E.Yj)(),previousBlockhash:(0,E.Yj)(),parentSlot:(0,E.ai)(),transactions:(0,E.YO)((0,E.NW)({transaction:nr,meta:(0,E.me)(ar),version:(0,E.lq)(cr)})),rewards:(0,E.lq)((0,E.YO)(lr)),blockTime:(0,E.me)((0,E.ai)()),blockHeight:(0,E.me)((0,E.ai)())}))),fr=He((0,E.me)((0,E.NW)({blockhash:(0,E.Yj)(),previousBlockhash:(0,E.Yj)(),parentSlot:(0,E.ai)(),transactions:(0,E.YO)((0,E.NW)({transaction:Jt,meta:(0,E.me)(ar),version:(0,E.lq)(cr)})),rewards:(0,E.lq)((0,E.YO)(lr)),blockTime:(0,E.me)((0,E.ai)()),blockHeight:(0,E.me)((0,E.ai)())}))),gr=He((0,E.me)((0,E.NW)({blockhash:(0,E.Yj)(),previousBlockhash:(0,E.Yj)(),parentSlot:(0,E.ai)(),rewards:(0,E.lq)((0,E.YO)(lr)),blockTime:(0,E.me)((0,E.ai)()),blockHeight:(0,E.me)((0,E.ai)())}))),mr=He((0,E.me)((0,E.NW)({blockhash:(0,E.Yj)(),previousBlockhash:(0,E.Yj)(),parentSlot:(0,E.ai)(),transactions:(0,E.YO)((0,E.NW)({transaction:Gt,meta:(0,E.me)(or)})),rewards:(0,E.lq)((0,E.YO)(lr)),blockTime:(0,E.me)((0,E.ai)())}))),yr=He((0,E.me)((0,E.NW)({blockhash:(0,E.Yj)(),previousBlockhash:(0,E.Yj)(),parentSlot:(0,E.ai)(),signatures:(0,E.YO)((0,E.Yj)()),blockTime:(0,E.me)((0,E.ai)())}))),wr=He((0,E.me)((0,E.NW)({slot:(0,E.ai)(),meta:(0,E.me)(or),blockTime:(0,E.lq)((0,E.me)((0,E.ai)())),transaction:Gt,version:(0,E.lq)(cr)}))),br=He((0,E.me)((0,E.NW)({slot:(0,E.ai)(),transaction:nr,meta:(0,E.me)(ar),blockTime:(0,E.lq)((0,E.me)((0,E.ai)())),version:(0,E.lq)(cr)}))),vr=Ke((0,E.NW)({blockhash:(0,E.Yj)(),lastValidBlockHeight:(0,E.ai)()})),Er=Ke((0,E.zM)()),Ar=(0,E.NW)({slot:(0,E.ai)(),numTransactions:(0,E.ai)(),numSlots:(0,E.ai)(),samplePeriodSecs:(0,E.ai)()}),_r=He((0,E.YO)(Ar)),Ir=Ke((0,E.me)((0,E.NW)({feeCalculator:(0,E.NW)({lamportsPerSignature:(0,E.ai)()})}))),Sr=He((0,E.Yj)()),Cr=He((0,E.Yj)()),kr=(0,E.NW)({err:rt,logs:(0,E.YO)((0,E.Yj)()),signature:(0,E.Yj)()}),Nr=(0,E.NW)({result:Ve(kr),subscription:(0,E.ai)()}),xr={"solana-client":"js/1.0.0-maintenance"};class Tr{constructor(e,t){let r,n,i,s,o,a;var c;this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const e={};return async t=>{const{commitment:r,config:n}=$e(t),i=this._buildArgs([],r,void 0,n),s=Te(i);return e[s]=e[s]??(async()=>{try{const e=await this._rpcRequest("getBlockHeight",i),t=(0,E.vt)(e,He((0,E.ai)()));if("error"in t)throw new fe(t.error,"failed to get block height information");return t.result}finally{delete e[s]}})(),await e[s]}})(),t&&"string"==typeof t?this._commitment=t:t&&(this._commitment=t.commitment,this._confirmTransactionInitialTimeout=t.confirmTransactionInitialTimeout,r=t.wsEndpoint,n=t.httpHeaders,i=t.fetch,s=t.fetchMiddleware,o=t.disableRetryOnRateLimit,a=t.httpAgent),this._rpcEndpoint=function(e){if(!1===/^https?:/.test(e))throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return e}(e),this._rpcWsEndpoint=r||function(e){const t=e.match(Le);if(null==t)throw TypeError(`Failed to validate endpoint URL \`${e}\``);const[r,n,i,s]=t,o=e.startsWith("https:")?"wss:":"ws:",a=null==i?null:parseInt(i.slice(1),10);return`${o}//${n}${null==a?"":`:${a+1}`}${s}`}(e),this._rpcClient=function(e,t,r,n,i,s){const o=r||Re;let a;return null!=s&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments."),n&&(a=async(e,t)=>{const r=await new Promise((r,i)=>{try{n(e,t,(e,t)=>r([e,t]))}catch(e){i(e)}});return await o(...r)}),new(_())(async(r,n)=>{const s={method:"POST",body:r,agent:void 0,headers:Object.assign({"Content-Type":"application/json"},t||{},xr)};try{let t,r=5,c=500;for(;t=a?await a(e,s):await o(e,s),429===t.status&&!0!==i&&(r-=1,0!==r);)console.error(`Server responded with ${t.status} ${t.statusText}.  Retrying after ${c}ms delay...`),await me(c),c*=2;const l=await t.text();t.ok?n(null,l):n(new Error(`${t.status} ${t.statusText}: ${l}`))}catch(e){e instanceof Error&&n(e)}},{})}(e,n,i,s,o,a),this._rpcRequest=(c=this._rpcClient,(e,t)=>new Promise((r,n)=>{c.request(e,t,(e,t)=>{e?n(e):r(t)})})),this._rpcBatchRequest=function(e){return t=>new Promise((r,n)=>{0===t.length&&r([]);const i=t.map(t=>e.request(t.methodName,t.args));e.request(i,(e,t)=>{e?n(e):r(t)})})}(this._rpcClient),this._rpcWebSocket=new Ue(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(e,t){const{commitment:r,config:n}=$e(t),i=this._buildArgs([e.toBase58()],r,void 0,n),s=await this._rpcRequest("getBalance",i),o=(0,E.vt)(s,Ke((0,E.ai)()));if("error"in o)throw new fe(o.error,`failed to get balance for ${e.toBase58()}`);return o.result}async getBalance(e,t){return await this.getBalanceAndContext(e,t).then(e=>e.value).catch(t=>{throw new Error("failed to get balance of account "+e.toBase58()+": "+t)})}async getBlockTime(e){const t=await this._rpcRequest("getBlockTime",[e]),r=(0,E.vt)(t,He((0,E.me)((0,E.ai)())));if("error"in r)throw new fe(r.error,`failed to get block time for slot ${e}`);return r.result}async getMinimumLedgerSlot(){const e=await this._rpcRequest("minimumLedgerSlot",[]),t=(0,E.vt)(e,He((0,E.ai)()));if("error"in t)throw new fe(t.error,"failed to get minimum ledger slot");return t.result}async getFirstAvailableBlock(){const e=await this._rpcRequest("getFirstAvailableBlock",[]),t=(0,E.vt)(e,mt);if("error"in t)throw new fe(t.error,"failed to get first available block");return t.result}async getSupply(e){let t={};t="string"==typeof e?{commitment:e}:e?{...e,commitment:e&&e.commitment||this.commitment}:{commitment:this.commitment};const r=await this._rpcRequest("getSupply",[t]),n=(0,E.vt)(r,yt);if("error"in n)throw new fe(n.error,"failed to get supply");return n.result}async getTokenSupply(e,t){const r=this._buildArgs([e.toBase58()],t),n=await this._rpcRequest("getTokenSupply",r),i=(0,E.vt)(n,Ke(wt));if("error"in i)throw new fe(i.error,"failed to get token supply");return i.result}async getTokenAccountBalance(e,t){const r=this._buildArgs([e.toBase58()],t),n=await this._rpcRequest("getTokenAccountBalance",r),i=(0,E.vt)(n,Ke(wt));if("error"in i)throw new fe(i.error,"failed to get token account balance");return i.result}async getTokenAccountsByOwner(e,t,r){const{commitment:n,config:i}=$e(r);let s=[e.toBase58()];"mint"in t?s.push({mint:t.mint.toBase58()}):s.push({programId:t.programId.toBase58()});const o=this._buildArgs(s,n,"base64",i),a=await this._rpcRequest("getTokenAccountsByOwner",o),c=(0,E.vt)(a,vt);if("error"in c)throw new fe(c.error,`failed to get token accounts owned by account ${e.toBase58()}`);return c.result}async getParsedTokenAccountsByOwner(e,t,r){let n=[e.toBase58()];"mint"in t?n.push({mint:t.mint.toBase58()}):n.push({programId:t.programId.toBase58()});const i=this._buildArgs(n,r,"jsonParsed"),s=await this._rpcRequest("getTokenAccountsByOwner",i),o=(0,E.vt)(s,At);if("error"in o)throw new fe(o.error,`failed to get token accounts owned by account ${e.toBase58()}`);return o.result}async getLargestAccounts(e){const t={...e,commitment:e&&e.commitment||this.commitment},r=t.filter||t.commitment?[t]:[],n=await this._rpcRequest("getLargestAccounts",r),i=(0,E.vt)(n,_t);if("error"in i)throw new fe(i.error,"failed to get largest accounts");return i.result}async getTokenLargestAccounts(e,t){const r=this._buildArgs([e.toBase58()],t),n=await this._rpcRequest("getTokenLargestAccounts",r),i=(0,E.vt)(n,bt);if("error"in i)throw new fe(i.error,"failed to get token largest accounts");return i.result}async getAccountInfoAndContext(e,t){const{commitment:r,config:n}=$e(t),i=this._buildArgs([e.toBase58()],r,"base64",n),s=await this._rpcRequest("getAccountInfo",i),o=(0,E.vt)(s,Ke((0,E.me)(It)));if("error"in o)throw new fe(o.error,`failed to get info about account ${e.toBase58()}`);return o.result}async getParsedAccountInfo(e,t){const{commitment:r,config:n}=$e(t),i=this._buildArgs([e.toBase58()],r,"jsonParsed",n),s=await this._rpcRequest("getAccountInfo",i),o=(0,E.vt)(s,Ke((0,E.me)(kt)));if("error"in o)throw new fe(o.error,`failed to get info about account ${e.toBase58()}`);return o.result}async getAccountInfo(e,t){try{return(await this.getAccountInfoAndContext(e,t)).value}catch(t){throw new Error("failed to get info about account "+e.toBase58()+": "+t)}}async getMultipleParsedAccounts(e,t){const{commitment:r,config:n}=$e(t),i=e.map(e=>e.toBase58()),s=this._buildArgs([i],r,"jsonParsed",n),o=await this._rpcRequest("getMultipleAccounts",s),a=(0,E.vt)(o,Ke((0,E.YO)((0,E.me)(kt))));if("error"in a)throw new fe(a.error,`failed to get info for accounts ${i}`);return a.result}async getMultipleAccountsInfoAndContext(e,t){const{commitment:r,config:n}=$e(t),i=e.map(e=>e.toBase58()),s=this._buildArgs([i],r,"base64",n),o=await this._rpcRequest("getMultipleAccounts",s),a=(0,E.vt)(o,Ke((0,E.YO)((0,E.me)(It))));if("error"in a)throw new fe(a.error,`failed to get info for accounts ${i}`);return a.result}async getMultipleAccountsInfo(e,t){return(await this.getMultipleAccountsInfoAndContext(e,t)).value}async getStakeActivation(e,t,r){const{commitment:n,config:i}=$e(t),s=this._buildArgs([e.toBase58()],n,void 0,{...i,epoch:null!=r?r:i?.epoch}),o=await this._rpcRequest("getStakeActivation",s),a=(0,E.vt)(o,He(xt));if("error"in a)throw new fe(a.error,`failed to get Stake Activation ${e.toBase58()}`);return a.result}async getProgramAccounts(e,t){const{commitment:r,config:n}=$e(t),{encoding:i,...s}=n||{},o=this._buildArgs([e.toBase58()],r,i||"base64",{...s,...s.filters?{filters:ze(s.filters)}:null}),a=await this._rpcRequest("getProgramAccounts",o),c=(0,E.YO)(St),l=!0===s.withContext?(0,E.vt)(a,Ke(c)):(0,E.vt)(a,He(c));if("error"in l)throw new fe(l.error,`failed to get accounts owned by program ${e.toBase58()}`);return l.result}async getParsedProgramAccounts(e,t){const{commitment:r,config:n}=$e(t),i=this._buildArgs([e.toBase58()],r,"jsonParsed",n),s=await this._rpcRequest("getProgramAccounts",i),o=(0,E.vt)(s,He((0,E.YO)(Nt)));if("error"in o)throw new fe(o.error,`failed to get accounts owned by program ${e.toBase58()}`);return o.result}async confirmTransaction(e,t){let r,n;if("string"==typeof e)r=e;else{const t=e;if(t.abortSignal?.aborted)return Promise.reject(t.abortSignal.reason);r=t.signature}try{n=c().decode(r)}catch(e){throw new Error("signature must be base58 encoded: "+r)}return Z(64===n.length,"signature has invalid length"),"string"==typeof e?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:t||this.commitment,signature:r}):"lastValidBlockHeight"in e?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t||this.commitment,strategy:e}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:t||this.commitment,strategy:e})}getCancellationPromise(e){return new Promise((t,r)=>{null!=e&&(e.aborted?r(e.reason):e.addEventListener("abort",()=>{r(e.reason)}))})}getTransactionConfirmationPromise({commitment:e,signature:t}){let r,n,i=!1;return{abortConfirmation:()=>{n&&(n(),n=void 0),null!=r&&(this.removeSignatureListener(r),r=void 0)},confirmationPromise:new Promise((s,o)=>{try{r=this.onSignature(t,(e,t)=>{r=void 0;const n={context:t,value:e};s({__type:ie.PROCESSED,response:n})},e);const a=new Promise(e=>{null==r?e():n=this._onSubscriptionStateChange(r,t=>{"subscribed"===t&&e()})});(async()=>{if(await a,i)return;const r=await this.getSignatureStatus(t);if(i)return;if(null==r)return;const{context:n,value:c}=r;if(null!=c)if(c?.err)o(c.err);else{switch(e){case"confirmed":case"single":case"singleGossip":if("processed"===c.confirmationStatus)return;break;case"finalized":case"max":case"root":if("processed"===c.confirmationStatus||"confirmed"===c.confirmationStatus)return}i=!0,s({__type:ie.PROCESSED,response:{context:n,value:c}})}})()}catch(e){o(e)}})}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e,strategy:{abortSignal:t,lastValidBlockHeight:r,signature:n}}){let i=!1;const s=new Promise(t=>{const n=async()=>{try{return await this.getBlockHeight(e)}catch(e){return-1}};(async()=>{let e=await n();if(!i){for(;e<=r;){if(await me(1e3),i)return;if(e=await n(),i)return}t({__type:ie.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:o,confirmationPromise:a}=this.getTransactionConfirmationPromise({commitment:e,signature:n}),c=this.getCancellationPromise(t);let l;try{const e=await Promise.race([c,a,s]);if(e.__type!==ie.PROCESSED)throw new j(n);l=e.response}finally{i=!0,o()}return l}async confirmTransactionUsingDurableNonceStrategy({commitment:e,strategy:{abortSignal:t,minContextSlot:r,nonceAccountPubkey:n,nonceValue:i,signature:s}}){let o=!1;const a=new Promise(t=>{let s=i,a=null;const c=async()=>{try{const{context:t,value:i}=await this.getNonceAndContext(n,{commitment:e,minContextSlot:r});return a=t.slot,i?.nonce}catch(e){return s}};(async()=>{if(s=await c(),!o)for(;;){if(i!==s)return void t({__type:ie.NONCE_INVALID,slotInWhichNonceDidAdvance:a});if(await me(2e3),o)return;if(s=await c(),o)return}})()}),{abortConfirmation:c,confirmationPromise:l}=this.getTransactionConfirmationPromise({commitment:e,signature:s}),u=this.getCancellationPromise(t);let h;try{const t=await Promise.race([u,l,a]);if(t.__type===ie.PROCESSED)h=t.response;else{let n;for(;;){const e=await this.getSignatureStatus(s);if(null==e)break;if(!(e.context.slot<(t.slotInWhichNonceDidAdvance??r))){n=e;break}await me(400)}if(!n?.value)throw new z(s);{const t=e||"finalized",{confirmationStatus:r}=n.value;switch(t){case"processed":case"recent":if("processed"!==r&&"confirmed"!==r&&"finalized"!==r)throw new z(s);break;case"confirmed":case"single":case"singleGossip":if("confirmed"!==r&&"finalized"!==r)throw new z(s);break;case"finalized":case"max":case"root":if("finalized"!==r)throw new z(s)}h={context:n.context,value:{err:n.value.err}}}}}finally{o=!0,c()}return h}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:e,signature:t}){let r;const n=new Promise(t=>{let n=this._confirmTransactionInitialTimeout||6e4;switch(e){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":n=this._confirmTransactionInitialTimeout||3e4}r=setTimeout(()=>t({__type:ie.TIMED_OUT,timeoutMs:n}),n)}),{abortConfirmation:i,confirmationPromise:s}=this.getTransactionConfirmationPromise({commitment:e,signature:t});let o;try{const e=await Promise.race([s,n]);if(e.__type!==ie.PROCESSED)throw new $(t,e.timeoutMs/1e3);o=e.response}finally{clearTimeout(r),i()}return o}async getClusterNodes(){const e=await this._rpcRequest("getClusterNodes",[]),t=(0,E.vt)(e,He((0,E.YO)($t)));if("error"in t)throw new fe(t.error,"failed to get cluster nodes");return t.result}async getVoteAccounts(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getVoteAccounts",t),n=(0,E.vt)(r,qt);if("error"in n)throw new fe(n.error,"failed to get vote accounts");return n.result}async getSlot(e){const{commitment:t,config:r}=$e(e),n=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getSlot",n),s=(0,E.vt)(i,He((0,E.ai)()));if("error"in s)throw new fe(s.error,"failed to get slot");return s.result}async getSlotLeader(e){const{commitment:t,config:r}=$e(e),n=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getSlotLeader",n),s=(0,E.vt)(i,He((0,E.Yj)()));if("error"in s)throw new fe(s.error,"failed to get slot leader");return s.result}async getSlotLeaders(e,t){const r=[e,t],n=await this._rpcRequest("getSlotLeaders",r),i=(0,E.vt)(n,He((0,E.YO)(De)));if("error"in i)throw new fe(i.error,"failed to get slot leaders");return i.result}async getSignatureStatus(e,t){const{context:r,value:n}=await this.getSignatureStatuses([e],t);return Z(1===n.length),{context:r,value:n[0]}}async getSignatureStatuses(e,t){const r=[e];t&&r.push(t);const n=await this._rpcRequest("getSignatureStatuses",r),i=(0,E.vt)(n,Kt);if("error"in i)throw new fe(i.error,"failed to get signature status");return i.result}async getTransactionCount(e){const{commitment:t,config:r}=$e(e),n=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getTransactionCount",n),s=(0,E.vt)(i,He((0,E.ai)()));if("error"in s)throw new fe(s.error,"failed to get transaction count");return s.result}async getTotalSupply(e){return(await this.getSupply({commitment:e,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getInflationGovernor",t),n=(0,E.vt)(r,ut);if("error"in n)throw new fe(n.error,"failed to get inflation");return n.result}async getInflationReward(e,t,r){const{commitment:n,config:i}=$e(r),s=this._buildArgs([e.map(e=>e.toBase58())],n,void 0,{...i,epoch:null!=t?t:i?.epoch}),o=await this._rpcRequest("getInflationReward",s),a=(0,E.vt)(o,Ze);if("error"in a)throw new fe(a.error,"failed to get inflation reward");return a.result}async getInflationRate(){const e=await this._rpcRequest("getInflationRate",[]),t=(0,E.vt)(e,ht);if("error"in t)throw new fe(t.error,"failed to get inflation rate");return t.result}async getEpochInfo(e){const{commitment:t,config:r}=$e(e),n=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getEpochInfo",n),s=(0,E.vt)(i,pt);if("error"in s)throw new fe(s.error,"failed to get epoch info");return s.result}async getEpochSchedule(){const e=await this._rpcRequest("getEpochSchedule",[]),t=(0,E.vt)(e,ft);if("error"in t)throw new fe(t.error,"failed to get epoch schedule");const r=t.result;return new Pe(r.slotsPerEpoch,r.leaderScheduleSlotOffset,r.warmup,r.firstNormalEpoch,r.firstNormalSlot)}async getLeaderSchedule(){const e=await this._rpcRequest("getLeaderSchedule",[]),t=(0,E.vt)(e,gt);if("error"in t)throw new fe(t.error,"failed to get leader schedule");return t.result}async getMinimumBalanceForRentExemption(e,t){const r=this._buildArgs([e],t),n=await this._rpcRequest("getMinimumBalanceForRentExemption",r),i=(0,E.vt)(n,Vt);return"error"in i?(console.warn("Unable to fetch minimum balance for rent exemption"),0):i.result}async getRecentBlockhashAndContext(e){const{context:t,value:{blockhash:r}}=await this.getLatestBlockhashAndContext(e);return{context:t,value:{blockhash:r,feeCalculator:{get lamportsPerSignature(){throw new Error("The capability to fetch `lamportsPerSignature` using the `getRecentBlockhash` API is no longer offered by the network. Use the `getFeeForMessage` API to obtain the fee for a given message.")},toJSON:()=>({})}}}}async getRecentPerformanceSamples(e){const t=await this._rpcRequest("getRecentPerformanceSamples",e?[e]:[]),r=(0,E.vt)(t,_r);if("error"in r)throw new fe(r.error,"failed to get recent performance samples");return r.result}async getFeeCalculatorForBlockhash(e,t){const r=this._buildArgs([e],t),n=await this._rpcRequest("getFeeCalculatorForBlockhash",r),i=(0,E.vt)(n,Ir);if("error"in i)throw new fe(i.error,"failed to get fee calculator");const{context:s,value:o}=i.result;return{context:s,value:null!==o?o.feeCalculator:null}}async getFeeForMessage(e,t){const r=P(e.serialize()).toString("base64"),n=this._buildArgs([r],t),i=await this._rpcRequest("getFeeForMessage",n),s=(0,E.vt)(i,Ke((0,E.me)((0,E.ai)())));if("error"in s)throw new fe(s.error,"failed to get fee for message");if(null===s.result)throw new Error("invalid blockhash");return s.result}async getRecentPrioritizationFees(e){const t=e?.lockedWritableAccounts?.map(e=>e.toBase58()),r=t?.length?[t]:[],n=await this._rpcRequest("getRecentPrioritizationFees",r),i=(0,E.vt)(n,dt);if("error"in i)throw new fe(i.error,"failed to get recent prioritization fees");return i.result}async getRecentBlockhash(e){try{return(await this.getRecentBlockhashAndContext(e)).value}catch(e){throw new Error("failed to get recent blockhash: "+e)}}async getLatestBlockhash(e){try{return(await this.getLatestBlockhashAndContext(e)).value}catch(e){throw new Error("failed to get recent blockhash: "+e)}}async getLatestBlockhashAndContext(e){const{commitment:t,config:r}=$e(e),n=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getLatestBlockhash",n),s=(0,E.vt)(i,vr);if("error"in s)throw new fe(s.error,"failed to get latest blockhash");return s.result}async isBlockhashValid(e,t){const{commitment:r,config:n}=$e(t),i=this._buildArgs([e],r,void 0,n),s=await this._rpcRequest("isBlockhashValid",i),o=(0,E.vt)(s,Er);if("error"in o)throw new fe(o.error,"failed to determine if the blockhash `"+e+"`is valid");return o.result}async getVersion(){const e=await this._rpcRequest("getVersion",[]),t=(0,E.vt)(e,He(st));if("error"in t)throw new fe(t.error,"failed to get version");return t.result}async getGenesisHash(){const e=await this._rpcRequest("getGenesisHash",[]),t=(0,E.vt)(e,He((0,E.Yj)()));if("error"in t)throw new fe(t.error,"failed to get genesis hash");return t.result}async getBlock(e,t){const{commitment:r,config:n}=$e(t),i=this._buildArgsAtLeastConfirmed([e],r,void 0,n),s=await this._rpcRequest("getBlock",i);try{switch(n?.transactionDetails){case"accounts":{const e=(0,E.vt)(s,dr);if("error"in e)throw e.error;return e.result}case"none":{const e=(0,E.vt)(s,hr);if("error"in e)throw e.error;return e.result}default:{const e=(0,E.vt)(s,ur);if("error"in e)throw e.error;const{result:t}=e;return t?{...t,transactions:t.transactions.map(({transaction:e,meta:t,version:r})=>({meta:t,transaction:{...e,message:Ye(r,e.message)},version:r}))}:null}}}catch(e){throw new fe(e,"failed to get confirmed block")}}async getParsedBlock(e,t){const{commitment:r,config:n}=$e(t),i=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",n),s=await this._rpcRequest("getBlock",i);try{switch(n?.transactionDetails){case"accounts":{const e=(0,E.vt)(s,fr);if("error"in e)throw e.error;return e.result}case"none":{const e=(0,E.vt)(s,gr);if("error"in e)throw e.error;return e.result}default:{const e=(0,E.vt)(s,pr);if("error"in e)throw e.error;return e.result}}}catch(e){throw new fe(e,"failed to get block")}}async getBlockProduction(e){let t,r;if("string"==typeof e)r=e;else if(e){const{commitment:n,...i}=e;r=n,t=i}const n=this._buildArgs([],r,"base64",t),i=await this._rpcRequest("getBlockProduction",n),s=(0,E.vt)(i,lt);if("error"in s)throw new fe(s.error,"failed to get block production information");return s.result}async getTransaction(e,t){const{commitment:r,config:n}=$e(t),i=this._buildArgsAtLeastConfirmed([e],r,void 0,n),s=await this._rpcRequest("getTransaction",i),o=(0,E.vt)(s,wr);if("error"in o)throw new fe(o.error,"failed to get transaction");const a=o.result;return a?{...a,transaction:{...a.transaction,message:Ye(a.version,a.transaction.message)}}:a}async getParsedTransaction(e,t){const{commitment:r,config:n}=$e(t),i=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",n),s=await this._rpcRequest("getTransaction",i),o=(0,E.vt)(s,br);if("error"in o)throw new fe(o.error,"failed to get transaction");return o.result}async getParsedTransactions(e,t){const{commitment:r,config:n}=$e(t),i=e.map(e=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",n)}));return(await this._rpcBatchRequest(i)).map(e=>{const t=(0,E.vt)(e,br);if("error"in t)throw new fe(t.error,"failed to get transactions");return t.result})}async getTransactions(e,t){const{commitment:r,config:n}=$e(t),i=e.map(e=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([e],r,void 0,n)}));return(await this._rpcBatchRequest(i)).map(e=>{const t=(0,E.vt)(e,wr);if("error"in t)throw new fe(t.error,"failed to get transactions");const r=t.result;return r?{...r,transaction:{...r.transaction,message:Ye(r.version,r.transaction.message)}}:r})}async getConfirmedBlock(e,t){const r=this._buildArgsAtLeastConfirmed([e],t),n=await this._rpcRequest("getBlock",r),i=(0,E.vt)(n,mr);if("error"in i)throw new fe(i.error,"failed to get confirmed block");const s=i.result;if(!s)throw new Error("Confirmed block "+e+" not found");const o={...s,transactions:s.transactions.map(({transaction:e,meta:t})=>{const r=new te(e.message);return{meta:t,transaction:{...e,message:r}}})};return{...o,transactions:o.transactions.map(({transaction:e,meta:t})=>({meta:t,transaction:ae.populate(e.message,e.signatures)}))}}async getBlocks(e,t,r){const n=this._buildArgsAtLeastConfirmed(void 0!==t?[e,t]:[e],r),i=await this._rpcRequest("getBlocks",n),s=(0,E.vt)(i,He((0,E.YO)((0,E.ai)())));if("error"in s)throw new fe(s.error,"failed to get blocks");return s.result}async getBlockSignatures(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),n=await this._rpcRequest("getBlock",r),i=(0,E.vt)(n,yr);if("error"in i)throw new fe(i.error,"failed to get block");const s=i.result;if(!s)throw new Error("Block "+e+" not found");return s}async getConfirmedBlockSignatures(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),n=await this._rpcRequest("getBlock",r),i=(0,E.vt)(n,yr);if("error"in i)throw new fe(i.error,"failed to get confirmed block");const s=i.result;if(!s)throw new Error("Confirmed block "+e+" not found");return s}async getConfirmedTransaction(e,t){const r=this._buildArgsAtLeastConfirmed([e],t),n=await this._rpcRequest("getTransaction",r),i=(0,E.vt)(n,wr);if("error"in i)throw new fe(i.error,"failed to get transaction");const s=i.result;if(!s)return s;const o=new te(s.transaction.message),a=s.transaction.signatures;return{...s,transaction:ae.populate(o,a)}}async getParsedConfirmedTransaction(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,"jsonParsed"),n=await this._rpcRequest("getTransaction",r),i=(0,E.vt)(n,br);if("error"in i)throw new fe(i.error,"failed to get confirmed transaction");return i.result}async getParsedConfirmedTransactions(e,t){const r=e.map(e=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([e],t,"jsonParsed")}));return(await this._rpcBatchRequest(r)).map(e=>{const t=(0,E.vt)(e,br);if("error"in t)throw new fe(t.error,"failed to get confirmed transactions");return t.result})}async getConfirmedSignaturesForAddress(e,t,r){let n={},i=await this.getFirstAvailableBlock();for(;!("until"in n)&&!(--t<=0||t<i);)try{const e=await this.getConfirmedBlockSignatures(t,"finalized");e.signatures.length>0&&(n.until=e.signatures[e.signatures.length-1].toString())}catch(e){if(e instanceof Error&&e.message.includes("skipped"))continue;throw e}let s=await this.getSlot("finalized");for(;!("before"in n||++r>s);)try{const e=await this.getConfirmedBlockSignatures(r);e.signatures.length>0&&(n.before=e.signatures[e.signatures.length-1].toString())}catch(e){if(e instanceof Error&&e.message.includes("skipped"))continue;throw e}return(await this.getConfirmedSignaturesForAddress2(e,n)).map(e=>e.signature)}async getConfirmedSignaturesForAddress2(e,t,r){const n=this._buildArgsAtLeastConfirmed([e.toBase58()],r,void 0,t),i=await this._rpcRequest("getConfirmedSignaturesForAddress2",n),s=(0,E.vt)(i,Tt);if("error"in s)throw new fe(s.error,"failed to get confirmed signatures for address");return s.result}async getSignaturesForAddress(e,t,r){const n=this._buildArgsAtLeastConfirmed([e.toBase58()],r,void 0,t),i=await this._rpcRequest("getSignaturesForAddress",n),s=(0,E.vt)(i,Ot);if("error"in s)throw new fe(s.error,"failed to get signatures for address");return s.result}async getAddressLookupTable(e,t){const{context:r,value:n}=await this.getAccountInfoAndContext(e,t);let i=null;return null!==n&&(i=new Be({key:e,state:Be.deserialize(n.data)})),{context:r,value:i}}async getNonceAndContext(e,t){const{context:r,value:n}=await this.getAccountInfoAndContext(e,t);let i=null;return null!==n&&(i=Ee.fromAccountData(n.data)),{context:r,value:i}}async getNonce(e,t){return await this.getNonceAndContext(e,t).then(e=>e.value).catch(t=>{throw new Error("failed to get nonce for account "+e.toBase58()+": "+t)})}async requestAirdrop(e,t){const r=await this._rpcRequest("requestAirdrop",[e.toBase58(),t]),n=(0,E.vt)(r,Sr);if("error"in n)throw new fe(n.error,`airdrop to ${e.toBase58()} failed`);return n.result}async _blockhashWithExpiryBlockHeight(e){if(!e){for(;this._pollingBlockhash;)await me(100);const e=Date.now()-this._blockhashInfo.lastFetch>=3e4;if(null!==this._blockhashInfo.latestBlockhash&&!e)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const e=Date.now(),t=this._blockhashInfo.latestBlockhash,r=t?t.blockhash:null;for(let e=0;e<50;e++){const e=await this.getLatestBlockhash("finalized");if(r!==e.blockhash)return this._blockhashInfo={latestBlockhash:e,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},e;await me(200)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-e}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(e){const{commitment:t,config:r}=$e(e),n=this._buildArgs([],t,"base64",r),i=await this._rpcRequest("getStakeMinimumDelegation",n),s=(0,E.vt)(i,Ke((0,E.ai)()));if("error"in s)throw new fe(s.error,"failed to get stake minimum delegation");return s.result}async simulateTransaction(e,t,r){if("message"in e){const i=e.serialize(),s=n.Buffer.from(i).toString("base64");if(Array.isArray(t)||void 0!==r)throw new Error("Invalid arguments");const o=t||{};o.encoding="base64","commitment"in o||(o.commitment=this.commitment),t&&"object"==typeof t&&"innerInstructions"in t&&(o.innerInstructions=t.innerInstructions);const a=[s,o],c=await this._rpcRequest("simulateTransaction",a),l=(0,E.vt)(c,ct);if("error"in l)throw new Error("failed to simulate transaction: "+l.error.message);return l.result}let i;if(e instanceof ae){let t=e;i=new ae,i.feePayer=t.feePayer,i.instructions=e.instructions,i.nonceInfo=t.nonceInfo,i.signatures=t.signatures}else i=ae.populate(e),i._message=i._json=void 0;if(void 0!==t&&!Array.isArray(t))throw new Error("Invalid arguments");const s=t;if(i.nonceInfo&&s)i.sign(...s);else{let e=this._disableBlockhashCaching;for(;;){const t=await this._blockhashWithExpiryBlockHeight(e);if(i.lastValidBlockHeight=t.lastValidBlockHeight,i.recentBlockhash=t.blockhash,!s)break;if(i.sign(...s),!i.signature)throw new Error("!signature");const r=i.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(r)&&!this._blockhashInfo.transactionSignatures.includes(r)){this._blockhashInfo.simulatedSignatures.push(r);break}e=!0}}const o=i._compile(),a=o.serialize(),c=i._serialize(a).toString("base64"),l={encoding:"base64",commitment:this.commitment};if(r){const e=(Array.isArray(r)?r:o.nonProgramIds()).map(e=>e.toBase58());l.accounts={encoding:"base64",addresses:e}}s&&(l.sigVerify=!0),t&&"object"==typeof t&&"innerInstructions"in t&&(l.innerInstructions=t.innerInstructions);const u=[c,l],h=await this._rpcRequest("simulateTransaction",u),d=(0,E.vt)(h,ct);if("error"in d){let e;if("data"in d.error&&(e=d.error.data.logs,e&&Array.isArray(e))){const t="\n    ",r=t+e.join(t);console.error(d.error.message,r)}throw new pe({action:"simulate",signature:"",transactionMessage:d.error.message,logs:e})}return d.result}async sendTransaction(e,t,r){if("version"in e){if(t&&Array.isArray(t))throw new Error("Invalid arguments");const r=e.serialize();return await this.sendRawTransaction(r,t)}if(void 0===t||!Array.isArray(t))throw new Error("Invalid arguments");const n=t;if(e.nonceInfo)e.sign(...n);else{let t=this._disableBlockhashCaching;for(;;){const r=await this._blockhashWithExpiryBlockHeight(t);if(e.lastValidBlockHeight=r.lastValidBlockHeight,e.recentBlockhash=r.blockhash,e.sign(...n),!e.signature)throw new Error("!signature");const i=e.signature.toString("base64");if(!this._blockhashInfo.transactionSignatures.includes(i)){this._blockhashInfo.transactionSignatures.push(i);break}t=!0}}const i=e.serialize();return await this.sendRawTransaction(i,r)}async sendRawTransaction(e,t){const r=P(e).toString("base64");return await this.sendEncodedTransaction(r,t)}async sendEncodedTransaction(e,t){const r={encoding:"base64"},n=t&&t.skipPreflight,i=!0===n?"processed":t&&t.preflightCommitment||this.commitment;t&&null!=t.maxRetries&&(r.maxRetries=t.maxRetries),t&&null!=t.minContextSlot&&(r.minContextSlot=t.minContextSlot),n&&(r.skipPreflight=n),i&&(r.preflightCommitment=i);const s=[e,r],o=await this._rpcRequest("sendTransaction",s),a=(0,E.vt)(o,Cr);if("error"in a){let e;throw"data"in a.error&&(e=a.error.data.logs),new pe({action:n?"send":"simulate",signature:"",transactionMessage:a.error.message,logs:e})}return a.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}_wsOnClose(e){this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),1e3!==e?(this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([e,t])=>{this._setSubscription(e,{...t,state:"pending"})})):this._updateSubscriptions()}_setSubscription(e,t){const r=this._subscriptionsByHash[e]?.state;if(this._subscriptionsByHash[e]=t,r!==t.state){const r=this._subscriptionStateChangeCallbacksByHash[e];r&&r.forEach(e=>{try{e(t.state)}catch{}})}}_onSubscriptionStateChange(e,t){const r=this._subscriptionHashByClientSubscriptionId[e];if(null==r)return()=>{};const n=this._subscriptionStateChangeCallbacksByHash[r]||=new Set;return n.add(t),()=>{n.delete(t),0===n.size&&delete this._subscriptionStateChangeCallbacksByHash[r]}}async _updateSubscriptions(){if(0===Object.keys(this._subscriptionsByHash).length)return void(this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(e){e instanceof Error&&console.log(`Error when closing socket connection: ${e.message}`)}},500)));if(null!==this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected)return void this._rpcWebSocket.connect();const e=this._rpcWebSocketGeneration,t=()=>e===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async e=>{const r=this._subscriptionsByHash[e];if(void 0!==r)switch(r.state){case"pending":case"unsubscribed":if(0===r.callbacks.size)return delete this._subscriptionsByHash[e],"unsubscribed"===r.state&&delete this._subscriptionCallbacksByServerSubscriptionId[r.serverSubscriptionId],void await this._updateSubscriptions();await(async()=>{const{args:n,method:i}=r;try{this._setSubscription(e,{...r,state:"subscribing"});const t=await this._rpcWebSocket.call(i,n);this._setSubscription(e,{...r,serverSubscriptionId:t,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[t]=r.callbacks,await this._updateSubscriptions()}catch(s){if(console.error(`Received ${s instanceof Error?"":"JSON-RPC "}error calling \`${i}\``,{args:n,error:s}),!t())return;this._setSubscription(e,{...r,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":0===r.callbacks.size&&await(async()=>{const{serverSubscriptionId:n,unsubscribeMethod:i}=r;if(this._subscriptionsAutoDisposedByRpc.has(n))this._subscriptionsAutoDisposedByRpc.delete(n);else{this._setSubscription(e,{...r,state:"unsubscribing"}),this._setSubscription(e,{...r,state:"unsubscribing"});try{await this._rpcWebSocket.call(i,[n])}catch(n){if(n instanceof Error&&console.error(`${i} error:`,n.message),!t())return;return this._setSubscription(e,{...r,state:"subscribed"}),void await this._updateSubscriptions()}}this._setSubscription(e,{...r,state:"unsubscribed"}),await this._updateSubscriptions()})()}}))}_handleServerNotification(e,t){const r=this._subscriptionCallbacksByServerSubscriptionId[e];void 0!==r&&r.forEach(e=>{try{e(...t)}catch(e){console.error(e)}})}_wsOnAccountNotification(e){const{result:t,subscription:r}=(0,E.vt)(e,Pt);this._handleServerNotification(r,[t.value,t.context])}_makeSubscription(e,t){const r=this._nextClientSubscriptionId++,n=Te([e.method,t]),i=this._subscriptionsByHash[n];return void 0===i?this._subscriptionsByHash[n]={...e,args:t,callbacks:new Set([e.callback]),state:"pending"}:i.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[r]=n,this._subscriptionDisposeFunctionsByClientSubscriptionId[r]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[r],delete this._subscriptionHashByClientSubscriptionId[r];const t=this._subscriptionsByHash[n];Z(void 0!==t,`Could not find a \`Subscription\` when tearing down client subscription #${r}`),t.callbacks.delete(e.callback),await this._updateSubscriptions()},this._updateSubscriptions(),r}onAccountChange(e,t,r){const{commitment:n,config:i}=$e(r),s=this._buildArgs([e.toBase58()],n||this._commitment||"finalized","base64",i);return this._makeSubscription({callback:t,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},s)}async removeAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"account change")}_wsOnProgramAccountNotification(e){const{result:t,subscription:r}=(0,E.vt)(e,Ut);this._handleServerNotification(r,[{accountId:t.value.pubkey,accountInfo:t.value.account},t.context])}onProgramAccountChange(e,t,r,n){const{commitment:i,config:s}=$e(r),o=this._buildArgs([e.toBase58()],i||this._commitment||"finalized","base64",s||(n?{filters:ze(n)}:void 0));return this._makeSubscription({callback:t,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},o)}async removeProgramAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"program account change")}onLogs(e,t,r){const n=this._buildArgs(["object"==typeof e?{mentions:[e.toString()]}:e],r||this._commitment||"finalized");return this._makeSubscription({callback:t,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},n)}async removeOnLogsListener(e){await this._unsubscribeClientSubscription(e,"logs")}_wsOnLogsNotification(e){const{result:t,subscription:r}=(0,E.vt)(e,Nr);this._handleServerNotification(r,[t.value,t.context])}_wsOnSlotNotification(e){const{result:t,subscription:r}=(0,E.vt)(e,Mt);this._handleServerNotification(r,[t])}onSlotChange(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(e){await this._unsubscribeClientSubscription(e,"slot change")}_wsOnSlotUpdatesNotification(e){const{result:t,subscription:r}=(0,E.vt)(e,Dt);this._handleServerNotification(r,[t])}onSlotUpdate(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(e){await this._unsubscribeClientSubscription(e,"slot update")}async _unsubscribeClientSubscription(e,t){const r=this._subscriptionDisposeFunctionsByClientSubscriptionId[e];r?await r():console.warn(`Ignored unsubscribe request because an active subscription with id \`${e}\` for '${t}' events could not be found.`)}_buildArgs(e,t,r,n){const i=t||this._commitment;if(i||r||n){let t={};r&&(t.encoding=r),i&&(t.commitment=i),n&&(t=Object.assign(t,n)),e.push(t)}return e}_buildArgsAtLeastConfirmed(e,t,r,n){const i=t||this._commitment;if(i&&!["confirmed","finalized"].includes(i))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,t,r,n)}_wsOnSignatureNotification(e){const{result:t,subscription:r}=(0,E.vt)(e,Wt);"receivedSignature"!==t.value&&this._subscriptionsAutoDisposedByRpc.add(r),this._handleServerNotification(r,"receivedSignature"===t.value?[{type:"received"},t.context]:[{type:"status",result:t.value},t.context])}onSignature(e,t,r){const n=this._buildArgs([e],r||this._commitment||"finalized"),i=this._makeSubscription({callback:(e,r)=>{if("status"===e.type){t(e.result,r);try{this.removeSignatureListener(i)}catch(e){}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},n);return i}onSignatureWithOptions(e,t,r){const{commitment:n,...i}={...r,commitment:r&&r.commitment||this._commitment||"finalized"},s=this._buildArgs([e],n,void 0,i),o=this._makeSubscription({callback:(e,r)=>{t(e,r);try{this.removeSignatureListener(o)}catch(e){}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},s);return o}async removeSignatureListener(e){await this._unsubscribeClientSubscription(e,"signature result")}_wsOnRootNotification(e){const{result:t,subscription:r}=(0,E.vt)(e,jt);this._handleServerNotification(r,[t])}onRootChange(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(e){await this._unsubscribeClientSubscription(e,"root change")}}class Or{constructor(e){this._keypair=void 0,this._keypair=e??k()}static generate(){return new Or(k())}static fromSecretKey(e,t){if(64!==e.byteLength)throw new Error("bad secret key size");const r=e.slice(32,64);if(!t||!t.skipValidation){const t=e.slice(0,32),n=N(t);for(let e=0;e<32;e++)if(r[e]!==n[e])throw new Error("provided secretKey is invalid")}return new Or({publicKey:r,secretKey:e})}static fromSeed(e){const t=N(e),r=new Uint8Array(64);return r.set(e),r.set(t,32),new Or({publicKey:t,secretKey:r})}get publicKey(){return new D(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}Object.freeze({CreateLookupTable:{index:0,layout:h.w3([h.DH("instruction"),Ae("recentSlot"),h.u8("bumpSeed")])},FreezeLookupTable:{index:1,layout:h.w3([h.DH("instruction")])},ExtendLookupTable:{index:2,layout:h.w3([h.DH("instruction"),Ae(),h.O6(F(),h.cY(h.DH(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:h.w3([h.DH("instruction")])},CloseLookupTable:{index:4,layout:h.w3([h.DH("instruction")])}});new D("AddressLookupTab1e1111111111111111111111111");Object.freeze({RequestUnits:{index:0,layout:h.w3([h.u8("instruction"),h.DH("units"),h.DH("additionalFee")])},RequestHeapFrame:{index:1,layout:h.w3([h.u8("instruction"),h.DH("bytes")])},SetComputeUnitLimit:{index:2,layout:h.w3([h.u8("instruction"),h.DH("units")])},SetComputeUnitPrice:{index:3,layout:h.w3([h.u8("instruction"),Ae("microLamports")])}});new D("ComputeBudget111111111111111111111111111111");const Pr=h.w3([h.u8("numSignatures"),h.u8("padding"),h.NX("signatureOffset"),h.NX("signatureInstructionIndex"),h.NX("publicKeyOffset"),h.NX("publicKeyInstructionIndex"),h.NX("messageDataOffset"),h.NX("messageDataSize"),h.NX("messageInstructionIndex")]);class Rr{constructor(){}static createInstructionWithPublicKey(e){const{publicKey:t,message:r,signature:i,instructionIndex:s}=e;Z(32===t.length,`Public Key must be 32 bytes but received ${t.length} bytes`),Z(64===i.length,`Signature must be 64 bytes but received ${i.length} bytes`);const o=Pr.span,a=o+t.length,c=a+i.length,l=n.Buffer.alloc(c+r.length),u=null==s?65535:s;return Pr.encode({numSignatures:1,padding:0,signatureOffset:a,signatureInstructionIndex:u,publicKeyOffset:o,publicKeyInstructionIndex:u,messageDataOffset:c,messageDataSize:r.length,messageInstructionIndex:u},l),l.fill(t,o),l.fill(i,a),l.fill(r,c),new oe({keys:[],programId:Rr.programId,data:l})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:r,instructionIndex:n}=e;Z(64===t.length,`Private key must be 64 bytes but received ${t.length} bytes`);try{const e=Or.fromSecretKey(t),i=e.publicKey.toBytes(),s=T(r,e.secretKey);return this.createInstructionWithPublicKey({publicKey:i,message:r,signature:s,instructionIndex:n})}catch(e){throw new Error(`Error creating instruction; ${e}`)}}}Rr.programId=new D("Ed25519SigVerify111111111111111111111111111"),C.bI.utils.isValidPrivateKey;const Ur=C.bI.getPublicKey,Br=h.w3([h.u8("numSignatures"),h.NX("signatureOffset"),h.u8("signatureInstructionIndex"),h.NX("ethAddressOffset"),h.u8("ethAddressInstructionIndex"),h.NX("messageDataOffset"),h.NX("messageDataSize"),h.u8("messageInstructionIndex"),h.av(20,"ethAddress"),h.av(64,"signature"),h.u8("recoveryId")]);class Mr{constructor(){}static publicKeyToEthAddress(e){Z(64===e.length,`Public key must be 64 bytes but received ${e.length} bytes`);try{return n.Buffer.from((0,S.lY)(P(e))).slice(-20)}catch(e){throw new Error(`Error constructing Ethereum address: ${e}`)}}static createInstructionWithPublicKey(e){const{publicKey:t,message:r,signature:n,recoveryId:i,instructionIndex:s}=e;return Mr.createInstructionWithEthAddress({ethAddress:Mr.publicKeyToEthAddress(t),message:r,signature:n,recoveryId:i,instructionIndex:s})}static createInstructionWithEthAddress(e){const{ethAddress:t,message:r,signature:i,recoveryId:s,instructionIndex:o=0}=e;let a;a="string"==typeof t?t.startsWith("0x")?n.Buffer.from(t.substr(2),"hex"):n.Buffer.from(t,"hex"):t,Z(20===a.length,`Address must be 20 bytes but received ${a.length} bytes`);const c=12+a.length,l=c+i.length+1,u=n.Buffer.alloc(Br.span+r.length);return Br.encode({numSignatures:1,signatureOffset:c,signatureInstructionIndex:o,ethAddressOffset:12,ethAddressInstructionIndex:o,messageDataOffset:l,messageDataSize:r.length,messageInstructionIndex:o,signature:P(i),ethAddress:P(a),recoveryId:s},u),u.fill(P(r),Br.span),new oe({keys:[],programId:Mr.programId,data:u})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:r,instructionIndex:i}=e;Z(32===t.length,`Private key must be 32 bytes but received ${t.length} bytes`);try{const e=P(t),s=Ur(e,!1).slice(1),o=n.Buffer.from((0,S.lY)(P(r))),[a,c]=((e,t)=>{const r=C.bI.sign(e,t);return[r.toCompactRawBytes(),r.recovery]})(o,e);return this.createInstructionWithPublicKey({publicKey:s,message:r,signature:a,recoveryId:c,instructionIndex:i})}catch(e){throw new Error(`Error creating instruction; ${e}`)}}}var Lr;Mr.programId=new D("KeccakSecp256k11111111111111111111111111111");const Dr=new D("StakeConfig11111111111111111111111111111111");class Wr{constructor(e,t,r){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=r}}Lr=Wr,Wr.default=new Lr(0,0,D.default);const jr=Object.freeze({Initialize:{index:0,layout:h.w3([h.DH("instruction"),((e="authorized")=>h.w3([F("staker"),F("withdrawer")],e))(),((e="lockup")=>h.w3([h.Wg("unixTimestamp"),h.Wg("epoch"),F("custodian")],e))()])},Authorize:{index:1,layout:h.w3([h.DH("instruction"),F("newAuthorized"),h.DH("stakeAuthorizationType")])},Delegate:{index:2,layout:h.w3([h.DH("instruction")])},Split:{index:3,layout:h.w3([h.DH("instruction"),h.Wg("lamports")])},Withdraw:{index:4,layout:h.w3([h.DH("instruction"),h.Wg("lamports")])},Deactivate:{index:5,layout:h.w3([h.DH("instruction")])},Merge:{index:7,layout:h.w3([h.DH("instruction")])},AuthorizeWithSeed:{index:8,layout:h.w3([h.DH("instruction"),F("newAuthorized"),h.DH("stakeAuthorizationType"),K("authoritySeed"),F("authorityOwner")])}});Object.freeze({Staker:{index:0},Withdrawer:{index:1}});class $r{constructor(){}static initialize(e){const{stakePubkey:t,authorized:r,lockup:n}=e,i=n||Wr.default,s=ye(jr.Initialize,{authorized:{staker:P(r.staker.toBuffer()),withdrawer:P(r.withdrawer.toBuffer())},lockup:{unixTimestamp:i.unixTimestamp,epoch:i.epoch,custodian:P(i.custodian.toBuffer())}}),o={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:he,isSigner:!1,isWritable:!1}],programId:this.programId,data:s};return new oe(o)}static createAccountWithSeed(e){const t=new ae;t.add(Ie.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:r,authorized:n,lockup:i}=e;return t.add(this.initialize({stakePubkey:r,authorized:n,lockup:i}))}static createAccount(e){const t=new ae;t.add(Ie.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:r,authorized:n,lockup:i}=e;return t.add(this.initialize({stakePubkey:r,authorized:n,lockup:i}))}static delegate(e){const{stakePubkey:t,authorizedPubkey:r,votePubkey:n}=e,i=ye(jr.Delegate);return(new ae).add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:le,isSigner:!1,isWritable:!1},{pubkey:de,isSigner:!1,isWritable:!1},{pubkey:Dr,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:i})}static authorize(e){const{stakePubkey:t,authorizedPubkey:r,newAuthorizedPubkey:n,stakeAuthorizationType:i,custodianPubkey:s}=e,o=ye(jr.Authorize,{newAuthorized:P(n.toBuffer()),stakeAuthorizationType:i.index}),a=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:le,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}];return s&&a.push({pubkey:s,isSigner:!0,isWritable:!1}),(new ae).add({keys:a,programId:this.programId,data:o})}static authorizeWithSeed(e){const{stakePubkey:t,authorityBase:r,authoritySeed:n,authorityOwner:i,newAuthorizedPubkey:s,stakeAuthorizationType:o,custodianPubkey:a}=e,c=ye(jr.AuthorizeWithSeed,{newAuthorized:P(s.toBuffer()),stakeAuthorizationType:o.index,authoritySeed:n,authorityOwner:P(i.toBuffer())}),l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1},{pubkey:le,isSigner:!1,isWritable:!1}];return a&&l.push({pubkey:a,isSigner:!0,isWritable:!1}),(new ae).add({keys:l,programId:this.programId,data:c})}static splitInstruction(e){const{stakePubkey:t,authorizedPubkey:r,splitStakePubkey:n,lamports:i}=e,s=ye(jr.Split,{lamports:i});return new oe({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:s})}static split(e,t){const r=new ae;return r.add(Ie.createAccount({fromPubkey:e.authorizedPubkey,newAccountPubkey:e.splitStakePubkey,lamports:t,space:this.space,programId:this.programId})),r.add(this.splitInstruction(e))}static splitWithSeed(e,t){const{stakePubkey:r,authorizedPubkey:n,splitStakePubkey:i,basePubkey:s,seed:o,lamports:a}=e,c=new ae;return c.add(Ie.allocate({accountPubkey:i,basePubkey:s,seed:o,space:this.space,programId:this.programId})),t&&t>0&&c.add(Ie.transfer({fromPubkey:e.authorizedPubkey,toPubkey:i,lamports:t})),c.add(this.splitInstruction({stakePubkey:r,authorizedPubkey:n,splitStakePubkey:i,lamports:a}))}static merge(e){const{stakePubkey:t,sourceStakePubKey:r,authorizedPubkey:n}=e,i=ye(jr.Merge);return(new ae).add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:le,isSigner:!1,isWritable:!1},{pubkey:de,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:i})}static withdraw(e){const{stakePubkey:t,authorizedPubkey:r,toPubkey:n,lamports:i,custodianPubkey:s}=e,o=ye(jr.Withdraw,{lamports:i}),a=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:le,isSigner:!1,isWritable:!1},{pubkey:de,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return s&&a.push({pubkey:s,isSigner:!0,isWritable:!1}),(new ae).add({keys:a,programId:this.programId,data:o})}static deactivate(e){const{stakePubkey:t,authorizedPubkey:r}=e,n=ye(jr.Deactivate);return(new ae).add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:le,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}}$r.programId=new D("Stake11111111111111111111111111111111111111"),$r.space=200;const zr=Object.freeze({InitializeAccount:{index:0,layout:h.w3([h.DH("instruction"),((e="voteInit")=>h.w3([F("nodePubkey"),F("authorizedVoter"),F("authorizedWithdrawer"),h.u8("commission")],e))()])},Authorize:{index:1,layout:h.w3([h.DH("instruction"),F("newAuthorized"),h.DH("voteAuthorizationType")])},Withdraw:{index:3,layout:h.w3([h.DH("instruction"),h.Wg("lamports")])},UpdateValidatorIdentity:{index:4,layout:h.w3([h.DH("instruction")])},AuthorizeWithSeed:{index:10,layout:h.w3([h.DH("instruction"),((e="voteAuthorizeWithSeedArgs")=>h.w3([h.DH("voteAuthorizationType"),F("currentAuthorityDerivedKeyOwnerPubkey"),K("currentAuthorityDerivedKeySeed"),F("newAuthorized")],e))()])}});Object.freeze({Voter:{index:0},Withdrawer:{index:1}});class qr{constructor(){}static initializeAccount(e){const{votePubkey:t,nodePubkey:r,voteInit:n}=e,i=ye(zr.InitializeAccount,{voteInit:{nodePubkey:P(n.nodePubkey.toBuffer()),authorizedVoter:P(n.authorizedVoter.toBuffer()),authorizedWithdrawer:P(n.authorizedWithdrawer.toBuffer()),commission:n.commission}}),s={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:he,isSigner:!1,isWritable:!1},{pubkey:le,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:i};return new oe(s)}static createAccount(e){const t=new ae;return t.add(Ie.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.votePubkey,lamports:e.lamports,space:this.space,programId:this.programId})),t.add(this.initializeAccount({votePubkey:e.votePubkey,nodePubkey:e.voteInit.nodePubkey,voteInit:e.voteInit}))}static authorize(e){const{votePubkey:t,authorizedPubkey:r,newAuthorizedPubkey:n,voteAuthorizationType:i}=e,s=ye(zr.Authorize,{newAuthorized:P(n.toBuffer()),voteAuthorizationType:i.index}),o=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:le,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return(new ae).add({keys:o,programId:this.programId,data:s})}static authorizeWithSeed(e){const{currentAuthorityDerivedKeyBasePubkey:t,currentAuthorityDerivedKeyOwnerPubkey:r,currentAuthorityDerivedKeySeed:n,newAuthorizedPubkey:i,voteAuthorizationType:s,votePubkey:o}=e,a=ye(zr.AuthorizeWithSeed,{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:P(r.toBuffer()),currentAuthorityDerivedKeySeed:n,newAuthorized:P(i.toBuffer()),voteAuthorizationType:s.index}}),c=[{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:le,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!0,isWritable:!1}];return(new ae).add({keys:c,programId:this.programId,data:a})}static withdraw(e){const{votePubkey:t,authorizedWithdrawerPubkey:r,lamports:n,toPubkey:i}=e,s=ye(zr.Withdraw,{lamports:n}),o=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}];return(new ae).add({keys:o,programId:this.programId,data:s})}static safeWithdraw(e,t,r){if(e.lamports>t-r)throw new Error("Withdraw will leave vote account with insufficient funds.");return qr.withdraw(e)}static updateValidatorIdentity(e){const{votePubkey:t,authorizedWithdrawerPubkey:r,nodePubkey:n}=e,i=ye(zr.UpdateValidatorIdentity),s=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return(new ae).add({keys:s,programId:this.programId,data:i})}}qr.programId=new D("Vote111111111111111111111111111111111111111"),qr.space=3762,new D("Va1idator1nfo111111111111111111111111111111"),(0,E.NW)({name:(0,E.Yj)(),website:(0,E.lq)((0,E.Yj)()),details:(0,E.lq)((0,E.Yj)()),iconUrl:(0,E.lq)((0,E.Yj)()),keybaseUsername:(0,E.lq)((0,E.Yj)())}),new D("Vote111111111111111111111111111111111111111"),h.w3([F("nodePubkey"),F("authorizedWithdrawer"),h.u8("commission"),h.I0(),h.O6(h.w3([h.I0("slot"),h.DH("confirmationCount")]),h.cY(h.DH(),-8),"votes"),h.u8("rootSlotValid"),h.I0("rootSlot"),h.I0(),h.O6(h.w3([h.I0("epoch"),F("authorizedVoter")]),h.cY(h.DH(),-8),"authorizedVoters"),h.w3([h.O6(h.w3([F("authorizedPubkey"),h.I0("epochOfLastAuthorizedSwitch"),h.I0("targetEpoch")]),32,"buf"),h.I0("idx"),h.u8("isEmpty")],"priorVoters"),h.I0(),h.O6(h.w3([h.I0("epoch"),h.I0("credits"),h.I0("prevCredits")]),h.cY(h.DH(),-8),"epochCredits"),h.w3([h.I0("slot"),h.I0("timestamp")],"lastTimestamp")])},7508:(e,t,r)=>{r.d(t,{i:()=>s});var n=r(4376),i=r(6036);const s={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5,transactionsHistory:15e3,tokenPrice:15e3},isCacheExpired:(e,t)=>Date.now()-e>t,getActiveNetworkProps(){const e=s.getActiveNamespace(),t=s.getActiveCaipNetworkId(),r=t?t.split(":")[1]:void 0;return{namespace:e,caipNetworkId:t,chainId:r?isNaN(Number(r))?r:Number(r):void 0}},setWalletConnectDeepLink({name:e,href:t}){try{i.Ud.setItem(i.Ws.DEEPLINK_CHOICE,JSON.stringify({href:t,name:e}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const e=i.Ud.getItem(i.Ws.DEEPLINK_CHOICE);if(e)return JSON.parse(e)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{i.Ud.removeItem(i.Ws.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(e){try{i.Ud.setItem(i.Ws.ACTIVE_NAMESPACE,e)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(e){try{i.Ud.setItem(i.Ws.ACTIVE_CAIP_NETWORK_ID,e),s.setActiveNamespace(e.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return i.Ud.getItem(i.Ws.ACTIVE_CAIP_NETWORK_ID)}catch{return void console.info("Unable to get active caip network id")}},deleteActiveCaipNetworkId(){try{i.Ud.removeItem(i.Ws.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(e){try{const t=(0,i.T8)(e);i.Ud.removeItem(t)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(e){try{const t=s.getRecentWallets();t.find(t=>t.id===e.id)||(t.unshift(e),t.length>2&&t.pop(),i.Ud.setItem(i.Ws.RECENT_WALLETS,JSON.stringify(t)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const e=i.Ud.getItem(i.Ws.RECENT_WALLETS);return e?JSON.parse(e):[]}catch{console.info("Unable to get AppKit recent")}return[]},setConnectedConnectorId(e,t){try{const r=(0,i.T8)(e);i.Ud.setItem(r,t)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return i.Ud.getItem(i.Ws.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(e){if(e)try{const t=(0,i.T8)(e);return i.Ud.getItem(t)}catch(t){console.info("Unable to get connected connector id in namespace",e)}},setConnectedSocialProvider(e){try{i.Ud.setItem(i.Ws.CONNECTED_SOCIAL,e)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return i.Ud.getItem(i.Ws.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{i.Ud.removeItem(i.Ws.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return i.Ud.getItem(i.Ws.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){const e=i.Ud.getItem(i.Ws.ACTIVE_CAIP_NETWORK_ID),t=e?.split(":")?.[1];return t},setConnectionStatus(e){try{i.Ud.setItem(i.Ws.CONNECTION_STATUS,e)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return i.Ud.getItem(i.Ws.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const e=i.Ud.getItem(i.Ws.CONNECTED_NAMESPACES);return e?.length?e.split(","):[]}catch{return[]}},setConnectedNamespaces(e){try{const t=Array.from(new Set(e));i.Ud.setItem(i.Ws.CONNECTED_NAMESPACES,t.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(e){try{const t=s.getConnectedNamespaces();t.includes(e)||(t.push(e),s.setConnectedNamespaces(t))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(e){try{const t=s.getConnectedNamespaces(),r=t.indexOf(e);r>-1&&(t.splice(r,1),s.setConnectedNamespaces(t))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return i.Ud.getItem(i.Ws.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(e){try{i.Ud.setItem(i.Ws.TELEGRAM_SOCIAL_PROVIDER,e)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{i.Ud.removeItem(i.Ws.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let e={};try{const t=i.Ud.getItem(i.Ws.PORTFOLIO_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get balance cache")}return e},removeAddressFromBalanceCache(e){try{const t=s.getBalanceCache();i.Ud.setItem(i.Ws.PORTFOLIO_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove address from balance cache",e)}},getBalanceCacheForCaipAddress(e){try{const t=s.getBalanceCache()[e];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.portfolio))return t.balance;s.removeAddressFromBalanceCache(e)}catch{console.info("Unable to get balance cache for address",e)}},updateBalanceCache(e){try{const t=s.getBalanceCache();t[e.caipAddress]=e,i.Ud.setItem(i.Ws.PORTFOLIO_CACHE,JSON.stringify(t))}catch{console.info("Unable to update balance cache",e)}},getNativeBalanceCache(){let e={};try{const t=i.Ud.getItem(i.Ws.NATIVE_BALANCE_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get balance cache")}return e},removeAddressFromNativeBalanceCache(e){try{const t=s.getBalanceCache();i.Ud.setItem(i.Ws.NATIVE_BALANCE_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove address from balance cache",e)}},getNativeBalanceCacheForCaipAddress(e){try{const t=s.getNativeBalanceCache()[e];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.nativeBalance))return t;console.info("Discarding cache for address",e),s.removeAddressFromBalanceCache(e)}catch{console.info("Unable to get balance cache for address",e)}},updateNativeBalanceCache(e){try{const t=s.getNativeBalanceCache();t[e.caipAddress]=e,i.Ud.setItem(i.Ws.NATIVE_BALANCE_CACHE,JSON.stringify(t))}catch{console.info("Unable to update balance cache",e)}},getEnsCache(){let e={};try{const t=i.Ud.getItem(i.Ws.ENS_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get ens name cache")}return e},getEnsFromCacheForAddress(e){try{const t=s.getEnsCache()[e];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.ens))return t.ens;s.removeEnsFromCache(e)}catch{console.info("Unable to get ens name from cache",e)}},updateEnsCache(e){try{const t=s.getEnsCache();t[e.address]=e,i.Ud.setItem(i.Ws.ENS_CACHE,JSON.stringify(t))}catch{console.info("Unable to update ens name cache",e)}},removeEnsFromCache(e){try{const t=s.getEnsCache();i.Ud.setItem(i.Ws.ENS_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove ens name from cache",e)}},getIdentityCache(){let e={};try{const t=i.Ud.getItem(i.Ws.IDENTITY_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get identity cache")}return e},getIdentityFromCacheForAddress(e){try{const t=s.getIdentityCache()[e];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.identity))return t.identity;s.removeIdentityFromCache(e)}catch{console.info("Unable to get identity from cache",e)}},updateIdentityCache(e){try{const t=s.getIdentityCache();t[e.address]={identity:e.identity,timestamp:e.timestamp},i.Ud.setItem(i.Ws.IDENTITY_CACHE,JSON.stringify(t))}catch{console.info("Unable to update identity cache",e)}},removeIdentityFromCache(e){try{const t=s.getIdentityCache();i.Ud.setItem(i.Ws.IDENTITY_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove identity from cache",e)}},clearAddressCache(){try{i.Ud.removeItem(i.Ws.PORTFOLIO_CACHE),i.Ud.removeItem(i.Ws.NATIVE_BALANCE_CACHE),i.Ud.removeItem(i.Ws.ENS_CACHE),i.Ud.removeItem(i.Ws.IDENTITY_CACHE),i.Ud.removeItem(i.Ws.HISTORY_TRANSACTIONS_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(e){try{i.Ud.setItem(i.Ws.PREFERRED_ACCOUNT_TYPES,JSON.stringify(e))}catch{console.info("Unable to set preferred account types",e)}},getPreferredAccountTypes(){try{const e=i.Ud.getItem(i.Ws.PREFERRED_ACCOUNT_TYPES);return e?JSON.parse(e):{}}catch{console.info("Unable to get preferred account types")}return{}},setConnections(e,t){try{const r=s.getConnections(),o=r[t]??[],a=new Map;for(const e of o)a.set(e.connectorId,{...e});for(const t of e){const e=a.get(t.connectorId),r=t.connectorId===n.o.CONNECTOR_ID.AUTH;if(e&&!r){const r=new Set(e.accounts.map(e=>e.address.toLowerCase())),n=t.accounts.filter(e=>!r.has(e.address.toLowerCase()));e.accounts.push(...n)}else a.set(t.connectorId,{...t})}const c={...r,[t]:Array.from(a.values())};i.Ud.setItem(i.Ws.CONNECTIONS,JSON.stringify(c))}catch(e){console.error("Unable to sync connections to storage",e)}},getConnections(){try{const e=i.Ud.getItem(i.Ws.CONNECTIONS);return e?JSON.parse(e):{}}catch(e){return console.error("Unable to get connections from storage",e),{}}},deleteAddressFromConnection({connectorId:e,address:t,namespace:r}){try{const n=s.getConnections(),o=n[r]??[],a=new Map(o.map(e=>[e.connectorId,e])),c=a.get(e);c&&(0===c.accounts.filter(e=>e.address.toLowerCase()!==t.toLowerCase()).length?a.delete(e):a.set(e,{...c,accounts:c.accounts.filter(e=>e.address.toLowerCase()!==t.toLowerCase())})),i.Ud.setItem(i.Ws.CONNECTIONS,JSON.stringify({...n,[r]:Array.from(a.values())}))}catch{console.error(`Unable to remove address "${t}" from connector "${e}" in namespace "${r}"`)}},getDisconnectedConnectorIds(){try{const e=i.Ud.getItem(i.Ws.DISCONNECTED_CONNECTOR_IDS);return e?JSON.parse(e):{}}catch{console.info("Unable to get disconnected connector ids")}return{}},addDisconnectedConnectorId(e,t){try{const r=s.getDisconnectedConnectorIds(),n=r[t]??[];n.push(e),i.Ud.setItem(i.Ws.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...r,[t]:Array.from(new Set(n))}))}catch{console.error(`Unable to set disconnected connector id "${e}" for namespace "${t}"`)}},removeDisconnectedConnectorId(e,t){try{const r=s.getDisconnectedConnectorIds();let n=r[t]??[];n=n.filter(t=>t.toLowerCase()!==e.toLowerCase()),i.Ud.setItem(i.Ws.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...r,[t]:Array.from(new Set(n))}))}catch{console.error(`Unable to remove disconnected connector id "${e}" for namespace "${t}"`)}},isConnectorDisconnected(e,t){try{return(s.getDisconnectedConnectorIds()[t]??[]).some(t=>t.toLowerCase()===e.toLowerCase())}catch{console.info(`Unable to get disconnected connector id "${e}" for namespace "${t}"`)}return!1},getTransactionsCache(){try{const e=i.Ud.getItem(i.Ws.HISTORY_TRANSACTIONS_CACHE);return e?JSON.parse(e):{}}catch{console.info("Unable to get transactions cache")}return{}},getTransactionsCacheForAddress({address:e,chainId:t=""}){try{const r=s.getTransactionsCache(),n=r[e]?.[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.transactionsHistory))return n.transactions;s.removeTransactionsCache({address:e,chainId:t})}catch{console.info("Unable to get transactions cache")}},updateTransactionsCache({address:e,chainId:t="",timestamp:r,transactions:n}){try{const o=s.getTransactionsCache();o[e]={...o[e],[t]:{timestamp:r,transactions:n}},i.Ud.setItem(i.Ws.HISTORY_TRANSACTIONS_CACHE,JSON.stringify(o))}catch{console.info("Unable to update transactions cache",{address:e,chainId:t,timestamp:r,transactions:n})}},removeTransactionsCache({address:e,chainId:t}){try{const r=s.getTransactionsCache(),n=r?.[e]||{},{[t]:o,...a}=n;i.Ud.setItem(i.Ws.HISTORY_TRANSACTIONS_CACHE,JSON.stringify({...r,[e]:a}))}catch{console.info("Unable to remove transactions cache",{address:e,chainId:t})}},getTokenPriceCache(){try{const e=i.Ud.getItem(i.Ws.TOKEN_PRICE_CACHE);return e?JSON.parse(e):{}}catch{console.info("Unable to get token price cache")}return{}},getTokenPriceCacheForAddresses(e){try{const t=s.getTokenPriceCache()[e.join(",")];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.tokenPrice))return t.tokenPrice;s.removeTokenPriceCache(e)}catch{console.info("Unable to get token price cache for addresses",e)}},updateTokenPriceCache(e){try{const t=s.getTokenPriceCache();t[e.addresses.join(",")]={timestamp:e.timestamp,tokenPrice:e.tokenPrice},i.Ud.setItem(i.Ws.TOKEN_PRICE_CACHE,JSON.stringify(t))}catch{console.info("Unable to update token price cache",e)}},removeTokenPriceCache(e){try{const t=s.getTokenPriceCache();i.Ud.setItem(i.Ws.TOKEN_PRICE_CACHE,JSON.stringify({...t,[e.join(",")]:void 0}))}catch{console.info("Unable to remove token price cache",e)}}}},7526:(e,t)=>{t.byteLength=function(e){var t=a(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,s=a(e),o=s[0],c=s[1],l=new i(function(e,t,r){return 3*(t+r)/4-r}(0,o,c)),u=0,h=c>0?o-4:o;for(r=0;r<h;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;return 2===c&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,l[u++]=255&t),1===c&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t),l},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,s=[],o=16383,a=0,c=n-i;a<c;a+=o)s.push(l(e,a,a+o>c?c:a+o));return 1===i?(t=e[n-1],s.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],s.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),s.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0;o<64;++o)r[o]=s[o],n[s.charCodeAt(o)]=o;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function l(e,t,r){for(var n,i=[],s=t;s<r;s+=3)n=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),i.push(c(n));return i.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},7601:(e,t,r)=>{r.d(t,{$:()=>c});var n=r(8126),i=r(8249),s=r(3337);const o={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:"",sui:"",stacks:""},a=(0,n.BX)({networkImagePromises:{}}),c={async fetchWalletImage(e){if(e)return await i.N._fetchWalletImage(e),this.getWalletImageById(e)},async fetchNetworkImage(e){if(!e)return;return this.getNetworkImageById(e)||(a.networkImagePromises[e]||(a.networkImagePromises[e]=i.N._fetchNetworkImage(e)),await a.networkImagePromises[e],this.getNetworkImageById(e))},getWalletImageById(e){if(e)return s.j.state.walletImages[e]},getWalletImage:e=>e?.image_url?e?.image_url:e?.image_id?s.j.state.walletImages[e.image_id]:void 0,getNetworkImage:e=>e?.assets?.imageUrl?e?.assets?.imageUrl:e?.assets?.imageId?s.j.state.networkImages[e.assets.imageId]:void 0,getNetworkImageById(e){if(e)return s.j.state.networkImages[e]},getConnectorImage:e=>e?.imageUrl?e.imageUrl:e?.info?.icon?e.info.icon:e?.imageId?s.j.state.connectorImages[e.imageId]:void 0,getChainImage:e=>s.j.state.networkImages[o[e]]}},7790:()=>{},7803:(e,t,r)=>{var n=r(8287).Buffer;t.k5=function(e){{const t=n.from(e);t.reverse();const r=t.toString("hex");return 0===r.length?BigInt(0):BigInt(`0x${r}`)}},t.cI=function(e){{const t=e.toString("hex");return 0===t.length?BigInt(0):BigInt(`0x${t}`)}},t.Bq=function(e,t){{const r=e.toString(16),i=n.from(r.padStart(2*t,"0").slice(0,2*t),"hex");return i.reverse(),i}},t.zy=function(e,t){{const r=e.toString(16);return n.from(r.padStart(2*t,"0").slice(0,2*t),"hex")}}},8030:(e,t,r)=>{r.d(t,{D0:()=>N,LH:()=>k,Tp:()=>T,dQ:()=>A,jr:()=>I,pS:()=>S,qy:()=>O,zH:()=>m,zi:()=>g});var n=r(1848),i=r(2531);const s=BigInt(0),o=BigInt(1),a=BigInt(2),c=BigInt(3),l=BigInt(4),u=BigInt(5),h=BigInt(7),d=BigInt(8),p=BigInt(9),f=BigInt(16);function g(e,t){const r=e%t;return r>=s?r:t+r}function m(e,t,r){let n=e;for(;t-- >s;)n*=n,n%=r;return n}function y(e,t){if(e===s)throw new Error("invert: expected non-zero number");if(t<=s)throw new Error("invert: expected positive modulus, got "+t);let r=g(e,t),n=t,i=s,a=o,c=o,l=s;for(;r!==s;){const e=n/r,t=n%r,s=i-c*e,o=a-l*e;n=r,r=t,i=c,a=l,c=s,l=o}if(n!==o)throw new Error("invert: does not exist");return g(i,t)}function w(e,t,r){if(!e.eql(e.sqr(t),r))throw new Error("Cannot find square root")}function b(e,t){const r=(e.ORDER+o)/l,n=e.pow(t,r);return w(e,n,t),n}function v(e,t){const r=(e.ORDER-u)/d,n=e.mul(t,a),i=e.pow(n,r),s=e.mul(t,i),o=e.mul(e.mul(s,a),i),c=e.mul(s,e.sub(o,e.ONE));return w(e,c,t),c}function E(e){if(e<c)throw new Error("sqrt is not defined for small field");let t=e-o,r=0;for(;t%a===s;)t/=a,r++;let n=a;const i=N(e);for(;1===C(i,n);)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===r)return b;let l=i.pow(n,t);const u=(t+o)/a;return function(e,n){if(e.is0(n))return n;if(1!==C(e,n))throw new Error("Cannot find square root");let i=r,s=e.mul(e.ONE,l),a=e.pow(n,t),c=e.pow(n,u);for(;!e.eql(a,e.ONE);){if(e.is0(a))return e.ZERO;let t=1,r=e.sqr(a);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===i)throw new Error("Cannot find square root");const n=o<<BigInt(i-t-1),l=e.pow(s,n);i=t,s=e.sqr(l),a=e.mul(a,s),c=e.mul(c,l)}return c}}const A=(e,t)=>(g(e,t)&o)===o,_=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function I(e){const t=_.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"});return(0,n.DS)(e,t),e}function S(e,t,r=!1){const n=new Array(t.length).fill(r?e.ZERO:void 0),i=t.reduce((t,r,i)=>e.is0(r)?t:(n[i]=t,e.mul(t,r)),e.ONE),s=e.inv(i);return t.reduceRight((t,r,i)=>e.is0(r)?t:(n[i]=e.mul(t,n[i]),e.mul(t,r)),s),n}function C(e,t){const r=(e.ORDER-o)/a,n=e.pow(t,r),i=e.eql(n,e.ONE),s=e.eql(n,e.ZERO),c=e.eql(n,e.neg(e.ONE));if(!i&&!s&&!c)throw new Error("invalid Legendre symbol result");return i?1:s?0:-1}function k(e,t){void 0!==t&&(0,i.Fe)(t);const r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function N(e,t,r=!1,i={}){if(e<=s)throw new Error("invalid field: expected ORDER > 0, got "+e);let a,m,A,_=!1;if("object"==typeof t&&null!=t){if(i.sqrt||r)throw new Error("cannot specify opts in two arguments");const e=t;e.BITS&&(a=e.BITS),e.sqrt&&(m=e.sqrt),"boolean"==typeof e.isLE&&(r=e.isLE),"boolean"==typeof e.modFromBytes&&(_=e.modFromBytes),A=e.allowedLengths}else"number"==typeof t&&(a=t),i.sqrt&&(m=i.sqrt);const{nBitLength:I,nByteLength:C}=k(e,a);if(C>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let x;const T=Object.freeze({ORDER:e,isLE:r,BITS:I,BYTES:C,MASK:(0,n.OG)(I),ZERO:s,ONE:o,allowedLengths:A,create:t=>g(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return s<=t&&t<e},is0:e=>e===s,isValidNot0:e=>!T.is0(e)&&T.isValid(e),isOdd:e=>(e&o)===o,neg:t=>g(-t,e),eql:(e,t)=>e===t,sqr:t=>g(t*t,e),add:(t,r)=>g(t+r,e),sub:(t,r)=>g(t-r,e),mul:(t,r)=>g(t*r,e),pow:(e,t)=>function(e,t,r){if(r<s)throw new Error("invalid exponent, negatives unsupported");if(r===s)return e.ONE;if(r===o)return t;let n=e.ONE,i=t;for(;r>s;)r&o&&(n=e.mul(n,i)),i=e.sqr(i),r>>=o;return n}(T,e,t),div:(t,r)=>g(t*y(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>y(t,e),sqrt:m||(t=>{return x||(x=(r=e)%l===c?b:r%d===u?v:r%f===p?function(e){const t=N(e),r=E(e),n=r(t,t.neg(t.ONE)),i=r(t,n),s=r(t,t.neg(n)),o=(e+h)/f;return(e,t)=>{let r=e.pow(t,o),a=e.mul(r,n);const c=e.mul(r,i),l=e.mul(r,s),u=e.eql(e.sqr(a),t),h=e.eql(e.sqr(c),t);r=e.cmov(r,a,u),a=e.cmov(l,c,h);const d=e.eql(e.sqr(a),t),p=e.cmov(r,a,d);return w(e,p,t),p}}(r):E(r)),x(T,t);var r}),toBytes:e=>r?(0,n.z)(e,C):(0,n.lq)(e,C),fromBytes:(t,i=!0)=>{if(A){if(!A.includes(t.length)||t.length>C)throw new Error("Field.fromBytes: expected "+A+" bytes, got "+t.length);const e=new Uint8Array(C);e.set(t,r?0:e.length-t.length),t=e}if(t.length!==C)throw new Error("Field.fromBytes: expected "+C+" bytes, got "+t.length);let s=r?(0,n.lX)(t):(0,n.Ph)(t);if(_&&(s=g(s,e)),!i&&!T.isValid(s))throw new Error("invalid field element: outside of range 0..ORDER");return s},invertBatch:e=>S(T,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(T)}function x(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function T(e){const t=x(e);return t+Math.ceil(t/2)}function O(e,t,r=!1){const i=e.length,s=x(t),a=T(t);if(i<16||i<a||i>1024)throw new Error("expected "+a+"-1024 bytes of input, got "+i);const c=g(r?(0,n.lX)(e):(0,n.Ph)(e),t-o)+o;return r?(0,n.z)(c,s):(0,n.lq)(c,s)}},8075:(e,t,r)=>{r.d(t,{Z:()=>d});var n=r(4376),i=r(3450),s=r(5595),o=r(6056),a=r(1211),c=r(6010),l=r(7135);const u={createBalance(e,t){const r={name:e.metadata.name||"",symbol:e.metadata.symbol||"",decimals:e.metadata.decimals||0,value:e.metadata.value||0,price:e.metadata.price||0,iconUrl:e.metadata.iconUrl||""};return{name:r.name,symbol:r.symbol,chainId:t,address:"native"===e.address?void 0:this.convertAddressToCAIP10Address(e.address,t),value:r.value,price:r.price,quantity:{decimals:r.decimals.toString(),numeric:this.convertHexToBalance({hex:e.balance,decimals:r.decimals})},iconUrl:r.iconUrl}},convertHexToBalance:({hex:e,decimals:t})=>(0,l.J)(BigInt(e),t),convertAddressToCAIP10Address:(e,t)=>`${t}:${e}`,createCAIP2ChainId:(e,t)=>`${t}:${parseInt(e,16)}`,getChainIdHexFromCAIP2ChainId(e){const t=e.split(":");if(t.length<2||!t[1])return"0x0";const r=t[1],n=parseInt(r,10);return isNaN(n)?"0x0":`0x${n.toString(16)}`},isWalletGetAssetsResponse(e){return"object"==typeof e&&null!==e&&Object.values(e).every(e=>Array.isArray(e)&&e.every(e=>this.isValidAsset(e)))},isValidAsset:e=>"object"==typeof e&&null!==e&&"string"==typeof e.address&&"string"==typeof e.balance&&("ERC20"===e.type||"NATIVE"===e.type)&&"object"==typeof e.metadata&&null!==e.metadata&&"string"==typeof e.metadata.name&&"string"==typeof e.metadata.symbol&&"number"==typeof e.metadata.decimals&&"number"==typeof e.metadata.price&&"string"==typeof e.metadata.iconUrl};var h=r(7508);const d={async getMyTokensWithBalance(e){const t=i.U.state.address,r=o.W.state.activeCaipNetwork,a=c.a.getConnectorId("eip155")===n.o.CONNECTOR_ID.AUTH;if(!t||!r)return[];const l=`${r.caipNetworkId}:${t}`,u=h.i.getBalanceCacheForCaipAddress(l);if(u)return u.balances;if(r.chainNamespace===n.o.CHAIN.EVM&&a){const e=await this.getEIP155Balances(t,r);if(e)return this.filterLowQualityTokens(e)}const d=await s.T.getBalance(t,r.caipNetworkId,e);return this.filterLowQualityTokens(d.balances)},async getEIP155Balances(e,t){try{const r=u.getChainIdHexFromCAIP2ChainId(t.caipNetworkId),n=await a.x.getCapabilities(e);if(!n?.[r]?.assetDiscovery?.supported)return null;const i=await a.x.walletGetAssets({account:e,chainFilter:[r]});if(!u.isWalletGetAssetsResponse(i))return null;const s=(i[r]||[]).map(e=>u.createBalance(e,t.caipNetworkId));return h.i.updateBalanceCache({caipAddress:`${t.caipNetworkId}:${e}`,balance:{balances:s},timestamp:Date.now()}),s}catch(e){return null}},filterLowQualityTokens:e=>e.filter(e=>"0"!==e.quantity.decimals)}},8126:(e,t,r)=>{r.d(t,{BX:()=>w,KR:()=>E,P9:()=>v,B1:()=>b,h2:()=>A}),Symbol();const n=Symbol(),i=Object.getPrototypeOf,s=new WeakMap,o=(e,t=!0)=>{s.set(e,t)},a=e=>"object"==typeof e&&null!==e,c=(e,t)=>{const r=h.get(e);if((null==r?void 0:r[0])===t)return r[1];const n=Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e));return o(n,!0),h.set(e,[t,n]),Reflect.ownKeys(e).forEach(t=>{if(Object.getOwnPropertyDescriptor(n,t))return;const r=Reflect.get(e,t),{enumerable:i}=Reflect.getOwnPropertyDescriptor(e,t),s={value:r,enumerable:i,configurable:!0};if(u.has(r))o(r,!1);else if(l.has(r)){const[e,t]=l.get(r);s.value=c(e,t())}Object.defineProperty(n,t,s)}),Object.preventExtensions(n)},l=new WeakMap,u=new WeakSet,h=new WeakMap,d=[1,1],p=new WeakMap;let f=Object.is,g=(e,t)=>new Proxy(e,t),m=c,y=(e,t,r,o)=>({deleteProperty(e,t){const n=Reflect.get(e,t);r(t);const i=Reflect.deleteProperty(e,t);return i&&o(["delete",[t],n]),i},set(c,h,d,g){const m=!e()&&Reflect.has(c,h),y=Reflect.get(c,h,g);if(m&&(f(y,d)||p.has(d)&&f(y,p.get(d))))return!0;var b;r(h),a(d)&&(d=(e=>e&&(s.has(e)?s.get(e):i(e)===Object.prototype||i(e)===Array.prototype))(b=d)&&b[n]||d);const v=l.has(d)||(!a(E=d)||u.has(E)||!Array.isArray(E)&&Symbol.iterator in E||E instanceof WeakMap||E instanceof WeakSet||E instanceof Error||E instanceof Number||E instanceof Date||E instanceof String||E instanceof RegExp||E instanceof ArrayBuffer||E instanceof Promise)?d:w(d);var E;return t(h,v),Reflect.set(c,h,v,g),o(["set",[h],d,y]),!0}});function w(e={}){if(!a(e))throw new Error("object required");const t=p.get(e);if(t)return t;let r=d[0];const n=new Set,i=(e,t=++d[0])=>{r!==t&&(r=t,n.forEach(r=>r(e,t)))};let s=d[1];const o=e=>(t,r)=>{const n=[...t];n[1]=[e,...n[1]],i(n,r)},c=new Map;let h=!0;const f=y(()=>h,(e,t)=>{const r=!u.has(t)&&l.get(t);if(r){if(c.has(e))throw new Error("prop listener already exists");if(n.size){const t=r[2](o(e));c.set(e,[r,t])}else c.set(e,[r])}},e=>{var t;const r=c.get(e);r&&(c.delete(e),null==(t=r[1])||t.call(r))},i),m=g(e,f);p.set(e,m);const w=[e,(e=++d[1])=>(s===e||n.size||(s=e,c.forEach(([t])=>{const n=t[1](e);n>r&&(r=n)})),r),e=>(n.add(e),1===n.size&&c.forEach(([e,t],r)=>{if(t)throw new Error("remove already exists");const n=e[2](o(r));c.set(r,[e,n])}),()=>{n.delete(e),0===n.size&&c.forEach(([e,t],r)=>{t&&(t(),c.set(r,[e]))})})];return l.set(m,w),Reflect.ownKeys(e).forEach(t=>{const r=Object.getOwnPropertyDescriptor(e,t);"value"in r&&r.writable&&(m[t]=e[t])}),h=!1,m}function b(e,t,r){const n=l.get(e);let i;n||console.warn("Please use proxy object");const s=[],o=n[2];let a=!1;const c=o(e=>{s.push(e),r?t(s.splice(0)):i||(i=Promise.resolve().then(()=>{i=void 0,a&&t(s.splice(0))}))});return a=!0,()=>{a=!1,c()}}function v(e){const t=l.get(e);t||console.warn("Please use proxy object");const[r,n]=t;return m(r,n())}function E(e){return u.add(e),e}function A(){return{proxyStateMap:l,refSet:u,snapCache:h,versionHolder:d,proxyCache:p}}},8169:(e,t,r)=>{r.d(t,{r:()=>l});var n=r(4353),i=r(5826),s=r(6279),o=r(3581);n.extend(s),n.extend(o);const a={...i,name:"en-web3-modal",relativeTime:{future:"in %s",past:"%s ago",s:"%d sec",m:"1 min",mm:"%d min",h:"1 hr",hh:"%d hrs",d:"1 d",dd:"%d d",M:"1 mo",MM:"%d mo",y:"1 yr",yy:"%d yr"}},c=["January","February","March","April","May","June","July","August","September","October","November","December"];n.locale("en-web3-modal",a);const l={getMonthNameByIndex:e=>c[e],getYear:(e=(new Date).toISOString())=>n(e).year(),getRelativeDateFromNow:e=>n(e).locale("en-web3-modal").fromNow(!0),formatDate:(e,t="DD MMM")=>n(e).format(t)}},8196:(e,t)=>{function r(e){let t;return"undefined"!=typeof window&&void 0!==window[e]&&(t=window[e]),t}function n(e){const t=r(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalStorage=t.getLocalStorageOrThrow=t.getCrypto=t.getCryptoOrThrow=t.getLocation=t.getLocationOrThrow=t.getNavigator=t.getNavigatorOrThrow=t.getDocument=t.getDocumentOrThrow=t.getFromWindowOrThrow=t.getFromWindow=void 0,t.getFromWindow=r,t.getFromWindowOrThrow=n,t.getDocumentOrThrow=function(){return n("document")},t.getDocument=function(){return r("document")},t.getNavigatorOrThrow=function(){return n("navigator")},t.getNavigator=function(){return r("navigator")},t.getLocationOrThrow=function(){return n("location")},t.getLocation=function(){return r("location")},t.getCryptoOrThrow=function(){return n("crypto")},t.getCrypto=function(){return r("crypto")},t.getLocalStorageOrThrow=function(){return n("localStorage")},t.getLocalStorage=function(){return r("localStorage")}},8226:(e,t,r)=>{r.d(t,{sc:()=>n});const n=r(8442).sc},8249:(e,t,r)=>{r.d(t,{N:()=>b});var n=r(8126),i=r(4707),s=r(4376),o=r(7601),a=r(6742),c=r(5905),l=r(5574),u=r(7508),h=r(3337),d=r(6056),p=r(6010),f=r(184),g=r(2733);const m=a.w.getApiUrl(),y=new c.Z({baseUrl:m,clientId:null}),w=(0,n.BX)({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1}),b={state:w,subscribeKey:(e,t)=>(0,i.u$)(w,e,t),_getSdkProperties(){const{projectId:e,sdkType:t,sdkVersion:r}=g.H.state;return{projectId:e,st:t||"appkit",sv:r||"html-wagmi-4.2.2"}},_filterOutExtensions:e=>g.H.state.isUniversalProvider?e.filter(e=>Boolean(e.mobile_link||e.desktop_link||e.webapp_link)):e,async _fetchWalletImage(e){const t=`${y.baseUrl}/getWalletImage/${e}`,r=await y.getBlob({path:t,params:b._getSdkProperties()});h.j.setWalletImage(e,URL.createObjectURL(r))},async _fetchNetworkImage(e){const t=`${y.baseUrl}/public/getAssetImage/${e}`,r=await y.getBlob({path:t,params:b._getSdkProperties()});h.j.setNetworkImage(e,URL.createObjectURL(r))},async _fetchConnectorImage(e){const t=`${y.baseUrl}/public/getAssetImage/${e}`,r=await y.getBlob({path:t,params:b._getSdkProperties()});h.j.setConnectorImage(e,URL.createObjectURL(r))},async _fetchCurrencyImage(e){const t=`${y.baseUrl}/public/getCurrencyImage/${e}`,r=await y.getBlob({path:t,params:b._getSdkProperties()});h.j.setCurrencyImage(e,URL.createObjectURL(r))},async _fetchTokenImage(e){const t=`${y.baseUrl}/public/getTokenImage/${e}`,r=await y.getBlob({path:t,params:b._getSdkProperties()});h.j.setTokenImage(e,URL.createObjectURL(r))},_filterWalletsByPlatform:e=>a.w.isMobile()?e?.filter(e=>!!e.mobile_link||(e.id===l.O.COINBASE.id||e.id===l.O.BINANCE.id||"solana"===d.W.state.activeChain&&(e.id===l.O.SOLFLARE.id||e.id===l.O.PHANTOM.id))):e,fetchProjectConfig:async()=>(await y.get({path:"/appkit/v1/config",params:b._getSdkProperties()})).features,async fetchAllowedOrigins(){try{const{allowedOrigins:e}=await y.get({path:"/projects/v1/origins",params:b._getSdkProperties()});return e}catch(e){if(e instanceof Error&&e.cause instanceof Response){const t=e.cause.status;if(t===s.o.HTTP_STATUS_CODES.TOO_MANY_REQUESTS)throw new Error("RATE_LIMITED",{cause:e});if(t>=s.o.HTTP_STATUS_CODES.SERVER_ERROR&&t<600)throw new Error("SERVER_ERROR",{cause:e});return[]}return[]}},async fetchNetworkImages(){const e=d.W.getAllRequestedCaipNetworks(),t=e?.map(({assets:e})=>e?.imageId).filter(Boolean).filter(e=>!o.$.getNetworkImageById(e));t&&await Promise.allSettled(t.map(e=>b._fetchNetworkImage(e)))},async fetchConnectorImages(){const{connectors:e}=p.a.state,t=e.map(({imageId:e})=>e).filter(Boolean);await Promise.allSettled(t.map(e=>b._fetchConnectorImage(e)))},async fetchCurrencyImages(e=[]){await Promise.allSettled(e.map(e=>b._fetchCurrencyImage(e)))},async fetchTokenImages(e=[]){await Promise.allSettled(e.map(e=>b._fetchTokenImage(e)))},async fetchWallets(e){const t=e.exclude??[];b._getSdkProperties().sv.startsWith("html-core-")&&t.push(...Object.values(l.O).map(e=>e.id));const r=await y.get({path:"/getWallets",params:{...b._getSdkProperties(),...e,page:String(e.page),entries:String(e.entries),include:e.include?.join(","),exclude:t.join(",")}});return{data:b._filterWalletsByPlatform(r?.data)||[],count:r?.count}},async fetchFeaturedWallets(){const{featuredWalletIds:e}=g.H.state;if(e?.length){const t={...b._getSdkProperties(),page:1,entries:e?.length??4,include:e},{data:r}=await b.fetchWallets(t),n=[...r].sort((t,r)=>e.indexOf(t.id)-e.indexOf(r.id)),i=n.map(e=>e.image_id).filter(Boolean);await Promise.allSettled(i.map(e=>b._fetchWalletImage(e))),w.featured=n,w.allFeatured=n}},async fetchRecommendedWallets(){try{w.isFetchingRecommendedWallets=!0;const{includeWalletIds:e,excludeWalletIds:t,featuredWalletIds:r}=g.H.state,n={page:1,entries:4,include:e,exclude:[...t??[],...r??[]].filter(Boolean),chains:d.W.getRequestedCaipNetworkIds().join(",")},{data:i,count:s}=await b.fetchWallets(n),o=u.i.getRecentWallets(),a=i.map(e=>e.image_id).filter(Boolean),c=o.map(e=>e.image_id).filter(Boolean);await Promise.allSettled([...a,...c].map(e=>b._fetchWalletImage(e))),w.recommended=i,w.allRecommended=i,w.count=s??0}catch{}finally{w.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:e}){const{includeWalletIds:t,excludeWalletIds:r,featuredWalletIds:n}=g.H.state,i=d.W.getRequestedCaipNetworkIds().join(","),s={page:e,entries:40,include:t,exclude:[...w.recommended.map(({id:e})=>e),...r??[],...n??[]].filter(Boolean),chains:i},{data:o,count:c}=await b.fetchWallets(s),l=o.slice(0,20).map(e=>e.image_id).filter(Boolean);await Promise.allSettled(l.map(e=>b._fetchWalletImage(e))),w.wallets=a.w.uniqueBy([...w.wallets,...b._filterOutExtensions(o)],"id").filter(e=>e.chains?.some(e=>i.includes(e))),w.count=c>w.count?c:w.count,w.page=e},async initializeExcludedWallets({ids:e}){const t={page:1,entries:e.length,include:e},{data:r}=await b.fetchWallets(t);r&&r.forEach(e=>{w.excludedWallets.push({rdns:e.rdns,name:e.name})})},async searchWallet({search:e,badge:t}){const{includeWalletIds:r,excludeWalletIds:n}=g.H.state,i=d.W.getRequestedCaipNetworkIds().join(",");w.search=[];const s={page:1,entries:100,search:e?.trim(),badge_type:t,include:r,exclude:n,chains:i},{data:o}=await b.fetchWallets(s);f.E.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:t??"",search:e??""}});const c=o.map(e=>e.image_id).filter(Boolean);await Promise.allSettled([...c.map(e=>b._fetchWalletImage(e)),a.w.wait(300)]),w.search=b._filterOutExtensions(o)},initPromise:(e,t)=>w.promises[e]||(w.promises[e]=t()),prefetch({fetchConnectorImages:e=!0,fetchFeaturedWallets:t=!0,fetchRecommendedWallets:r=!0,fetchNetworkImages:n=!0}={}){const i=[e&&b.initPromise("connectorImages",b.fetchConnectorImages),t&&b.initPromise("featuredWallets",b.fetchFeaturedWallets),r&&b.initPromise("recommendedWallets",b.fetchRecommendedWallets),n&&b.initPromise("networkImages",b.fetchNetworkImages)].filter(Boolean);return Promise.allSettled(i)},prefetchAnalyticsConfig(){g.H.state.features?.analytics&&b.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:e}=await y.get({path:"/getAnalyticsConfig",params:b._getSdkProperties()});g.H.setFeatures({analytics:e})}catch(e){g.H.setFeatures({analytics:!1})}},filterByNamespaces(e){if(!e?.length)return w.featured=w.allFeatured,void(w.recommended=w.allRecommended);const t=d.W.getRequestedCaipNetworkIds().join(",");w.featured=w.allFeatured.filter(e=>e.chains?.some(e=>t.includes(e))),w.recommended=w.allRecommended.filter(e=>e.chains?.some(e=>t.includes(e))),w.filteredWallets=w.wallets.filter(e=>e.chains?.some(e=>t.includes(e)))},clearFilterByNamespaces(){w.filteredWallets=[]},setFilterByNamespace(e){if(!e)return w.featured=w.allFeatured,void(w.recommended=w.allRecommended);const t=d.W.getRequestedCaipNetworkIds().join(",");w.featured=w.allFeatured.filter(e=>e.chains?.some(e=>t.includes(e))),w.recommended=w.allRecommended.filter(e=>e.chains?.some(e=>t.includes(e))),w.filteredWallets=w.wallets.filter(e=>e.chains?.some(e=>t.includes(e)))}}},8287:(e,t,r)=>{const n=r(7526),i=r(251),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=c,t.SlowBuffer=function(e){return+e!=e&&(e=0),c.alloc(+e)},t.INSPECT_MAX_BYTES=50;const o=2147483647;function a(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return h(e)}return l(e,t,r)}function l(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|g(e,t);let n=a(r);const i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(G(e,Uint8Array)){const t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(G(e,ArrayBuffer)||e&&G(e.buffer,ArrayBuffer))return p(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(G(e,SharedArrayBuffer)||e&&G(e.buffer,SharedArrayBuffer)))return p(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return c.from(n,t,r);const i=function(e){if(c.isBuffer(e)){const t=0|f(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||Z(e.length)?a(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return u(e),a(e<0?0:0|f(e))}function d(e){const t=e.length<0?0:0|f(e.length),r=a(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function p(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,c.prototype),n}function f(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function g(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||G(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return K(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return V(e).length;default:if(i)return n?-1:K(e).length;t=(""+t).toLowerCase(),i=!0}}function m(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,r);case"utf8":case"utf-8":return C(this,t,r);case"ascii":return N(this,t,r);case"latin1":case"binary":return x(this,t,r);case"base64":return S(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function w(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Z(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:b(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):b(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,r,n,i){let s,o=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,a/=2,c/=2,r/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){let n=-1;for(s=r;s<a;s++)if(l(e,s)===l(t,-1===n?0:s-n)){if(-1===n&&(n=s),s-n+1===c)return n*o}else-1!==n&&(s-=s-n),n=-1}else for(r+c>a&&(r=a-c),s=r;s>=0;s--){let r=!0;for(let n=0;n<c;n++)if(l(e,s+n)!==l(t,n)){r=!1;break}if(r)return s}return-1}function v(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const s=t.length;let o;for(n>s/2&&(n=s/2),o=0;o<n;++o){const n=parseInt(t.substr(2*o,2),16);if(Z(n))return o;e[r+o]=n}return o}function E(e,t,r,n){return Y(K(t,e.length-r),e,r,n)}function A(e,t,r,n){return Y(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function _(e,t,r,n){return Y(V(t),e,r,n)}function I(e,t,r,n){return Y(function(e,t){let r,n,i;const s=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)r=e.charCodeAt(o),n=r>>8,i=r%256,s.push(i),s.push(n);return s}(t,e.length-r),e,r,n)}function S(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function C(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let s=null,o=t>239?4:t>223?3:t>191?2:1;if(i+o<=r){let r,n,a,c;switch(o){case 1:t<128&&(s=t);break;case 2:r=e[i+1],128==(192&r)&&(c=(31&t)<<6|63&r,c>127&&(s=c));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(c=(15&t)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:r=e[i+1],n=e[i+2],a=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(s=c))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=o}return function(e){const t=e.length;if(t<=k)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=k));return r}(n)}t.kMaxLength=o,c.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,r){return l(e,t,r)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,r){return function(e,t,r){return u(e),e<=0?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)}(e,t,r)},c.allocUnsafe=function(e){return h(e)},c.allocUnsafeSlow=function(e){return h(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(G(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),G(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=c.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if(G(t,Uint8Array))i+t.length>n.length?(c.isBuffer(t)||(t=c.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!c.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},c.byteLength=g,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},c.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},c.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},c.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?C(this,0,e):m.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},s&&(c.prototype[s]=c.prototype.inspect),c.prototype.compare=function(e,t,r,n,i){if(G(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let s=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0);const a=Math.min(s,o),l=this.slice(n,i),u=e.slice(t,r);for(let e=0;e<a;++e)if(l[e]!==u[e]){s=l[e],o=u[e];break}return s<o?-1:o<s?1:0},c.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},c.prototype.indexOf=function(e,t,r){return w(this,e,t,r,!0)},c.prototype.lastIndexOf=function(e,t,r){return w(this,e,t,r,!1)},c.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let s=!1;for(;;)switch(n){case"hex":return v(this,e,t,r);case"utf8":case"utf-8":return E(this,e,t,r);case"ascii":case"latin1":case"binary":return A(this,e,t,r);case"base64":return _(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const k=4096;function N(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function x(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function T(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=J[e[n]];return i}function O(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function P(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,r,n,i,s){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function U(e,t,r,n,i){z(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,r}function B(e,t,r,n,i){z(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r+7]=s,s>>=8,e[r+6]=s,s>>=8,e[r+5]=s,s>>=8,e[r+4]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,o>>=8,e[r+2]=o,o>>=8,e[r+1]=o,o>>=8,e[r]=o,r+8}function M(e,t,r,n,i,s){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function L(e,t,r,n,s){return t=+t,r>>>=0,s||M(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function D(e,t,r,n,s){return t=+t,r>>>=0,s||M(e,0,r,8),i.write(e,t,r,n,52,8),r+8}c.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,c.prototype),n},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return n},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readBigUInt64LE=X(function(e){q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||F(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))}),c.prototype.readBigUInt64BE=X(function(e){q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||F(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)}),c.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);let n=t,i=1,s=this[e+--n];for(;n>0&&(i*=256);)s+=this[e+--n]*i;return i*=128,s>=i&&(s-=Math.pow(2,8*t)),s},c.prototype.readInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||P(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt16BE=function(e,t){e>>>=0,t||P(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readBigInt64LE=X(function(e){q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||F(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)}),c.prototype.readBigInt64BE=X(function(e){q(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||F(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)}),c.prototype.readFloatLE=function(e,t){return e>>>=0,t||P(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||P(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||P(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||P(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||R(this,e,t,r,Math.pow(2,8*r)-1,0);let i=1,s=0;for(this[t]=255&e;++s<r&&(i*=256);)this[t+s]=e/i&255;return t+r},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||R(this,e,t,r,Math.pow(2,8*r)-1,0);let i=r-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+r},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigUInt64LE=X(function(e,t=0){return U(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeBigUInt64BE=X(function(e,t=0){return B(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),c.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);R(this,e,t,r,n-1,-n)}let i=0,s=1,o=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s|0)-o&255;return t+r},c.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);R(this,e,t,r,n-1,-n)}let i=r-1,s=1,o=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s|0)-o&255;return t+r},c.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigInt64LE=X(function(e,t=0){return U(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeBigInt64BE=X(function(e,t=0){return B(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),c.prototype.writeFloatLE=function(e,t,r){return L(this,e,t,!0,r)},c.prototype.writeFloatBE=function(e,t,r){return L(this,e,t,!1,r)},c.prototype.writeDoubleLE=function(e,t,r){return D(this,e,t,!0,r)},c.prototype.writeDoubleBE=function(e,t,r){return D(this,e,t,!1,r)},c.prototype.copy=function(e,t,r,n){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},c.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const s=c.isBuffer(e)?e:c.from(e,n),o=s.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=s[i%o]}return this};const W={};function j(e,t,r){W[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function $(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function z(e,t,r,n,i,s){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=s>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(s+1)}${n}`:`>= -(2${n} ** ${8*(s+1)-1}${n}) and < 2 ** ${8*(s+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new W.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){q(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||F(t,e.length-(r+1))}(n,i,s)}function q(e,t){if("number"!=typeof e)throw new W.ERR_INVALID_ARG_TYPE(t,"number",e)}function F(e,t,r){if(Math.floor(e)!==e)throw q(e,r),new W.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new W.ERR_BUFFER_OUT_OF_BOUNDS;throw new W.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}j("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),j("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),j("ERR_OUT_OF_RANGE",function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=$(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=$(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n},RangeError);const H=/[^+/0-9A-Za-z-_]/g;function K(e,t){let r;t=t||1/0;const n=e.length;let i=null;const s=[];for(let o=0;o<n;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function V(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(H,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Y(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function G(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Z(e){return e!=e}const J=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function X(e){return"undefined"==typeof BigInt?Q:e}function Q(){throw new Error("BigInt not supported")}},8341:(e,t,r)=>{var n;r.d(t,{v4:()=>u});var i=new Uint8Array(16);function s(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(i)}const o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var a=[],c=0;c<256;++c)a.push((c+256).toString(16).substr(1));const l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&o.test(e)}(r))throw TypeError("Stringified UUID is invalid");return r},u=function(e,t,r){var n=(e=e||{}).random||(e.rng||s)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=n[i];return t}return l(n)}},8351:(e,t,r)=>{r.d(t,{R:()=>_});var n=r(8126),i=r(4707),s=r(3768),o=r(4376),a=r(6210),c=r(152),l=r(8075),u=r(4496),h=r(2944),d=r(6742),p=r(36),f=r(5940),g=r(3450),m=r(6056),y=r(1211),w=r(184),b=r(8508),v=r(1871);const E=(0,n.BX)({tokenBalances:[],loading:!1}),A={state:E,subscribe:e=>(0,n.B1)(E,()=>e(E)),subscribeKey:(e,t)=>(0,i.u$)(E,e,t),setToken(e){e&&(E.token=(0,n.KR)(e))},setTokenAmount(e){E.sendTokenAmount=e},setReceiverAddress(e){E.receiverAddress=e},setReceiverProfileImageUrl(e){E.receiverProfileImageUrl=e},setReceiverProfileName(e){E.receiverProfileName=e},setNetworkBalanceInUsd(e){E.networkBalanceInUSD=e},setLoading(e){E.loading=e},async sendToken(){try{switch(_.setLoading(!0),m.W.state.activeCaipNetwork?.chainNamespace){case"eip155":return void await _.sendEvmToken();case"solana":return void await _.sendSolanaToken();default:throw new Error("Unsupported chain")}}finally{_.setLoading(!1)}},async sendEvmToken(){const e=m.W.state.activeChain;if(!e)throw new Error("SendController:sendEvmToken - activeChainNamespace is required");const t=(0,u.lj)(e);if(!_.state.sendTokenAmount||!_.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!_.state.token)throw new Error("A token is required");_.state.token?.address?(w.E.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:t===c.Vl.ACCOUNT_TYPES.SMART_ACCOUNT,token:_.state.token.address,amount:_.state.sendTokenAmount,network:m.W.state.activeCaipNetwork?.caipNetworkId||""}}),await _.sendERC20Token({receiverAddress:_.state.receiverAddress,tokenAddress:_.state.token.address,sendTokenAmount:_.state.sendTokenAmount,decimals:_.state.token.quantity.decimals})):(w.E.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:t===c.Vl.ACCOUNT_TYPES.SMART_ACCOUNT,token:_.state.token.symbol||"",amount:_.state.sendTokenAmount,network:m.W.state.activeCaipNetwork?.caipNetworkId||""}}),await _.sendNativeToken({receiverAddress:_.state.receiverAddress,sendTokenAmount:_.state.sendTokenAmount,decimals:_.state.token.quantity.decimals}))},async fetchTokenBalance(e){E.loading=!0;const t=m.W.state.activeCaipNetwork?.caipNetworkId,r=m.W.state.activeCaipNetwork?.chainNamespace,n=m.W.state.activeCaipAddress,i=n?d.w.getPlainAddress(n):void 0;if(E.lastRetry&&!d.w.isAllowedRetry(E.lastRetry,30*h.oU.ONE_SEC_MS))return E.loading=!1,[];try{if(i&&t&&r){const e=await l.Z.getMyTokensWithBalance();return E.tokenBalances=e,E.lastRetry=void 0,e}}catch(t){E.lastRetry=Date.now(),e?.(t),v.P.showError("Token Balance Unavailable")}finally{E.loading=!1}return[]},fetchNetworkBalance(){if(0===E.tokenBalances.length)return;const e=p.s.mapBalancesToSwapTokens(E.tokenBalances);if(!e)return;const t=e.find(e=>e.address===(0,u.K1)());t&&(E.networkBalanceInUSD=t?s.S.multiply(t.quantity.numeric,t.price).toString():"0")},async sendNativeToken(e){b.I.pushTransactionStack({});const t=e.receiverAddress,r=g.U.state.address,n=y.x.parseUnits(e.sendTokenAmount.toString(),Number(e.decimals));await y.x.sendTransaction({chainNamespace:o.o.CHAIN.EVM,to:t,address:r,data:"0x",value:n??BigInt(0)}),w.E.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:(0,u.lj)("eip155")===c.Vl.ACCOUNT_TYPES.SMART_ACCOUNT,token:_.state.token?.symbol||"",amount:e.sendTokenAmount,network:m.W.state.activeCaipNetwork?.caipNetworkId||""}}),y.x._getClient()?.updateBalance("eip155"),_.resetSend()},async sendERC20Token(e){b.I.pushTransactionStack({onSuccess(){b.I.replace("Account")}});const t=y.x.parseUnits(e.sendTokenAmount.toString(),Number(e.decimals));if(g.U.state.address&&e.sendTokenAmount&&e.receiverAddress&&e.tokenAddress){const r=d.w.getPlainAddress(e.tokenAddress);if(!r)throw new Error("SendController:sendERC20Token - tokenAddress is required");await y.x.writeContract({fromAddress:g.U.state.address,tokenAddress:r,args:[e.receiverAddress,t??BigInt(0)],method:"transfer",abi:a.v.getERC20Abi(r),chainNamespace:o.o.CHAIN.EVM}),_.resetSend()}},async sendSolanaToken(){if(!_.state.sendTokenAmount||!_.state.receiverAddress)throw new Error("An amount and receiver address are required");b.I.pushTransactionStack({onSuccess(){b.I.replace("Account")}}),await y.x.sendTransaction({chainNamespace:"solana",to:_.state.receiverAddress,value:_.state.sendTokenAmount}),y.x._getClient()?.updateBalance("solana"),_.resetSend()},resetSend(){E.token=void 0,E.sendTokenAmount=void 0,E.receiverAddress=void 0,E.receiverProfileImageUrl=void 0,E.receiverProfileName=void 0,E.loading=!1,E.tokenBalances=[]}},_=(0,f.X)(A)},8442:(e,t,r)=>{r.d(t,{sc:()=>b,Zf:()=>v});var n=r(2531);function i(e,t,r){return e&t^~e&r}function s(e,t,r){return e&t^e&r^t&r}class o extends n.Vw{constructor(e,t,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(e),this.view=(0,n.O8)(this.buffer)}update(e){(0,n.CC)(this),e=(0,n.ZJ)(e),(0,n.DO)(e);const{view:t,buffer:r,blockLen:i}=this,s=e.length;for(let o=0;o<s;){const a=Math.min(i-this.pos,s-o);if(a===i){const t=(0,n.O8)(e);for(;i<=s-o;o+=i)this.process(t,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,n.CC)(this),(0,n.Ht)(e,this),this.finished=!0;const{buffer:t,view:r,blockLen:i,isLE:s}=this;let{pos:o}=this;t[o++]=128,(0,n.uH)(this.buffer.subarray(o)),this.padOffset>i-o&&(this.process(r,0),o=0);for(let e=o;e<i;e++)t[e]=0;!function(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,l=n?0:4;e.setUint32(t+c,o,n),e.setUint32(t+l,a,n)}(r,i-8,BigInt(8*this.length),s),this.process(r,0);const a=(0,n.O8)(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<l;e++)a.setUint32(4*e,u[e],s)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:r,length:n,finished:i,destroyed:s,pos:o}=this;return e.destroyed=s,e.finished=i,e.length=n,e.pos=o,n%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}const a=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),c=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);var l=r(9271);const u=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),h=new Uint32Array(64);class d extends o{constructor(e=32){super(64,e,8,!1),this.A=0|a[0],this.B=0|a[1],this.C=0|a[2],this.D=0|a[3],this.E=0|a[4],this.F=0|a[5],this.G=0|a[6],this.H=0|a[7]}get(){const{A:e,B:t,C:r,D:n,E:i,F:s,G:o,H:a}=this;return[e,t,r,n,i,s,o,a]}set(e,t,r,n,i,s,o,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|s,this.G=0|o,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)h[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=h[e-15],r=h[e-2],i=(0,n.Ow)(t,7)^(0,n.Ow)(t,18)^t>>>3,s=(0,n.Ow)(r,17)^(0,n.Ow)(r,19)^r>>>10;h[e]=s+h[e-7]+i+h[e-16]|0}let{A:r,B:o,C:a,D:c,E:l,F:d,G:p,H:f}=this;for(let e=0;e<64;e++){const t=f+((0,n.Ow)(l,6)^(0,n.Ow)(l,11)^(0,n.Ow)(l,25))+i(l,d,p)+u[e]+h[e]|0,g=((0,n.Ow)(r,2)^(0,n.Ow)(r,13)^(0,n.Ow)(r,22))+s(r,o,a)|0;f=p,p=d,d=l,l=c+t|0,c=a,a=o,o=r,r=t+g|0}r=r+this.A|0,o=o+this.B|0,a=a+this.C|0,c=c+this.D|0,l=l+this.E|0,d=d+this.F|0,p=p+this.G|0,f=f+this.H|0,this.set(r,o,a,c,l,d,p,f)}roundClean(){(0,n.uH)(h)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,n.uH)(this.buffer)}}const p=(()=>l.lD(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))))(),f=(()=>p[0])(),g=(()=>p[1])(),m=new Uint32Array(80),y=new Uint32Array(80);class w extends o{constructor(e=64){super(128,e,16,!1),this.Ah=0|c[0],this.Al=0|c[1],this.Bh=0|c[2],this.Bl=0|c[3],this.Ch=0|c[4],this.Cl=0|c[5],this.Dh=0|c[6],this.Dl=0|c[7],this.Eh=0|c[8],this.El=0|c[9],this.Fh=0|c[10],this.Fl=0|c[11],this.Gh=0|c[12],this.Gl=0|c[13],this.Hh=0|c[14],this.Hl=0|c[15]}get(){const{Ah:e,Al:t,Bh:r,Bl:n,Ch:i,Cl:s,Dh:o,Dl:a,Eh:c,El:l,Fh:u,Fl:h,Gh:d,Gl:p,Hh:f,Hl:g}=this;return[e,t,r,n,i,s,o,a,c,l,u,h,d,p,f,g]}set(e,t,r,n,i,s,o,a,c,l,u,h,d,p,f,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|s,this.Dh=0|o,this.Dl=0|a,this.Eh=0|c,this.El=0|l,this.Fh=0|u,this.Fl=0|h,this.Gh=0|d,this.Gl=0|p,this.Hh=0|f,this.Hl=0|g}process(e,t){for(let r=0;r<16;r++,t+=4)m[r]=e.getUint32(t),y[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|m[e-15],r=0|y[e-15],n=l.rE(t,r,1)^l.rE(t,r,8)^l.xn(t,r,7),i=l.ry(t,r,1)^l.ry(t,r,8)^l.jm(t,r,7),s=0|m[e-2],o=0|y[e-2],a=l.rE(s,o,19)^l.qh(s,o,61)^l.xn(s,o,6),c=l.ry(s,o,19)^l.Ei(s,o,61)^l.jm(s,o,6),u=l.CW(i,c,y[e-7],y[e-16]),h=l.CQ(u,n,a,m[e-7],m[e-16]);m[e]=0|h,y[e]=0|u}let{Ah:r,Al:n,Bh:i,Bl:s,Ch:o,Cl:a,Dh:c,Dl:u,Eh:h,El:d,Fh:p,Fl:w,Gh:b,Gl:v,Hh:E,Hl:A}=this;for(let e=0;e<80;e++){const t=l.rE(h,d,14)^l.rE(h,d,18)^l.qh(h,d,41),_=l.ry(h,d,14)^l.ry(h,d,18)^l.Ei(h,d,41),I=h&p^~h&b,S=d&w^~d&v,C=l.F8(A,_,S,g[e],y[e]),k=l.TH(C,E,t,I,f[e],m[e]),N=0|C,x=l.rE(r,n,28)^l.qh(r,n,34)^l.qh(r,n,39),T=l.ry(r,n,28)^l.Ei(r,n,34)^l.Ei(r,n,39),O=r&i^r&o^i&o,P=n&s^n&a^s&a;E=0|b,A=0|v,b=0|p,v=0|w,p=0|h,w=0|d,({h,l:d}=l.WQ(0|c,0|u,0|k,0|N)),c=0|o,u=0|a,o=0|i,a=0|s,i=0|r,s=0|n;const R=l.Vl(N,T,P);r=l.Vr(R,k,x,O),n=0|R}({h:r,l:n}=l.WQ(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:s}=l.WQ(0|this.Bh,0|this.Bl,0|i,0|s)),({h:o,l:a}=l.WQ(0|this.Ch,0|this.Cl,0|o,0|a)),({h:c,l:u}=l.WQ(0|this.Dh,0|this.Dl,0|c,0|u)),({h,l:d}=l.WQ(0|this.Eh,0|this.El,0|h,0|d)),({h:p,l:w}=l.WQ(0|this.Fh,0|this.Fl,0|p,0|w)),({h:b,l:v}=l.WQ(0|this.Gh,0|this.Gl,0|b,0|v)),({h:E,l:A}=l.WQ(0|this.Hh,0|this.Hl,0|E,0|A)),this.set(r,n,i,s,o,a,c,u,h,d,p,w,b,v,E,A)}roundClean(){(0,n.uH)(m,y)}destroy(){(0,n.uH)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const b=(0,n.qj)(()=>new d),v=(0,n.qj)(()=>new w)},8467:(e,t,r)=>{r.d(t,{z:()=>o});var n=r(8126),i=r(4707);const s=(0,n.BX)({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),o={state:s,subscribe:e=>(0,n.B1)(s,()=>e(s)),subscribeOpen:e=>(0,i.u$)(s,"open",e),set(e){Object.assign(s,{...s,...e})}}},8508:(e,t,r)=>{r.d(t,{I:()=>p});var n=r(8126),i=r(4707),s=r(5940),o=r(3450),a=r(6056),c=r(6010),l=r(6396),u=r(2733);const h=(0,n.BX)({view:"Connect",history:["Connect"],transactionStack:[]}),d={state:h,subscribeKey:(e,t)=>(0,i.u$)(h,e,t),pushTransactionStack(e){h.transactionStack.push(e)},popTransactionStack(e){const t=h.transactionStack.pop();if(!t)return;const{onSuccess:r,onError:n,onCancel:i}=t;switch(e){case"success":r?.();break;case"error":n?.(),p.goBack();break;case"cancel":i?.(),p.goBack()}},push(e,t){e!==h.view&&(h.view=e,h.history.push(e),h.data=t)},reset(e,t){h.view=e,h.history=[e],h.data=t},replace(e,t){h.history.at(-1)===e||(h.view=e,h.history[h.history.length-1]=e,h.data=t)},goBack(){const e=a.W.state.activeCaipAddress,t="ConnectingFarcaster"===p.state.view,r=!e&&t;if(h.history.length>1){h.history.pop();const[t]=h.history.slice(-1);if(t){const r="Connect"===t;h.view=e&&r?"Account":t}}else l.W.close();h.data?.wallet&&(h.data.wallet=void 0),setTimeout(()=>{if(r){o.U.setFarcasterUrl(void 0,a.W.state.activeChain);const e=c.a.getAuthConnector();e?.provider?.reload();const t=(0,n.P9)(u.H.state);e?.provider?.syncDappData?.({metadata:t.metadata,sdkVersion:t.sdkVersion,projectId:t.projectId,sdkType:t.sdkType})}},100)},goBackToIndex(e){if(h.history.length>1){h.history=h.history.slice(0,e+1);const[t]=h.history.slice(-1);t&&(h.view=t)}},goBackOrCloseModal(){p.state.history.length>1?p.goBack():l.W.close()}},p=(0,s.X)(d)},8577:(e,t,r)=>{r.d(t,{b:()=>o});var n=r(1211),i=r(6010),s=r(2733);const o={getConnectionStatus(e,t){const r=i.a.state.activeConnectorIds[t],s=n.x.getConnections(t);return Boolean(r)&&e.connectorId===r?"connected":s.some(t=>t.connectorId.toLowerCase()===e.connectorId.toLowerCase())?"active":"disconnected"},excludeConnectorAddressFromConnections:({connections:e,connectorId:t,addresses:r})=>e.map(e=>{if(t&&e.connectorId.toLowerCase()===t.toLowerCase()&&r){const t=e.accounts.filter(e=>!r.some(t=>t.toLowerCase()===e.address.toLowerCase()));return{...e,accounts:t}}return e}),excludeExistingConnections(e,t){const r=new Set(e);return t.filter(e=>!r.has(e.connectorId))},getConnectionsByConnectorId:(e,t)=>e.filter(e=>e.connectorId.toLowerCase()===t.toLowerCase()),getConnectionsData(e){const t=Boolean(s.H.state.remoteFeatures?.multiWallet),r=i.a.state.activeConnectorIds[e],a=n.x.getConnections(e),c=(n.x.state.recentConnections.get(e)??[]).filter(e=>i.a.getConnectorById(e.connectorId)),l=o.excludeExistingConnections([...a.map(e=>e.connectorId),...r?[r]:[]],c);return t?{connections:a,recentConnections:l}:{connections:a.filter(e=>e.connectorId.toLowerCase()===r?.toLowerCase()),recentConnections:[]}}}},8751:(e,t,r)=>{r.d(t,{L:()=>c});var n=r(4376),i=r(3450),s=r(6056),o=r(6010),a=r(8508);const c={onSwitchNetwork({network:e,ignoreSwitchConfirmation:t=!1}){const r=s.W.state.activeCaipNetwork,c=a.I.state.data;if(e.id===r?.id)return;const l=i.U.getCaipAddress(s.W.state.activeChain),u=e.chainNamespace!==s.W.state.activeChain,h=i.U.getCaipAddress(e.chainNamespace),d=o.a.getConnectorId(s.W.state.activeChain)===n.o.CONNECTOR_ID.AUTH,p=n.o.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(t=>t===e.chainNamespace);t||d&&p?a.I.push("SwitchNetwork",{...c,network:e}):l&&u&&!h?a.I.push("SwitchActiveChain",{switchToChain:e.chainNamespace,navigateTo:"Connect",navigateWithReplace:!0,network:e}):a.I.push("SwitchNetwork",{...c,network:e})}}},8900:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(5215);n.__exportStar(r(9606),t),n.__exportStar(r(9883),t),n.__exportStar(r(2010),t),n.__exportStar(r(9026),t)},8990:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(8126),i=r(4707);const s={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0,sui:void 0,stacks:void 0},o=(0,n.BX)({providers:{...s},providerIds:{...s}}),a={state:o,subscribeKey:(e,t)=>(0,i.u$)(o,e,t),subscribe:e=>(0,n.B1)(o,()=>{e(o)}),subscribeProviders:e=>(0,n.B1)(o.providers,()=>e(o.providers)),setProvider(e,t){e&&t&&(o.providers[e]=(0,n.KR)(t))},getProvider(e){if(e)return o.providers[e]},setProviderId(e,t){t&&(o.providerIds[e]=t)},getProviderId(e){if(e)return o.providerIds[e]},reset(){o.providers={...s},o.providerIds={...s}},resetChain(e){o.providers[e]=void 0,o.providerIds[e]=void 0}}},8996:(e,t,r)=>{r.d(t,{W:()=>l});var n=r(8126),i=r(3096),s=r(5940),o=r(6010);const a=(0,n.BX)({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),c={state:a,subscribe:e=>(0,n.B1)(a,()=>e(a)),setThemeMode(e){a.themeMode=e;try{const t=o.a.getAuthConnector();if(t){const r=c.getSnapshot().themeVariables;t.provider.syncTheme({themeMode:e,themeVariables:r,w3mThemeVariables:(0,i.o)(r,e)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(e){a.themeVariables={...a.themeVariables,...e};try{const e=o.a.getAuthConnector();if(e){const t=c.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:t,w3mThemeVariables:(0,i.o)(a.themeVariables,a.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot:()=>(0,n.P9)(a)},l=(0,s.X)(c)},9026:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(5215);n.__exportStar(r(9244),t),n.__exportStar(r(1861),t)},9244:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_THOUSAND=t.ONE_HUNDRED=void 0,t.ONE_HUNDRED=100,t.ONE_THOUSAND=1e3},9271:(e,t,r)=>{r.d(t,{B4:()=>f,CQ:()=>E,CW:()=>v,Ei:()=>d,F8:()=>A,P5:()=>p,TH:()=>_,Vl:()=>w,Vr:()=>b,WM:()=>g,WQ:()=>y,im:()=>m,jm:()=>c,lD:()=>o,qh:()=>h,rE:()=>l,ry:()=>u,xn:()=>a});const n=BigInt(2**32-1),i=BigInt(32);function s(e,t=!1){return t?{h:Number(e&n),l:Number(e>>i&n)}:{h:0|Number(e>>i&n),l:0|Number(e&n)}}function o(e,t=!1){const r=e.length;let n=new Uint32Array(r),i=new Uint32Array(r);for(let o=0;o<r;o++){const{h:r,l:a}=s(e[o],t);[n[o],i[o]]=[r,a]}return[n,i]}const a=(e,t,r)=>e>>>r,c=(e,t,r)=>e<<32-r|t>>>r,l=(e,t,r)=>e>>>r|t<<32-r,u=(e,t,r)=>e<<32-r|t>>>r,h=(e,t,r)=>e<<64-r|t>>>r-32,d=(e,t,r)=>e>>>r-32|t<<64-r,p=(e,t,r)=>e<<r|t>>>32-r,f=(e,t,r)=>t<<r|e>>>32-r,g=(e,t,r)=>t<<r-32|e>>>64-r,m=(e,t,r)=>e<<r-32|t>>>64-r;function y(e,t,r,n){const i=(t>>>0)+(n>>>0);return{h:e+r+(i/2**32|0)|0,l:0|i}}const w=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),b=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,v=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),E=(e,t,r,n,i)=>t+r+n+i+(e/2**32|0)|0,A=(e,t,r,n,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0),_=(e,t,r,n,i,s)=>t+r+n+i+s+(e/2**32|0)|0},9404:function(e,t,r){!function(e,t){function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function s(e,t,r){if(s.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}var o;"object"==typeof e?e.exports=s:t.BN=s,s.BN=s,s.wordSize=26;try{o="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:r(7790).Buffer}catch(e){}function a(e,t){var r=e.charCodeAt(t);return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:void n(!1,"Invalid character in "+e)}function c(e,t,r){var n=a(e,r);return r-1>=t&&(n|=a(e,r-1)<<4),n}function l(e,t,r,i){for(var s=0,o=0,a=Math.min(e.length,r),c=t;c<a;c++){var l=e.charCodeAt(c)-48;s*=i,o=l>=49?l-49+10:l>=17?l-17+10:l,n(l>=0&&o<i,"Invalid character"),s+=o}return s}function u(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}if(s.isBN=function(e){return e instanceof s||null!==e&&"object"==typeof e&&e.constructor.wordSize===s.wordSize&&Array.isArray(e.words)},s.max=function(e,t){return e.cmp(t)>0?e:t},s.min=function(e,t){return e.cmp(t)<0?e:t},s.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,r):(this._parseBase(e,t,i),"le"===r&&this._initArray(this.toArray(),t,r)))},s.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},s.prototype._initArray=function(e,t,r){if(n("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var s,o,a=0;if("be"===r)for(i=e.length-1,s=0;i>=0;i-=3)o=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);else if("le"===r)for(i=0,s=0;i<e.length;i+=3)o=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);return this._strip()},s.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,s=0,o=0;if("be"===r)for(n=e.length-1;n>=t;n-=2)i=c(e,t,n)<<s,this.words[o]|=67108863&i,s>=18?(s-=18,o+=1,this.words[o]|=i>>>26):s+=8;else for(n=(e.length-t)%2==0?t+1:t;n<e.length;n+=2)i=c(e,t,n)<<s,this.words[o]|=67108863&i,s>=18?(s-=18,o+=1,this.words[o]|=i>>>26):s+=8;this._strip()},s.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var n=0,i=1;i<=67108863;i*=t)n++;n--,i=i/t|0;for(var s=e.length-r,o=s%n,a=Math.min(s,s-o)+r,c=0,u=r;u<a;u+=n)c=l(e,u,u+n,t),this.imuln(i),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==o){var h=1;for(c=l(e,u,e.length,t),u=0;u<o;u++)h*=t;this.imuln(h),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}this._strip()},s.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},s.prototype._move=function(e){u(e,this)},s.prototype.clone=function(){var e=new s(null);return this.copy(e),e},s.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},s.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},s.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=h}catch(e){s.prototype.inspect=h}else s.prototype.inspect=h;function h(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],p=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],f=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function g(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0;r.length=n,n=n-1|0;var i=0|e.words[0],s=0|t.words[0],o=i*s,a=67108863&o,c=o/67108864|0;r.words[0]=a;for(var l=1;l<n;l++){for(var u=c>>>26,h=67108863&c,d=Math.min(l,t.length-1),p=Math.max(0,l-e.length+1);p<=d;p++){var f=l-p|0;u+=(o=(i=0|e.words[f])*(s=0|t.words[p])+h)/67108864|0,h=67108863&o}r.words[l]=0|h,c=0|u}return 0!==c?r.words[l]=0|c:r.length--,r._strip()}s.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var i=0,s=0,o=0;o<this.length;o++){var a=this.words[o],c=(16777215&(a<<i|s)).toString(16);s=a>>>24-i&16777215,(i+=2)>=26&&(i-=26,o--),r=0!==s||o!==this.length-1?d[6-c.length]+c+r:c+r}for(0!==s&&(r=s.toString(16)+r);r.length%t!==0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var l=p[e],u=f[e];r="";var h=this.clone();for(h.negative=0;!h.isZero();){var g=h.modrn(u).toString(e);r=(h=h.idivn(u)).isZero()?g+r:d[l-g.length]+g+r}for(this.isZero()&&(r="0"+r);r.length%t!==0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},s.prototype.toJSON=function(){return this.toString(16,2)},o&&(s.prototype.toBuffer=function(e,t){return this.toArrayLike(o,e,t)}),s.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},s.prototype.toArrayLike=function(e,t,r){this._strip();var i=this.byteLength(),s=r||Math.max(1,i);n(i<=s,"byte array longer than desired length"),n(s>0,"Requested array length <= 0");var o=function(e,t){return e.allocUnsafe?e.allocUnsafe(t):new e(t)}(e,s);return this["_toArrayLike"+("le"===t?"LE":"BE")](o,i),o},s.prototype._toArrayLikeLE=function(e,t){for(var r=0,n=0,i=0,s=0;i<this.length;i++){var o=this.words[i]<<s|n;e[r++]=255&o,r<e.length&&(e[r++]=o>>8&255),r<e.length&&(e[r++]=o>>16&255),6===s?(r<e.length&&(e[r++]=o>>24&255),n=0,s=0):(n=o>>>24,s+=2)}if(r<e.length)for(e[r++]=n;r<e.length;)e[r++]=0},s.prototype._toArrayLikeBE=function(e,t){for(var r=e.length-1,n=0,i=0,s=0;i<this.length;i++){var o=this.words[i]<<s|n;e[r--]=255&o,r>=0&&(e[r--]=o>>8&255),r>=0&&(e[r--]=o>>16&255),6===s?(r>=0&&(e[r--]=o>>24&255),n=0,s=0):(n=o>>>24,s+=2)}if(r>=0)for(e[r--]=n;r>=0;)e[r--]=0},Math.clz32?s.prototype._countBits=function(e){return 32-Math.clz32(e)}:s.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},s.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return 8191&t||(r+=13,t>>>=13),127&t||(r+=7,t>>>=7),15&t||(r+=4,t>>>=4),3&t||(r+=2,t>>>=2),1&t||r++,r},s.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},s.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return 0!==this.negative},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},s.prototype.ior=function(e){return n(0===(this.negative|e.negative)),this.iuor(e)},s.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},s.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},s.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this._strip()},s.prototype.iand=function(e){return n(0===(this.negative|e.negative)),this.iuand(e)},s.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},s.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},s.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var n=0;n<r.length;n++)this.words[n]=t.words[n]^r.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this._strip()},s.prototype.ixor=function(e){return n(0===(this.negative|e.negative)),this.iuxor(e)},s.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},s.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},s.prototype.inotn=function(e){n("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this._strip()},s.prototype.notn=function(e){return this.clone().inotn(e)},s.prototype.setn=function(e,t){n("number"==typeof e&&e>=0);var r=e/26|0,i=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<i:this.words[r]&~(1<<i),this._strip()},s.prototype.iadd=function(e){var t,r,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,n=e):(r=e,n=this);for(var i=0,s=0;s<n.length;s++)t=(0|r.words[s])+(0|n.words[s])+i,this.words[s]=67108863&t,i=t>>>26;for(;0!==i&&s<r.length;s++)t=(0|r.words[s])+i,this.words[s]=67108863&t,i=t>>>26;if(this.length=r.length,0!==i)this.words[this.length]=i,this.length++;else if(r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this},s.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},s.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,n,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(r=this,n=e):(r=e,n=this);for(var s=0,o=0;o<n.length;o++)s=(t=(0|r.words[o])-(0|n.words[o])+s)>>26,this.words[o]=67108863&t;for(;0!==s&&o<r.length;o++)s=(t=(0|r.words[o])+s)>>26,this.words[o]=67108863&t;if(0===s&&o<r.length&&r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this.length=Math.max(this.length,o),r!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(e){return this.clone().isub(e)};var m=function(e,t,r){var n,i,s,o=e.words,a=t.words,c=r.words,l=0,u=0|o[0],h=8191&u,d=u>>>13,p=0|o[1],f=8191&p,g=p>>>13,m=0|o[2],y=8191&m,w=m>>>13,b=0|o[3],v=8191&b,E=b>>>13,A=0|o[4],_=8191&A,I=A>>>13,S=0|o[5],C=8191&S,k=S>>>13,N=0|o[6],x=8191&N,T=N>>>13,O=0|o[7],P=8191&O,R=O>>>13,U=0|o[8],B=8191&U,M=U>>>13,L=0|o[9],D=8191&L,W=L>>>13,j=0|a[0],$=8191&j,z=j>>>13,q=0|a[1],F=8191&q,H=q>>>13,K=0|a[2],V=8191&K,Y=K>>>13,G=0|a[3],Z=8191&G,J=G>>>13,X=0|a[4],Q=8191&X,ee=X>>>13,te=0|a[5],re=8191&te,ne=te>>>13,ie=0|a[6],se=8191&ie,oe=ie>>>13,ae=0|a[7],ce=8191&ae,le=ae>>>13,ue=0|a[8],he=8191&ue,de=ue>>>13,pe=0|a[9],fe=8191&pe,ge=pe>>>13;r.negative=e.negative^t.negative,r.length=19;var me=(l+(n=Math.imul(h,$))|0)+((8191&(i=(i=Math.imul(h,z))+Math.imul(d,$)|0))<<13)|0;l=((s=Math.imul(d,z))+(i>>>13)|0)+(me>>>26)|0,me&=67108863,n=Math.imul(f,$),i=(i=Math.imul(f,z))+Math.imul(g,$)|0,s=Math.imul(g,z);var ye=(l+(n=n+Math.imul(h,F)|0)|0)+((8191&(i=(i=i+Math.imul(h,H)|0)+Math.imul(d,F)|0))<<13)|0;l=((s=s+Math.imul(d,H)|0)+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(y,$),i=(i=Math.imul(y,z))+Math.imul(w,$)|0,s=Math.imul(w,z),n=n+Math.imul(f,F)|0,i=(i=i+Math.imul(f,H)|0)+Math.imul(g,F)|0,s=s+Math.imul(g,H)|0;var we=(l+(n=n+Math.imul(h,V)|0)|0)+((8191&(i=(i=i+Math.imul(h,Y)|0)+Math.imul(d,V)|0))<<13)|0;l=((s=s+Math.imul(d,Y)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(v,$),i=(i=Math.imul(v,z))+Math.imul(E,$)|0,s=Math.imul(E,z),n=n+Math.imul(y,F)|0,i=(i=i+Math.imul(y,H)|0)+Math.imul(w,F)|0,s=s+Math.imul(w,H)|0,n=n+Math.imul(f,V)|0,i=(i=i+Math.imul(f,Y)|0)+Math.imul(g,V)|0,s=s+Math.imul(g,Y)|0;var be=(l+(n=n+Math.imul(h,Z)|0)|0)+((8191&(i=(i=i+Math.imul(h,J)|0)+Math.imul(d,Z)|0))<<13)|0;l=((s=s+Math.imul(d,J)|0)+(i>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(_,$),i=(i=Math.imul(_,z))+Math.imul(I,$)|0,s=Math.imul(I,z),n=n+Math.imul(v,F)|0,i=(i=i+Math.imul(v,H)|0)+Math.imul(E,F)|0,s=s+Math.imul(E,H)|0,n=n+Math.imul(y,V)|0,i=(i=i+Math.imul(y,Y)|0)+Math.imul(w,V)|0,s=s+Math.imul(w,Y)|0,n=n+Math.imul(f,Z)|0,i=(i=i+Math.imul(f,J)|0)+Math.imul(g,Z)|0,s=s+Math.imul(g,J)|0;var ve=(l+(n=n+Math.imul(h,Q)|0)|0)+((8191&(i=(i=i+Math.imul(h,ee)|0)+Math.imul(d,Q)|0))<<13)|0;l=((s=s+Math.imul(d,ee)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(C,$),i=(i=Math.imul(C,z))+Math.imul(k,$)|0,s=Math.imul(k,z),n=n+Math.imul(_,F)|0,i=(i=i+Math.imul(_,H)|0)+Math.imul(I,F)|0,s=s+Math.imul(I,H)|0,n=n+Math.imul(v,V)|0,i=(i=i+Math.imul(v,Y)|0)+Math.imul(E,V)|0,s=s+Math.imul(E,Y)|0,n=n+Math.imul(y,Z)|0,i=(i=i+Math.imul(y,J)|0)+Math.imul(w,Z)|0,s=s+Math.imul(w,J)|0,n=n+Math.imul(f,Q)|0,i=(i=i+Math.imul(f,ee)|0)+Math.imul(g,Q)|0,s=s+Math.imul(g,ee)|0;var Ee=(l+(n=n+Math.imul(h,re)|0)|0)+((8191&(i=(i=i+Math.imul(h,ne)|0)+Math.imul(d,re)|0))<<13)|0;l=((s=s+Math.imul(d,ne)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(x,$),i=(i=Math.imul(x,z))+Math.imul(T,$)|0,s=Math.imul(T,z),n=n+Math.imul(C,F)|0,i=(i=i+Math.imul(C,H)|0)+Math.imul(k,F)|0,s=s+Math.imul(k,H)|0,n=n+Math.imul(_,V)|0,i=(i=i+Math.imul(_,Y)|0)+Math.imul(I,V)|0,s=s+Math.imul(I,Y)|0,n=n+Math.imul(v,Z)|0,i=(i=i+Math.imul(v,J)|0)+Math.imul(E,Z)|0,s=s+Math.imul(E,J)|0,n=n+Math.imul(y,Q)|0,i=(i=i+Math.imul(y,ee)|0)+Math.imul(w,Q)|0,s=s+Math.imul(w,ee)|0,n=n+Math.imul(f,re)|0,i=(i=i+Math.imul(f,ne)|0)+Math.imul(g,re)|0,s=s+Math.imul(g,ne)|0;var Ae=(l+(n=n+Math.imul(h,se)|0)|0)+((8191&(i=(i=i+Math.imul(h,oe)|0)+Math.imul(d,se)|0))<<13)|0;l=((s=s+Math.imul(d,oe)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(P,$),i=(i=Math.imul(P,z))+Math.imul(R,$)|0,s=Math.imul(R,z),n=n+Math.imul(x,F)|0,i=(i=i+Math.imul(x,H)|0)+Math.imul(T,F)|0,s=s+Math.imul(T,H)|0,n=n+Math.imul(C,V)|0,i=(i=i+Math.imul(C,Y)|0)+Math.imul(k,V)|0,s=s+Math.imul(k,Y)|0,n=n+Math.imul(_,Z)|0,i=(i=i+Math.imul(_,J)|0)+Math.imul(I,Z)|0,s=s+Math.imul(I,J)|0,n=n+Math.imul(v,Q)|0,i=(i=i+Math.imul(v,ee)|0)+Math.imul(E,Q)|0,s=s+Math.imul(E,ee)|0,n=n+Math.imul(y,re)|0,i=(i=i+Math.imul(y,ne)|0)+Math.imul(w,re)|0,s=s+Math.imul(w,ne)|0,n=n+Math.imul(f,se)|0,i=(i=i+Math.imul(f,oe)|0)+Math.imul(g,se)|0,s=s+Math.imul(g,oe)|0;var _e=(l+(n=n+Math.imul(h,ce)|0)|0)+((8191&(i=(i=i+Math.imul(h,le)|0)+Math.imul(d,ce)|0))<<13)|0;l=((s=s+Math.imul(d,le)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(B,$),i=(i=Math.imul(B,z))+Math.imul(M,$)|0,s=Math.imul(M,z),n=n+Math.imul(P,F)|0,i=(i=i+Math.imul(P,H)|0)+Math.imul(R,F)|0,s=s+Math.imul(R,H)|0,n=n+Math.imul(x,V)|0,i=(i=i+Math.imul(x,Y)|0)+Math.imul(T,V)|0,s=s+Math.imul(T,Y)|0,n=n+Math.imul(C,Z)|0,i=(i=i+Math.imul(C,J)|0)+Math.imul(k,Z)|0,s=s+Math.imul(k,J)|0,n=n+Math.imul(_,Q)|0,i=(i=i+Math.imul(_,ee)|0)+Math.imul(I,Q)|0,s=s+Math.imul(I,ee)|0,n=n+Math.imul(v,re)|0,i=(i=i+Math.imul(v,ne)|0)+Math.imul(E,re)|0,s=s+Math.imul(E,ne)|0,n=n+Math.imul(y,se)|0,i=(i=i+Math.imul(y,oe)|0)+Math.imul(w,se)|0,s=s+Math.imul(w,oe)|0,n=n+Math.imul(f,ce)|0,i=(i=i+Math.imul(f,le)|0)+Math.imul(g,ce)|0,s=s+Math.imul(g,le)|0;var Ie=(l+(n=n+Math.imul(h,he)|0)|0)+((8191&(i=(i=i+Math.imul(h,de)|0)+Math.imul(d,he)|0))<<13)|0;l=((s=s+Math.imul(d,de)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(D,$),i=(i=Math.imul(D,z))+Math.imul(W,$)|0,s=Math.imul(W,z),n=n+Math.imul(B,F)|0,i=(i=i+Math.imul(B,H)|0)+Math.imul(M,F)|0,s=s+Math.imul(M,H)|0,n=n+Math.imul(P,V)|0,i=(i=i+Math.imul(P,Y)|0)+Math.imul(R,V)|0,s=s+Math.imul(R,Y)|0,n=n+Math.imul(x,Z)|0,i=(i=i+Math.imul(x,J)|0)+Math.imul(T,Z)|0,s=s+Math.imul(T,J)|0,n=n+Math.imul(C,Q)|0,i=(i=i+Math.imul(C,ee)|0)+Math.imul(k,Q)|0,s=s+Math.imul(k,ee)|0,n=n+Math.imul(_,re)|0,i=(i=i+Math.imul(_,ne)|0)+Math.imul(I,re)|0,s=s+Math.imul(I,ne)|0,n=n+Math.imul(v,se)|0,i=(i=i+Math.imul(v,oe)|0)+Math.imul(E,se)|0,s=s+Math.imul(E,oe)|0,n=n+Math.imul(y,ce)|0,i=(i=i+Math.imul(y,le)|0)+Math.imul(w,ce)|0,s=s+Math.imul(w,le)|0,n=n+Math.imul(f,he)|0,i=(i=i+Math.imul(f,de)|0)+Math.imul(g,he)|0,s=s+Math.imul(g,de)|0;var Se=(l+(n=n+Math.imul(h,fe)|0)|0)+((8191&(i=(i=i+Math.imul(h,ge)|0)+Math.imul(d,fe)|0))<<13)|0;l=((s=s+Math.imul(d,ge)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(D,F),i=(i=Math.imul(D,H))+Math.imul(W,F)|0,s=Math.imul(W,H),n=n+Math.imul(B,V)|0,i=(i=i+Math.imul(B,Y)|0)+Math.imul(M,V)|0,s=s+Math.imul(M,Y)|0,n=n+Math.imul(P,Z)|0,i=(i=i+Math.imul(P,J)|0)+Math.imul(R,Z)|0,s=s+Math.imul(R,J)|0,n=n+Math.imul(x,Q)|0,i=(i=i+Math.imul(x,ee)|0)+Math.imul(T,Q)|0,s=s+Math.imul(T,ee)|0,n=n+Math.imul(C,re)|0,i=(i=i+Math.imul(C,ne)|0)+Math.imul(k,re)|0,s=s+Math.imul(k,ne)|0,n=n+Math.imul(_,se)|0,i=(i=i+Math.imul(_,oe)|0)+Math.imul(I,se)|0,s=s+Math.imul(I,oe)|0,n=n+Math.imul(v,ce)|0,i=(i=i+Math.imul(v,le)|0)+Math.imul(E,ce)|0,s=s+Math.imul(E,le)|0,n=n+Math.imul(y,he)|0,i=(i=i+Math.imul(y,de)|0)+Math.imul(w,he)|0,s=s+Math.imul(w,de)|0;var Ce=(l+(n=n+Math.imul(f,fe)|0)|0)+((8191&(i=(i=i+Math.imul(f,ge)|0)+Math.imul(g,fe)|0))<<13)|0;l=((s=s+Math.imul(g,ge)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,n=Math.imul(D,V),i=(i=Math.imul(D,Y))+Math.imul(W,V)|0,s=Math.imul(W,Y),n=n+Math.imul(B,Z)|0,i=(i=i+Math.imul(B,J)|0)+Math.imul(M,Z)|0,s=s+Math.imul(M,J)|0,n=n+Math.imul(P,Q)|0,i=(i=i+Math.imul(P,ee)|0)+Math.imul(R,Q)|0,s=s+Math.imul(R,ee)|0,n=n+Math.imul(x,re)|0,i=(i=i+Math.imul(x,ne)|0)+Math.imul(T,re)|0,s=s+Math.imul(T,ne)|0,n=n+Math.imul(C,se)|0,i=(i=i+Math.imul(C,oe)|0)+Math.imul(k,se)|0,s=s+Math.imul(k,oe)|0,n=n+Math.imul(_,ce)|0,i=(i=i+Math.imul(_,le)|0)+Math.imul(I,ce)|0,s=s+Math.imul(I,le)|0,n=n+Math.imul(v,he)|0,i=(i=i+Math.imul(v,de)|0)+Math.imul(E,he)|0,s=s+Math.imul(E,de)|0;var ke=(l+(n=n+Math.imul(y,fe)|0)|0)+((8191&(i=(i=i+Math.imul(y,ge)|0)+Math.imul(w,fe)|0))<<13)|0;l=((s=s+Math.imul(w,ge)|0)+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(D,Z),i=(i=Math.imul(D,J))+Math.imul(W,Z)|0,s=Math.imul(W,J),n=n+Math.imul(B,Q)|0,i=(i=i+Math.imul(B,ee)|0)+Math.imul(M,Q)|0,s=s+Math.imul(M,ee)|0,n=n+Math.imul(P,re)|0,i=(i=i+Math.imul(P,ne)|0)+Math.imul(R,re)|0,s=s+Math.imul(R,ne)|0,n=n+Math.imul(x,se)|0,i=(i=i+Math.imul(x,oe)|0)+Math.imul(T,se)|0,s=s+Math.imul(T,oe)|0,n=n+Math.imul(C,ce)|0,i=(i=i+Math.imul(C,le)|0)+Math.imul(k,ce)|0,s=s+Math.imul(k,le)|0,n=n+Math.imul(_,he)|0,i=(i=i+Math.imul(_,de)|0)+Math.imul(I,he)|0,s=s+Math.imul(I,de)|0;var Ne=(l+(n=n+Math.imul(v,fe)|0)|0)+((8191&(i=(i=i+Math.imul(v,ge)|0)+Math.imul(E,fe)|0))<<13)|0;l=((s=s+Math.imul(E,ge)|0)+(i>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,n=Math.imul(D,Q),i=(i=Math.imul(D,ee))+Math.imul(W,Q)|0,s=Math.imul(W,ee),n=n+Math.imul(B,re)|0,i=(i=i+Math.imul(B,ne)|0)+Math.imul(M,re)|0,s=s+Math.imul(M,ne)|0,n=n+Math.imul(P,se)|0,i=(i=i+Math.imul(P,oe)|0)+Math.imul(R,se)|0,s=s+Math.imul(R,oe)|0,n=n+Math.imul(x,ce)|0,i=(i=i+Math.imul(x,le)|0)+Math.imul(T,ce)|0,s=s+Math.imul(T,le)|0,n=n+Math.imul(C,he)|0,i=(i=i+Math.imul(C,de)|0)+Math.imul(k,he)|0,s=s+Math.imul(k,de)|0;var xe=(l+(n=n+Math.imul(_,fe)|0)|0)+((8191&(i=(i=i+Math.imul(_,ge)|0)+Math.imul(I,fe)|0))<<13)|0;l=((s=s+Math.imul(I,ge)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,n=Math.imul(D,re),i=(i=Math.imul(D,ne))+Math.imul(W,re)|0,s=Math.imul(W,ne),n=n+Math.imul(B,se)|0,i=(i=i+Math.imul(B,oe)|0)+Math.imul(M,se)|0,s=s+Math.imul(M,oe)|0,n=n+Math.imul(P,ce)|0,i=(i=i+Math.imul(P,le)|0)+Math.imul(R,ce)|0,s=s+Math.imul(R,le)|0,n=n+Math.imul(x,he)|0,i=(i=i+Math.imul(x,de)|0)+Math.imul(T,he)|0,s=s+Math.imul(T,de)|0;var Te=(l+(n=n+Math.imul(C,fe)|0)|0)+((8191&(i=(i=i+Math.imul(C,ge)|0)+Math.imul(k,fe)|0))<<13)|0;l=((s=s+Math.imul(k,ge)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(D,se),i=(i=Math.imul(D,oe))+Math.imul(W,se)|0,s=Math.imul(W,oe),n=n+Math.imul(B,ce)|0,i=(i=i+Math.imul(B,le)|0)+Math.imul(M,ce)|0,s=s+Math.imul(M,le)|0,n=n+Math.imul(P,he)|0,i=(i=i+Math.imul(P,de)|0)+Math.imul(R,he)|0,s=s+Math.imul(R,de)|0;var Oe=(l+(n=n+Math.imul(x,fe)|0)|0)+((8191&(i=(i=i+Math.imul(x,ge)|0)+Math.imul(T,fe)|0))<<13)|0;l=((s=s+Math.imul(T,ge)|0)+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,n=Math.imul(D,ce),i=(i=Math.imul(D,le))+Math.imul(W,ce)|0,s=Math.imul(W,le),n=n+Math.imul(B,he)|0,i=(i=i+Math.imul(B,de)|0)+Math.imul(M,he)|0,s=s+Math.imul(M,de)|0;var Pe=(l+(n=n+Math.imul(P,fe)|0)|0)+((8191&(i=(i=i+Math.imul(P,ge)|0)+Math.imul(R,fe)|0))<<13)|0;l=((s=s+Math.imul(R,ge)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,n=Math.imul(D,he),i=(i=Math.imul(D,de))+Math.imul(W,he)|0,s=Math.imul(W,de);var Re=(l+(n=n+Math.imul(B,fe)|0)|0)+((8191&(i=(i=i+Math.imul(B,ge)|0)+Math.imul(M,fe)|0))<<13)|0;l=((s=s+Math.imul(M,ge)|0)+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863;var Ue=(l+(n=Math.imul(D,fe))|0)+((8191&(i=(i=Math.imul(D,ge))+Math.imul(W,fe)|0))<<13)|0;return l=((s=Math.imul(W,ge))+(i>>>13)|0)+(Ue>>>26)|0,Ue&=67108863,c[0]=me,c[1]=ye,c[2]=we,c[3]=be,c[4]=ve,c[5]=Ee,c[6]=Ae,c[7]=_e,c[8]=Ie,c[9]=Se,c[10]=Ce,c[11]=ke,c[12]=Ne,c[13]=xe,c[14]=Te,c[15]=Oe,c[16]=Pe,c[17]=Re,c[18]=Ue,0!==l&&(c[19]=l,r.length++),r};function y(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var n=0,i=0,s=0;s<r.length-1;s++){var o=i;i=0;for(var a=67108863&n,c=Math.min(s,t.length-1),l=Math.max(0,s-e.length+1);l<=c;l++){var u=s-l,h=(0|e.words[u])*(0|t.words[l]),d=67108863&h;a=67108863&(d=d+a|0),i+=(o=(o=o+(h/67108864|0)|0)+(d>>>26)|0)>>>26,o&=67108863}r.words[s]=a,n=o,o=i}return 0!==n?r.words[s]=n:r.length--,r._strip()}function w(e,t,r){return y(e,t,r)}function b(e,t){this.x=e,this.y=t}Math.imul||(m=g),s.prototype.mulTo=function(e,t){var r=this.length+e.length;return 10===this.length&&10===e.length?m(this,e,t):r<63?g(this,e,t):r<1024?y(this,e,t):w(this,e,t)},b.prototype.makeRBT=function(e){for(var t=new Array(e),r=s.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,r,e);return t},b.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var n=0,i=0;i<t;i++)n|=(1&e)<<t-i-1,e>>=1;return n},b.prototype.permute=function(e,t,r,n,i,s){for(var o=0;o<s;o++)n[o]=t[e[o]],i[o]=r[e[o]]},b.prototype.transform=function(e,t,r,n,i,s){this.permute(s,e,t,r,n,i);for(var o=1;o<i;o<<=1)for(var a=o<<1,c=Math.cos(2*Math.PI/a),l=Math.sin(2*Math.PI/a),u=0;u<i;u+=a)for(var h=c,d=l,p=0;p<o;p++){var f=r[u+p],g=n[u+p],m=r[u+p+o],y=n[u+p+o],w=h*m-d*y;y=h*y+d*m,m=w,r[u+p]=f+m,n[u+p]=g+y,r[u+p+o]=f-m,n[u+p+o]=g-y,p!==a&&(w=c*h-l*d,d=c*d+l*h,h=w)}},b.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),n=1&r,i=0;for(r=r/2|0;r;r>>>=1)i++;return 1<<i+1+n},b.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var n=0;n<r/2;n++){var i=e[n];e[n]=e[r-n-1],e[r-n-1]=i,i=t[n],t[n]=-t[r-n-1],t[r-n-1]=-i}},b.prototype.normalize13b=function(e,t){for(var r=0,n=0;n<t/2;n++){var i=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+r;e[n]=67108863&i,r=i<67108864?0:i/67108864|0}return e},b.prototype.convert13b=function(e,t,r,i){for(var s=0,o=0;o<t;o++)s+=0|e[o],r[2*o]=8191&s,s>>>=13,r[2*o+1]=8191&s,s>>>=13;for(o=2*t;o<i;++o)r[o]=0;n(0===s),n(!(-8192&s))},b.prototype.stub=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=0;return t},b.prototype.mulp=function(e,t,r){var n=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(n),s=this.stub(n),o=new Array(n),a=new Array(n),c=new Array(n),l=new Array(n),u=new Array(n),h=new Array(n),d=r.words;d.length=n,this.convert13b(e.words,e.length,o,n),this.convert13b(t.words,t.length,l,n),this.transform(o,s,a,c,n,i),this.transform(l,s,u,h,n,i);for(var p=0;p<n;p++){var f=a[p]*u[p]-c[p]*h[p];c[p]=a[p]*h[p]+c[p]*u[p],a[p]=f}return this.conjugate(a,c,n),this.transform(a,c,d,s,n,i),this.conjugate(d,s,n),this.normalize13b(d,n),r.negative=e.negative^t.negative,r.length=e.length+t.length,r._strip()},s.prototype.mul=function(e){var t=new s(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},s.prototype.mulf=function(e){var t=new s(null);return t.words=new Array(this.length+e.length),w(this,e,t)},s.prototype.imul=function(e){return this.clone().mulTo(e,this)},s.prototype.imuln=function(e){var t=e<0;t&&(e=-e),n("number"==typeof e),n(e<67108864);for(var r=0,i=0;i<this.length;i++){var s=(0|this.words[i])*e,o=(67108863&s)+(67108863&r);r>>=26,r+=s/67108864|0,r+=o>>>26,this.words[i]=67108863&o}return 0!==r&&(this.words[i]=r,this.length++),this.length=0===e?1:this.length,t?this.ineg():this},s.prototype.muln=function(e){return this.clone().imuln(e)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),r=0;r<t.length;r++){var n=r/26|0,i=r%26;t[r]=e.words[n]>>>i&1}return t}(e);if(0===t.length)return new s(1);for(var r=this,n=0;n<t.length&&0===t[n];n++,r=r.sqr());if(++n<t.length)for(var i=r.sqr();n<t.length;n++,i=i.sqr())0!==t[n]&&(r=r.mul(i));return r},s.prototype.iushln=function(e){n("number"==typeof e&&e>=0);var t,r=e%26,i=(e-r)/26,s=67108863>>>26-r<<26-r;if(0!==r){var o=0;for(t=0;t<this.length;t++){var a=this.words[t]&s,c=(0|this.words[t])-a<<r;this.words[t]=c|o,o=a>>>26-r}o&&(this.words[t]=o,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this._strip()},s.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},s.prototype.iushrn=function(e,t,r){var i;n("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var s=e%26,o=Math.min((e-s)/26,this.length),a=67108863^67108863>>>s<<s,c=r;if(i-=o,i=Math.max(0,i),c){for(var l=0;l<o;l++)c.words[l]=this.words[l];c.length=o}if(0===o);else if(this.length>o)for(this.length-=o,l=0;l<this.length;l++)this.words[l]=this.words[l+o];else this.words[0]=0,this.length=1;var u=0;for(l=this.length-1;l>=0&&(0!==u||l>=i);l--){var h=0|this.words[l];this.words[l]=u<<26-s|h>>>s,u=h&a}return c&&0!==u&&(c.words[c.length++]=u),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(e,t,r){return n(0===this.negative),this.iushrn(e,t,r)},s.prototype.shln=function(e){return this.clone().ishln(e)},s.prototype.ushln=function(e){return this.clone().iushln(e)},s.prototype.shrn=function(e){return this.clone().ishrn(e)},s.prototype.ushrn=function(e){return this.clone().iushrn(e)},s.prototype.testn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26,i=1<<t;return!(this.length<=r||!(this.words[r]&i))},s.prototype.imaskn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==t&&r++,this.length=Math.min(r,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this._strip()},s.prototype.maskn=function(e){return this.clone().imaskn(e)},s.prototype.iaddn=function(e){return n("number"==typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},s.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},s.prototype.isubn=function(e){if(n("number"==typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this._strip()},s.prototype.addn=function(e){return this.clone().iaddn(e)},s.prototype.subn=function(e){return this.clone().isubn(e)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(e,t,r){var i,s,o=e.length+r;this._expand(o);var a=0;for(i=0;i<e.length;i++){s=(0|this.words[i+r])+a;var c=(0|e.words[i])*t;a=((s-=67108863&c)>>26)-(c/67108864|0),this.words[i+r]=67108863&s}for(;i<this.length-r;i++)a=(s=(0|this.words[i+r])+a)>>26,this.words[i+r]=67108863&s;if(0===a)return this._strip();for(n(-1===a),a=0,i=0;i<this.length;i++)a=(s=-(0|this.words[i])+a)>>26,this.words[i]=67108863&s;return this.negative=1,this._strip()},s.prototype._wordDiv=function(e,t){var r=(this.length,e.length),n=this.clone(),i=e,o=0|i.words[i.length-1];0!=(r=26-this._countBits(o))&&(i=i.ushln(r),n.iushln(r),o=0|i.words[i.length-1]);var a,c=n.length-i.length;if("mod"!==t){(a=new s(null)).length=c+1,a.words=new Array(a.length);for(var l=0;l<a.length;l++)a.words[l]=0}var u=n.clone()._ishlnsubmul(i,1,c);0===u.negative&&(n=u,a&&(a.words[c]=1));for(var h=c-1;h>=0;h--){var d=67108864*(0|n.words[i.length+h])+(0|n.words[i.length+h-1]);for(d=Math.min(d/o|0,67108863),n._ishlnsubmul(i,d,h);0!==n.negative;)d--,n.negative=0,n._ishlnsubmul(i,1,h),n.isZero()||(n.negative^=1);a&&(a.words[h]=d)}return a&&a._strip(),n._strip(),"div"!==t&&0!==r&&n.iushrn(r),{div:a||null,mod:n}},s.prototype.divmod=function(e,t,r){return n(!e.isZero()),this.isZero()?{div:new s(0),mod:new s(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(i=a.div.neg()),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.iadd(e)),{div:i,mod:o}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(i=a.div.neg()),{div:i,mod:a.mod}):0!==(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.isub(e)),{div:a.div,mod:o}):e.length>this.length||this.cmp(e)<0?{div:new s(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new s(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new s(this.modrn(e.words[0]))}:this._wordDiv(e,t);var i,o,a},s.prototype.div=function(e){return this.divmod(e,"div",!1).div},s.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},s.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},s.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),i=e.andln(1),s=r.cmp(n);return s<0||1===i&&0===s?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},s.prototype.modrn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=(1<<26)%e,i=0,s=this.length-1;s>=0;s--)i=(r*i+(0|this.words[s]))%e;return t?-i:i},s.prototype.modn=function(e){return this.modrn(e)},s.prototype.idivn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=0,i=this.length-1;i>=0;i--){var s=(0|this.words[i])+67108864*r;this.words[i]=s/e|0,r=s%e}return this._strip(),t?this.ineg():this},s.prototype.divn=function(e){return this.clone().idivn(e)},s.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new s(1),o=new s(0),a=new s(0),c=new s(1),l=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++l;for(var u=r.clone(),h=t.clone();!t.isZero();){for(var d=0,p=1;0===(t.words[0]&p)&&d<26;++d,p<<=1);if(d>0)for(t.iushrn(d);d-- >0;)(i.isOdd()||o.isOdd())&&(i.iadd(u),o.isub(h)),i.iushrn(1),o.iushrn(1);for(var f=0,g=1;0===(r.words[0]&g)&&f<26;++f,g<<=1);if(f>0)for(r.iushrn(f);f-- >0;)(a.isOdd()||c.isOdd())&&(a.iadd(u),c.isub(h)),a.iushrn(1),c.iushrn(1);t.cmp(r)>=0?(t.isub(r),i.isub(a),o.isub(c)):(r.isub(t),a.isub(i),c.isub(o))}return{a,b:c,gcd:r.iushln(l)}},s.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i,o=new s(1),a=new s(0),c=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var l=0,u=1;0===(t.words[0]&u)&&l<26;++l,u<<=1);if(l>0)for(t.iushrn(l);l-- >0;)o.isOdd()&&o.iadd(c),o.iushrn(1);for(var h=0,d=1;0===(r.words[0]&d)&&h<26;++h,d<<=1);if(h>0)for(r.iushrn(h);h-- >0;)a.isOdd()&&a.iadd(c),a.iushrn(1);t.cmp(r)>=0?(t.isub(r),o.isub(a)):(r.isub(t),a.isub(o))}return(i=0===t.cmpn(1)?o:a).cmpn(0)<0&&i.iadd(e),i},s.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var n=0;t.isEven()&&r.isEven();n++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var i=t.cmp(r);if(i<0){var s=t;t=r,r=s}else if(0===i||0===r.cmpn(1))break;t.isub(r)}return r.iushln(n)},s.prototype.invm=function(e){return this.egcd(e).a.umod(e)},s.prototype.isEven=function(){return!(1&this.words[0])},s.prototype.isOdd=function(){return!(1&~this.words[0])},s.prototype.andln=function(e){return this.words[0]&e},s.prototype.bincn=function(e){n("number"==typeof e);var t=e%26,r=(e-t)/26,i=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var s=i,o=r;0!==s&&o<this.length;o++){var a=0|this.words[o];s=(a+=s)>>>26,a&=67108863,this.words[o]=a}return 0!==s&&(this.words[o]=s,this.length++),this},s.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},s.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this._strip(),this.length>1)t=1;else{r&&(e=-e),n(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},s.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},s.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],i=0|e.words[r];if(n!==i){n<i?t=-1:n>i&&(t=1);break}}return t},s.prototype.gtn=function(e){return 1===this.cmpn(e)},s.prototype.gt=function(e){return 1===this.cmp(e)},s.prototype.gten=function(e){return this.cmpn(e)>=0},s.prototype.gte=function(e){return this.cmp(e)>=0},s.prototype.ltn=function(e){return-1===this.cmpn(e)},s.prototype.lt=function(e){return-1===this.cmp(e)},s.prototype.lten=function(e){return this.cmpn(e)<=0},s.prototype.lte=function(e){return this.cmp(e)<=0},s.prototype.eqn=function(e){return 0===this.cmpn(e)},s.prototype.eq=function(e){return 0===this.cmp(e)},s.red=function(e){return new C(e)},s.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},s.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(e){return this.red=e,this},s.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},s.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},s.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},s.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},s.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},s.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},s.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},s.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},s.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var v={k256:null,p224:null,p192:null,p25519:null};function E(e,t){this.name=e,this.p=new s(t,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function A(){E.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function _(){E.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function I(){E.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function S(){E.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function C(e){if("string"==typeof e){var t=s._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function k(e){C.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}E.prototype._tmp=function(){var e=new s(null);return e.words=new Array(Math.ceil(this.n/13)),e},E.prototype.ireduce=function(e){var t,r=e;do{this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},E.prototype.split=function(e,t){e.iushrn(this.n,0,t)},E.prototype.imulK=function(e){return e.imul(this.k)},i(A,E),A.prototype.split=function(e,t){for(var r=4194303,n=Math.min(e.length,9),i=0;i<n;i++)t.words[i]=e.words[i];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var s=e.words[9];for(t.words[t.length++]=s&r,i=10;i<e.length;i++){var o=0|e.words[i];e.words[i-10]=(o&r)<<4|s>>>22,s=o}s>>>=22,e.words[i-10]=s,0===s&&e.length>10?e.length-=10:e.length-=9},A.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var n=0|e.words[r];t+=977*n,e.words[r]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(_,E),i(I,E),i(S,E),S.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var n=19*(0|e.words[r])+t,i=67108863&n;n>>>=26,e.words[r]=i,t=n}return 0!==t&&(e.words[e.length++]=t),e},s._prime=function(e){if(v[e])return v[e];var t;if("k256"===e)t=new A;else if("p224"===e)t=new _;else if("p192"===e)t=new I;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new S}return v[e]=t,t},C.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},C.prototype._verify2=function(e,t){n(0===(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},C.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(u(e,e.umod(this.m)._forceRed(this)),e)},C.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},C.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},C.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},C.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},C.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return r.cmpn(0)<0&&r.iadd(this.m),r},C.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},C.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},C.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},C.prototype.isqr=function(e){return this.imul(e,e.clone())},C.prototype.sqr=function(e){return this.mul(e,e)},C.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2==1),3===t){var r=this.m.add(new s(1)).iushrn(2);return this.pow(e,r)}for(var i=this.m.subn(1),o=0;!i.isZero()&&0===i.andln(1);)o++,i.iushrn(1);n(!i.isZero());var a=new s(1).toRed(this),c=a.redNeg(),l=this.m.subn(1).iushrn(1),u=this.m.bitLength();for(u=new s(2*u*u).toRed(this);0!==this.pow(u,l).cmp(c);)u.redIAdd(c);for(var h=this.pow(u,i),d=this.pow(e,i.addn(1).iushrn(1)),p=this.pow(e,i),f=o;0!==p.cmp(a);){for(var g=p,m=0;0!==g.cmp(a);m++)g=g.redSqr();n(m<f);var y=this.pow(h,new s(1).iushln(f-m-1));d=d.redMul(y),h=y.redSqr(),p=p.redMul(h),f=m}return d},C.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},C.prototype.pow=function(e,t){if(t.isZero())return new s(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=new Array(16);r[0]=new s(1).toRed(this),r[1]=e;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],e);var i=r[0],o=0,a=0,c=t.bitLength()%26;for(0===c&&(c=26),n=t.length-1;n>=0;n--){for(var l=t.words[n],u=c-1;u>=0;u--){var h=l>>u&1;i!==r[0]&&(i=this.sqr(i)),0!==h||0!==o?(o<<=1,o|=h,(4===++a||0===n&&0===u)&&(i=this.mul(i,r[o]),a=0,o=0)):a=0}c=26}return i},C.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},C.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},s.mont=function(e){return new k(e)},i(k,C),k.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},k.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},k.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},k.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new s(0)._forceRed(this);var r=e.mul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},k.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e=r.nmd(e),this)},9477:(e,t,r)=>{r.d(t,{Y:()=>o,w:()=>s});var n=r(7323),i=r(4376);const s={UNIVERSAL_PROVIDER_RELAY_URL:"wss://relay.walletconnect.org",HASH_PREFIX:"SPL Name Service",ROOT_DOMAIN_ACCOUNT:new n.J3("58PwtjSDuFHuUkYjH9BYnnQKHfwo9reZhC2zMJv9JPkx"),NAME_PROGRAM_ID:new n.J3("namesLPneVptA9Z5rqUDD9tMTWEJwofgaYwp8cawRkX"),REVERSE_LOOKUP_CLASS:new n.J3("33m47vH6Eav6jr5Ry86XjhRft2jRBLDnDgPSHoquXi2Z"),DEFAULT_CHAIN:{id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",chainNamespace:i.o.CHAIN.SOLANA,nativeCurrency:{name:"Solana",decimals:9,symbol:"SOL"},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},rpcUrls:{default:{http:[`${i.o.BLOCKCHAIN_API_RPC_URL}/v1`]}}},CHAIN_IDS:{Mainnet:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",Devnet:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",Testnet:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",Deprecated_Mainnet:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ",Deprecated_Devnet:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"},LAMPORTS_PER_SOL:1e9},o={UNIT_PRICE_MICRO_LAMPORTS:2e7,UNIT_LIMIT_TRANSFER_ONLY:3e5,UNIT_LIMIT_WITH_ATA_CREATION:4e5}},9510:(e,t,r)=>{r.d(t,{o:()=>n});const n={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",EIP155:r(4376).o.CHAIN.EVM,ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH"}},9606:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=r(5215);n.__exportStar(r(2985),t),n.__exportStar(r(221),t)},9835:(e,t,r)=>{r.d(t,{Y:()=>Kr});var n,i,s=r(5910),o=r(4376),a=r(152),c=r(6409);!function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const r of e)t[r]=r;return t},e.getValidEnumValues=t=>{const r=e.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]),n={};for(const e of r)n[e]=t[e];return e.objectValues(n)},e.objectValues=t=>e.objectKeys(t).map(function(e){return t[e]}),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(const r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(n||(n={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(i||(i={}));const l=n.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),u=e=>{switch(typeof e){case"undefined":return l.undefined;case"string":return l.string;case"number":return isNaN(e)?l.nan:l.number;case"boolean":return l.boolean;case"function":return l.function;case"bigint":return l.bigint;case"symbol":return l.symbol;case"object":return Array.isArray(e)?l.array:null===e?l.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?l.promise:"undefined"!=typeof Map&&e instanceof Map?l.map:"undefined"!=typeof Set&&e instanceof Set?l.set:"undefined"!=typeof Date&&e instanceof Date?l.date:l.object;default:return l.unknown}},h=n.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class d extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},r={_errors:[]},n=e=>{for(const i of e.issues)if("invalid_union"===i.code)i.unionErrors.map(n);else if("invalid_return_type"===i.code)n(i.returnTypeError);else if("invalid_arguments"===i.code)n(i.argumentsError);else if(0===i.path.length)r._errors.push(t(i));else{let e=r,n=0;for(;n<i.path.length;){const r=i.path[n];n===i.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(i))):e[r]=e[r]||{_errors:[]},e=e[r],n++}}};return n(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,n.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){const t={},r=[];for(const n of this.issues)n.path.length>0?(t[n.path[0]]=t[n.path[0]]||[],t[n.path[0]].push(e(n))):r.push(e(n));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}d.create=e=>new d(e);const p=(e,t)=>{let r;switch(e.code){case h.invalid_type:r=e.received===l.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case h.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,n.jsonStringifyReplacer)}`;break;case h.unrecognized_keys:r=`Unrecognized key(s) in object: ${n.joinValues(e.keys,", ")}`;break;case h.invalid_union:r="Invalid input";break;case h.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${n.joinValues(e.options)}`;break;case h.invalid_enum_value:r=`Invalid enum value. Expected ${n.joinValues(e.options)}, received '${e.received}'`;break;case h.invalid_arguments:r="Invalid function arguments";break;case h.invalid_return_type:r="Invalid function return type";break;case h.invalid_date:r="Invalid date";break;case h.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:n.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case h.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case h.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case h.custom:r="Invalid input";break;case h.invalid_intersection_types:r="Intersection results could not be merged";break;case h.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case h.not_finite:r="Number must be finite";break;default:r=t.defaultError,n.assertNever(e)}return{message:r}};let f=p;function g(){return f}const m=e=>{const{data:t,path:r,errorMaps:n,issueData:i}=e,s=[...r,...i.path||[]],o={...i,path:s};let a="";const c=n.filter(e=>!!e).slice().reverse();for(const e of c)a=e(o,{data:t,defaultError:a}).message;return{...i,path:s,message:i.message||a}};function y(e,t){const r=m({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,g(),p].filter(e=>!!e)});e.common.issues.push(r)}class w{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const n of t){if("aborted"===n.status)return b;"dirty"===n.status&&e.dirty(),r.push(n.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const e of t)r.push({key:await e.key,value:await e.value});return w.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const n of t){const{key:t,value:i}=n;if("aborted"===t.status)return b;if("aborted"===i.status)return b;"dirty"===t.status&&e.dirty(),"dirty"===i.status&&e.dirty(),"__proto__"===t.value||void 0===i.value&&!n.alwaysSet||(r[t.value]=i.value)}return{status:e.value,value:r}}}const b=Object.freeze({status:"aborted"}),v=e=>({status:"dirty",value:e}),E=e=>({status:"valid",value:e}),A=e=>"aborted"===e.status,_=e=>"dirty"===e.status,I=e=>"valid"===e.status,S=e=>"undefined"!=typeof Promise&&e instanceof Promise;var C;!function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:null==e?void 0:e.message}(C||(C={}));class k{constructor(e,t,r,n){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const N=(e,t)=>{if(I(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new d(e.common.issues);return this._error=t,this._error}}};function x(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:i}=e;if(t&&(r||n))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:i}:{errorMap:(e,t)=>"invalid_type"!==e.code?{message:t.defaultError}:void 0===t.data?{message:null!=n?n:t.defaultError}:{message:null!=r?r:t.defaultError},description:i}}class T{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return u(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:u(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new w,ctx:{common:e.parent.common,data:e.data,parsedType:u(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(S(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const n={common:{issues:[],async:null!==(r=null==t?void 0:t.async)&&void 0!==r&&r,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:u(e)},i=this._parseSync({data:e,path:n.path,parent:n});return N(n,i)}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:u(e)},n=this._parse({data:e,path:r.path,parent:r}),i=await(S(n)?n:Promise.resolve(n));return N(r,i)}refine(e,t){const r=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,n)=>{const i=e(t),s=()=>n.addIssue({code:h.custom,...r(t)});return"undefined"!=typeof Promise&&i instanceof Promise?i.then(e=>!!e||(s(),!1)):!!i||(s(),!1)})}refinement(e,t){return this._refinement((r,n)=>!!e(r)||(n.addIssue("function"==typeof t?t(r,n):t),!1))}_refinement(e){return new be({schema:this,typeName:Oe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return ve.create(this,this._def)}nullable(){return Ee.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ee.create(this,this._def)}promise(){return we.create(this,this._def)}or(e){return ne.create([this,e],this._def)}and(e){return ae.create(this,e,this._def)}transform(e){return new be({...x(this._def),schema:this,typeName:Oe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new Ae({...x(this._def),innerType:this,defaultValue:t,typeName:Oe.ZodDefault})}brand(){return new Ce({typeName:Oe.ZodBranded,type:this,...x(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new _e({...x(this._def),innerType:this,catchValue:t,typeName:Oe.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return ke.create(this,e)}readonly(){return Ne.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const O=/^c[^\s-]{8,}$/i,P=/^[a-z][a-z0-9]*$/,R=/^[0-9A-HJKMNP-TV-Z]{26}$/,U=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,B=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let M;const L=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,D=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,W=e=>e.precision?e.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${e.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${e.precision}}Z$`):0===e.precision?e.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):e.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function j(e,t){return!("v4"!==t&&t||!L.test(e))||!("v6"!==t&&t||!D.test(e))}class $ extends T{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==l.string){const t=this._getOrReturnCtx(e);return y(t,{code:h.invalid_type,expected:l.string,received:t.parsedType}),b}const t=new w;let r;for(const i of this._def.checks)if("min"===i.kind)e.data.length<i.value&&(r=this._getOrReturnCtx(e,r),y(r,{code:h.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("max"===i.kind)e.data.length>i.value&&(r=this._getOrReturnCtx(e,r),y(r,{code:h.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("length"===i.kind){const n=e.data.length>i.value,s=e.data.length<i.value;(n||s)&&(r=this._getOrReturnCtx(e,r),n?y(r,{code:h.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):s&&y(r,{code:h.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),t.dirty())}else if("email"===i.kind)B.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"email",code:h.invalid_string,message:i.message}),t.dirty());else if("emoji"===i.kind)M||(M=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),M.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"emoji",code:h.invalid_string,message:i.message}),t.dirty());else if("uuid"===i.kind)U.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"uuid",code:h.invalid_string,message:i.message}),t.dirty());else if("cuid"===i.kind)O.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"cuid",code:h.invalid_string,message:i.message}),t.dirty());else if("cuid2"===i.kind)P.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"cuid2",code:h.invalid_string,message:i.message}),t.dirty());else if("ulid"===i.kind)R.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"ulid",code:h.invalid_string,message:i.message}),t.dirty());else if("url"===i.kind)try{new URL(e.data)}catch(n){r=this._getOrReturnCtx(e,r),y(r,{validation:"url",code:h.invalid_string,message:i.message}),t.dirty()}else"regex"===i.kind?(i.regex.lastIndex=0,i.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"regex",code:h.invalid_string,message:i.message}),t.dirty())):"trim"===i.kind?e.data=e.data.trim():"includes"===i.kind?e.data.includes(i.value,i.position)||(r=this._getOrReturnCtx(e,r),y(r,{code:h.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),t.dirty()):"toLowerCase"===i.kind?e.data=e.data.toLowerCase():"toUpperCase"===i.kind?e.data=e.data.toUpperCase():"startsWith"===i.kind?e.data.startsWith(i.value)||(r=this._getOrReturnCtx(e,r),y(r,{code:h.invalid_string,validation:{startsWith:i.value},message:i.message}),t.dirty()):"endsWith"===i.kind?e.data.endsWith(i.value)||(r=this._getOrReturnCtx(e,r),y(r,{code:h.invalid_string,validation:{endsWith:i.value},message:i.message}),t.dirty()):"datetime"===i.kind?W(i).test(e.data)||(r=this._getOrReturnCtx(e,r),y(r,{code:h.invalid_string,validation:"datetime",message:i.message}),t.dirty()):"ip"===i.kind?j(e.data,i.version)||(r=this._getOrReturnCtx(e,r),y(r,{validation:"ip",code:h.invalid_string,message:i.message}),t.dirty()):n.assertNever(i);return{status:t.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:h.invalid_string,...C.errToObj(r)})}_addCheck(e){return new $({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...C.errToObj(e)})}url(e){return this._addCheck({kind:"url",...C.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...C.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...C.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...C.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...C.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...C.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...C.errToObj(e)})}datetime(e){var t;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,...C.errToObj(null==e?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...C.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...C.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...C.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...C.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...C.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...C.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...C.errToObj(t)})}nonempty(e){return this.min(1,C.errToObj(e))}trim(){return new $({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new $({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new $({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function z(e,t){const r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,i=r>n?r:n;return parseInt(e.toFixed(i).replace(".",""))%parseInt(t.toFixed(i).replace(".",""))/Math.pow(10,i)}$.create=e=>{var t;return new $({checks:[],typeName:Oe.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...x(e)})};class q extends T{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==l.number){const t=this._getOrReturnCtx(e);return y(t,{code:h.invalid_type,expected:l.number,received:t.parsedType}),b}let t;const r=new w;for(const i of this._def.checks)"int"===i.kind?n.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),y(t,{code:h.invalid_type,expected:"integer",received:"float",message:i.message}),r.dirty()):"min"===i.kind?(i.inclusive?e.data<i.value:e.data<=i.value)&&(t=this._getOrReturnCtx(e,t),y(t,{code:h.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):"max"===i.kind?(i.inclusive?e.data>i.value:e.data>=i.value)&&(t=this._getOrReturnCtx(e,t),y(t,{code:h.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):"multipleOf"===i.kind?0!==z(e.data,i.value)&&(t=this._getOrReturnCtx(e,t),y(t,{code:h.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):"finite"===i.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),y(t,{code:h.not_finite,message:i.message}),r.dirty()):n.assertNever(i);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,C.toString(t))}gt(e,t){return this.setLimit("min",e,!1,C.toString(t))}lte(e,t){return this.setLimit("max",e,!0,C.toString(t))}lt(e,t){return this.setLimit("max",e,!1,C.toString(t))}setLimit(e,t,r,n){return new q({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:C.toString(n)}]})}_addCheck(e){return new q({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:C.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:C.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:C.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:C.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:C.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:C.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:C.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:C.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:C.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&n.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}q.create=e=>new q({checks:[],typeName:Oe.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...x(e)});class F extends T{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==l.bigint){const t=this._getOrReturnCtx(e);return y(t,{code:h.invalid_type,expected:l.bigint,received:t.parsedType}),b}let t;const r=new w;for(const i of this._def.checks)"min"===i.kind?(i.inclusive?e.data<i.value:e.data<=i.value)&&(t=this._getOrReturnCtx(e,t),y(t,{code:h.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):"max"===i.kind?(i.inclusive?e.data>i.value:e.data>=i.value)&&(t=this._getOrReturnCtx(e,t),y(t,{code:h.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):"multipleOf"===i.kind?e.data%i.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),y(t,{code:h.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):n.assertNever(i);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,C.toString(t))}gt(e,t){return this.setLimit("min",e,!1,C.toString(t))}lte(e,t){return this.setLimit("max",e,!0,C.toString(t))}lt(e,t){return this.setLimit("max",e,!1,C.toString(t))}setLimit(e,t,r,n){return new F({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:C.toString(n)}]})}_addCheck(e){return new F({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:C.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:C.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:C.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:C.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:C.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}F.create=e=>{var t;return new F({checks:[],typeName:Oe.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...x(e)})};class H extends T{_parse(e){if(this._def.coerce&&(e.data=Boolean(e.data)),this._getType(e)!==l.boolean){const t=this._getOrReturnCtx(e);return y(t,{code:h.invalid_type,expected:l.boolean,received:t.parsedType}),b}return E(e.data)}}H.create=e=>new H({typeName:Oe.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...x(e)});class K extends T{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==l.date){const t=this._getOrReturnCtx(e);return y(t,{code:h.invalid_type,expected:l.date,received:t.parsedType}),b}if(isNaN(e.data.getTime()))return y(this._getOrReturnCtx(e),{code:h.invalid_date}),b;const t=new w;let r;for(const i of this._def.checks)"min"===i.kind?e.data.getTime()<i.value&&(r=this._getOrReturnCtx(e,r),y(r,{code:h.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),t.dirty()):"max"===i.kind?e.data.getTime()>i.value&&(r=this._getOrReturnCtx(e,r),y(r,{code:h.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),t.dirty()):n.assertNever(i);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new K({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:C.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:C.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}K.create=e=>new K({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:Oe.ZodDate,...x(e)});class V extends T{_parse(e){if(this._getType(e)!==l.symbol){const t=this._getOrReturnCtx(e);return y(t,{code:h.invalid_type,expected:l.symbol,received:t.parsedType}),b}return E(e.data)}}V.create=e=>new V({typeName:Oe.ZodSymbol,...x(e)});class Y extends T{_parse(e){if(this._getType(e)!==l.undefined){const t=this._getOrReturnCtx(e);return y(t,{code:h.invalid_type,expected:l.undefined,received:t.parsedType}),b}return E(e.data)}}Y.create=e=>new Y({typeName:Oe.ZodUndefined,...x(e)});class G extends T{_parse(e){if(this._getType(e)!==l.null){const t=this._getOrReturnCtx(e);return y(t,{code:h.invalid_type,expected:l.null,received:t.parsedType}),b}return E(e.data)}}G.create=e=>new G({typeName:Oe.ZodNull,...x(e)});class Z extends T{constructor(){super(...arguments),this._any=!0}_parse(e){return E(e.data)}}Z.create=e=>new Z({typeName:Oe.ZodAny,...x(e)});class J extends T{constructor(){super(...arguments),this._unknown=!0}_parse(e){return E(e.data)}}J.create=e=>new J({typeName:Oe.ZodUnknown,...x(e)});class X extends T{_parse(e){const t=this._getOrReturnCtx(e);return y(t,{code:h.invalid_type,expected:l.never,received:t.parsedType}),b}}X.create=e=>new X({typeName:Oe.ZodNever,...x(e)});class Q extends T{_parse(e){if(this._getType(e)!==l.undefined){const t=this._getOrReturnCtx(e);return y(t,{code:h.invalid_type,expected:l.void,received:t.parsedType}),b}return E(e.data)}}Q.create=e=>new Q({typeName:Oe.ZodVoid,...x(e)});class ee extends T{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),n=this._def;if(t.parsedType!==l.array)return y(t,{code:h.invalid_type,expected:l.array,received:t.parsedType}),b;if(null!==n.exactLength){const e=t.data.length>n.exactLength.value,i=t.data.length<n.exactLength.value;(e||i)&&(y(t,{code:e?h.too_big:h.too_small,minimum:i?n.exactLength.value:void 0,maximum:e?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(null!==n.minLength&&t.data.length<n.minLength.value&&(y(t,{code:h.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),null!==n.maxLength&&t.data.length>n.maxLength.value&&(y(t,{code:h.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>n.type._parseAsync(new k(t,e,t.path,r)))).then(e=>w.mergeArray(r,e));const i=[...t.data].map((e,r)=>n.type._parseSync(new k(t,e,t.path,r)));return w.mergeArray(r,i)}get element(){return this._def.type}min(e,t){return new ee({...this._def,minLength:{value:e,message:C.toString(t)}})}max(e,t){return new ee({...this._def,maxLength:{value:e,message:C.toString(t)}})}length(e,t){return new ee({...this._def,exactLength:{value:e,message:C.toString(t)}})}nonempty(e){return this.min(1,e)}}function te(e){if(e instanceof re){const t={};for(const r in e.shape){const n=e.shape[r];t[r]=ve.create(te(n))}return new re({...e._def,shape:()=>t})}return e instanceof ee?new ee({...e._def,type:te(e.element)}):e instanceof ve?ve.create(te(e.unwrap())):e instanceof Ee?Ee.create(te(e.unwrap())):e instanceof ce?ce.create(e.items.map(e=>te(e))):e}ee.create=(e,t)=>new ee({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Oe.ZodArray,...x(t)});class re extends T{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=n.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==l.object){const t=this._getOrReturnCtx(e);return y(t,{code:h.invalid_type,expected:l.object,received:t.parsedType}),b}const{status:t,ctx:r}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),s=[];if(!(this._def.catchall instanceof X&&"strip"===this._def.unknownKeys))for(const e in r.data)i.includes(e)||s.push(e);const o=[];for(const e of i){const t=n[e],i=r.data[e];o.push({key:{status:"valid",value:e},value:t._parse(new k(r,i,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof X){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of s)o.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)s.length>0&&(y(r,{code:h.unrecognized_keys,keys:s}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of s){const n=r.data[t];o.push({key:{status:"valid",value:t},value:e._parse(new k(r,n,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const e=[];for(const t of o){const r=await t.key;e.push({key:r,value:await t.value,alwaysSet:t.alwaysSet})}return e}).then(e=>w.mergeObjectSync(t,e)):w.mergeObjectSync(t,o)}get shape(){return this._def.shape()}strict(e){return C.errToObj,new re({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{var n,i,s,o;const a=null!==(s=null===(i=(n=this._def).errorMap)||void 0===i?void 0:i.call(n,t,r).message)&&void 0!==s?s:r.defaultError;return"unrecognized_keys"===t.code?{message:null!==(o=C.errToObj(e).message)&&void 0!==o?o:a}:{message:a}}}:{}})}strip(){return new re({...this._def,unknownKeys:"strip"})}passthrough(){return new re({...this._def,unknownKeys:"passthrough"})}extend(e){return new re({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new re({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Oe.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new re({...this._def,catchall:e})}pick(e){const t={};return n.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new re({...this._def,shape:()=>t})}omit(e){const t={};return n.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new re({...this._def,shape:()=>t})}deepPartial(){return te(this)}partial(e){const t={};return n.objectKeys(this.shape).forEach(r=>{const n=this.shape[r];e&&!e[r]?t[r]=n:t[r]=n.optional()}),new re({...this._def,shape:()=>t})}required(e){const t={};return n.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof ve;)e=e._def.innerType;t[r]=e}}),new re({...this._def,shape:()=>t})}keyof(){return ge(n.objectKeys(this.shape))}}re.create=(e,t)=>new re({shape:()=>e,unknownKeys:"strip",catchall:X.create(),typeName:Oe.ZodObject,...x(t)}),re.strictCreate=(e,t)=>new re({shape:()=>e,unknownKeys:"strict",catchall:X.create(),typeName:Oe.ZodObject,...x(t)}),re.lazycreate=(e,t)=>new re({shape:e,unknownKeys:"strip",catchall:X.create(),typeName:Oe.ZodObject,...x(t)});class ne extends T{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{const r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;const r=e.map(e=>new d(e.ctx.common.issues));return y(t,{code:h.invalid_union,unionErrors:r}),b});{let e;const n=[];for(const i of r){const r={...t,common:{...t.common,issues:[]},parent:null},s=i._parseSync({data:t.data,path:t.path,parent:r});if("valid"===s.status)return s;"dirty"!==s.status||e||(e={result:s,ctx:r}),r.common.issues.length&&n.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const i=n.map(e=>new d(e));return y(t,{code:h.invalid_union,unionErrors:i}),b}}get options(){return this._def.options}}ne.create=(e,t)=>new ne({options:e,typeName:Oe.ZodUnion,...x(t)});const ie=e=>e instanceof pe?ie(e.schema):e instanceof be?ie(e.innerType()):e instanceof fe?[e.value]:e instanceof me?e.options:e instanceof ye?Object.keys(e.enum):e instanceof Ae?ie(e._def.innerType):e instanceof Y?[void 0]:e instanceof G?[null]:null;class se extends T{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==l.object)return y(t,{code:h.invalid_type,expected:l.object,received:t.parsedType}),b;const r=this.discriminator,n=t.data[r],i=this.optionsMap.get(n);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(y(t,{code:h.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),b)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const n=new Map;for(const r of t){const t=ie(r.shape[e]);if(!t)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const i of t){if(n.has(i))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(i)}`);n.set(i,r)}}return new se({typeName:Oe.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:n,...x(r)})}}function oe(e,t){const r=u(e),i=u(t);if(e===t)return{valid:!0,data:e};if(r===l.object&&i===l.object){const r=n.objectKeys(t),i=n.objectKeys(e).filter(e=>-1!==r.indexOf(e)),s={...e,...t};for(const r of i){const n=oe(e[r],t[r]);if(!n.valid)return{valid:!1};s[r]=n.data}return{valid:!0,data:s}}if(r===l.array&&i===l.array){if(e.length!==t.length)return{valid:!1};const r=[];for(let n=0;n<e.length;n++){const i=oe(e[n],t[n]);if(!i.valid)return{valid:!1};r.push(i.data)}return{valid:!0,data:r}}return r===l.date&&i===l.date&&+e===+t?{valid:!0,data:e}:{valid:!1}}class ae extends T{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),n=(e,n)=>{if(A(e)||A(n))return b;const i=oe(e.value,n.value);return i.valid?((_(e)||_(n))&&t.dirty(),{status:t.value,value:i.data}):(y(r,{code:h.invalid_intersection_types}),b)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>n(e,t)):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ae.create=(e,t,r)=>new ae({left:e,right:t,typeName:Oe.ZodIntersection,...x(r)});class ce extends T{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==l.array)return y(r,{code:h.invalid_type,expected:l.array,received:r.parsedType}),b;if(r.data.length<this._def.items.length)return y(r,{code:h.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),b;!this._def.rest&&r.data.length>this._def.items.length&&(y(r,{code:h.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const n=[...r.data].map((e,t)=>{const n=this._def.items[t]||this._def.rest;return n?n._parse(new k(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(n).then(e=>w.mergeArray(t,e)):w.mergeArray(t,n)}get items(){return this._def.items}rest(e){return new ce({...this._def,rest:e})}}ce.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ce({items:e,typeName:Oe.ZodTuple,rest:null,...x(t)})};class le extends T{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==l.object)return y(r,{code:h.invalid_type,expected:l.object,received:r.parsedType}),b;const n=[],i=this._def.keyType,s=this._def.valueType;for(const e in r.data)n.push({key:i._parse(new k(r,e,r.path,e)),value:s._parse(new k(r,r.data[e],r.path,e))});return r.common.async?w.mergeObjectAsync(t,n):w.mergeObjectSync(t,n)}get element(){return this._def.valueType}static create(e,t,r){return new le(t instanceof T?{keyType:e,valueType:t,typeName:Oe.ZodRecord,...x(r)}:{keyType:$.create(),valueType:e,typeName:Oe.ZodRecord,...x(t)})}}class ue extends T{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==l.map)return y(r,{code:h.invalid_type,expected:l.map,received:r.parsedType}),b;const n=this._def.keyType,i=this._def.valueType,s=[...r.data.entries()].map(([e,t],s)=>({key:n._parse(new k(r,e,r.path,[s,"key"])),value:i._parse(new k(r,t,r.path,[s,"value"]))}));if(r.common.async){const e=new Map;return Promise.resolve().then(async()=>{for(const r of s){const n=await r.key,i=await r.value;if("aborted"===n.status||"aborted"===i.status)return b;"dirty"!==n.status&&"dirty"!==i.status||t.dirty(),e.set(n.value,i.value)}return{status:t.value,value:e}})}{const e=new Map;for(const r of s){const n=r.key,i=r.value;if("aborted"===n.status||"aborted"===i.status)return b;"dirty"!==n.status&&"dirty"!==i.status||t.dirty(),e.set(n.value,i.value)}return{status:t.value,value:e}}}}ue.create=(e,t,r)=>new ue({valueType:t,keyType:e,typeName:Oe.ZodMap,...x(r)});class he extends T{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==l.set)return y(r,{code:h.invalid_type,expected:l.set,received:r.parsedType}),b;const n=this._def;null!==n.minSize&&r.data.size<n.minSize.value&&(y(r,{code:h.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),t.dirty()),null!==n.maxSize&&r.data.size>n.maxSize.value&&(y(r,{code:h.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),t.dirty());const i=this._def.valueType;function s(e){const r=new Set;for(const n of e){if("aborted"===n.status)return b;"dirty"===n.status&&t.dirty(),r.add(n.value)}return{status:t.value,value:r}}const o=[...r.data.values()].map((e,t)=>i._parse(new k(r,e,r.path,t)));return r.common.async?Promise.all(o).then(e=>s(e)):s(o)}min(e,t){return new he({...this._def,minSize:{value:e,message:C.toString(t)}})}max(e,t){return new he({...this._def,maxSize:{value:e,message:C.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}he.create=(e,t)=>new he({valueType:e,minSize:null,maxSize:null,typeName:Oe.ZodSet,...x(t)});class de extends T{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==l.function)return y(t,{code:h.invalid_type,expected:l.function,received:t.parsedType}),b;function r(e,r){return m({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,g(),p].filter(e=>!!e),issueData:{code:h.invalid_arguments,argumentsError:r}})}function n(e,r){return m({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,g(),p].filter(e=>!!e),issueData:{code:h.invalid_return_type,returnTypeError:r}})}const i={errorMap:t.common.contextualErrorMap},s=t.data;if(this._def.returns instanceof we){const e=this;return E(async function(...t){const o=new d([]),a=await e._def.args.parseAsync(t,i).catch(e=>{throw o.addIssue(r(t,e)),o}),c=await Reflect.apply(s,this,a);return await e._def.returns._def.type.parseAsync(c,i).catch(e=>{throw o.addIssue(n(c,e)),o})})}{const e=this;return E(function(...t){const o=e._def.args.safeParse(t,i);if(!o.success)throw new d([r(t,o.error)]);const a=Reflect.apply(s,this,o.data),c=e._def.returns.safeParse(a,i);if(!c.success)throw new d([n(a,c.error)]);return c.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new de({...this._def,args:ce.create(e).rest(J.create())})}returns(e){return new de({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new de({args:e||ce.create([]).rest(J.create()),returns:t||J.create(),typeName:Oe.ZodFunction,...x(r)})}}class pe extends T{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}pe.create=(e,t)=>new pe({getter:e,typeName:Oe.ZodLazy,...x(t)});class fe extends T{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return y(t,{received:t.data,code:h.invalid_literal,expected:this._def.value}),b}return{status:"valid",value:e.data}}get value(){return this._def.value}}function ge(e,t){return new me({values:e,typeName:Oe.ZodEnum,...x(t)})}fe.create=(e,t)=>new fe({value:e,typeName:Oe.ZodLiteral,...x(t)});class me extends T{_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),r=this._def.values;return y(t,{expected:n.joinValues(r),received:t.parsedType,code:h.invalid_type}),b}if(-1===this._def.values.indexOf(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return y(t,{received:t.data,code:h.invalid_enum_value,options:r}),b}return E(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return me.create(e)}exclude(e){return me.create(this.options.filter(t=>!e.includes(t)))}}me.create=ge;class ye extends T{_parse(e){const t=n.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==l.string&&r.parsedType!==l.number){const e=n.objectValues(t);return y(r,{expected:n.joinValues(e),received:r.parsedType,code:h.invalid_type}),b}if(-1===t.indexOf(e.data)){const e=n.objectValues(t);return y(r,{received:r.data,code:h.invalid_enum_value,options:e}),b}return E(e.data)}get enum(){return this._def.values}}ye.create=(e,t)=>new ye({values:e,typeName:Oe.ZodNativeEnum,...x(t)});class we extends T{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==l.promise&&!1===t.common.async)return y(t,{code:h.invalid_type,expected:l.promise,received:t.parsedType}),b;const r=t.parsedType===l.promise?t.data:Promise.resolve(t.data);return E(r.then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}we.create=(e,t)=>new we({type:e,typeName:Oe.ZodPromise,...x(t)});class be extends T{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Oe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:e=>{y(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),"preprocess"===i.type){const e=i.transform(r.data,s);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(e).then(e=>this._def.schema._parseAsync({data:e,path:r.path,parent:r})):this._def.schema._parseSync({data:e,path:r.path,parent:r})}if("refinement"===i.type){const e=e=>{const t=i.refinement(e,s);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===r.common.async){const n=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===n.status?b:("dirty"===n.status&&t.dirty(),e(n.value),{status:t.value,value:n.value})}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?b:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))))}if("transform"===i.type){if(!1===r.common.async){const e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!I(e))return e;const n=i.transform(e.value,s);if(n instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:n}}return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>I(e)?Promise.resolve(i.transform(e.value,s)).then(e=>({status:t.value,value:e})):e)}n.assertNever(i)}}be.create=(e,t,r)=>new be({schema:e,typeName:Oe.ZodEffects,effect:t,...x(r)}),be.createWithPreprocess=(e,t,r)=>new be({schema:t,effect:{type:"preprocess",transform:e},typeName:Oe.ZodEffects,...x(r)});class ve extends T{_parse(e){return this._getType(e)===l.undefined?E(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ve.create=(e,t)=>new ve({innerType:e,typeName:Oe.ZodOptional,...x(t)});class Ee extends T{_parse(e){return this._getType(e)===l.null?E(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ee.create=(e,t)=>new Ee({innerType:e,typeName:Oe.ZodNullable,...x(t)});class Ae extends T{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===l.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Ae.create=(e,t)=>new Ae({innerType:e,typeName:Oe.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...x(t)});class _e extends T{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},n=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return S(n)?n.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new d(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===n.status?n.value:this._def.catchValue({get error(){return new d(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}_e.create=(e,t)=>new _e({innerType:e,typeName:Oe.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...x(t)});class Ie extends T{_parse(e){if(this._getType(e)!==l.nan){const t=this._getOrReturnCtx(e);return y(t,{code:h.invalid_type,expected:l.nan,received:t.parsedType}),b}return{status:"valid",value:e.data}}}Ie.create=e=>new Ie({typeName:Oe.ZodNaN,...x(e)});const Se=Symbol("zod_brand");class Ce extends T{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class ke extends T{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?b:"dirty"===e.status?(t.dirty(),v(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{const e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?b:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new ke({in:e,out:t,typeName:Oe.ZodPipeline})}}class Ne extends T{_parse(e){const t=this._def.innerType._parse(e);return I(t)&&(t.value=Object.freeze(t.value)),t}}Ne.create=(e,t)=>new Ne({innerType:e,typeName:Oe.ZodReadonly,...x(t)});const xe=(e,t={},r)=>e?Z.create().superRefine((n,i)=>{var s,o;if(!e(n)){const e="function"==typeof t?t(n):"string"==typeof t?{message:t}:t,a=null===(o=null!==(s=e.fatal)&&void 0!==s?s:r)||void 0===o||o,c="string"==typeof e?{message:e}:e;i.addIssue({code:"custom",...c,fatal:a})}}):Z.create(),Te={object:re.lazycreate};var Oe;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(Oe||(Oe={}));const Pe=$.create,Re=q.create,Ue=Ie.create,Be=F.create,Me=H.create,Le=K.create,De=V.create,We=Y.create,je=G.create,$e=Z.create,ze=J.create,qe=X.create,Fe=Q.create,He=ee.create,Ke=re.create,Ve=re.strictCreate,Ye=ne.create,Ge=se.create,Ze=ae.create,Je=ce.create,Xe=le.create,Qe=ue.create,et=he.create,tt=de.create,rt=pe.create,nt=fe.create,it=me.create,st=ye.create,ot=we.create,at=be.create,ct=ve.create,lt=Ee.create,ut=be.createWithPreprocess,ht=ke.create,dt={string:e=>$.create({...e,coerce:!0}),number:e=>q.create({...e,coerce:!0}),boolean:e=>H.create({...e,coerce:!0}),bigint:e=>F.create({...e,coerce:!0}),date:e=>K.create({...e,coerce:!0})},pt=b;var ft=Object.freeze({__proto__:null,defaultErrorMap:p,setErrorMap:function(e){f=e},getErrorMap:g,makeIssue:m,EMPTY_PATH:[],addIssueToContext:y,ParseStatus:w,INVALID:b,DIRTY:v,OK:E,isAborted:A,isDirty:_,isValid:I,isAsync:S,get util(){return n},get objectUtil(){return i},ZodParsedType:l,getParsedType:u,ZodType:T,ZodString:$,ZodNumber:q,ZodBigInt:F,ZodBoolean:H,ZodDate:K,ZodSymbol:V,ZodUndefined:Y,ZodNull:G,ZodAny:Z,ZodUnknown:J,ZodNever:X,ZodVoid:Q,ZodArray:ee,ZodObject:re,ZodUnion:ne,ZodDiscriminatedUnion:se,ZodIntersection:ae,ZodTuple:ce,ZodRecord:le,ZodMap:ue,ZodSet:he,ZodFunction:de,ZodLazy:pe,ZodLiteral:fe,ZodEnum:me,ZodNativeEnum:ye,ZodPromise:we,ZodEffects:be,ZodTransformer:be,ZodOptional:ve,ZodNullable:Ee,ZodDefault:Ae,ZodCatch:_e,ZodNaN:Ie,BRAND:Se,ZodBranded:Ce,ZodPipeline:ke,ZodReadonly:Ne,custom:xe,Schema:T,ZodSchema:T,late:Te,get ZodFirstPartyTypeKind(){return Oe},coerce:dt,any:$e,array:He,bigint:Be,boolean:Me,date:Le,discriminatedUnion:Ge,effect:at,enum:it,function:tt,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>xe(t=>t instanceof e,t),intersection:Ze,lazy:rt,literal:nt,map:Qe,nan:Ue,nativeEnum:st,never:qe,null:je,nullable:lt,number:Re,object:Ke,oboolean:()=>Me().optional(),onumber:()=>Re().optional(),optional:ct,ostring:()=>Pe().optional(),pipeline:ht,preprocess:ut,promise:ot,record:Xe,set:et,strictObject:Ve,string:Pe,symbol:De,transformer:at,tuple:Je,undefined:We,union:Ye,unknown:ze,void:Fe,NEVER:pt,ZodIssueCode:h,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:d});const gt=ft.object({message:ft.string()});function mt(e){return ft.literal(a.s1[e])}const yt=ft.object({serializedMessage:ft.string().optional(),accountAddress:ft.string(),chainId:ft.string(),notBefore:ft.string().optional(),domain:ft.string(),uri:ft.string(),version:ft.string(),nonce:ft.string(),statement:ft.string().optional(),resources:ft.array(ft.string()).optional(),requestId:ft.string().optional(),issuedAt:ft.string().optional(),expirationTime:ft.string().optional()}),wt=(ft.object({accessList:ft.array(ft.string()),blockHash:ft.string().nullable(),blockNumber:ft.string().nullable(),chainId:ft.string().or(ft.number()),from:ft.string(),gas:ft.string(),hash:ft.string(),input:ft.string().nullable(),maxFeePerGas:ft.string(),maxPriorityFeePerGas:ft.string(),nonce:ft.string(),r:ft.string(),s:ft.string(),to:ft.string(),transactionIndex:ft.string().nullable(),type:ft.string(),v:ft.string(),value:ft.string()}),ft.object({chainId:ft.string().or(ft.number()),rpcUrl:ft.optional(ft.string())})),bt=ft.object({email:ft.string().email()}),vt=ft.object({otp:ft.string()}),Et=ft.object({uri:ft.string(),preferredAccountType:ft.optional(ft.string()),chainId:ft.optional(ft.string().or(ft.number())),siwxMessage:ft.optional(yt),rpcUrl:ft.optional(ft.string())}),At=ft.object({chainId:ft.optional(ft.string().or(ft.number())),preferredAccountType:ft.optional(ft.string()),socialUri:ft.optional(ft.string()),siwxMessage:ft.optional(yt),rpcUrl:ft.optional(ft.string())}),_t=ft.object({provider:ft.enum(["google","github","apple","facebook","x","discord"])}),It=ft.object({email:ft.string().email()}),St=ft.object({otp:ft.string()}),Ct=ft.object({otp:ft.string()}),kt=ft.object({themeMode:ft.optional(ft.enum(["light","dark"])),themeVariables:ft.optional(ft.record(ft.string(),ft.string().or(ft.number()))),w3mThemeVariables:ft.optional(ft.record(ft.string(),ft.string()))}),Nt=ft.object({metadata:ft.object({name:ft.string(),description:ft.string(),url:ft.string(),icons:ft.array(ft.string())}).optional(),sdkVersion:ft.string().optional(),sdkType:ft.string().optional(),projectId:ft.string()}),xt=ft.object({type:ft.string()}),Tt=ft.object({action:ft.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),Ot=ft.object({url:ft.string()}),Pt=ft.object({userName:ft.string()}),Rt=ft.object({email:ft.string().optional().nullable(),address:ft.string(),chainId:ft.string().or(ft.number()),accounts:ft.array(ft.object({address:ft.string(),type:ft.enum([a.Vl.ACCOUNT_TYPES.EOA,a.Vl.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:ft.string().optional().nullable(),preferredAccountType:ft.optional(ft.string()),signature:ft.string().optional(),message:ft.string().optional(),siwxMessage:ft.optional(yt)}),Ut=ft.object({action:ft.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),Bt=ft.object({email:ft.string().email().optional().nullable(),address:ft.string(),chainId:ft.string().or(ft.number()),smartAccountDeployed:ft.optional(ft.boolean()),accounts:ft.array(ft.object({address:ft.string(),type:ft.enum([a.Vl.ACCOUNT_TYPES.EOA,a.Vl.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:ft.optional(ft.string()),signature:ft.string().optional(),message:ft.string().optional(),siwxMessage:ft.optional(yt)}),Mt=ft.object({uri:ft.string()}),Lt=ft.object({isConnected:ft.boolean()}),Dt=ft.object({chainId:ft.string().or(ft.number())}),Wt=ft.object({chainId:ft.string().or(ft.number())}),jt=ft.object({newEmail:ft.string().email()}),$t=ft.object({smartAccountEnabledNetworks:ft.array(ft.number())}),zt=(ft.object({address:ft.string(),isDeployed:ft.boolean()}),ft.object({version:ft.string().optional()})),qt=ft.object({type:ft.string(),address:ft.string()}),Ft=ft.any(),Ht=ft.object({method:ft.literal("eth_accounts")}),Kt=ft.object({method:ft.literal("eth_blockNumber")}),Vt=ft.object({method:ft.literal("eth_call"),params:ft.array(ft.any())}),Yt=ft.object({method:ft.literal("eth_chainId")}),Gt=ft.object({method:ft.literal("eth_estimateGas"),params:ft.array(ft.any())}),Zt=ft.object({method:ft.literal("eth_feeHistory"),params:ft.array(ft.any())}),Jt=ft.object({method:ft.literal("eth_gasPrice")}),Xt=ft.object({method:ft.literal("eth_getAccount"),params:ft.array(ft.any())}),Qt=ft.object({method:ft.literal("eth_getBalance"),params:ft.array(ft.any())}),er=ft.object({method:ft.literal("eth_getBlockByHash"),params:ft.array(ft.any())}),tr=ft.object({method:ft.literal("eth_getBlockByNumber"),params:ft.array(ft.any())}),rr=ft.object({method:ft.literal("eth_getBlockReceipts"),params:ft.array(ft.any())}),nr=ft.object({method:ft.literal("eth_getBlockTransactionCountByHash"),params:ft.array(ft.any())}),ir=ft.object({method:ft.literal("eth_getBlockTransactionCountByNumber"),params:ft.array(ft.any())}),sr=ft.object({method:ft.literal("eth_getCode"),params:ft.array(ft.any())}),or=ft.object({method:ft.literal("eth_getFilterChanges"),params:ft.array(ft.any())}),ar=ft.object({method:ft.literal("eth_getFilterLogs"),params:ft.array(ft.any())}),cr=ft.object({method:ft.literal("eth_getLogs"),params:ft.array(ft.any())}),lr=ft.object({method:ft.literal("eth_getProof"),params:ft.array(ft.any())}),ur=ft.object({method:ft.literal("eth_getStorageAt"),params:ft.array(ft.any())}),hr=ft.object({method:ft.literal("eth_getTransactionByBlockHashAndIndex"),params:ft.array(ft.any())}),dr=ft.object({method:ft.literal("eth_getTransactionByBlockNumberAndIndex"),params:ft.array(ft.any())}),pr=ft.object({method:ft.literal("eth_getTransactionByHash"),params:ft.array(ft.any())}),fr=ft.object({method:ft.literal("eth_getTransactionCount"),params:ft.array(ft.any())}),gr=ft.object({method:ft.literal("eth_getTransactionReceipt"),params:ft.array(ft.any())}),mr=ft.object({method:ft.literal("eth_getUncleCountByBlockHash"),params:ft.array(ft.any())}),yr=ft.object({method:ft.literal("eth_getUncleCountByBlockNumber"),params:ft.array(ft.any())}),wr=ft.object({method:ft.literal("eth_maxPriorityFeePerGas")}),br=ft.object({method:ft.literal("eth_newBlockFilter")}),vr=ft.object({method:ft.literal("eth_newFilter"),params:ft.array(ft.any())}),Er=ft.object({method:ft.literal("eth_newPendingTransactionFilter")}),Ar=ft.object({method:ft.literal("eth_sendRawTransaction"),params:ft.array(ft.any())}),_r=ft.object({method:ft.literal("eth_syncing"),params:ft.array(ft.any())}),Ir=ft.object({method:ft.literal("eth_uninstallFilter"),params:ft.array(ft.any())}),Sr=ft.object({method:ft.literal("personal_sign"),params:ft.array(ft.any())}),Cr=ft.object({method:ft.literal("eth_signTypedData_v4"),params:ft.array(ft.any())}),kr=ft.object({method:ft.literal("eth_sendTransaction"),params:ft.array(ft.any())}),Nr=ft.object({method:ft.literal("solana_signMessage"),params:ft.object({message:ft.string(),pubkey:ft.string()})}),xr=ft.object({method:ft.literal("solana_signTransaction"),params:ft.object({transaction:ft.string()})}),Tr=ft.object({method:ft.literal("solana_signAllTransactions"),params:ft.object({transactions:ft.array(ft.string())})}),Or=ft.object({method:ft.literal("solana_signAndSendTransaction"),params:ft.object({transaction:ft.string(),options:ft.object({skipPreflight:ft.boolean().optional(),preflightCommitment:ft.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:ft.number().optional(),minContextSlot:ft.number().optional()}).optional()})}),Pr=ft.object({method:ft.literal("wallet_sendCalls"),params:ft.array(ft.object({chainId:ft.string().or(ft.number()).optional(),from:ft.string().optional(),version:ft.string().optional(),capabilities:ft.any().optional(),calls:ft.array(ft.object({to:ft.string().startsWith("0x"),data:ft.string().startsWith("0x").optional(),value:ft.string().optional()}))}))}),Rr=ft.object({method:ft.literal("wallet_getCallsStatus"),params:ft.array(ft.string())}),Ur=ft.object({method:ft.literal("wallet_getCapabilities"),params:ft.array(ft.string().or(ft.number()).optional()).optional()}),Br=ft.object({method:ft.literal("wallet_grantPermissions"),params:ft.array(ft.any())}),Mr=ft.object({method:ft.literal("wallet_revokePermissions"),params:ft.any()}),Lr=ft.object({method:ft.literal("wallet_getAssets"),params:ft.any()}),Dr=ft.object({token:ft.string()}),Wr=ft.object({id:ft.string().optional()}),jr={appEvent:Wr.extend({type:mt("APP_SWITCH_NETWORK"),payload:wt}).or(Wr.extend({type:mt("APP_CONNECT_EMAIL"),payload:bt})).or(Wr.extend({type:mt("APP_CONNECT_DEVICE")})).or(Wr.extend({type:mt("APP_CONNECT_OTP"),payload:vt})).or(Wr.extend({type:mt("APP_CONNECT_SOCIAL"),payload:Et})).or(Wr.extend({type:mt("APP_GET_FARCASTER_URI")})).or(Wr.extend({type:mt("APP_CONNECT_FARCASTER")})).or(Wr.extend({type:mt("APP_GET_USER"),payload:ft.optional(At)})).or(Wr.extend({type:mt("APP_GET_SOCIAL_REDIRECT_URI"),payload:_t})).or(Wr.extend({type:mt("APP_SIGN_OUT")})).or(Wr.extend({type:mt("APP_IS_CONNECTED"),payload:ft.optional(Dr)})).or(Wr.extend({type:mt("APP_GET_CHAIN_ID")})).or(Wr.extend({type:mt("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(Wr.extend({type:mt("APP_INIT_SMART_ACCOUNT")})).or(Wr.extend({type:mt("APP_SET_PREFERRED_ACCOUNT"),payload:xt})).or(Wr.extend({type:mt("APP_RPC_REQUEST"),payload:Sr.or(Lr).or(Ht).or(Kt).or(Vt).or(Yt).or(Gt).or(Zt).or(Jt).or(Xt).or(Qt).or(er).or(tr).or(rr).or(nr).or(ir).or(sr).or(or).or(ar).or(cr).or(lr).or(ur).or(hr).or(dr).or(pr).or(fr).or(gr).or(mr).or(yr).or(wr).or(br).or(vr).or(Er).or(Ar).or(_r).or(Ir).or(Sr).or(Cr).or(kr).or(Nr).or(xr).or(Tr).or(Or).or(Rr).or(Pr).or(Ur).or(Br).or(Mr).and(ft.object({chainId:ft.string().or(ft.number()).optional(),chainNamespace:ft.enum(["eip155","solana","polkadot","bip122","cosmos"]).optional(),rpcUrl:ft.string().optional()}))})).or(Wr.extend({type:mt("APP_UPDATE_EMAIL"),payload:It})).or(Wr.extend({type:mt("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:St})).or(Wr.extend({type:mt("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:Ct})).or(Wr.extend({type:mt("APP_SYNC_THEME"),payload:kt})).or(Wr.extend({type:mt("APP_SYNC_DAPP_DATA"),payload:Nt})).or(Wr.extend({type:mt("APP_RELOAD")})).or(Wr.extend({type:mt("APP_RPC_ABORT")})),frameEvent:Wr.extend({type:mt("FRAME_SWITCH_NETWORK_ERROR"),payload:gt}).or(Wr.extend({type:mt("FRAME_SWITCH_NETWORK_SUCCESS"),payload:Wt})).or(Wr.extend({type:mt("FRAME_CONNECT_EMAIL_SUCCESS"),payload:Tt})).or(Wr.extend({type:mt("FRAME_CONNECT_EMAIL_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:Ot})).or(Wr.extend({type:mt("FRAME_GET_FARCASTER_URI_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:Pt})).or(Wr.extend({type:mt("FRAME_CONNECT_FARCASTER_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_CONNECT_OTP_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_CONNECT_OTP_SUCCESS")})).or(Wr.extend({type:mt("FRAME_CONNECT_DEVICE_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_CONNECT_DEVICE_SUCCESS")})).or(Wr.extend({type:mt("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:Rt})).or(Wr.extend({type:mt("FRAME_CONNECT_SOCIAL_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_GET_USER_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_GET_USER_SUCCESS"),payload:Bt})).or(Wr.extend({type:mt("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:Mt})).or(Wr.extend({type:mt("FRAME_SIGN_OUT_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_SIGN_OUT_SUCCESS")})).or(Wr.extend({type:mt("FRAME_IS_CONNECTED_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_IS_CONNECTED_SUCCESS"),payload:Lt})).or(Wr.extend({type:mt("FRAME_GET_CHAIN_ID_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_GET_CHAIN_ID_SUCCESS"),payload:Dt})).or(Wr.extend({type:mt("FRAME_RPC_REQUEST_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_RPC_REQUEST_SUCCESS"),payload:Ft})).or(Wr.extend({type:mt("FRAME_SESSION_UPDATE"),payload:Dr})).or(Wr.extend({type:mt("FRAME_UPDATE_EMAIL_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_UPDATE_EMAIL_SUCCESS"),payload:Ut})).or(Wr.extend({type:mt("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(Wr.extend({type:mt("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:jt})).or(Wr.extend({type:mt("FRAME_SYNC_THEME_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_SYNC_THEME_SUCCESS")})).or(Wr.extend({type:mt("FRAME_SYNC_DAPP_DATA_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(Wr.extend({type:mt("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:$t})).or(Wr.extend({type:mt("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:qt})).or(Wr.extend({type:mt("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_READY"),payload:zt})).or(Wr.extend({type:mt("FRAME_RELOAD_ERROR"),payload:gt})).or(Wr.extend({type:mt("FRAME_RELOAD_SUCCESS")}))};function $r(e,t={}){return"string"==typeof t?.type&&t?.type?.includes(e)}class zr{constructor({projectId:e,isAppClient:t=!1,chainId:r="eip155:1",enableLogger:n=!0,enableCloudAuthAccount:i=!1,rpcUrl:s=o.o.BLOCKCHAIN_API_RPC_URL}){if(this.iframe=null,this.iframeIsReady=!1,this.initFrame=()=>{const e=document.getElementById("w3m-iframe");this.iframe&&!e&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(e,t,r)=>{function n({data:r}){if(!$r(a.s1.FRAME_EVENT_KEY,r))return;const i=jr.frameEvent.safeParse(r);i.success?i.data?.id===e&&(t(i.data),window.removeEventListener("message",n)):console.warn("W3mFrame: invalid frame event",i.error.message)}c.Q.isClient&&(window.addEventListener("message",n),r.addEventListener("abort",()=>{window.removeEventListener("message",n)}))},onFrameEvent:e=>{c.Q.isClient&&window.addEventListener("message",({data:t})=>{if(!$r(a.s1.FRAME_EVENT_KEY,t))return;const r=jr.frameEvent.safeParse(t);r.success?e(r.data):console.warn("W3mFrame: invalid frame event",r.error.message)})},onAppEvent:e=>{c.Q.isClient&&window.addEventListener("message",({data:t})=>{if(!$r(a.s1.APP_EVENT_KEY,t))return;const r=jr.appEvent.safeParse(t);r.success||console.warn("W3mFrame: invalid app event",r.error.message),e(t)})},postAppEvent:e=>{if(c.Q.isClient){if(!this.iframe?.contentWindow)throw new Error("W3mFrame: iframe is not set");this.iframe.contentWindow.postMessage(e,"*")}},postFrameEvent:e=>{if(c.Q.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");parent.postMessage(e,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((e,t)=>{this.frameLoadPromiseResolver={resolve:e,reject:t}}),this.rpcUrl=s,t&&(this.frameLoadPromise=new Promise((e,t)=>{this.frameLoadPromiseResolver={resolve:e,reject:t}}),c.Q.isClient)){const t=document.createElement("iframe");t.id="w3m-iframe",t.src=function({projectId:e,chainId:t,enableLogger:r,rpcUrl:n=o.o.BLOCKCHAIN_API_RPC_URL,enableCloudAuthAccount:i=!1}){const s=new URL(a.hy);return s.searchParams.set("projectId",e),s.searchParams.set("chainId",String(t)),s.searchParams.set("version",a.gS),s.searchParams.set("enableLogger",String(r)),s.searchParams.set("rpcUrl",n),i&&s.searchParams.set("enableCloudAuthAccount","true"),s.toString()}({projectId:e,chainId:r,enableLogger:n,rpcUrl:this.rpcUrl,enableCloudAuthAccount:i}),t.name="w3m-secure-iframe",t.style.position="fixed",t.style.zIndex="999999",t.style.display="none",t.style.border="none",t.style.animationDelay="0s, 50ms",t.style.borderBottomLeftRadius="clamp(0px, var(--wui-border-radius-l), 44px)",t.style.borderBottomRightRadius="clamp(0px, var(--wui-border-radius-l), 44px)",this.iframe=t,this.iframe.onerror=()=>{this.frameLoadPromiseResolver?.reject("Unable to load email login dependency")},this.events.onFrameEvent(e=>{"@w3m-frame/READY"===e.type&&(this.iframeIsReady=!0,this.frameLoadPromiseResolver?.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(e=>({[e]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${e}&projectId=${this.projectId}`,chainId:e}}));return Object.assign({},...e)}}var qr=r(9838);class Fr{constructor(e){const t=(0,qr.iP)({level:a.OH}),{logger:r,chunkLoggerController:n}=(0,qr.D5)({opts:t});this.logger=(0,qr.U5)(r,this.constructor.name),this.chunkLoggerController=n,"undefined"!=typeof window&&this.chunkLoggerController?.downloadLogsBlobInBrowser&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{this.chunkLoggerController?.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}var Hr=r(6508);class Kr{constructor({projectId:e,chainId:t,enableLogger:r=!0,onTimeout:n,abortController:i,getActiveCaipNetwork:s,getCaipNetworks:o,enableCloudAuthAccount:a}){this.openRpcRequests=[],this.isInitialized=!1,r&&(this.w3mLogger=new Fr(e)),this.abortController=i,this.getActiveCaipNetwork=s,this.getCaipNetworks=o;const c=this.getRpcUrl(t);this.w3mFrame=new zr({projectId:e,isAppClient:!0,chainId:t,enableLogger:r,rpcUrl:c,enableCloudAuthAccount:a}),this.onTimeout=n,this.getLoginEmailUsed()&&this.createFrame()}async createFrame(){this.w3mFrame.initFrame(),this.initPromise=new Promise(e=>{this.w3mFrame.events.onFrameEvent(t=>{t.type===a.s1.FRAME_READY&&setTimeout(()=>{e()},500)})}),await this.initPromise,this.isInitialized=!0,this.initPromise=void 0}async init(){this.isInitialized||(this.initPromise?await this.initPromise:await this.createFrame())}getLoginEmailUsed(){return Boolean(Hr.o.get(a.s1.EMAIL_LOGIN_USED_KEY))}getEmail(){return Hr.o.get(a.s1.EMAIL)}getUsername(){return Hr.o.get(a.s1.SOCIAL_USERNAME)}async reload(){try{await this.appEvent({type:a.s1.APP_RELOAD})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error reloading iframe"),e}}async connectEmail(e){try{c.Q.checkIfAllowedToTriggerEmail(),await this.init();const t=await this.appEvent({type:a.s1.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),t}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting email"),e}}async connectDevice(){try{return this.appEvent({type:a.s1.APP_CONNECT_DEVICE})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting device"),e}}async connectOtp(e){try{return this.appEvent({type:a.s1.APP_CONNECT_OTP,payload:e})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting otp"),e}}async isConnected(){try{if(!this.getLoginEmailUsed())return{isConnected:!1};const e=await this.appEvent({type:a.s1.APP_IS_CONNECTED});return e?.isConnected||this.deleteAuthLoginCache(),e}catch(e){throw this.deleteAuthLoginCache(),this.w3mLogger?.logger.error({error:e},"Error checking connection"),e}}async getChainId(){try{const e=await this.appEvent({type:a.s1.APP_GET_CHAIN_ID});return this.setLastUsedChainId(e.chainId),e}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error getting chain id"),e}}async getSocialRedirectUri(e){try{return await this.init(),this.appEvent({type:a.s1.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error getting social redirect uri"),e}}async updateEmail(e){try{const t=await this.appEvent({type:a.s1.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),t}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error updating email"),e}}async updateEmailPrimaryOtp(e){try{return this.appEvent({type:a.s1.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error updating email primary otp"),e}}async updateEmailSecondaryOtp(e){try{const t=await this.appEvent({type:a.s1.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(t.newEmail),t}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error updating email secondary otp"),e}}async syncTheme(e){try{return this.appEvent({type:a.s1.APP_SYNC_THEME,payload:e})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error syncing theme"),e}}async syncDappData(e){try{return this.appEvent({type:a.s1.APP_SYNC_DAPP_DATA,payload:e})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error syncing dapp data"),e}}async getSmartAccountEnabledNetworks(){try{const e=await this.appEvent({type:a.s1.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(e.smartAccountEnabledNetworks),e}catch(e){throw this.persistSmartAccountEnabledNetworks([]),this.w3mLogger?.logger.error({error:e},"Error getting smart account enabled networks"),e}}async setPreferredAccount(e){try{return this.appEvent({type:a.s1.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error setting preferred account"),e}}async connect(e){if(e?.socialUri)try{await this.init();const t=this.getRpcUrl(e.chainId),r=await this.appEvent({type:a.s1.APP_CONNECT_SOCIAL,payload:{uri:e.socialUri,preferredAccountType:e.preferredAccountType,chainId:e.chainId,siwxMessage:e.siwxMessage,rpcUrl:t}});return r.userName&&this.setSocialLoginSuccess(r.userName),this.setLoginSuccess(r.email),this.setLastUsedChainId(r.chainId),this.user=r,r}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting social"),e}else try{const t=e?.chainId||this.getLastUsedChainId()||1,r=await this.getUser({chainId:t,preferredAccountType:e?.preferredAccountType,siwxMessage:e?.siwxMessage,rpcUrl:this.getRpcUrl(t)});return this.setLoginSuccess(r.email),this.setLastUsedChainId(r.chainId),this.user=r,r}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting"),e}}async getUser(e){try{await this.init();const t=e?.chainId||this.getLastUsedChainId()||1,r=await this.appEvent({type:a.s1.APP_GET_USER,payload:{...e,chainId:t,rpcUrl:this.getRpcUrl(t)}});return this.user=r,r}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting"),e}}async connectSocial({uri:e,chainId:t,preferredAccountType:r}){try{await this.init();const n=this.getRpcUrl(t),i=await this.appEvent({type:a.s1.APP_CONNECT_SOCIAL,payload:{uri:e,chainId:t,rpcUrl:n,preferredAccountType:r}});return i.userName&&this.setSocialLoginSuccess(i.userName),i}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting social"),e}}async getFarcasterUri(){try{return await this.init(),await this.appEvent({type:a.s1.APP_GET_FARCASTER_URI})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error getting farcaster uri"),e}}async connectFarcaster(){try{const e=await this.appEvent({type:a.s1.APP_CONNECT_FARCASTER});return e.userName&&this.setSocialLoginSuccess(e.userName),e}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting farcaster"),e}}async switchNetwork({chainId:e}){try{const t=this.getRpcUrl(e),r=await this.appEvent({type:a.s1.APP_SWITCH_NETWORK,payload:{chainId:e,rpcUrl:t}});return this.setLastUsedChainId(r.chainId),r}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error switching network"),e}}async disconnect(){try{return this.deleteAuthLoginCache(),await new Promise(async e=>{const t=setTimeout(()=>{e()},3e3);await this.appEvent({type:a.s1.APP_SIGN_OUT}),clearTimeout(t),e()})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error disconnecting"),e}}async request(e){const t=e;try{if(a.Vl.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();const r=e.chainNamespace||"eip155",n=this.getActiveCaipNetwork(r)?.id;t.chainNamespace=r,t.chainId=n,t.rpcUrl=this.getRpcUrl(n),this.rpcRequestHandler?.(e);const i=await this.appEvent({type:a.s1.APP_RPC_REQUEST,payload:t});return this.rpcSuccessHandler?.(i,t),i}catch(e){throw this.rpcErrorHandler?.(e,t),this.w3mLogger?.logger.error({error:e},"Error requesting"),e}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===a.s1.FRAME_IS_CONNECTED_SUCCESS&&t.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===a.s1.FRAME_IS_CONNECTED_ERROR&&e(),t.type!==a.s1.FRAME_IS_CONNECTED_SUCCESS||t.payload.isConnected||e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===a.s1.FRAME_GET_USER_SUCCESS&&e(t.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===a.s1.FRAME_CONNECT_SOCIAL_SUCCESS&&e(t.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(t=>{t.type===a.s1.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(t.payload):t.type===a.s1.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:a.Vl.ACCOUNT_TYPES.EOA})})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}async rejectRpcRequests(){try{await Promise.all(this.openRpcRequests.map(async({abortController:e,method:t})=>{a.Vl.SAFE_RPC_METHODS.includes(t)||e.abort(),await this.appEvent({type:a.s1.APP_RPC_ABORT})})),this.openRpcRequests=[]}catch(e){this.w3mLogger?.logger.error({error:e},"Error aborting RPC request")}}async appEvent(e){let t,r;function n(e){return e.replace("@w3m-app/","")}const i=[a.s1.APP_SYNC_DAPP_DATA,a.s1.APP_SYNC_THEME,a.s1.APP_SET_PREFERRED_ACCOUNT],s=n(e.type);return this.w3mFrame.iframeIsReady||i.includes(e.type)||(r=setTimeout(()=>{this.onTimeout?.("iframe_load_failed"),this.abortController.abort()},2e4)),await this.w3mFrame.frameLoadPromise,clearTimeout(r),[a.s1.APP_CONNECT_EMAIL,a.s1.APP_CONNECT_DEVICE,a.s1.APP_CONNECT_OTP,a.s1.APP_CONNECT_SOCIAL,a.s1.APP_GET_SOCIAL_REDIRECT_URI].map(n).includes(s)&&(t=setTimeout(()=>{this.onTimeout?.("iframe_request_timeout"),this.abortController.abort()},12e4)),new Promise((n,i)=>{const o=Math.random().toString(36).substring(7);this.w3mLogger?.logger.info?.({event:e,id:o},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:o});const a=new AbortController;if("RPC_REQUEST"===s){const t=e;this.openRpcRequests=[...this.openRpcRequests,{...t.payload,abortController:a}]}a.signal.addEventListener("abort",()=>{"RPC_REQUEST"===s?i(new Error("Request was aborted")):"GET_FARCASTER_URI"!==s&&i(new Error("Something went wrong"))}),this.w3mFrame.events.registerFrameEventHandler(o,e=>{return a=e,c=this.w3mLogger,void(a.id===o&&(c?.logger.info?.({framEvent:a,id:o},"Received frame response"),a.type===`@w3m-frame/${s}_SUCCESS`?(t&&clearTimeout(t),r&&clearTimeout(r),"payload"in a&&n(a.payload),n(void 0)):a.type===`@w3m-frame/${s}_ERROR`&&(t&&clearTimeout(t),r&&clearTimeout(r),"payload"in a&&i(new Error(a.payload?.message||"An error occurred")),i(new Error("An error occurred")))));var a,c},this.abortController.signal)})}setNewLastEmailLoginTime(){Hr.o.set(a.s1.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){Hr.o.set(a.s1.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&Hr.o.set(a.s1.EMAIL,e),Hr.o.set(a.s1.EMAIL_LOGIN_USED_KEY,"true"),Hr.o.delete(a.s1.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){Hr.o.delete(a.s1.EMAIL_LOGIN_USED_KEY),Hr.o.delete(a.s1.EMAIL),Hr.o.delete(a.s1.LAST_USED_CHAIN_KEY),Hr.o.delete(a.s1.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&Hr.o.set(a.s1.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=Hr.o.get(a.s1.LAST_USED_CHAIN_KEY)??void 0,t=Number(e);return isNaN(t)?e:t}persistSmartAccountEnabledNetworks(e){Hr.o.set(a.s1.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}getRpcUrl(e){let t=void 0===e?void 0:"eip155";"string"==typeof e&&(t=e.includes(":")?s.C.parseCaipNetworkId(e)?.chainNamespace:Number.isInteger(Number(e))?"eip155":"solana");const r=this.getCaipNetworks(t),n=e?r.find(t=>String(t.id)===String(e)||t.caipNetworkId===e):r[0];return n?.rpcUrls.default.http?.[0]}}},9838:(e,t,r)=>{r.d(t,{D5:()=>C,U5:()=>S,h6:()=>i.a,iP:()=>_,oI:()=>I});var n=r(4874),i=r.n(n),s=r(3554);const o={level:"info"},a="custom_context",c=1024e3;class l{constructor(e){this.nodeValue=e,this.sizeInBytes=(new TextEncoder).encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class u{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const t=new l(e);if(t.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=t),this.tail=t):(this.head=t,this.tail=t),this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let t=this.head;for(;null!==t;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const t=e.value;return e=e.next,{done:!1,value:t}}}}}class h{constructor(e,t=c){this.level=e??"error",this.levelValue=n.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new u(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===n.levels.values.error?console.error(e):t===n.levels.values.warn?console.warn(e):t===n.levels.values.debug?console.debug(e):t===n.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append((0,s.h)({timestamp:(new Date).toISOString(),log:e}));const t="string"==typeof e?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new u(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const t=this.getLogArray();return t.push((0,s.h)({extraMetadata:e})),new Blob(t,{type:"application/json"})}}class d{constructor(e,t=c){this.baseChunkLogger=new h(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const t=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=t,r.download=`walletconnect-logs-${(new Date).toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}}class p{constructor(e,t=c){this.baseChunkLogger=new h(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}}var f=Object.defineProperty,g=Object.defineProperties,m=Object.getOwnPropertyDescriptors,y=Object.getOwnPropertySymbols,w=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable,v=(e,t,r)=>t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,E=(e,t)=>{for(var r in t||(t={}))w.call(t,r)&&v(e,r,t[r]);if(y)for(var r of y(t))b.call(t,r)&&v(e,r,t[r]);return e},A=(e,t)=>g(e,m(t));function _(e){return A(E({},e),{level:e?.level||o.level})}function I(e,t=a){let r="";return r=typeof e.bindings>"u"?function(e,t=a){return e[t]||""}(e,t):e.bindings().context||"",r}function S(e,t,r=a){const n=function(e,t,r=a){const n=I(e,r);return n.trim()?`${n}/${t}`:t}(e,t,r);return function(e,t,r=a){return e[r]=t,e}(e.child({context:n}),n,r)}function C(e){return typeof e.loggerOverride<"u"&&"string"!=typeof e.loggerOverride?{logger:e.loggerOverride,chunkLoggerController:null}:typeof window<"u"?function(e){var t,r;const n=new d(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:i()(A(E({},e.opts),{level:"trace",browser:A(E({},null==(r=e.opts)?void 0:r.browser),{write:e=>n.write(e)})})),chunkLoggerController:n}}(e):function(e){var t;const r=new p(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:i()(A(E({},e.opts),{level:"trace"}),r),chunkLoggerController:r}}(e)}},9883:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(e){if(this.timestamps.has(e))throw new Error(`Watch already started for label: ${e}`);this.timestamps.set(e,{started:Date.now()})}stop(e){const t=this.get(e);if(void 0!==t.elapsed)throw new Error(`Watch already stopped for label: ${e}`);const r=Date.now()-t.started;this.timestamps.set(e,{started:t.started,elapsed:r})}get(e){const t=this.timestamps.get(e);if(void 0===t)throw new Error(`No timestamp found for label: ${e}`);return t}elapsed(e){const t=this.get(e);return t.elapsed||Date.now()-t.started}}t.Watch=r,t.default=r}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var s=n[e]={id:e,loaded:!1,exports:{}};return r[e].call(s.exports,s,s.exports,i),s.loaded=!0,s.exports}i.m=r,i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce((t,r)=>(i.f[r](e,t),t),[])),i.u=e=>e+".mainModule.js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),e={8792:0},t=t=>{var r,n,{__webpack_esm_ids__:s,__webpack_esm_modules__:o,__webpack_esm_runtime__:a}=t,c=0;for(r in o)i.o(o,r)&&(i.m[r]=o[r]);for(a&&a(i);c<s.length;c++)n=s[c],i.o(e,n)&&e[n]&&e[n][0](),e[s[c]]=0},i.f.j=(r,n)=>{var s=i.o(e,r)?e[r]:void 0;if(0!==s)if(s)n.push(s[1]);else{var o=import("./"+i.u(r)).then(t,t=>{throw 0!==e[r]&&(e[r]=void 0),t});o=Promise.race([o,new Promise(t=>s=e[r]=[t])]),n.push(s[1]=o)}};var s=i(6742),o=i(4376),a=i(3096),c=i(1122),l=i(4496),u=i(6010),h=i(1211),d=i(184),p=i(8467),f=i(8249),g=i(2944),m=i(6056),y=i(2733),w=i(3450),b=i(8996),v=i(7508),E=i(1655),A=i(9510),_=i(5306),I=i(1785),S=i(8990),C=i(6409),k=i(152),N=i(9835);class x{constructor(){}static getInstance({projectId:e,chainId:t,enableLogger:r,onTimeout:n,abortController:i,getActiveCaipNetwork:s,getCaipNetworks:o}){return x.instance||(x.instance=new N.Y({projectId:e,chainId:t,enableLogger:r,onTimeout:n,abortController:i,getActiveCaipNetwork:s,getCaipNetworks:o,enableCloudAuthAccount:Boolean(y.H.state.remoteFeatures?.emailCapture)})),x.instance}}var T=i(6601),O=i(5910),P=i(3495),R=i(5595),U=i(4549),B=i(7601),M=i(8577),L=i(5884),D=i(8351),W=i(6396),j=i(1871),$=i(8508),z=i(6092),q=(i(1482),i(5042)),F=i(148),H=i(5839),K=i(9838);const V={createLogger(e,t="error"){const r=(0,K.iP)({level:t}),{logger:n}=(0,K.D5)({opts:r});return n.error=(...t)=>{for(const r of t)if(r instanceof Error)return void e(r,...t);e(void 0,...t)},n}};var Y=i(1307),G=i(1727),Z=i(2571);const J={hexStringToNumber(e){const t=e.startsWith("0x")?e.slice(2):e;return parseInt(t,16)},numberToHexString:e=>`0x${e.toString(16)}`,async getUserInfo(e){const[t,r]=await Promise.all([J.getAddresses(e),J.getChainId(e)]);return{chainId:r,addresses:t}},async getChainId(e){const t=await e.request({method:"eth_chainId"});return Number(t)},async getAddress(e){const[t]=await e.request({method:"eth_accounts"});return t},getAddresses:async e=>await e.request({method:"eth_accounts"}),async addEthereumChain(e,t){const r=t.rpcUrls.chainDefault?.http||[];await e.request({method:"wallet_addEthereumChain",params:[{chainId:J.numberToHexString(t.id),rpcUrls:[...r],chainName:t.name,nativeCurrency:{name:t.nativeCurrency.name,decimals:t.nativeCurrency.decimals,symbol:t.nativeCurrency.symbol},blockExplorerUrls:[t.blockExplorers?.default.url],iconUrls:[Z.L.NetworkImageIds[t.id]]}]})}},X=0,Q=1;function ee(e){return{formatters:void 0,fees:void 0,serializers:void 0,...e}}const te=ee({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),re=ee({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"}),ne=ee({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"}),ie=(ee({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}}),ee({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0}),{solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]}),se={getMethodsByChainNamespace:e=>ie[e]||[],createDefaultNamespace(e){return{methods:this.getMethodsByChainNamespace(e),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(e,t){if(!t)return{...e};const r={...e},n=new Set;if(t.methods&&Object.keys(t.methods).forEach(e=>n.add(e)),t.chains&&Object.keys(t.chains).forEach(e=>n.add(e)),t.events&&Object.keys(t.events).forEach(e=>n.add(e)),t.rpcMap&&Object.keys(t.rpcMap).forEach(e=>{const[t]=e.split(":");t&&n.add(t)}),n.forEach(e=>{r[e]||(r[e]=this.createDefaultNamespace(e))}),t.methods&&Object.entries(t.methods).forEach(([e,t])=>{r[e]&&(r[e].methods=t)}),t.chains&&Object.entries(t.chains).forEach(([e,t])=>{r[e]&&(r[e].chains=t)}),t.events&&Object.entries(t.events).forEach(([e,t])=>{r[e]&&(r[e].events=t)}),t.rpcMap){const e=new Set;Object.entries(t.rpcMap).forEach(([t,n])=>{const[i,s]=t.split(":");i&&s&&r[i]&&(r[i].rpcMap||(r[i].rpcMap={}),e.has(i)||(r[i].rpcMap={},e.add(i)),r[i].rpcMap[s]=n)})}return r},createNamespaces(e,t){const r=e.reduce((e,t)=>{const{id:r,chainNamespace:n,rpcUrls:i}=t,s=i.default.http[0];e[n]||(e[n]=this.createDefaultNamespace(n));const o=`${n}:${r}`,a=e[n];switch(a.chains.push(o),o){case te.caipNetworkId:a.chains.push(te.deprecatedCaipNetworkId);break;case re.caipNetworkId:a.chains.push(re.deprecatedCaipNetworkId)}return a?.rpcMap&&s&&(a.rpcMap[r]=s),e},{});return this.applyNamespaceOverrides(r,t)},resolveReownName:async e=>{const t=await U.f.resolveName(e),r=Object.values(t?.addresses)||[];return r[0]?.address||!1},getChainsFromNamespaces:(e={})=>Object.values(e).flatMap(e=>{const t=e.chains||[],r=e.accounts.map(e=>{const[t,r]=e.split(":");return`${t}:${r}`});return Array.from(new Set([...t,...r]))}),isSessionEventData:e=>"object"==typeof e&&null!==e&&"id"in e&&"topic"in e&&"params"in e&&"object"==typeof e.params&&null!==e.params&&"chainId"in e.params&&"event"in e.params&&"object"==typeof e.params.event&&null!==e.params.event,isOriginAllowed(e,t,r){for(const n of[...t,...r])if(n.includes("*")){const t=`^${n.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*")}$`;if(new RegExp(t,"u").test(e))return!0}else try{if(new URL(n).origin===e)return!0}catch(t){if(n===e)return!0}return!1},listenWcProvider({universalProvider:e,namespace:t,onConnect:r,onDisconnect:n,onAccountsChanged:i,onChainChanged:o,onDisplayUri:a}){r&&e.on("connect",()=>{const n=se.getWalletConnectAccounts(e,t);r(n)}),n&&e.on("disconnect",()=>{n()}),i&&e.on("session_event",e=>{if(se.isSessionEventData(e)){const{name:r,data:n}=e.params.event;if("accountsChanged"===r&&Array.isArray(n)){const e=n.filter(e=>s.w.isCaipAddress(e)).map(e=>O.C.parseCaipAddress(e)).filter(e=>e.chainNamespace===t);i(e)}}}),o&&e.on("chainChanged",e=>{o(e)}),a&&e.on("display_uri",e=>{a(e)})},getWalletConnectAccounts(e,t){const r=new Set,n=e?.session?.namespaces?.[t]?.accounts?.map(e=>O.C.parseCaipAddress(e)).filter(({address:e})=>!r.has(e.toLowerCase())&&(r.add(e.toLowerCase()),!0));return n&&n.length>0?n:[]}};class oe{constructor(e){this.namespace=e.namespace}async syncConnections(e){switch(this.namespace){case o.o.CHAIN.EVM:await this.syncEVMConnections(e);break;case o.o.CHAIN.SOLANA:await this.syncSolanaConnections(e);break;case o.o.CHAIN.BITCOIN:await this.syncBitcoinConnections(e);break;default:throw new Error(`Unsupported chain namespace: ${this.namespace}`)}}async syncEVMConnections({connectors:e,caipNetworks:t,universalProvider:r,getConnectionStatusInfo:n,onConnection:i,onListenProvider:s}){await Promise.all(e.filter(e=>{const{hasDisconnected:t,hasConnected:r}=n(e.id);return!t&&r}).map(async e=>{if(e.id===o.o.CONNECTOR_ID.WALLET_CONNECT){const n=se.getWalletConnectAccounts(r,this.namespace),s=t.find(e=>e.chainNamespace===this.namespace&&e.id.toString()===n[0]?.chainId?.toString());n.length>0&&i({connectorId:e.id,accounts:n.map(e=>({address:e.address})),caipNetwork:s})}else{const{accounts:r,chainId:n}=await z.g.fetchProviderData(e);if(r.length>0&&n){const a=t.find(e=>e.chainNamespace===this.namespace&&e.id.toString()===n.toString());i({connectorId:e.id,accounts:r.map(e=>({address:e})),caipNetwork:a}),e.provider&&e.id!==o.o.CONNECTOR_ID.AUTH&&e.id!==o.o.CONNECTOR_ID.WALLET_CONNECT&&s(e.id,e.provider)}}}))}async syncSolanaConnections({connectors:e,caipNetwork:t,universalProvider:r,getConnectionStatusInfo:n,onConnection:i,onListenProvider:s}){await Promise.all(e.filter(e=>{const{hasDisconnected:t,hasConnected:r}=n(e.id);return!t&&r}).map(async e=>{if(e.id===o.o.CONNECTOR_ID.WALLET_CONNECT){const n=se.getWalletConnectAccounts(r,this.namespace);n.length>0&&i({connectorId:e.id,accounts:n.map(e=>({address:e.address})),caipNetwork:t})}else{const r=await e.connect({chainId:t?.id});r&&(i({connectorId:e.id,accounts:[{address:r}],caipNetwork:t}),s(e.id,e.provider))}}))}async syncBitcoinConnections({connectors:e,caipNetwork:t,universalProvider:r,getConnectionStatusInfo:n,onConnection:i,onListenProvider:a}){await Promise.all(e.filter(e=>{const{hasDisconnected:t,hasConnected:r}=n(e.id);return!t&&r}).map(async e=>{if(e.id===o.o.CONNECTOR_ID.WALLET_CONNECT){const n=se.getWalletConnectAccounts(r,this.namespace);return void(n.length>0&&i({connectorId:e.id,accounts:n.map(e=>({address:e.address})),caipNetwork:t}))}const n=await e.connect(),c=await e.getAccountAddresses();let l=c?.map(e=>s.w.createAccount(o.o.CHAIN.BITCOIN,e.address,e.purpose||"payment",e.publicKey,e.path));if(l&&l.length>1&&(l=[{namespace:o.o.CHAIN.BITCOIN,publicKey:l[X]?.publicKey??"",path:l[X]?.path??"",address:l[X]?.address??"",type:"payment"},{namespace:o.o.CHAIN.BITCOIN,publicKey:l[Q]?.publicKey??"",path:l[Q]?.path??"",address:l[Q]?.address??"",type:"ordinal"}]),!e.chains.find(e=>e.id===t?.id)&&!e.chains[0])throw new Error("The connector does not support any of the requested chains");n&&(a(e.id,e.provider),i({connectorId:e.id,accounts:l.map(e=>({address:e.address,type:e.type})),caipNetwork:t}))}))}getConnection({address:e,connectorId:t,connections:r,connectors:n}){if(t){const i=r.find(e=>_.y.isLowerCaseMatch(e.connectorId,t));if(!i)return null;const s=n.find(e=>_.y.isLowerCaseMatch(e.id,i.connectorId)),o=e?i.accounts.find(t=>_.y.isLowerCaseMatch(t.address,e)):i.accounts[0];return{...i,account:o,connector:s}}const i=r.find(e=>e.accounts.length>0&&n.some(t=>_.y.isLowerCaseMatch(t.id,e.connectorId)));if(i){const[e]=i.accounts,t=n.find(e=>_.y.isLowerCaseMatch(e.id,i.connectorId));return{...i,account:e,connector:t}}return null}}const ae=["http://localhost:*","https://localhost:*","http://127.0.0.1:*","https://127.0.0.1:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"];class ce{constructor({provider:e,namespace:t}){this.id=o.o.CONNECTOR_ID.WALLET_CONNECT,this.name=Z.L.ConnectorNamesMap[o.o.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=Z.L.ConnectorImageIds[o.o.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=m.W.getCaipNetworks.bind(m.W),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=t}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const e=this.getCaipNetworks(),t=y.H.state.universalProviderConfigOverride,r=se.createNamespaces(e,t);await this.provider.connect({optionalNamespaces:r})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(e=>e.caipNetworkId);return c.U.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:le})}}const le=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],ue=[o.o.CONNECTOR_ID.AUTH,o.o.CONNECTOR_ID.WALLET_CONNECT];class he{constructor(e){this.availableConnectors=[],this.availableConnections=[],this.providerHandlers={},this.eventListeners=new Map,this.getCaipNetworks=e=>m.W.getCaipNetworks(e),this.getConnectorId=e=>u.a.getConnectorId(e),e&&this.construct(e),e?.namespace&&(this.connectionManager=new oe({namespace:e.namespace}))}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get connections(){return this.availableConnections}get networks(){return this.getCaipNetworks(this.namespace)}onAuthConnected({accounts:e,chainId:t}){const r=this.getCaipNetworks().filter(e=>e.chainNamespace===this.namespace).find(e=>e.id.toString()===t?.toString());e&&r&&this.addConnection({connectorId:o.o.CONNECTOR_ID.AUTH,accounts:e,caipNetwork:r})}setAuthProvider(e){e.onConnect(this.onAuthConnected.bind(this)),e.onSocialConnected(this.onAuthConnected.bind(this)),this.addConnector({id:o.o.CONNECTOR_ID.AUTH,type:"AUTH",name:o.o.CONNECTOR_NAMES.AUTH,provider:e,imageId:Z.L.ConnectorImageIds[o.o.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){const t=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(e=>!t.has(e.id)&&(t.add(e.id),!0)),this.emit("connectors",this.availableConnectors)}addConnection(...e){const t=new Set;this.availableConnections=[...e,...this.availableConnections].filter(e=>!t.has(e.connectorId.toLowerCase())&&(t.add(e.connectorId.toLowerCase()),!0)),this.emit("connections",this.availableConnections)}deleteConnection(e){this.availableConnections=this.availableConnections.filter(t=>!_.y.isLowerCaseMatch(t.connectorId,e)),this.emit("connections",this.availableConnections)}clearConnections(e=!1){this.availableConnections=[],e&&this.emit("connections",this.availableConnections)}setStatus(e,t){w.U.setStatus(e,t)}on(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e)?.add(t)}off(e,t){const r=this.eventListeners.get(e);r&&r.delete(t)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,t){const r=this.eventListeners.get(e);r&&r.forEach(e=>e(t))}async connectWalletConnect(e){const t=this.getWalletConnectConnector();return{clientId:(await t.connectWalletConnect()).clientId}}async switchNetwork(e){const{caipNetwork:t,providerType:r}=e;if(!e.provider)return;const n="provider"in e.provider?e.provider.provider:e.provider;if("WALLET_CONNECT"!==r){if(n&&"AUTH"===r){const e=n,r=(0,l.lj)(t.chainNamespace);await e.switchNetwork({chainId:t.caipNetworkId});const i=await e.getUser({chainId:t.caipNetworkId,preferredAccountType:r});this.emit("switchNetwork",i)}}else n.setDefaultChain(t.caipNetworkId)}getWalletConnectConnector(){const e=this.connectors.find(e=>e instanceof ce);if(!e)throw new Error("WalletConnectConnector not found");return e}onConnect(e,t){if(e.length>0){const{address:r,chainId:n}=s.w.getAccount(e[0]),i=this.getCaipNetworks().filter(e=>e.chainNamespace===this.namespace).find(e=>e.id.toString()===n?.toString()),o=this.connectors.find(e=>e.id===t);r&&(this.emit("accountChanged",{address:r,chainId:n,connector:o}),this.addConnection({connectorId:t,accounts:e.map(e=>{const{address:t}=s.w.getAccount(e);return{address:t}}),caipNetwork:i}))}}onAccountsChanged(e,t,r=!0){if(e.length>0){const{address:r}=s.w.getAccount(e[0]),n=this.connectionManager?.getConnection({connectorId:t,connections:this.connections,connectors:this.connectors});r&&_.y.isLowerCaseMatch(this.getConnectorId(o.o.CHAIN.EVM),t)&&this.emit("accountChanged",{address:r,chainId:n?.caipNetwork?.id,connector:n?.connector}),this.addConnection({connectorId:t,accounts:e.map(e=>{const{address:t}=s.w.getAccount(e);return{address:t}}),caipNetwork:n?.caipNetwork})}else r&&this.onDisconnect(t)}onDisconnect(e){this.removeProviderListeners(e),this.deleteConnection(e),_.y.isLowerCaseMatch(this.getConnectorId(o.o.CHAIN.EVM),e)&&this.emitFirstAvailableConnection(),0===this.connections.length&&this.emit("disconnect")}onChainChanged(e,t){const r="string"==typeof e&&e.startsWith("0x")?J.hexStringToNumber(e).toString():e.toString(),n=this.connectionManager?.getConnection({connectorId:t,connections:this.connections,connectors:this.connectors}),i=this.getCaipNetworks().filter(e=>e.chainNamespace===this.namespace).find(e=>e.id.toString()===r);n&&this.addConnection({connectorId:t,accounts:n.accounts,caipNetwork:i}),_.y.isLowerCaseMatch(this.getConnectorId(o.o.CHAIN.EVM),t)&&this.emit("switchNetwork",{chainId:r})}listenProviderEvents(e,t){if(ue.includes(e))return;const r=t=>this.onAccountsChanged(t,e),n=t=>this.onChainChanged(t,e),i=()=>this.onDisconnect(e);this.providerHandlers[e]||(t.on("disconnect",i),t.on("accountsChanged",r),t.on("chainChanged",n),this.providerHandlers[e]={provider:t,disconnect:i,accountsChanged:r,chainChanged:n})}removeProviderListeners(e){if(this.providerHandlers[e]){const{provider:t,disconnect:r,accountsChanged:n,chainChanged:i}=this.providerHandlers[e];t.removeListener("disconnect",r),t.removeListener("accountsChanged",n),t.removeListener("chainChanged",i),this.providerHandlers[e]=null}}emitFirstAvailableConnection(){const e=this.connectionManager?.getConnection({connections:this.connections,connectors:this.connectors});if(e){const[t]=e.accounts;this.emit("accountChanged",{address:t?.address,chainId:e.caipNetwork?.id,connector:e.connector})}}}class de extends he{async setUniversalProvider(e){if(!this.namespace)throw new Error("UniversalAdapter:setUniversalProvider - namespace is required");return this.addConnector(new ce({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace})),Promise.resolve()}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{const e=this.getWalletConnectConnector();await e.disconnect(),this.emit("disconnect")}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}return{connections:[]}}syncConnections(){return Promise.resolve()}async getAccounts({namespace:e}){const t=this.provider,r=t?.session?.namespaces?.[e]?.accounts?.map(e=>{const[,,t]=e.split(":");return t}).filter((e,t,r)=>r.indexOf(e)===t)||[];return Promise.resolve({accounts:r.map(t=>s.w.createAccount(e,t,"bip122"===e?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){if(!e.caipNetwork||!g.oU.BALANCE_SUPPORTED_CHAINS.includes(e.caipNetwork?.chainNamespace)||e.caipNetwork?.testnet)return{balance:"0.00",symbol:e.caipNetwork?.nativeCurrency.symbol||""};if(w.U.state.balanceLoading&&e.chainId===m.W.state.activeCaipNetwork?.id)return{balance:w.U.state.balance||"0.00",symbol:w.U.state.balanceSymbol||""};const t=(await w.U.fetchTokenBalance()).find(t=>t.chainId===`${e.caipNetwork?.chainNamespace}:${e.chainId}`&&t.symbol===e.caipNetwork?.nativeCurrency.symbol);return{balance:t?.quantity.numeric||"0.00",symbol:t?.symbol||e.caipNetwork?.nativeCurrency.symbol||""}}async signMessage(e){const{provider:t,message:r,address:n}=e;if(!t)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return i=m.W.state.activeCaipNetwork?.chainNamespace===o.o.CHAIN.SOLANA?(await t.request({method:"solana_signMessage",params:{message:Y.A.encode((new TextEncoder).encode(r)),pubkey:n}},m.W.state.activeCaipNetwork?.caipNetworkId)).signature:await t.request({method:"personal_sign",params:[r,n]},m.W.state.activeCaipNetwork?.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}emitFirstAvailableConnection(){}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){const{caipNetwork:t}=e,r=this.getWalletConnectConnector();if(t.chainNamespace===o.o.CHAIN.EVM)try{await(r.provider?.request({method:"wallet_switchEthereumChain",params:[{chainId:(0,G.nj)(t.id)}]}))}catch(e){if(4902===e.code||32603===e.code||5e3===e.code||4902===e?.data?.originalError?.code)try{await(r.provider?.request({method:"wallet_addEthereumChain",params:[{chainId:(0,G.nj)(t.id),rpcUrls:[t?.rpcUrls.chainDefault?.http],chainName:t.name,nativeCurrency:t.nativeCurrency,blockExplorerUrls:[t.blockExplorers?.default.url]}]}))}catch(e){throw new Error("Chain is not supported")}}r.provider.setDefaultChain(t.caipNetworkId)}getWalletConnectProvider(){const e=this.connectors.find(e=>"WALLET_CONNECT"===e.type),t=e?.provider;return t}}const pe=["email","socials","swaps","onramp","activity","reownBranding","multiWallet","emailCapture"],fe={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;const t=e.config;return Boolean(e.isEnabled)&&t.includes("email")},processFallback:e=>void 0===e?g.oU.DEFAULT_REMOTE_FEATURES.email:Boolean(e)},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;const t=e.config;return!!(Boolean(e.isEnabled)&&t.length>0)&&t.filter(e=>"email"!==e)},processFallback:e=>void 0===e?g.oU.DEFAULT_REMOTE_FEATURES.socials:"boolean"==typeof e?!!e&&g.oU.DEFAULT_REMOTE_FEATURES.socials:e},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;const t=e.config;return!!(Boolean(e.isEnabled)&&t.length>0)&&t},processFallback:e=>void 0===e?g.oU.DEFAULT_REMOTE_FEATURES.swaps:"boolean"==typeof e?!!e&&g.oU.DEFAULT_REMOTE_FEATURES.swaps:e},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;const t=e.config;return!!(Boolean(e.isEnabled)&&t.length>0)&&t},processFallback:e=>void 0===e?g.oU.DEFAULT_REMOTE_FEATURES.onramp:"boolean"==typeof e?!!e&&g.oU.DEFAULT_REMOTE_FEATURES.onramp:e},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:e=>Boolean(e.isEnabled),processFallback:e=>void 0===e?g.oU.DEFAULT_REMOTE_FEATURES.activity:Boolean(e)},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>Boolean(e.isEnabled),processFallback:e=>void 0===e?g.oU.DEFAULT_REMOTE_FEATURES.reownBranding:Boolean(e)},emailCapture:{apiFeatureName:"email_capture",localFeatureName:"emailCapture",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>e.isEnabled&&(e.config??[]),processFallback:e=>!1},multiWallet:{apiFeatureName:"multi_wallet",localFeatureName:"multiWallet",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>Boolean(e.isEnabled),processFallback:()=>g.oU.DEFAULT_REMOTE_FEATURES.multiWallet}},ge={localSettingsOverridden:new Set,getApiConfig:(e,t)=>t?.find(t=>t.id===e),addWarning(e,t){if(void 0!==e){const e=fe[t],r=e.isLegacy?`"features.${e.localFeatureName}" (now "${t}")`:`"features.${t}"`;this.localSettingsOverridden.add(r)}},processFeature(e,t,r,n,i){const s=fe[e],o=t[s.localFeatureName];if(i&&!s.isAvailableOnBasic)return!1;if(n){const t=this.getApiConfig(s.apiFeatureName,r);return null===t?.config?this.processFallbackFeature(e,o):!!t?.config&&(void 0!==o&&this.addWarning(o,e),this.processApiFeature(e,t))}return this.processFallbackFeature(e,o)},processApiFeature:(e,t)=>fe[e].processApi(t),processFallbackFeature:(e,t)=>fe[e].processFallback(t),async fetchRemoteFeatures(e){const t=e.basic??!1,r=e.features||{};this.localSettingsOverridden.clear();let n=null,i=!1;try{n=await f.N.fetchProjectConfig(),i=null!=n}catch(e){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",e)}const s=i&&!t?g.oU.DEFAULT_REMOTE_FEATURES:g.oU.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(const e of pe){const o=this.processFeature(e,r,n,i,t);Object.assign(s,{[e]:o})}}catch(e){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",e),g.oU.DEFAULT_REMOTE_FEATURES}if(i&&this.localSettingsOverridden.size>0){const e=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;E.h.open({debugMessage:I.R.ALERT_WARNINGS.LOCAL_CONFIGURATION_IGNORED.debugMessage(e)},"warning")}return s}};class me{constructor(e){this.chainNamespaces=[],this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(e,t)=>{if(e){const r=m.W.getCaipNetworks(e)?.find(e=>e.id===t);if(r)return r;const n=m.W.getNetworkData(e)?.caipNetwork;if(n)return n;const i=m.W.getRequestedCaipNetworks(e);return i.filter(t=>t.chainNamespace===e)?.[0]}return m.W.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const e=this.getCaipNetwork();if(e)return e.id},this.getCaipNetworks=e=>m.W.getCaipNetworks(e),this.getActiveChainNamespace=()=>m.W.state.activeChain,this.setRequestedCaipNetworks=(e,t)=>{m.W.setRequestedCaipNetworks(e,t)},this.getApprovedCaipNetworkIds=()=>m.W.getAllApprovedCaipNetworkIds(),this.getCaipAddress=e=>m.W.state.activeChain!==e&&e?m.W.state.chains.get(e)?.accountState?.caipAddress:m.W.state.activeCaipAddress,this.setClientId=e=>{R.T.setClientId(e)},this.getProvider=e=>S.A.getProvider(e),this.getProviderType=e=>S.A.getProviderId(e),this.getPreferredAccountType=e=>(0,l.lj)(e),this.setCaipAddress=(e,t)=>{w.U.setCaipAddress(e,t)},this.setBalance=(e,t,r)=>{w.U.setBalance(e,t,r)},this.setProfileName=(e,t)=>{w.U.setProfileName(e,t)},this.setProfileImage=(e,t)=>{w.U.setProfileImage(e,t)},this.setUser=(e,t)=>{w.U.setUser(e,t)},this.resetAccount=e=>{w.U.resetAccount(e)},this.setCaipNetwork=e=>{m.W.setActiveCaipNetwork(e)},this.setCaipNetworkOfNamespace=(e,t)=>{m.W.setChainNetworkData(t,{caipNetwork:e})},this.setStatus=(e,t)=>{w.U.setStatus(e,t),u.a.isConnected()?v.i.setConnectionStatus("connected"):v.i.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=e=>m.W.state.chains.get(e)?.accountState?.address,this.setConnectors=e=>{const t=[...u.a.state.allConnectors,...e];u.a.setConnectors(t)},this.setConnections=(e,t)=>{v.i.setConnections(e,t),h.x.setConnections(e,t)},this.fetchIdentity=e=>R.T.fetchIdentity(e),this.getReownName=e=>U.f.getNamesForAddress(e),this.getConnectors=()=>u.a.getConnectors(),this.getConnectorImage=e=>B.$.getConnectorImage(e),this.getConnections=e=>this.remoteFeatures.multiWallet?M.b.getConnectionsData(e).connections:(E.h.open(o.o.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.getRecentConnections=e=>this.remoteFeatures.multiWallet?M.b.getConnectionsData(e).recentConnections:(E.h.open(o.o.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.switchConnection=async e=>{this.remoteFeatures.multiWallet?await h.x.switchConnection(e):E.h.open(o.o.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info")},this.deleteConnection=e=>{this.remoteFeatures.multiWallet?(v.i.deleteAddressFromConnection(e),h.x.syncStorageConnections()):E.h.open(o.o.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info")},this.setConnectedWalletInfo=(e,t)=>{const r=S.A.getProviderId(t),n=e?{...e,type:r}:void 0;w.U.setConnectedWalletInfo(n,t)},this.getIsConnectedState=()=>Boolean(m.W.state.activeCaipAddress),this.addAddressLabel=(e,t,r)=>{w.U.addAddressLabel(e,t,r)},this.removeAddressLabel=(e,t)=>{w.U.removeAddressLabel(e,t)},this.getAddress=e=>m.W.state.activeChain!==e&&e?m.W.state.chains.get(e)?.accountState?.address:w.U.state.address,this.setApprovedCaipNetworksData=e=>m.W.setApprovedCaipNetworksData(e),this.resetNetwork=e=>{m.W.resetNetwork(e)},this.addConnector=e=>{u.a.addConnector(e)},this.resetWcConnection=()=>{h.x.resetWcConnection()},this.setAddressExplorerUrl=(e,t)=>{w.U.setAddressExplorerUrl(e,t)},this.setSmartAccountDeployed=(e,t)=>{w.U.setSmartAccountDeployed(e,t)},this.setPreferredAccountType=(e,t)=>{m.W.setAccountProp("preferredAccountType",e,t)},this.setEIP6963Enabled=e=>{y.H.setEIP6963Enabled(e)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e)}getChainNamespacesSet(e,t){const r=e?.map(e=>e.namespace).filter(e=>Boolean(e));if(r?.length)return[...new Set(r)];const n=t?.map(e=>e.chainNamespace);return[...new Set(n)]}async initialize(e){this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),y.H.state.enableReconnect?(await this.syncExistingConnection(),await this.syncAdapterConnections()):await this.unSyncExistingConnection(),this.remoteFeatures=await ge.fetchRemoteFeatures(e),y.H.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&L.aG.setOnrampProviders(this.remoteFeatures.onramp),(y.H.state.remoteFeatures?.email||Array.isArray(y.H.state.remoteFeatures?.socials)&&y.H.state.remoteFeatures?.socials.length>0)&&await this.checkAllowedOrigins()}async checkAllowedOrigins(){try{const e=await f.N.fetchAllowedOrigins();if(!e||!s.w.isClient())return void E.h.open(I.R.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");const t=window.location.origin;se.isOriginAllowed(t,e,ae)||E.h.open(I.R.ALERT_ERRORS.ORIGIN_NOT_ALLOWED,"error")}catch(e){if(!(e instanceof Error))return void E.h.open(I.R.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");switch(e.message){case"RATE_LIMITED":E.h.open(I.R.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{const t=e.cause instanceof Error?e.cause:e;E.h.open({displayMessage:I.R.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.displayMessage,debugMessage:I.R.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.debugMessage(t.message)},"error");break}default:E.h.open(I.R.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error")}}}sendInitializeEvent(e){const{...t}=e;delete t.adapters,delete t.universalProvider,d.E.sendEvent({type:"track",event:"INITIALIZE",properties:{...t,networks:e.networks.map(e=>e.id),siweConfig:{options:e.siweConfig?.options||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&b.W.setThemeMode(e.themeMode),e.themeVariables&&b.W.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");m.W.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const t=this.getDefaultNetwork();t&&m.W.setActiveCaipNetwork(t)}initializeConnectionController(e){h.x.initialize(e.adapters??[]),h.x.setWcBasic(e.basic??!1)}initializeConnectorController(){u.a.initialize(this.chainNamespaces)}initializeProjectSettings(e){y.H.setProjectId(e.projectId),y.H.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){y.H.setDebug(!1!==e.debug),y.H.setEnableWalletConnect(!1!==e.enableWalletConnect),y.H.setEnableWalletGuide(!1!==e.enableWalletGuide),y.H.setEnableWallets(!1!==e.enableWallets),y.H.setEIP6963Enabled(!1!==e.enableEIP6963),y.H.setEnableNetworkSwitch(!1!==e.enableNetworkSwitch),y.H.setEnableReconnect(!1!==e.enableReconnect),y.H.setEnableAuthLogger(!1!==e.enableAuthLogger),y.H.setCustomRpcUrls(e.customRpcUrls),y.H.setEnableEmbedded(e.enableEmbedded),y.H.setAllWallets(e.allWallets),y.H.setIncludeWalletIds(e.includeWalletIds),y.H.setExcludeWalletIds(e.excludeWalletIds),y.H.setFeaturedWalletIds(e.featuredWalletIds),y.H.setTokens(e.tokens),y.H.setTermsConditionsUrl(e.termsConditionsUrl),y.H.setPrivacyPolicyUrl(e.privacyPolicyUrl),y.H.setCustomWallets(e.customWallets),y.H.setFeatures(e.features),y.H.setAllowUnsupportedChain(e.allowUnsupportedChain),y.H.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),y.H.setPreferUniversalLinks(e.experimental_preferUniversalLinks),y.H.setDefaultAccountTypes(e.defaultAccountTypes);const t=this.getDefaultMetaData();if(!e.metadata&&t&&(e.metadata=t),y.H.setMetadata(e.metadata),y.H.setDisableAppend(e.disableAppend),y.H.setEnableEmbedded(e.enableEmbedded),y.H.setSIWX(e.siwx),!e.projectId)return void E.h.open(I.R.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");const r=e.adapters?.find(e=>e.namespace===o.o.CHAIN.EVM);if(r&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");y.H.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){return s.w.isClient()?{name:document.getElementsByTagName("title")?.[0]?.textContent||"",description:document.querySelector('meta[property="og:description"]')?.content||"",url:window.location.origin,icons:[document.querySelector('link[rel~="icon"]')?.href||""]}:null}setUnsupportedNetwork(e){const t=this.getActiveChainNamespace();if(t){const r=H.R.getUnsupportedNetwork(`${t}:${e}`);m.W.setActiveCaipNetwork(r)}}getDefaultNetwork(){return H.R.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,t){return H.R.extendCaipNetwork(e,{customNetworkImageUrls:t.chainImages,projectId:t.projectId})}extendCaipNetworks(e){return H.R.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const t=e.networks.find(t=>t.id===e.defaultNetwork?.id);return t?H.R.extendCaipNetwork(t,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectNamespace(e,t){try{this.setLoading(!0,e);let r={connections:[]};const n=this.getAdapter(e),i=m.W.state.chains.get(e)?.accountState?.caipAddress;return!i&&y.H.state.enableReconnect||!n?.disconnect||(r=await n.disconnect({id:t})),this.setLoading(!1,e),r}catch(t){throw this.setLoading(!1,e),new Error(`Failed to disconnect chains: ${t.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{const e=m.W.state.activeChain,t=this.getAdapter(e),r=this.getCaipNetwork(e)?.id,n=h.x.getConnections(e),i=this.remoteFeatures.multiWallet,s=n.length>0;if(!t)throw new Error("Adapter not found");const o=await t.connectWalletConnect(r);(!s||!i)&&this.close(),this.setClientId(o?.clientId||null),v.i.setConnectedNamespaces([...m.W.state.chains.keys()]),await this.syncWalletConnectAccount(),await c.U.initializeIfEnabled()},connectExternal:async({id:e,address:t,info:r,type:n,provider:i,chain:s,caipNetwork:o,socialUri:a})=>{const c=m.W.state.activeChain,l=s||c,u=this.getAdapter(l);if(s&&s!==c&&!o){const e=this.getCaipNetworks().find(e=>e.chainNamespace===s);e&&this.setCaipNetwork(e)}if(!l)throw new Error("connectExternal: namespace not found");if(!u)throw new Error("connectExternal: adapter not found");const h=this.getCaipNetwork(l),d=await u.connect({id:e,address:t,info:r,type:n,provider:i,socialUri:a,chainId:o?.id||h?.id,rpcUrl:o?.rpcUrls?.default?.http?.[0]||h?.rpcUrls?.default?.http?.[0]});if(d)return v.i.addConnectedNamespace(l),this.syncProvider({...d,chainNamespace:l}),this.setStatus("connected",l),this.syncConnectedWalletInfo(l),v.i.removeDisconnectedConnectorId(e,l),{address:d.address}},reconnectExternal:async({id:e,info:t,type:r,provider:n})=>{const i=m.W.state.activeChain,s=this.getAdapter(i);if(!i)throw new Error("reconnectExternal: namespace not found");if(!s)throw new Error("reconnectExternal: adapter not found");s?.reconnect&&(await(s?.reconnect({id:e,info:t,type:r,provider:n,chainId:this.getCaipNetwork()?.id})),v.i.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnect:async e=>{const{id:t,chainNamespace:r,initialDisconnect:n}=e||{},i=r||m.W.state.activeChain,s=u.a.getConnectorId(i),a=t===o.o.CONNECTOR_ID.AUTH||s===o.o.CONNECTOR_ID.AUTH,l=t===o.o.CONNECTOR_ID.WALLET_CONNECT||s===o.o.CONNECTOR_ID.WALLET_CONNECT;try{const e=Array.from(m.W.state.chains.keys());let i=r?[r]:e;(l||a)&&(i=e);const s=i.map(async e=>{const r=u.a.getConnectorId(e),i=await this.disconnectNamespace(e,t||r);i&&(a&&v.i.deleteConnectedSocialProvider(),i.connections.forEach(t=>{v.i.addDisconnectedConnectorId(t.connectorId,e)})),n&&this.onDisconnectNamespace({chainNamespace:e,closeModal:!1})}),o=await Promise.allSettled(s);D.R.resetSend(),h.x.resetWcConnection(),c.U.getSIWX()?.signOutOnDisconnect&&await c.U.clearSessions(),u.a.setFilterByNamespace(void 0),h.x.syncStorageConnections();const p=o.filter(e=>"rejected"===e.status);if(p.length>0)throw new Error(p.map(e=>e.reason.message).join(", "));d.E.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:r||"all"}})}catch(e){throw new Error(`Failed to disconnect chains: ${e.message}`)}},checkInstalled:e=>e?e.some(e=>Boolean(window.ethereum?.[String(e)])):Boolean(window.ethereum),signMessage:async e=>{const t=m.W.state.activeChain,r=this.getAdapter(m.W.state.activeChain);if(!t)throw new Error("signMessage: namespace not found");if(!r)throw new Error("signMessage: adapter not found");const n=await(r?.signMessage({message:e,address:w.U.state.address,provider:S.A.getProvider(t)}));return n?.signature||""},sendTransaction:async e=>{const t=e.chainNamespace;if(!t)throw new Error("sendTransaction: namespace not found");if(g.oU.SEND_SUPPORTED_NAMESPACES.includes(t)){const r=this.getAdapter(t);if(!r)throw new Error("sendTransaction: adapter not found");const n=S.A.getProvider(t),i=await(r?.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:n}));return i?.hash||""}return""},estimateGas:async e=>{const t=e.chainNamespace;if(t===o.o.CHAIN.EVM){const r=this.getAdapter(t);if(!r)throw new Error("estimateGas: adapter is required but got undefined");const n=S.A.getProvider(t),i=this.getCaipNetwork();if(!i)throw new Error("estimateGas: caipNetwork is required but got undefined");const s=await(r?.estimateGas({...e,provider:n,caipNetwork:i}));return s?.gas||0n}return 0n},getEnsAvatar:async()=>{const e=m.W.state.activeChain;if(!e)throw new Error("getEnsAvatar: namespace is required but got undefined");return await this.syncIdentity({address:w.U.state.address,chainId:Number(this.getCaipNetwork()?.id),chainNamespace:e}),w.U.state.profileImage||!1},getEnsAddress:async e=>await se.resolveReownName(e),writeContract:async e=>{const t=m.W.state.activeChain,r=this.getAdapter(t);if(!t)throw new Error("writeContract: namespace is required but got undefined");if(!r)throw new Error("writeContract: adapter is required but got undefined");const n=this.getCaipNetwork(),i=this.getCaipAddress(),s=S.A.getProvider(t);if(!n||!i)throw new Error("writeContract: caipNetwork or caipAddress is required but got undefined");const o=await(r?.writeContract({...e,caipNetwork:n,provider:s,caipAddress:i}));return o?.hash},parseUnits:(e,t)=>{const r=this.getAdapter(m.W.state.activeChain);if(!r)throw new Error("parseUnits: adapter is required but got undefined");return r?.parseUnits({value:e,decimals:t})??0n},formatUnits:(e,t)=>{const r=this.getAdapter(m.W.state.activeChain);if(!r)throw new Error("formatUnits: adapter is required but got undefined");return r?.formatUnits({value:e,decimals:t})??"0"},getCapabilities:async e=>{const t=this.getAdapter(m.W.state.activeChain);if(!t)throw new Error("getCapabilities: adapter is required but got undefined");return await(t?.getCapabilities(e))},grantPermissions:async e=>{const t=this.getAdapter(m.W.state.activeChain);if(!t)throw new Error("grantPermissions: adapter is required but got undefined");return await(t?.grantPermissions(e))},revokePermissions:async e=>{const t=this.getAdapter(m.W.state.activeChain);if(!t)throw new Error("revokePermissions: adapter is required but got undefined");return t?.revokePermissions?await t.revokePermissions(e):"0x"},walletGetAssets:async e=>{const t=this.getAdapter(m.W.state.activeChain);if(!t)throw new Error("walletGetAssets: adapter is required but got undefined");return await(t?.walletGetAssets(e))??{}},updateBalance:e=>{const t=this.getCaipNetwork(e);t&&w.U.state.address&&this.updateNativeBalance(w.U.state.address,t?.id,e)}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},h.x.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){if(S.A.getProviderId(m.W.state.activeChain)===A.o.CONNECTOR_TYPE_WALLET_CONNECT){const e=this.universalProvider?.session?.namespaces;return{supportsAllNetworks:"MetaMask Wallet"===this.universalProvider?.session?.peer?.metadata.name,approvedCaipNetworkIds:this.getChainsFromNamespaces(e)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){if(!e)return;const t=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const r=S.A.getProvider(t),n=S.A.getProviderId(t);if(e.chainNamespace===m.W.state.activeChain){const i=this.getAdapter(t);await(i?.switchNetwork({caipNetwork:e,provider:r,providerType:n}))}else if(this.setCaipNetwork(e),n===A.o.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const r=this.getAddressByChainNamespace(t);r&&this.syncAccount({address:r,chainId:e.id,chainNamespace:t})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(e=>{const t=e.chains||[],r=e.accounts.map(e=>{const{chainId:t,chainNamespace:r}=O.C.parseCaipAddress(e);return`${r}:${t}`});return Array.from(new Set([...t,...r]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((t,r)=>{const n=e?.find(e=>e.namespace===r);return n?(n.construct({namespace:r,projectId:this.options?.projectId,networks:this.getCaipNetworks()}),t[r]=n):t[r]=new de({namespace:r,networks:this.getCaipNetworks()}),t},{})}async initChainAdapter(e){this.onConnectors(e),this.listenAdapter(e),await(this.chainAdapters?.[e].syncConnectors(this.options,this)),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){const t=this.getAdapter(e);t?.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const t=this.getAdapter(e);if(!t)return;const r=v.i.getConnectionStatus();!1===y.H.state.enableReconnect?this.setStatus("disconnected",e):"connected"===r?this.setStatus("connecting",e):"disconnected"===r?(v.i.clearAddressCache(),this.setStatus(r,e)):this.setStatus(r,e),t.on("switchNetwork",({address:t,chainId:r})=>{const n=this.getCaipNetworks().find(e=>e.id.toString()===r.toString()||e.caipNetworkId.toString()===r.toString()),i=m.W.state.activeChain===e,s=m.W.state.chains.get(e)?.accountState?.address;if(n){const r=i&&t?t:s;r&&this.syncAccount({address:r,chainId:n.id,chainNamespace:e})}else this.setUnsupportedNetwork(r)}),t.on("disconnect",()=>{const t=this.remoteFeatures.multiWallet,r=Array.from(h.x.state.connections.values()).flat();this.onDisconnectNamespace({chainNamespace:e,closeModal:!t||0===r.length})}),t.on("connections",t=>{this.setConnections(t,e)}),t.on("pendingTransactions",()=>{const e=w.U.state.address,t=m.W.state.activeCaipNetwork;e&&t?.id&&this.updateNativeBalance(e,t.id,t.chainNamespace)}),t.on("accountChanged",({address:t,chainId:r,connector:n})=>{const i=m.W.state.activeChain===e;n?.provider&&(this.syncProvider({id:n.id,type:n.type,provider:n.provider,chainNamespace:e}),this.syncConnectedWalletInfo(e)),i&&r?this.syncAccount({address:t,chainId:r,chainNamespace:e}):i&&m.W.state.activeCaipNetwork?.id?this.syncAccount({address:t,chainId:m.W.state.activeCaipNetwork?.id,chainNamespace:e}):this.syncAccountInfo(t,r,e),v.i.addConnectedNamespace(e)})}async createUniversalProviderForAdapter(e){await this.getUniversalProvider(),this.universalProvider&&await(this.chainAdapters?.[e]?.setUniversalProvider?.(this.universalProvider))}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async unSyncExistingConnection(){try{await Promise.allSettled(this.chainNamespaces.map(e=>h.x.disconnect({namespace:e,initialDisconnect:!0})))}catch(e){console.error("Error disconnecting existing connections:",e)}}async syncNamespaceConnection(e){try{e===o.o.CHAIN.EVM&&s.w.isSafeApp()&&u.a.setConnectorId(o.o.CONNECTOR_ID.SAFE,e);const t=u.a.getConnectorId(e);switch(this.setStatus("connecting",e),t){case o.o.CONNECTOR_ID.WALLET_CONNECT:await this.syncWalletConnectAccount();break;case o.o.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(t){console.warn("AppKit couldn't sync existing connection",t),this.setStatus("disconnected",e)}}onDisconnectNamespace(e){const{chainNamespace:t,closeModal:r}=e||{};m.W.resetAccount(t),m.W.resetNetwork(t),v.i.removeConnectedNamespace(t);const n=Array.from(m.W.state.chains.keys());(t?[t]:n).forEach(e=>v.i.addDisconnectedConnectorId(u.a.getConnectorId(e)||"",e)),u.a.removeConnectorId(t),S.A.resetChain(t),this.setUser(void 0,t),this.setStatus("disconnected",t),this.setConnectedWalletInfo(void 0,t),!1!==r&&W.W.close()}async syncAdapterConnections(){await Promise.allSettled(this.chainNamespaces.map(e=>{const t=this.getCaipAddress(e),r=this.getCaipNetwork(e);return this.chainAdapters?.[e].syncConnections({connectToFirstConnector:!t,caipNetwork:r,getConnectorStorageInfo(t){const r=v.i.getConnections()[e]??[];return{hasDisconnected:v.i.isConnectorDisconnected(t,e),hasConnected:r.some(e=>_.y.isLowerCaseMatch(e.connectorId,t))}}})}))}async syncAdapterConnection(e){const t=this.getAdapter(e),r=u.a.getConnectorId(e),n=this.getCaipNetwork(e),i=u.a.getConnectors(e).find(e=>e.id===r);try{if(!t||!i)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!n?.id)throw new Error("CaipNetwork not found");const r=await(t?.syncConnection({namespace:e,id:i.id,chainId:n.id,rpcUrl:n?.rpcUrls?.default?.http?.[0]}));r?(this.syncProvider({...r,chainNamespace:e}),await this.syncAccount({...r,chainNamespace:e}),this.setStatus("connected",e)):this.setStatus("disconnected",e)}catch(t){this.onDisconnectNamespace({chainNamespace:e,closeModal:!1})}}async syncWalletConnectAccount(){const e=Object.keys(this.universalProvider?.session?.namespaces||{}),t=this.chainNamespaces.map(async t=>{const r=this.getAdapter(t);if(!r)return;const n=this.universalProvider?.session?.namespaces?.[t]?.accounts||[],i=m.W.state.activeCaipNetwork?.id,s=n.find(e=>{const{chainId:t}=O.C.parseCaipAddress(e);return t===i?.toString()})||n[0];if(s){const e=O.C.validateCaipAddress(s),{chainId:n,address:i}=O.C.parseCaipAddress(e);if(S.A.setProviderId(t,A.o.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&m.W.state.activeCaipNetwork&&r.namespace!==o.o.CHAIN.EVM){const e=r.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:m.W.state.activeCaipNetwork});S.A.setProvider(t,e)}else S.A.setProvider(t,this.universalProvider);u.a.setConnectorId(o.o.CONNECTOR_ID.WALLET_CONNECT,t),v.i.addConnectedNamespace(t),await this.syncAccount({address:i,chainId:n,chainNamespace:t})}else e.includes(t)&&this.setStatus("disconnected",t);this.syncConnectedWalletInfo(t),await m.W.setApprovedCaipNetworksData(t)});await Promise.all(t)}syncProvider({type:e,provider:t,id:r,chainNamespace:n}){S.A.setProviderId(n,e),S.A.setProvider(n,t),u.a.setConnectorId(r,n)}async syncAccount(e){const t=e.chainNamespace===m.W.state.activeChain,r=m.W.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:n,chainId:i,chainNamespace:s}=e,{chainId:a}=v.i.getActiveNetworkProps(),c=i||a,l=m.W.state.activeCaipNetwork?.name===o.o.UNSUPPORTED_NETWORK_NAME,u=m.W.getNetworkProp("supportsAllNetworks",s);if(this.setStatus("connected",s),(!l||u)&&c){let e=this.getCaipNetworks().find(e=>e.id.toString()===c.toString()),a=this.getCaipNetworks().find(e=>e.chainNamespace===s);if(!u&&!e&&!a){const t=this.getApprovedCaipNetworkIds()||[],r=t.find(e=>O.C.parseCaipNetworkId(e)?.chainId===c.toString()),n=t.find(e=>O.C.parseCaipNetworkId(e)?.chainNamespace===s);e=this.getCaipNetworks().find(e=>e.caipNetworkId===r),a=this.getCaipNetworks().find(e=>e.caipNetworkId===n||"deprecatedCaipNetworkId"in e&&e.deprecatedCaipNetworkId===n)}const l=e||a;l?.chainNamespace===m.W.state.activeChain?y.H.state.enableNetworkSwitch&&!y.H.state.allowUnsupportedChain&&m.W.state.activeCaipNetwork?.name===o.o.UNSUPPORTED_NETWORK_NAME?m.W.showUnsupportedChainUI():this.setCaipNetwork(l):t||r&&this.setCaipNetworkOfNamespace(r,s),this.syncConnectedWalletInfo(s),_.y.isLowerCaseMatch(n,w.U.state.address)||this.syncAccountInfo(n,l?.id,s),t?await this.syncBalance({address:n,chainId:l?.id,chainNamespace:s}):await this.syncBalance({address:n,chainId:r?.id,chainNamespace:s}),this.syncIdentity({address:n,chainId:i,chainNamespace:s})}}async syncAccountInfo(e,t,r){const n=this.getCaipAddress(r),i=t||n?.split(":")[1];if(!i)return;const s=`${r}:${i}:${e}`;this.setCaipAddress(s,r),await this.syncIdentity({address:e,chainId:i,chainNamespace:r})}async syncReownName(e,t){try{const r=await this.getReownName(e);if(r[0]){const e=r[0];this.setProfileName(e.name,t)}else this.setProfileName(null,t)}catch{this.setProfileName(null,t)}}syncConnectedWalletInfo(e){const t=u.a.getConnectorId(e),r=S.A.getProviderId(e);if(r===A.o.CONNECTOR_TYPE_ANNOUNCED||r===A.o.CONNECTOR_TYPE_INJECTED){if(t){const r=this.getConnectors().find(e=>{const r=e.id===t,n=e.info?.rdns===t,i=e.connectors?.some(e=>e.id===t||e.info?.rdns===t);return r||n||Boolean(i)});if(r){const{info:t,name:n,imageUrl:i}=r,s=i||this.getConnectorImage(r);this.setConnectedWalletInfo({name:n,icon:s,...t},e)}}}else if(r===A.o.CONNECTOR_TYPE_WALLET_CONNECT){const t=S.A.getProvider(e);t?.session&&this.setConnectedWalletInfo({...t.session.peer.metadata,name:t.session.peer.metadata.name,icon:t.session.peer.metadata.icons?.[0]},e)}else if(t&&(t===o.o.CONNECTOR_ID.COINBASE_SDK||t===o.o.CONNECTOR_ID.COINBASE)){const r=this.getConnectors().find(e=>e.id===t),n=r?.name||"Coinbase Wallet",i=r?.imageUrl||this.getConnectorImage(r),s=r?.info;this.setConnectedWalletInfo({...s,name:n,icon:i},e)}}async syncBalance(e){P.L.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(t=>t.id.toString()===e.chainId?.toString())&&e.chainId&&await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,t,r){const n=this.getAdapter(r),i=m.W.getCaipNetworkByNamespace(r,t);if(n){const s=await n.getBalance({address:e,chainId:t,caipNetwork:i,tokens:this.options.tokens});return this.setBalance(s.balance,s.symbol,r),s}}async initializeUniversalAdapter(){const e=V.createLogger((e,...t)=>{e&&this.handleAlertError(e),console.error(...t)}),t={projectId:this.options?.projectId,metadata:{name:this.options?.metadata?this.options?.metadata.name:"",description:this.options?.metadata?this.options?.metadata.description:"",url:this.options?.metadata?this.options?.metadata.url:"",icons:this.options?.metadata?this.options?.metadata.icons:[""]},logger:e};y.H.setManualWCControl(Boolean(this.options?.manualWCControl)),this.universalProvider=this.options.universalProvider??await T.A.init(t),!1===y.H.state.enableReconnect&&this.universalProvider.session&&await this.universalProvider.disconnect(),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&this.chainNamespaces.forEach(e=>{se.listenWcProvider({universalProvider:this.universalProvider,namespace:e,onDisplayUri:e=>{h.x.setUri(e)},onConnect:e=>{const{address:t}=s.w.getAccount(e[0]);h.x.finalizeWcConnection(t)},onDisconnect:()=>{m.W.state.noAdapters&&this.resetAccount(e),h.x.resetWcConnection()},onChainChanged:t=>{const r=m.W.state.activeChain,n=r&&u.a.state.activeConnectorIds[r]===o.o.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(m.W.state.noAdapters||n)){const e=this.getCaipNetworks().find(e=>e.id.toString()===t.toString()||e.caipNetworkId.toString()===t.toString()),r=this.getCaipNetwork();if(!e)return void this.setUnsupportedNetwork(t);r?.id.toString()!==e?.id.toString()&&r?.chainNamespace===e?.chainNamespace&&this.setCaipNetwork(e)}},onAccountsChanged:t=>{const r=m.W.state.activeChain,n=r&&u.a.state.activeConnectorIds[r]===o.o.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(m.W.state.noAdapters||n)&&t.length>0){const e=t[0];this.syncAccount({address:e.address,chainId:e.chainId,chainNamespace:e.chainNamespace})}}})})}createUniversalProvider(){return!this.universalProviderInitPromise&&s.w.isClient()&&this.options?.projectId&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){d.E.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){const t=Object.entries(I.R.UniversalProviderErrors).find(([,{message:t}])=>e.message.includes(t)),[r,n]=t??[],{message:i,alertErrorKey:s}=n??{};if(r&&i&&!this.reportedAlertErrors[r]){const e=I.R.ALERT_ERRORS[s];e&&(E.h.open(e,"error"),this.reportedAlertErrors[r]=!0)}}getAdapter(e){if(e)return this.chainAdapters?.[e]}createAdapter(e){if(!e)return;const t=e.namespace;if(!t)return;this.createClients();const r=e;r.namespace=t,r.construct({namespace:t,projectId:this.options?.projectId,networks:this.getCaipNetworks()}),this.chainNamespaces.includes(t)||this.chainNamespaces.push(t),this.chainAdapters&&(this.chainAdapters[t]=r)}async open(e){return await this.injectModalUi(),e?.uri&&h.x.setUri(e.uri),e?.arguments&&"Swap"===e?.view?W.W.open({...e,data:{swap:e.arguments}}):W.W.open(e)}async close(){await this.injectModalUi(),W.W.close()}setLoading(e,t){W.W.setLoading(e,t)}async disconnect(e){await h.x.disconnect({namespace:e})}getSIWX(){return y.H.state.siwx}getError(){return""}getChainId(){return m.W.state.activeCaipNetwork?.id}async switchNetwork(e){const t=this.getCaipNetworks().find(t=>t.id===e.id);t?await m.W.switchActiveNetwork(t):E.h.open(I.R.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error")}getWalletProvider(){return m.W.state.activeChain?S.A.state.providers[m.W.state.activeChain]:null}getWalletProviderType(){return S.A.getProviderId(m.W.state.activeChain)}subscribeProviders(e){return S.A.subscribeProviders(e)}getThemeMode(){return b.W.state.themeMode}getThemeVariables(){return b.W.state.themeVariables}setThemeMode(e){b.W.setThemeMode(e),(0,F.JX)(b.W.state.themeMode)}setTermsConditionsUrl(e){y.H.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){y.H.setPrivacyPolicyUrl(e)}setThemeVariables(e){b.W.setThemeVariables(e),(0,F.ds)(b.W.state.themeVariables)}subscribeTheme(e){return b.W.subscribe(e)}subscribeConnections(e){return this.remoteFeatures.multiWallet?h.x.subscribe(e):(E.h.open(o.o.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),()=>{})}getWalletInfo(e){return e?m.W.state.chains.get(e)?.accountState?.connectedWalletInfo:w.U.state.connectedWalletInfo}getAccount(e){const t=e||m.W.state.activeChain,r=u.a.getAuthConnector(t),n=m.W.getAccountData(t),i=v.i.getConnectedConnectorId(m.W.state.activeChain),a=h.x.getConnections(t);if(!t)throw new Error("AppKit:getAccount - namespace is required");const c=a.flatMap(e=>e.accounts.map(({address:e,type:r,publicKey:n})=>s.w.createAccount(t,e,r||"eoa",n)));if(n)return{allAccounts:c,caipAddress:n.caipAddress,address:s.w.getPlainAddress(n.caipAddress),isConnected:Boolean(n.caipAddress),status:n.status,embeddedWalletInfo:r&&i===o.o.CONNECTOR_ID.AUTH?{user:n.user?{...n.user,username:v.i.getConnectedSocialUsername()}:void 0,authProvider:n.socialProvider||"email",accountType:(0,l.lj)(t),isSmartAccountDeployed:Boolean(n.smartAccountDeployed)}:void 0}}subscribeAccount(e,t){const r=()=>{const r=this.getAccount(t);r&&e(r)};t?m.W.subscribeChainProp("accountState",r,t):m.W.subscribe(r),u.a.subscribe(r)}subscribeNetwork(e){return m.W.subscribe(({activeCaipNetwork:t})=>{e({caipNetwork:t,chainId:t?.id,caipNetworkId:t?.caipNetworkId})})}subscribeWalletInfo(e,t){return t?w.U.subscribeKey("connectedWalletInfo",e,t):w.U.subscribeKey("connectedWalletInfo",e)}subscribeShouldUpdateToAddress(e){w.U.subscribeKey("shouldUpdateToAddress",e)}subscribeCaipNetworkChange(e){m.W.subscribeKey("activeCaipNetwork",e)}getState(){return p.z.state}getRemoteFeatures(){return y.H.state.remoteFeatures}subscribeState(e){return p.z.subscribe(e)}subscribeRemoteFeatures(e){return y.H.subscribeKey("remoteFeatures",e)}showErrorMessage(e){j.P.showError(e)}showSuccessMessage(e){j.P.showSuccess(e)}getEvent(){return{...d.E.state}}subscribeEvents(e){return d.E.subscribe(e)}replace(e){$.I.replace(e)}redirect(e){$.I.push(e)}popTransactionStack(e){$.I.popTransactionStack(e)}isOpen(){return W.W.state.open}isTransactionStackEmpty(){return 0===$.I.state.transactionStack.length}static getInstance(){return this.instance}updateFeatures(e){y.H.setFeatures(e)}updateRemoteFeatures(e){y.H.setRemoteFeatures(e)}updateOptions(e){const t={...y.H.state||{},...e};y.H.setOptions(t)}setConnectMethodsOrder(e){y.H.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){y.H.setWalletFeaturesOrder(e)}setCollapseWallets(e){y.H.setCollapseWallets(e)}setSocialsOrder(e){y.H.setSocialsOrder(e)}getConnectMethodsOrder(){return q.A.getConnectOrderMethod(y.H.state.features,u.a.getConnectors())}addNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const r=this.extendCaipNetwork(t,this.options);this.getCaipNetworks().find(e=>e.id===r.id)||m.W.addNetwork(r)}removeNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(e=>e.id===t)&&m.W.removeNetwork(e,t)}}let ye=!1;var we=i(8287),be=i(4305),ve=i(9404),Ee=i.n(ve),Ae=i(5992),_e=i.n(Ae),Ie=i(8226),Se=i(2755),Ce=i(601);function ke(e){return Array.isArray(e)?"%5B"+e.map(ke).join("%2C%20")+"%5D":"bigint"==typeof e?`${e}n`:encodeURIComponent(String(null!=e&&null===Object.getPrototypeOf(e)?{...e}:e))}function Ne([e,t]){return`${e}=${ke(t)}`}var xe=class extends Error{cause=this.cause;context;constructor(...[e,t]){let r,n;if(t){const{cause:e,...i}=t;e&&(n={cause:e}),Object.keys(i).length>0&&(r=i)}super(function(e,t={}){{let r=`Solana error #${e}; Decode this error by running \`npx @solana/errors decode -- ${e}`;return Object.keys(t).length&&(r+=` '${function(e){const t=Object.entries(e).map(Ne).join("&");return btoa(t)}(t)}'`),`${r}\``}}(e,r),n),this.context={__code:e,...r},this.name="SolanaError"}};function Te(e){return"fixedSize"in e&&"number"==typeof e.fixedSize}function Oe(e){return 1!==e?.endian}function Pe(e){return t={fixedSize:e.size,write(t,r,n){e.range&&function(e,t,r,n){if(n<t||n>r)throw new xe(8078011,{codecDescription:e,max:r,min:t,value:n})}(e.name,e.range[0],e.range[1],t);const i=new ArrayBuffer(e.size);return e.set(new DataView(i),t,Oe(e.config)),r.set(new Uint8Array(i),n),n+e.size}},Object.freeze({...t,encode:e=>{const r=new Uint8Array(function(e,t){return"fixedSize"in t?t.fixedSize:t.getSizeFromValue(e)}(e,t));return t.write(e,r,0),r}});var t}function Re(e){return t={fixedSize:e.size,read(t,r=0){!function(e,t,r=0){if(t.length-r<=0)throw new xe(8078e3,{codecDescription:e})}(e.name,t,r),function(e,t,r,n=0){const i=r.length-n;if(i<t)throw new xe(8078001,{bytesLength:i,codecDescription:e,expected:t})}(e.name,e.size,t,r);const n=new DataView(function(e,t,r){const n=e.byteOffset+(t??0),i=r??e.byteLength;return e.buffer.slice(n,n+i)}(t,r,e.size));return[e.get(n,Oe(e.config)),r+e.size]}},Object.freeze({...t,decode:(e,r=0)=>t.read(e,r)[0]});var t}var Ue=(e={})=>Pe({config:e,name:"u64",range:[0n,BigInt("0xffffffffffffffff")],set:(e,t,r)=>e.setBigUint64(0,BigInt(t),r),size:8}),Be=(e={})=>function(e,t){if(Te(e)!==Te(t))throw new xe(8078004);if(Te(e)&&Te(t)&&e.fixedSize!==t.fixedSize)throw new xe(8078005,{decoderFixedSize:t.fixedSize,encoderFixedSize:e.fixedSize});if(!Te(e)&&!Te(t)&&e.maxSize!==t.maxSize)throw new xe(8078006,{decoderMaxSize:t.maxSize,encoderMaxSize:e.maxSize});return{...t,...e,decode:t.decode,encode:e.encode,read:t.read,write:e.write}}(Ue(e),((e={})=>Re({config:e,get:(e,t)=>e.getBigUint64(0,t),name:"u64",size:8}))(e)),Me=i(2150),Le=i(22),De=i.n(Le),We=i(1825),je=i(7238),$e=i(5143);be.ev.utils.randomPrivateKey;const ze=()=>{const e=be.ev.utils.randomPrivateKey(),t=qe(e),r=new Uint8Array(64);return r.set(e),r.set(t,32),{publicKey:t,secretKey:r}},qe=be.ev.getPublicKey;function Fe(e){try{return be.ev.ExtendedPoint.fromHex(e),!0}catch{return!1}}const He=(e,t)=>be.ev.sign(e,t.slice(0,32)),Ke=be.ev.verify,Ve=e=>we.Buffer.isBuffer(e)?e:e instanceof Uint8Array?we.Buffer.from(e.buffer,e.byteOffset,e.byteLength):we.Buffer.from(e);class Ye{constructor(e){Object.assign(this,e)}encode(){return we.Buffer.from((0,Se.serialize)(Ge,this))}static decode(e){return(0,Se.deserialize)(Ge,this,e)}static decodeUnchecked(e){return(0,Se.deserializeUnchecked)(Ge,this,e)}}const Ge=new Map;var Ze;const Je=32;let Xe=1;class Qe extends Ye{constructor(e){if(super({}),this._bn=void 0,function(e){return void 0!==e._bn}(e))this._bn=e._bn;else{if("string"==typeof e){const t=_e().decode(e);if(t.length!=Je)throw new Error("Invalid public key input");this._bn=new(Ee())(t)}else this._bn=new(Ee())(e);if(this._bn.byteLength()>Je)throw new Error("Invalid public key input")}}static unique(){const e=new Qe(Xe);return Xe+=1,new Qe(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return _e().encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(we.Buffer);if(e.length===Je)return e;const t=we.Buffer.alloc(32);return e.copy(t,32-e.length),t}get[Symbol.toStringTag](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,r){const n=we.Buffer.concat([e.toBuffer(),we.Buffer.from(t),r.toBuffer()]),i=(0,Ie.sc)(n);return new Qe(i)}static createProgramAddressSync(e,t){let r=we.Buffer.alloc(0);e.forEach(function(e){if(e.length>32)throw new TypeError("Max seed length exceeded");r=we.Buffer.concat([r,Ve(e)])}),r=we.Buffer.concat([r,t.toBuffer(),we.Buffer.from("ProgramDerivedAddress")]);const n=(0,Ie.sc)(r);if(Fe(n))throw new Error("Invalid seeds, address must fall off the curve");return new Qe(n)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let r,n=255;for(;0!=n;){try{const i=e.concat(we.Buffer.from([n]));r=this.createProgramAddressSync(i,t)}catch(e){if(e instanceof TypeError)throw e;n--;continue}return[r,n]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){return Fe(new Qe(e).toBytes())}}Ze=Qe,Qe.default=new Ze("11111111111111111111111111111111"),Ge.set(Qe,{kind:"struct",fields:[["_bn","u256"]]}),new Qe("BPFLoader1111111111111111111111111111111111");const et=1232;class tt extends Error{constructor(e){super(`Signature ${e} has expired: block height exceeded.`),this.signature=void 0,this.signature=e}}Object.defineProperty(tt.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class rt extends Error{constructor(e,t){super(`Transaction was not confirmed in ${t.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${e} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=e}}Object.defineProperty(rt.prototype,"name",{value:"TransactionExpiredTimeoutError"});class nt extends Error{constructor(e){super(`Signature ${e} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=e}}Object.defineProperty(nt.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class it{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>256)throw new Error("Account index overflow encountered during compilation");const t=new Map;this.keySegments().flat().forEach((e,r)=>{t.set(e.toBase58(),r)});const r=e=>{const r=t.get(e.toBase58());if(void 0===r)throw new Error("Encountered an unknown instruction account key during compilation");return r};return e.map(e=>({programIdIndex:r(e.programId),accountKeyIndexes:e.keys.map(e=>r(e.pubkey)),data:e.data}))}}const st=(e="publicKey")=>Ce.av(32,e),ot=(e="signature")=>Ce.av(64,e),at=(e="string")=>{const t=Ce.w3([Ce.DH("length"),Ce.DH("lengthPadding"),Ce.av(Ce.cY(Ce.DH(),-8),"chars")],e),r=t.decode.bind(t),n=t.encode.bind(t),i=t;return i.decode=(e,t)=>r(e,t).chars.toString(),i.encode=(e,t,r)=>{const i={chars:we.Buffer.from(e,"utf8")};return n(i,t,r)},i.alloc=e=>Ce.DH().span+Ce.DH().span+we.Buffer.from(e,"utf8").length,i};function ct(e,t){const r=e=>{if(e.span>=0)return e.span;if("function"==typeof e.alloc)return e.alloc(t[e.property]);if("count"in e&&"elementLayout"in e){const n=t[e.property];if(Array.isArray(n))return n.length*r(e.elementLayout)}else if("fields"in e)return ct({layout:e},t[e.property]);return 0};let n=0;return e.layout.fields.forEach(e=>{n+=r(e)}),n}function lt(e){let t=0,r=0;for(;;){let n=e.shift();if(t|=(127&n)<<7*r,r+=1,!(128&n))break}return t}function ut(e,t){let r=t;for(;;){let t=127&r;if(r>>=7,0==r){e.push(t);break}t|=128,e.push(t)}}function ht(e,t){if(!e)throw new Error(t||"Assertion failed")}class dt{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const r=new Map,n=e=>{const t=e.toBase58();let n=r.get(t);return void 0===n&&(n={isSigner:!1,isWritable:!1,isInvoked:!1},r.set(t,n)),n},i=n(t);i.isSigner=!0,i.isWritable=!0;for(const t of e){n(t.programId).isInvoked=!0;for(const e of t.keys){const t=n(e.pubkey);t.isSigner||=e.isSigner,t.isWritable||=e.isWritable}}return new dt(t,r)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];ht(e.length<=256,"Max static account keys length exceeded");const t=e.filter(([,e])=>e.isSigner&&e.isWritable),r=e.filter(([,e])=>e.isSigner&&!e.isWritable),n=e.filter(([,e])=>!e.isSigner&&e.isWritable),i=e.filter(([,e])=>!e.isSigner&&!e.isWritable),s={numRequiredSignatures:t.length+r.length,numReadonlySignedAccounts:r.length,numReadonlyUnsignedAccounts:i.length};{ht(t.length>0,"Expected at least one writable signer key");const[e]=t[0];ht(e===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}return[s,[...t.map(([e])=>new Qe(e)),...r.map(([e])=>new Qe(e)),...n.map(([e])=>new Qe(e)),...i.map(([e])=>new Qe(e))]]}extractTableLookup(e){const[t,r]=this.drainKeysFoundInLookupTable(e.state.addresses,e=>!e.isSigner&&!e.isInvoked&&e.isWritable),[n,i]=this.drainKeysFoundInLookupTable(e.state.addresses,e=>!e.isSigner&&!e.isInvoked&&!e.isWritable);if(0!==t.length||0!==n.length)return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:n},{writable:r,readonly:i}]}drainKeysFoundInLookupTable(e,t){const r=new Array,n=new Array;for(const[i,s]of this.keyMetaMap.entries())if(t(s)){const t=new Qe(i),s=e.findIndex(e=>e.equals(t));s>=0&&(ht(s<256,"Max lookup table index exceeded"),r.push(s),n.push(t),this.keyMetaMap.delete(i))}return[r,n]}}const pt="Reached end of buffer unexpectedly";function ft(e){if(0===e.length)throw new Error(pt);return e.shift()}function gt(e,...t){const[r]=t;if(2===t.length?r+(t[1]??0)>e.length:r>=e.length)throw new Error(pt);return e.splice(...t)}class mt{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(e=>new Qe(e)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(e=>this.indexToProgramIds.set(e.programIdIndex,this.accountKeys[e.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:_e().decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new it(this.staticAccountKeys)}static compile(e){const t=dt.compile(e.instructions,e.payerKey),[r,n]=t.getMessageComponents(),i=new it(n).compileInstructions(e.instructions).map(e=>({programIdIndex:e.programIdIndex,accounts:e.accountKeyIndexes,data:_e().encode(e.data)}));return new mt({header:r,accountKeys:n,recentBlockhash:e.recentBlockhash,instructions:i})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;return e>=this.header.numRequiredSignatures?e-t<this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts:e<t-this.header.numReadonlySignedAccounts}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){const e=this.accountKeys.length;let t=[];ut(t,e);const r=this.instructions.map(e=>{const{accounts:t,programIdIndex:r}=e,n=Array.from(_e().decode(e.data));let i=[];ut(i,t.length);let s=[];return ut(s,n.length),{programIdIndex:r,keyIndicesCount:we.Buffer.from(i),keyIndices:t,dataLength:we.Buffer.from(s),data:n}});let n=[];ut(n,r.length);let i=we.Buffer.alloc(et);we.Buffer.from(n).copy(i);let s=n.length;r.forEach(e=>{const t=Ce.w3([Ce.u8("programIdIndex"),Ce.av(e.keyIndicesCount.length,"keyIndicesCount"),Ce.O6(Ce.u8("keyIndex"),e.keyIndices.length,"keyIndices"),Ce.av(e.dataLength.length,"dataLength"),Ce.O6(Ce.u8("userdatum"),e.data.length,"data")]).encode(e,i,s);s+=t}),i=i.slice(0,s);const o=Ce.w3([Ce.av(1,"numRequiredSignatures"),Ce.av(1,"numReadonlySignedAccounts"),Ce.av(1,"numReadonlyUnsignedAccounts"),Ce.av(t.length,"keyCount"),Ce.O6(st("key"),e,"keys"),st("recentBlockhash")]),a={numRequiredSignatures:we.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:we.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:we.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:we.Buffer.from(t),keys:this.accountKeys.map(e=>Ve(e.toBytes())),recentBlockhash:_e().decode(this.recentBlockhash)};let c=we.Buffer.alloc(2048);const l=o.encode(a,c);return i.copy(c,l),c.slice(0,l+i.length)}static from(e){let t=[...e];const r=ft(t);if(r!==(127&r))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const n=ft(t),i=ft(t),s=lt(t);let o=[];for(let e=0;e<s;e++){const e=gt(t,0,Je);o.push(new Qe(we.Buffer.from(e)))}const a=gt(t,0,Je),c=lt(t);let l=[];for(let e=0;e<c;e++){const e=ft(t),r=gt(t,0,lt(t)),n=gt(t,0,lt(t)),i=_e().encode(we.Buffer.from(n));l.push({programIdIndex:e,accounts:r,data:i})}const u={header:{numRequiredSignatures:r,numReadonlySignedAccounts:n,numReadonlyUnsignedAccounts:i},recentBlockhash:_e().encode(we.Buffer.from(a)),accountKeys:o,instructions:l};return new mt(u)}}class yt{constructor(e){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=e.header,this.staticAccountKeys=e.staticAccountKeys,this.recentBlockhash=e.recentBlockhash,this.compiledInstructions=e.compiledInstructions,this.addressTableLookups=e.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let e=0;for(const t of this.addressTableLookups)e+=t.readonlyIndexes.length+t.writableIndexes.length;return e}getAccountKeys(e){let t;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");t=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)t=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new it(this.staticAccountKeys,t)}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures,r=this.staticAccountKeys.length;return e>=r?e-r<this.addressTableLookups.reduce((e,t)=>e+t.writableIndexes.length,0):e>=this.header.numRequiredSignatures?e-t<r-t-this.header.numReadonlyUnsignedAccounts:e<t-this.header.numReadonlySignedAccounts}resolveAddressTableLookups(e){const t={writable:[],readonly:[]};for(const r of this.addressTableLookups){const n=e.find(e=>e.key.equals(r.accountKey));if(!n)throw new Error(`Failed to find address lookup table account for table key ${r.accountKey.toBase58()}`);for(const e of r.writableIndexes){if(!(e<n.state.addresses.length))throw new Error(`Failed to find address for index ${e} in address lookup table ${r.accountKey.toBase58()}`);t.writable.push(n.state.addresses[e])}for(const e of r.readonlyIndexes){if(!(e<n.state.addresses.length))throw new Error(`Failed to find address for index ${e} in address lookup table ${r.accountKey.toBase58()}`);t.readonly.push(n.state.addresses[e])}}return t}static compile(e){const t=dt.compile(e.instructions,e.payerKey),r=new Array,n={writable:new Array,readonly:new Array},i=e.addressLookupTableAccounts||[];for(const e of i){const i=t.extractTableLookup(e);if(void 0!==i){const[e,{writable:t,readonly:s}]=i;r.push(e),n.writable.push(...t),n.readonly.push(...s)}}const[s,o]=t.getMessageComponents(),a=new it(o,n).compileInstructions(e.instructions);return new yt({header:s,staticAccountKeys:o,recentBlockhash:e.recentBlockhash,compiledInstructions:a,addressTableLookups:r})}serialize(){const e=Array();ut(e,this.staticAccountKeys.length);const t=this.serializeInstructions(),r=Array();ut(r,this.compiledInstructions.length);const n=this.serializeAddressTableLookups(),i=Array();ut(i,this.addressTableLookups.length);const s=Ce.w3([Ce.u8("prefix"),Ce.w3([Ce.u8("numRequiredSignatures"),Ce.u8("numReadonlySignedAccounts"),Ce.u8("numReadonlyUnsignedAccounts")],"header"),Ce.av(e.length,"staticAccountKeysLength"),Ce.O6(st(),this.staticAccountKeys.length,"staticAccountKeys"),st("recentBlockhash"),Ce.av(r.length,"instructionsLength"),Ce.av(t.length,"serializedInstructions"),Ce.av(i.length,"addressTableLookupsLength"),Ce.av(n.length,"serializedAddressTableLookups")]),o=new Uint8Array(et),a=s.encode({prefix:128,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map(e=>e.toBytes()),recentBlockhash:_e().decode(this.recentBlockhash),instructionsLength:new Uint8Array(r),serializedInstructions:t,addressTableLookupsLength:new Uint8Array(i),serializedAddressTableLookups:n},o);return o.slice(0,a)}serializeInstructions(){let e=0;const t=new Uint8Array(et);for(const r of this.compiledInstructions){const n=Array();ut(n,r.accountKeyIndexes.length);const i=Array();ut(i,r.data.length),e+=Ce.w3([Ce.u8("programIdIndex"),Ce.av(n.length,"encodedAccountKeyIndexesLength"),Ce.O6(Ce.u8(),r.accountKeyIndexes.length,"accountKeyIndexes"),Ce.av(i.length,"encodedDataLength"),Ce.av(r.data.length,"data")]).encode({programIdIndex:r.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(n),accountKeyIndexes:r.accountKeyIndexes,encodedDataLength:new Uint8Array(i),data:r.data},t,e)}return t.slice(0,e)}serializeAddressTableLookups(){let e=0;const t=new Uint8Array(et);for(const r of this.addressTableLookups){const n=Array();ut(n,r.writableIndexes.length);const i=Array();ut(i,r.readonlyIndexes.length),e+=Ce.w3([st("accountKey"),Ce.av(n.length,"encodedWritableIndexesLength"),Ce.O6(Ce.u8(),r.writableIndexes.length,"writableIndexes"),Ce.av(i.length,"encodedReadonlyIndexesLength"),Ce.O6(Ce.u8(),r.readonlyIndexes.length,"readonlyIndexes")]).encode({accountKey:r.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(n),writableIndexes:r.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(i),readonlyIndexes:r.readonlyIndexes},t,e)}return t.slice(0,e)}static deserialize(e){let t=[...e];const r=ft(t),n=127&r;ht(r!==n,"Expected versioned message but received legacy message"),ht(0===n,`Expected versioned message with version 0 but found version ${n}`);const i={numRequiredSignatures:ft(t),numReadonlySignedAccounts:ft(t),numReadonlyUnsignedAccounts:ft(t)},s=[],o=lt(t);for(let e=0;e<o;e++)s.push(new Qe(gt(t,0,Je)));const a=_e().encode(gt(t,0,Je)),c=lt(t),l=[];for(let e=0;e<c;e++){const e=ft(t),r=gt(t,0,lt(t)),n=lt(t),i=new Uint8Array(gt(t,0,n));l.push({programIdIndex:e,accountKeyIndexes:r,data:i})}const u=lt(t),h=[];for(let e=0;e<u;e++){const e=new Qe(gt(t,0,Je)),r=gt(t,0,lt(t)),n=gt(t,0,lt(t));h.push({accountKey:e,writableIndexes:r,readonlyIndexes:n})}return new yt({header:i,staticAccountKeys:s,recentBlockhash:a,compiledInstructions:l,addressTableLookups:h})}}const wt={deserializeMessageVersion(e){const t=e[0],r=127&t;return r===t?"legacy":r},deserialize:e=>{const t=wt.deserializeMessageVersion(e);if("legacy"===t)return mt.from(e);if(0===t)return yt.deserialize(e);throw new Error(`Transaction message version ${t} deserialization is not supported`)}};let bt=function(e){return e[e.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",e[e.PROCESSED=1]="PROCESSED",e[e.TIMED_OUT=2]="TIMED_OUT",e[e.NONCE_INVALID=3]="NONCE_INVALID",e}({});const vt=we.Buffer.alloc(64).fill(0);class Et{constructor(e){this.keys=void 0,this.programId=void 0,this.data=we.Buffer.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:r})=>({pubkey:e.toJSON(),isSigner:t,isWritable:r})),programId:this.programId.toJSON(),data:[...this.data]}}}class At{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:r}=e;this.minNonceContextSlot=t,this.nonceInfo=r}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:r}=e;this.recentBlockhash=t,this.lastValidBlockHeight=r}else{const{recentBlockhash:t,nonceInfo:r}=e;r&&(this.nonceInfo=r),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(0===e.length)throw new Error("No instructions");return e.forEach(e=>{"instructions"in e?this.instructions=this.instructions.concat(e.instructions):"data"in e&&"programId"in e&&"keys"in e?this.instructions.push(e):this.instructions.push(new Et(e))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t,r;if(this.nonceInfo?(e=this.nonceInfo.nonce,t=this.instructions[0]!=this.nonceInfo.nonceInstruction?[this.nonceInfo.nonceInstruction,...this.instructions]:this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");if(t.length<1&&console.warn("No instructions provided"),this.feePayer)r=this.feePayer;else{if(!(this.signatures.length>0&&this.signatures[0].publicKey))throw new Error("Transaction fee payer required");r=this.signatures[0].publicKey}for(let e=0;e<t.length;e++)if(void 0===t[e].programId)throw new Error(`Transaction instruction index ${e} has undefined program id`);const n=[],i=[];t.forEach(e=>{e.keys.forEach(e=>{i.push({...e})});const t=e.programId.toString();n.includes(t)||n.push(t)}),n.forEach(e=>{i.push({pubkey:new Qe(e),isSigner:!1,isWritable:!1})});const s=[];i.forEach(e=>{const t=e.pubkey.toString(),r=s.findIndex(e=>e.pubkey.toString()===t);r>-1?(s[r].isWritable=s[r].isWritable||e.isWritable,s[r].isSigner=s[r].isSigner||e.isSigner):s.push(e)}),s.sort(function(e,t){return e.isSigner!==t.isSigner?e.isSigner?-1:1:e.isWritable!==t.isWritable?e.isWritable?-1:1:e.pubkey.toBase58().localeCompare(t.pubkey.toBase58(),"en",{localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"})});const o=s.findIndex(e=>e.pubkey.equals(r));if(o>-1){const[e]=s.splice(o,1);e.isSigner=!0,e.isWritable=!0,s.unshift(e)}else s.unshift({pubkey:r,isSigner:!0,isWritable:!0});for(const e of this.signatures){const t=s.findIndex(t=>t.pubkey.equals(e.publicKey));if(!(t>-1))throw new Error(`unknown signer: ${e.publicKey.toString()}`);s[t].isSigner||(s[t].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."))}let a=0,c=0,l=0;const u=[],h=[];s.forEach(({pubkey:e,isSigner:t,isWritable:r})=>{t?(u.push(e.toString()),a+=1,r||(c+=1)):(h.push(e.toString()),r||(l+=1))});const d=u.concat(h),p=t.map(e=>{const{data:t,programId:r}=e;return{programIdIndex:d.indexOf(r.toString()),accounts:e.keys.map(e=>d.indexOf(e.pubkey.toString())),data:_e().encode(t)}});return p.forEach(e=>{ht(e.programIdIndex>=0),e.accounts.forEach(e=>ht(e>=0))}),new mt({header:{numRequiredSignatures:a,numReadonlySignedAccounts:c,numReadonlyUnsignedAccounts:l},accountKeys:d,recentBlockhash:e,instructions:p})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((e,r)=>t[r].equals(e.publicKey))||(this.signatures=t.map(e=>({signature:null,publicKey:e}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(0===e.length)throw new Error("No signers");const t=new Set;this.signatures=e.filter(e=>{const r=e.toString();return!t.has(r)&&(t.add(r),!0)}).map(e=>({signature:null,publicKey:e}))}sign(...e){if(0===e.length)throw new Error("No signers");const t=new Set,r=[];for(const n of e){const e=n.publicKey.toString();t.has(e)||(t.add(e),r.push(n))}this.signatures=r.map(e=>({signature:null,publicKey:e.publicKey}));const n=this._compile();this._partialSign(n,...r)}partialSign(...e){if(0===e.length)throw new Error("No signers");const t=new Set,r=[];for(const n of e){const e=n.publicKey.toString();t.has(e)||(t.add(e),r.push(n))}const n=this._compile();this._partialSign(n,...r)}_partialSign(e,...t){const r=e.serialize();t.forEach(e=>{const t=He(r,e.secretKey);this._addSignature(e.publicKey,Ve(t))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){ht(64===t.length);const r=this.signatures.findIndex(t=>e.equals(t.publicKey));if(r<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[r].signature=we.Buffer.from(t)}verifySignatures(e=!0){return!this._getMessageSignednessErrors(this.serializeMessage(),e)}_getMessageSignednessErrors(e,t){const r={};for(const{signature:n,publicKey:i}of this.signatures)null===n?t&&(r.missing||=[]).push(i):Ke(n,e,i.toBytes())||(r.invalid||=[]).push(i);return r.invalid||r.missing?r:void 0}serialize(e){const{requireAllSignatures:t,verifySignatures:r}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),n=this.serializeMessage();if(r){const e=this._getMessageSignednessErrors(n,t);if(e){let t="Signature verification failed.";throw e.invalid&&(t+=`\nInvalid signature for public key${1===e.invalid.length?"":"(s)"} [\`${e.invalid.map(e=>e.toBase58()).join("`, `")}\`].`),e.missing&&(t+=`\nMissing signature for public key${1===e.missing.length?"":"(s)"} [\`${e.missing.map(e=>e.toBase58()).join("`, `")}\`].`),new Error(t)}}return this._serialize(n)}_serialize(e){const{signatures:t}=this,r=[];ut(r,t.length);const n=r.length+64*t.length+e.length,i=we.Buffer.alloc(n);return ht(t.length<256),we.Buffer.from(r).copy(i,0),t.forEach(({signature:e},t)=>{null!==e&&(ht(64===e.length,"signature has invalid length"),we.Buffer.from(e).copy(i,r.length+64*t))}),e.copy(i,r.length+64*t.length),ht(i.length<=et,`Transaction too large: ${i.length} > 1232`),i}get keys(){return ht(1===this.instructions.length),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return ht(1===this.instructions.length),this.instructions[0].programId}get data(){return ht(1===this.instructions.length),this.instructions[0].data}static from(e){let t=[...e];const r=lt(t);let n=[];for(let e=0;e<r;e++){const e=gt(t,0,64);n.push(_e().encode(we.Buffer.from(e)))}return At.populate(mt.from(t),n)}static populate(e,t=[]){const r=new At;return r.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(r.feePayer=e.accountKeys[0]),t.forEach((t,n)=>{const i={signature:t==_e().encode(vt)?null:_e().decode(t),publicKey:e.accountKeys[n]};r.signatures.push(i)}),e.instructions.forEach(t=>{const n=t.accounts.map(t=>{const n=e.accountKeys[t];return{pubkey:n,isSigner:r.signatures.some(e=>e.publicKey.toString()===n.toString())||e.isAccountSigner(t),isWritable:e.isAccountWritable(t)}});r.instructions.push(new Et({keys:n,programId:e.accountKeys[t.programIdIndex],data:_e().decode(t.data)}))}),r._message=e,r._json=r.toJSON(),r}}class _t{get version(){return this.message.version}constructor(e,t){if(this.signatures=void 0,this.message=void 0,void 0!==t)ht(t.length===e.header.numRequiredSignatures,"Expected signatures length to be equal to the number of required signatures"),this.signatures=t;else{const t=[];for(let r=0;r<e.header.numRequiredSignatures;r++)t.push(new Uint8Array(64));this.signatures=t}this.message=e}serialize(){const e=this.message.serialize(),t=Array();ut(t,this.signatures.length);const r=Ce.w3([Ce.av(t.length,"encodedSignaturesLength"),Ce.O6(ot(),this.signatures.length,"signatures"),Ce.av(e.length,"serializedMessage")]),n=new Uint8Array(2048),i=r.encode({encodedSignaturesLength:new Uint8Array(t),signatures:this.signatures,serializedMessage:e},n);return n.slice(0,i)}static deserialize(e){let t=[...e];const r=[],n=lt(t);for(let e=0;e<n;e++)r.push(new Uint8Array(gt(t,0,64)));const i=wt.deserialize(new Uint8Array(t));return new _t(i,r)}sign(e){const t=this.message.serialize(),r=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures);for(const n of e){const e=r.findIndex(e=>e.equals(n.publicKey));ht(e>=0,`Cannot sign with non signer key ${n.publicKey.toBase58()}`),this.signatures[e]=He(t,n.secretKey)}}addSignature(e,t){ht(64===t.byteLength,"Signature must be 64 bytes long");const r=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures).findIndex(t=>t.equals(e));ht(r>=0,`Can not add signature; \`${e.toBase58()}\` is not required to sign this transaction`),this.signatures[r]=t}}const It=new Qe("SysvarC1ock11111111111111111111111111111111"),St=(new Qe("SysvarEpochSchedu1e111111111111111111111111"),new Qe("Sysvar1nstructions1111111111111111111111111"),new Qe("SysvarRecentB1ockHashes11111111111111111111")),Ct=new Qe("SysvarRent111111111111111111111111111111111"),kt=(new Qe("SysvarRewards111111111111111111111111111111"),new Qe("SysvarS1otHashes111111111111111111111111111"),new Qe("SysvarS1otHistory11111111111111111111111111"),new Qe("SysvarStakeHistory1111111111111111111111111"));class Nt extends Error{constructor({action:e,signature:t,transactionMessage:r,logs:n}){const i=n?`Logs: \n${JSON.stringify(n.slice(-10),null,2)}. `:"",s="\nCatch the `SendTransactionError` and call `getLogs()` on it for full details.";let o;switch(e){case"send":o=`Transaction ${t} resulted in an error. \n${r}. `+i+s;break;case"simulate":o=`Simulation failed. \nMessage: ${r}. \n`+i+s;break;default:o=`Unknown action '${e}'`}super(o),this.signature=void 0,this.transactionMessage=void 0,this.transactionLogs=void 0,this.signature=t,this.transactionMessage=r,this.transactionLogs=n||void 0}get transactionError(){return{message:this.transactionMessage,logs:Array.isArray(this.transactionLogs)?this.transactionLogs:void 0}}get logs(){const e=this.transactionLogs;if(null==e||"object"!=typeof e||!("then"in e))return e}async getLogs(e){return Array.isArray(this.transactionLogs)||(this.transactionLogs=new Promise((t,r)=>{e.getTransaction(this.signature).then(e=>{if(e&&e.meta&&e.meta.logMessages){const r=e.meta.logMessages;this.transactionLogs=r,t(r)}else r(new Error("Log messages not found"))}).catch(r)})),await this.transactionLogs}}class xt extends Error{constructor({code:e,message:t,data:r},n){super(null!=n?`${n}: ${t}`:t),this.code=void 0,this.data=void 0,this.code=e,this.data=r,this.name="SolanaJSONRPCError"}}async function Tt(e,t,r,n){const i=n&&{skipPreflight:n.skipPreflight,preflightCommitment:n.preflightCommitment||n.commitment,maxRetries:n.maxRetries,minContextSlot:n.minContextSlot},s=await e.sendTransaction(t,r,i);let o;if(null!=t.recentBlockhash&&null!=t.lastValidBlockHeight)o=(await e.confirmTransaction({abortSignal:n?.abortSignal,signature:s,blockhash:t.recentBlockhash,lastValidBlockHeight:t.lastValidBlockHeight},n&&n.commitment)).value;else if(null!=t.minNonceContextSlot&&null!=t.nonceInfo){const{nonceInstruction:r}=t.nonceInfo,i=r.keys[0].pubkey;o=(await e.confirmTransaction({abortSignal:n?.abortSignal,minContextSlot:t.minNonceContextSlot,nonceAccountPubkey:i,nonceValue:t.nonceInfo.nonce,signature:s},n&&n.commitment)).value}else null!=n?.abortSignal&&console.warn("sendAndConfirmTransaction(): A transaction with a deprecated confirmation strategy was supplied along with an `abortSignal`. Only transactions having `lastValidBlockHeight` or a combination of `nonceInfo` and `minNonceContextSlot` are abortable."),o=(await e.confirmTransaction(s,n&&n.commitment)).value;if(o.err){if(null!=s)throw new Nt({action:"send",signature:s,transactionMessage:`Status: (${JSON.stringify(o)})`});throw new Error(`Transaction ${s} failed (${JSON.stringify(o)})`)}return s}function Ot(e){return new Promise(t=>setTimeout(t,e))}function Pt(e,t){const r=e.layout.span>=0?e.layout.span:ct(e,t),n=we.Buffer.alloc(r),i=Object.assign({instruction:e.index},t);return e.layout.encode(i,n),n}const Rt=Ce.I0("lamportsPerSignature"),Ut=Ce.w3([Ce.DH("version"),Ce.DH("state"),st("authorizedPubkey"),st("nonce"),Ce.w3([Rt],"feeCalculator")]),Bt=Ut.span;class Mt{constructor(e){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=e.authorizedPubkey,this.nonce=e.nonce,this.feeCalculator=e.feeCalculator}static fromAccountData(e){const t=Ut.decode(Ve(e),0);return new Mt({authorizedPubkey:new Qe(t.authorizedPubkey),nonce:new Qe(t.nonce).toString(),feeCalculator:t.feeCalculator})}}function Lt(e){const t=(0,Ce.av)(8,e),r=t.decode.bind(t),n=t.encode.bind(t),i=t,s=Be();return i.decode=(e,t)=>{const n=r(e,t);return s.decode(n)},i.encode=(e,t,r)=>{const i=s.encode(e);return n(i,t,r)},i}const Dt=Object.freeze({Create:{index:0,layout:Ce.w3([Ce.DH("instruction"),Ce.Wg("lamports"),Ce.Wg("space"),st("programId")])},Assign:{index:1,layout:Ce.w3([Ce.DH("instruction"),st("programId")])},Transfer:{index:2,layout:Ce.w3([Ce.DH("instruction"),Lt("lamports")])},CreateWithSeed:{index:3,layout:Ce.w3([Ce.DH("instruction"),st("base"),at("seed"),Ce.Wg("lamports"),Ce.Wg("space"),st("programId")])},AdvanceNonceAccount:{index:4,layout:Ce.w3([Ce.DH("instruction")])},WithdrawNonceAccount:{index:5,layout:Ce.w3([Ce.DH("instruction"),Ce.Wg("lamports")])},InitializeNonceAccount:{index:6,layout:Ce.w3([Ce.DH("instruction"),st("authorized")])},AuthorizeNonceAccount:{index:7,layout:Ce.w3([Ce.DH("instruction"),st("authorized")])},Allocate:{index:8,layout:Ce.w3([Ce.DH("instruction"),Ce.Wg("space")])},AllocateWithSeed:{index:9,layout:Ce.w3([Ce.DH("instruction"),st("base"),at("seed"),Ce.Wg("space"),st("programId")])},AssignWithSeed:{index:10,layout:Ce.w3([Ce.DH("instruction"),st("base"),at("seed"),st("programId")])},TransferWithSeed:{index:11,layout:Ce.w3([Ce.DH("instruction"),Lt("lamports"),at("seed"),st("programId")])},UpgradeNonceAccount:{index:12,layout:Ce.w3([Ce.DH("instruction")])}});class Wt{constructor(){}static createAccount(e){const t=Pt(Dt.Create,{lamports:e.lamports,space:e.space,programId:Ve(e.programId.toBuffer())});return new Et({keys:[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!0,isWritable:!0}],programId:this.programId,data:t})}static transfer(e){let t,r;return"basePubkey"in e?(t=Pt(Dt.TransferWithSeed,{lamports:BigInt(e.lamports),seed:e.seed,programId:Ve(e.programId.toBuffer())}),r=[{pubkey:e.fromPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]):(t=Pt(Dt.Transfer,{lamports:BigInt(e.lamports)}),r=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]),new Et({keys:r,programId:this.programId,data:t})}static assign(e){let t,r;return"basePubkey"in e?(t=Pt(Dt.AssignWithSeed,{base:Ve(e.basePubkey.toBuffer()),seed:e.seed,programId:Ve(e.programId.toBuffer())}),r=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]):(t=Pt(Dt.Assign,{programId:Ve(e.programId.toBuffer())}),r=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]),new Et({keys:r,programId:this.programId,data:t})}static createAccountWithSeed(e){const t=Pt(Dt.CreateWithSeed,{base:Ve(e.basePubkey.toBuffer()),seed:e.seed,lamports:e.lamports,space:e.space,programId:Ve(e.programId.toBuffer())});let r=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!1,isWritable:!0}];return e.basePubkey.equals(e.fromPubkey)||r.push({pubkey:e.basePubkey,isSigner:!0,isWritable:!1}),new Et({keys:r,programId:this.programId,data:t})}static createNonceAccount(e){const t=new At;"basePubkey"in e&&"seed"in e?t.add(Wt.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:Bt,programId:this.programId})):t.add(Wt.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,lamports:e.lamports,space:Bt,programId:this.programId}));const r={noncePubkey:e.noncePubkey,authorizedPubkey:e.authorizedPubkey};return t.add(this.nonceInitialize(r)),t}static nonceInitialize(e){const t=Pt(Dt.InitializeNonceAccount,{authorized:Ve(e.authorizedPubkey.toBuffer())}),r={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:St,isSigner:!1,isWritable:!1},{pubkey:Ct,isSigner:!1,isWritable:!1}],programId:this.programId,data:t};return new Et(r)}static nonceAdvance(e){const t=Pt(Dt.AdvanceNonceAccount),r={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:St,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:t};return new Et(r)}static nonceWithdraw(e){const t=Pt(Dt.WithdrawNonceAccount,{lamports:e.lamports});return new Et({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0},{pubkey:St,isSigner:!1,isWritable:!1},{pubkey:Ct,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:t})}static nonceAuthorize(e){const t=Pt(Dt.AuthorizeNonceAccount,{authorized:Ve(e.newAuthorizedPubkey.toBuffer())});return new Et({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:t})}static allocate(e){let t,r;return"basePubkey"in e?(t=Pt(Dt.AllocateWithSeed,{base:Ve(e.basePubkey.toBuffer()),seed:e.seed,space:e.space,programId:Ve(e.programId.toBuffer())}),r=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]):(t=Pt(Dt.Allocate,{space:e.space}),r=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]),new Et({keys:r,programId:this.programId,data:t})}}Wt.programId=new Qe("11111111111111111111111111111111");class jt{constructor(){}static getMinNumSignatures(e){return 2*(Math.ceil(e/jt.chunkSize)+1+1)}static async load(e,t,r,n,i){{const s=await e.getMinimumBalanceForRentExemption(i.length),o=await e.getAccountInfo(r.publicKey,"confirmed");let a=null;if(null!==o){if(o.executable)return console.error("Program load failed, account is already executable"),!1;o.data.length!==i.length&&(a=a||new At,a.add(Wt.allocate({accountPubkey:r.publicKey,space:i.length}))),o.owner.equals(n)||(a=a||new At,a.add(Wt.assign({accountPubkey:r.publicKey,programId:n}))),o.lamports<s&&(a=a||new At,a.add(Wt.transfer({fromPubkey:t.publicKey,toPubkey:r.publicKey,lamports:s-o.lamports})))}else a=(new At).add(Wt.createAccount({fromPubkey:t.publicKey,newAccountPubkey:r.publicKey,lamports:s>0?s:1,space:i.length,programId:n}));null!==a&&await Tt(e,a,[t,r],{commitment:"confirmed"})}const s=Ce.w3([Ce.DH("instruction"),Ce.DH("offset"),Ce.DH("bytesLength"),Ce.DH("bytesLengthPadding"),Ce.O6(Ce.u8("byte"),Ce.cY(Ce.DH(),-8),"bytes")]),o=jt.chunkSize;let a=0,c=i,l=[];for(;c.length>0;){const i=c.slice(0,o),u=we.Buffer.alloc(o+16);s.encode({instruction:0,offset:a,bytes:i,bytesLength:0,bytesLengthPadding:0},u);const h=(new At).add({keys:[{pubkey:r.publicKey,isSigner:!0,isWritable:!0}],programId:n,data:u});if(l.push(Tt(e,h,[t,r],{commitment:"confirmed"})),e._rpcEndpoint.includes("solana.com")){const e=4;await Ot(1e3/e)}a+=o,c=c.slice(o)}await Promise.all(l);{const i=Ce.w3([Ce.DH("instruction")]),s=we.Buffer.alloc(i.span);i.encode({instruction:1},s);const o=(new At).add({keys:[{pubkey:r.publicKey,isSigner:!0,isWritable:!0},{pubkey:Ct,isSigner:!1,isWritable:!1}],programId:n,data:s}),a="processed",c=await e.sendTransaction(o,[t,r],{preflightCommitment:a}),{context:l,value:u}=await e.confirmTransaction({signature:c,lastValidBlockHeight:o.lastValidBlockHeight,blockhash:o.recentBlockhash},a);if(u.err)throw new Error(`Transaction ${c} failed (${JSON.stringify(u)})`);for(;;){try{if(await e.getSlot({commitment:a})>l.slot)break}catch{}await new Promise(e=>setTimeout(e,Math.round(200)))}}return!0}}function $t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var zt,qt;function Ft(){if(qt)return zt;qt=1;var e=Object.prototype.toString,t=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};function r(n,i){var s,o,a,c,l,u,h;if(!0===n)return"true";if(!1===n)return"false";switch(typeof n){case"object":if(null===n)return null;if(n.toJSON&&"function"==typeof n.toJSON)return r(n.toJSON(),i);if("[object Array]"===(h=e.call(n))){for(a="[",o=n.length-1,s=0;s<o;s++)a+=r(n[s],!0)+",";return o>-1&&(a+=r(n[s],!0)),a+"]"}if("[object Object]"===h){for(o=(c=t(n).sort()).length,a="",s=0;s<o;)void 0!==(u=r(n[l=c[s]],!1))&&(a&&(a+=","),a+=JSON.stringify(l)+":"+u),s++;return"{"+a+"}"}return JSON.stringify(n);case"function":case"undefined":return i?null:void 0;case"string":return JSON.stringify(n);default:return isFinite(n)?n:null}}return zt=function(e){var t=r(e,!1);if(void 0!==t)return""+t}}jt.chunkSize=932,new Qe("BPFLoader2111111111111111111111111111111111");var Ht=$t(Ft());function Kt(e){let t=0;for(;e>1;)e/=2,t++;return t}class Vt{constructor(e,t,r,n,i){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=e,this.leaderScheduleSlotOffset=t,this.warmup=r,this.firstNormalEpoch=n,this.firstNormalSlot=i}getEpoch(e){return this.getEpochAndSlotIndex(e)[0]}getEpochAndSlotIndex(e){if(e<this.firstNormalSlot){const r=Kt(0===(t=e+32+1)?1:(t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,1+(t|=t>>32)))-Kt(32)-1;return[r,e-(this.getSlotsInEpoch(r)-32)]}{const t=e-this.firstNormalSlot,r=Math.floor(t/this.slotsPerEpoch);return[this.firstNormalEpoch+r,t%this.slotsPerEpoch]}var t}getFirstSlotInEpoch(e){return e<=this.firstNormalEpoch?32*(Math.pow(2,e)-1):(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}getSlotsInEpoch(e){return e<this.firstNormalEpoch?Math.pow(2,e+Kt(32)):this.slotsPerEpoch}}var Yt=globalThis.fetch;class Gt extends We.vE{constructor(e,t,r){super(e=>{const r=(0,We.kb)(e,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...t});return this.underlyingSocket="socket"in r?r.socket:r,r},e,t,r),this.underlyingSocket=void 0}call(...e){const t=this.underlyingSocket?.readyState;return 1===t?super.call(...e):Promise.reject(new Error("Tried to call a JSON-RPC method `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}notify(...e){const t=this.underlyingSocket?.readyState;return 1===t?super.notify(...e):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}}class Zt{constructor(e){this.key=void 0,this.state=void 0,this.key=e.key,this.state=e.state}isActive(){const e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}static deserialize(e){const t=function(e,t){let r;try{r=e.layout.decode(t)}catch(e){throw new Error("invalid instruction; "+e)}if(r.typeIndex!==e.index)throw new Error(`invalid account data; account type mismatch ${r.typeIndex} != ${e.index}`);return r}(Jt,e),r=e.length-56;ht(r>=0,"lookup table is invalid"),ht(r%32==0,"lookup table is invalid");const n=r/32,{addresses:i}=Ce.w3([Ce.O6(st(),n,"addresses")]).decode(e.slice(56));return{deactivationSlot:t.deactivationSlot,lastExtendedSlot:t.lastExtendedSlot,lastExtendedSlotStartIndex:t.lastExtendedStartIndex,authority:0!==t.authority.length?new Qe(t.authority[0]):void 0,addresses:i.map(e=>new Qe(e))}}}const Jt={index:1,layout:Ce.w3([Ce.DH("typeIndex"),Lt("deactivationSlot"),Ce.I0("lastExtendedSlot"),Ce.u8("lastExtendedStartIndex"),Ce.u8(),Ce.O6(st(),Ce.cY(Ce.u8(),-1),"authority")])},Xt=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i,Qt=(0,Me.au)((0,Me.KJ)(Qe),(0,Me.Yj)(),e=>new Qe(e)),er=(0,Me.PV)([(0,Me.Yj)(),(0,Me.eu)("base64")]),tr=(0,Me.au)((0,Me.KJ)(we.Buffer),er,e=>we.Buffer.from(e[0],"base64"));function rr(e){let t,r;if("string"==typeof e)t=e;else if(e){const{commitment:n,...i}=e;t=n,r=i}return{commitment:t,config:r}}function nr(e){return e.map(e=>"memcmp"in e?{...e,memcmp:{...e.memcmp,encoding:e.memcmp.encoding??"base58"}}:e)}function ir(e){return(0,Me.KC)([(0,Me.NW)({jsonrpc:(0,Me.eu)("2.0"),id:(0,Me.Yj)(),result:e}),(0,Me.NW)({jsonrpc:(0,Me.eu)("2.0"),id:(0,Me.Yj)(),error:(0,Me.NW)({code:(0,Me.L5)(),message:(0,Me.Yj)(),data:(0,Me.lq)((0,Me.bz)())})})])}const sr=ir((0,Me.L5)());function or(e){return(0,Me.au)(ir(e),sr,t=>"error"in t?t:{...t,result:(0,Me.vt)(t.result,e)})}function ar(e){return or((0,Me.NW)({context:(0,Me.NW)({slot:(0,Me.ai)()}),value:e}))}function cr(e){return(0,Me.NW)({context:(0,Me.NW)({slot:(0,Me.ai)()}),value:e})}function lr(e,t){return 0===e?new yt({header:t.header,staticAccountKeys:t.accountKeys.map(e=>new Qe(e)),recentBlockhash:t.recentBlockhash,compiledInstructions:t.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:_e().decode(e.data)})),addressTableLookups:t.addressTableLookups}):new mt(t)}const ur=(0,Me.NW)({foundation:(0,Me.ai)(),foundationTerm:(0,Me.ai)(),initial:(0,Me.ai)(),taper:(0,Me.ai)(),terminal:(0,Me.ai)()}),hr=or((0,Me.YO)((0,Me.me)((0,Me.NW)({epoch:(0,Me.ai)(),effectiveSlot:(0,Me.ai)(),amount:(0,Me.ai)(),postBalance:(0,Me.ai)(),commission:(0,Me.lq)((0,Me.me)((0,Me.ai)()))})))),dr=(0,Me.YO)((0,Me.NW)({slot:(0,Me.ai)(),prioritizationFee:(0,Me.ai)()})),pr=(0,Me.NW)({total:(0,Me.ai)(),validator:(0,Me.ai)(),foundation:(0,Me.ai)(),epoch:(0,Me.ai)()}),fr=(0,Me.NW)({epoch:(0,Me.ai)(),slotIndex:(0,Me.ai)(),slotsInEpoch:(0,Me.ai)(),absoluteSlot:(0,Me.ai)(),blockHeight:(0,Me.lq)((0,Me.ai)()),transactionCount:(0,Me.lq)((0,Me.ai)())}),gr=(0,Me.NW)({slotsPerEpoch:(0,Me.ai)(),leaderScheduleSlotOffset:(0,Me.ai)(),warmup:(0,Me.zM)(),firstNormalEpoch:(0,Me.ai)(),firstNormalSlot:(0,Me.ai)()}),mr=(0,Me.g1)((0,Me.Yj)(),(0,Me.YO)((0,Me.ai)())),yr=(0,Me.me)((0,Me.KC)([(0,Me.NW)({}),(0,Me.Yj)()])),wr=(0,Me.NW)({err:yr}),br=(0,Me.eu)("receivedSignature"),vr=(0,Me.NW)({"solana-core":(0,Me.Yj)(),"feature-set":(0,Me.lq)((0,Me.ai)())}),Er=(0,Me.NW)({program:(0,Me.Yj)(),programId:Qt,parsed:(0,Me.L5)()}),Ar=(0,Me.NW)({programId:Qt,accounts:(0,Me.YO)(Qt),data:(0,Me.Yj)()}),_r=ar((0,Me.NW)({err:(0,Me.me)((0,Me.KC)([(0,Me.NW)({}),(0,Me.Yj)()])),logs:(0,Me.me)((0,Me.YO)((0,Me.Yj)())),accounts:(0,Me.lq)((0,Me.me)((0,Me.YO)((0,Me.me)((0,Me.NW)({executable:(0,Me.zM)(),owner:(0,Me.Yj)(),lamports:(0,Me.ai)(),data:(0,Me.YO)((0,Me.Yj)()),rentEpoch:(0,Me.lq)((0,Me.ai)())}))))),unitsConsumed:(0,Me.lq)((0,Me.ai)()),returnData:(0,Me.lq)((0,Me.me)((0,Me.NW)({programId:(0,Me.Yj)(),data:(0,Me.PV)([(0,Me.Yj)(),(0,Me.eu)("base64")])}))),innerInstructions:(0,Me.lq)((0,Me.me)((0,Me.YO)((0,Me.NW)({index:(0,Me.ai)(),instructions:(0,Me.YO)((0,Me.KC)([Er,Ar]))}))))})),Ir=ar((0,Me.NW)({byIdentity:(0,Me.g1)((0,Me.Yj)(),(0,Me.YO)((0,Me.ai)())),range:(0,Me.NW)({firstSlot:(0,Me.ai)(),lastSlot:(0,Me.ai)()})})),Sr=or(ur),Cr=or(pr),kr=or(dr),Nr=or(fr),xr=or(gr),Tr=or(mr),Or=or((0,Me.ai)()),Pr=ar((0,Me.NW)({total:(0,Me.ai)(),circulating:(0,Me.ai)(),nonCirculating:(0,Me.ai)(),nonCirculatingAccounts:(0,Me.YO)(Qt)})),Rr=(0,Me.NW)({amount:(0,Me.Yj)(),uiAmount:(0,Me.me)((0,Me.ai)()),decimals:(0,Me.ai)(),uiAmountString:(0,Me.lq)((0,Me.Yj)())}),Ur=ar((0,Me.YO)((0,Me.NW)({address:Qt,amount:(0,Me.Yj)(),uiAmount:(0,Me.me)((0,Me.ai)()),decimals:(0,Me.ai)(),uiAmountString:(0,Me.lq)((0,Me.Yj)())}))),Br=ar((0,Me.YO)((0,Me.NW)({pubkey:Qt,account:(0,Me.NW)({executable:(0,Me.zM)(),owner:Qt,lamports:(0,Me.ai)(),data:tr,rentEpoch:(0,Me.ai)()})}))),Mr=(0,Me.NW)({program:(0,Me.Yj)(),parsed:(0,Me.L5)(),space:(0,Me.ai)()}),Lr=ar((0,Me.YO)((0,Me.NW)({pubkey:Qt,account:(0,Me.NW)({executable:(0,Me.zM)(),owner:Qt,lamports:(0,Me.ai)(),data:Mr,rentEpoch:(0,Me.ai)()})}))),Dr=ar((0,Me.YO)((0,Me.NW)({lamports:(0,Me.ai)(),address:Qt}))),Wr=(0,Me.NW)({executable:(0,Me.zM)(),owner:Qt,lamports:(0,Me.ai)(),data:tr,rentEpoch:(0,Me.ai)()}),jr=(0,Me.NW)({pubkey:Qt,account:Wr}),$r=(0,Me.au)((0,Me.KC)([(0,Me.KJ)(we.Buffer),Mr]),(0,Me.KC)([er,Mr]),e=>Array.isArray(e)?(0,Me.vt)(e,tr):e),zr=(0,Me.NW)({executable:(0,Me.zM)(),owner:Qt,lamports:(0,Me.ai)(),data:$r,rentEpoch:(0,Me.ai)()}),qr=(0,Me.NW)({pubkey:Qt,account:zr}),Fr=(0,Me.NW)({state:(0,Me.KC)([(0,Me.eu)("active"),(0,Me.eu)("inactive"),(0,Me.eu)("activating"),(0,Me.eu)("deactivating")]),active:(0,Me.ai)(),inactive:(0,Me.ai)()}),Hr=or((0,Me.YO)((0,Me.NW)({signature:(0,Me.Yj)(),slot:(0,Me.ai)(),err:yr,memo:(0,Me.me)((0,Me.Yj)()),blockTime:(0,Me.lq)((0,Me.me)((0,Me.ai)()))}))),Kr=or((0,Me.YO)((0,Me.NW)({signature:(0,Me.Yj)(),slot:(0,Me.ai)(),err:yr,memo:(0,Me.me)((0,Me.Yj)()),blockTime:(0,Me.lq)((0,Me.me)((0,Me.ai)()))}))),Vr=(0,Me.NW)({subscription:(0,Me.ai)(),result:cr(Wr)}),Yr=(0,Me.NW)({pubkey:Qt,account:Wr}),Gr=(0,Me.NW)({subscription:(0,Me.ai)(),result:cr(Yr)}),Zr=(0,Me.NW)({parent:(0,Me.ai)(),slot:(0,Me.ai)(),root:(0,Me.ai)()}),Jr=(0,Me.NW)({subscription:(0,Me.ai)(),result:Zr}),Xr=(0,Me.KC)([(0,Me.NW)({type:(0,Me.KC)([(0,Me.eu)("firstShredReceived"),(0,Me.eu)("completed"),(0,Me.eu)("optimisticConfirmation"),(0,Me.eu)("root")]),slot:(0,Me.ai)(),timestamp:(0,Me.ai)()}),(0,Me.NW)({type:(0,Me.eu)("createdBank"),parent:(0,Me.ai)(),slot:(0,Me.ai)(),timestamp:(0,Me.ai)()}),(0,Me.NW)({type:(0,Me.eu)("frozen"),slot:(0,Me.ai)(),timestamp:(0,Me.ai)(),stats:(0,Me.NW)({numTransactionEntries:(0,Me.ai)(),numSuccessfulTransactions:(0,Me.ai)(),numFailedTransactions:(0,Me.ai)(),maxTransactionsPerEntry:(0,Me.ai)()})}),(0,Me.NW)({type:(0,Me.eu)("dead"),slot:(0,Me.ai)(),timestamp:(0,Me.ai)(),err:(0,Me.Yj)()})]),Qr=(0,Me.NW)({subscription:(0,Me.ai)(),result:Xr}),en=(0,Me.NW)({subscription:(0,Me.ai)(),result:cr((0,Me.KC)([wr,br]))}),tn=(0,Me.NW)({subscription:(0,Me.ai)(),result:(0,Me.ai)()}),rn=(0,Me.NW)({pubkey:(0,Me.Yj)(),gossip:(0,Me.me)((0,Me.Yj)()),tpu:(0,Me.me)((0,Me.Yj)()),rpc:(0,Me.me)((0,Me.Yj)()),version:(0,Me.me)((0,Me.Yj)())}),nn=(0,Me.NW)({votePubkey:(0,Me.Yj)(),nodePubkey:(0,Me.Yj)(),activatedStake:(0,Me.ai)(),epochVoteAccount:(0,Me.zM)(),epochCredits:(0,Me.YO)((0,Me.PV)([(0,Me.ai)(),(0,Me.ai)(),(0,Me.ai)()])),commission:(0,Me.ai)(),lastVote:(0,Me.ai)(),rootSlot:(0,Me.me)((0,Me.ai)())}),sn=or((0,Me.NW)({current:(0,Me.YO)(nn),delinquent:(0,Me.YO)(nn)})),on=(0,Me.KC)([(0,Me.eu)("processed"),(0,Me.eu)("confirmed"),(0,Me.eu)("finalized")]),an=(0,Me.NW)({slot:(0,Me.ai)(),confirmations:(0,Me.me)((0,Me.ai)()),err:yr,confirmationStatus:(0,Me.lq)(on)}),cn=ar((0,Me.YO)((0,Me.me)(an))),ln=or((0,Me.ai)()),un=(0,Me.NW)({accountKey:Qt,writableIndexes:(0,Me.YO)((0,Me.ai)()),readonlyIndexes:(0,Me.YO)((0,Me.ai)())}),hn=(0,Me.NW)({signatures:(0,Me.YO)((0,Me.Yj)()),message:(0,Me.NW)({accountKeys:(0,Me.YO)((0,Me.Yj)()),header:(0,Me.NW)({numRequiredSignatures:(0,Me.ai)(),numReadonlySignedAccounts:(0,Me.ai)(),numReadonlyUnsignedAccounts:(0,Me.ai)()}),instructions:(0,Me.YO)((0,Me.NW)({accounts:(0,Me.YO)((0,Me.ai)()),data:(0,Me.Yj)(),programIdIndex:(0,Me.ai)()})),recentBlockhash:(0,Me.Yj)(),addressTableLookups:(0,Me.lq)((0,Me.YO)(un))})}),dn=(0,Me.NW)({pubkey:Qt,signer:(0,Me.zM)(),writable:(0,Me.zM)(),source:(0,Me.lq)((0,Me.KC)([(0,Me.eu)("transaction"),(0,Me.eu)("lookupTable")]))}),pn=(0,Me.NW)({accountKeys:(0,Me.YO)(dn),signatures:(0,Me.YO)((0,Me.Yj)())}),fn=(0,Me.NW)({parsed:(0,Me.L5)(),program:(0,Me.Yj)(),programId:Qt}),gn=(0,Me.NW)({accounts:(0,Me.YO)(Qt),data:(0,Me.Yj)(),programId:Qt}),mn=(0,Me.KC)([gn,fn]),yn=(0,Me.KC)([(0,Me.NW)({parsed:(0,Me.L5)(),program:(0,Me.Yj)(),programId:(0,Me.Yj)()}),(0,Me.NW)({accounts:(0,Me.YO)((0,Me.Yj)()),data:(0,Me.Yj)(),programId:(0,Me.Yj)()})]),wn=(0,Me.au)(mn,yn,e=>"accounts"in e?(0,Me.vt)(e,gn):(0,Me.vt)(e,fn)),bn=(0,Me.NW)({signatures:(0,Me.YO)((0,Me.Yj)()),message:(0,Me.NW)({accountKeys:(0,Me.YO)(dn),instructions:(0,Me.YO)(wn),recentBlockhash:(0,Me.Yj)(),addressTableLookups:(0,Me.lq)((0,Me.me)((0,Me.YO)(un)))})}),vn=(0,Me.NW)({accountIndex:(0,Me.ai)(),mint:(0,Me.Yj)(),owner:(0,Me.lq)((0,Me.Yj)()),programId:(0,Me.lq)((0,Me.Yj)()),uiTokenAmount:Rr}),En=(0,Me.NW)({writable:(0,Me.YO)(Qt),readonly:(0,Me.YO)(Qt)}),An=(0,Me.NW)({err:yr,fee:(0,Me.ai)(),innerInstructions:(0,Me.lq)((0,Me.me)((0,Me.YO)((0,Me.NW)({index:(0,Me.ai)(),instructions:(0,Me.YO)((0,Me.NW)({accounts:(0,Me.YO)((0,Me.ai)()),data:(0,Me.Yj)(),programIdIndex:(0,Me.ai)()}))})))),preBalances:(0,Me.YO)((0,Me.ai)()),postBalances:(0,Me.YO)((0,Me.ai)()),logMessages:(0,Me.lq)((0,Me.me)((0,Me.YO)((0,Me.Yj)()))),preTokenBalances:(0,Me.lq)((0,Me.me)((0,Me.YO)(vn))),postTokenBalances:(0,Me.lq)((0,Me.me)((0,Me.YO)(vn))),loadedAddresses:(0,Me.lq)(En),computeUnitsConsumed:(0,Me.lq)((0,Me.ai)())}),_n=(0,Me.NW)({err:yr,fee:(0,Me.ai)(),innerInstructions:(0,Me.lq)((0,Me.me)((0,Me.YO)((0,Me.NW)({index:(0,Me.ai)(),instructions:(0,Me.YO)(wn)})))),preBalances:(0,Me.YO)((0,Me.ai)()),postBalances:(0,Me.YO)((0,Me.ai)()),logMessages:(0,Me.lq)((0,Me.me)((0,Me.YO)((0,Me.Yj)()))),preTokenBalances:(0,Me.lq)((0,Me.me)((0,Me.YO)(vn))),postTokenBalances:(0,Me.lq)((0,Me.me)((0,Me.YO)(vn))),loadedAddresses:(0,Me.lq)(En),computeUnitsConsumed:(0,Me.lq)((0,Me.ai)())}),In=(0,Me.KC)([(0,Me.eu)(0),(0,Me.eu)("legacy")]),Sn=(0,Me.NW)({pubkey:(0,Me.Yj)(),lamports:(0,Me.ai)(),postBalance:(0,Me.me)((0,Me.ai)()),rewardType:(0,Me.me)((0,Me.Yj)()),commission:(0,Me.lq)((0,Me.me)((0,Me.ai)()))}),Cn=or((0,Me.me)((0,Me.NW)({blockhash:(0,Me.Yj)(),previousBlockhash:(0,Me.Yj)(),parentSlot:(0,Me.ai)(),transactions:(0,Me.YO)((0,Me.NW)({transaction:hn,meta:(0,Me.me)(An),version:(0,Me.lq)(In)})),rewards:(0,Me.lq)((0,Me.YO)(Sn)),blockTime:(0,Me.me)((0,Me.ai)()),blockHeight:(0,Me.me)((0,Me.ai)())}))),kn=or((0,Me.me)((0,Me.NW)({blockhash:(0,Me.Yj)(),previousBlockhash:(0,Me.Yj)(),parentSlot:(0,Me.ai)(),rewards:(0,Me.lq)((0,Me.YO)(Sn)),blockTime:(0,Me.me)((0,Me.ai)()),blockHeight:(0,Me.me)((0,Me.ai)())}))),Nn=or((0,Me.me)((0,Me.NW)({blockhash:(0,Me.Yj)(),previousBlockhash:(0,Me.Yj)(),parentSlot:(0,Me.ai)(),transactions:(0,Me.YO)((0,Me.NW)({transaction:pn,meta:(0,Me.me)(An),version:(0,Me.lq)(In)})),rewards:(0,Me.lq)((0,Me.YO)(Sn)),blockTime:(0,Me.me)((0,Me.ai)()),blockHeight:(0,Me.me)((0,Me.ai)())}))),xn=or((0,Me.me)((0,Me.NW)({blockhash:(0,Me.Yj)(),previousBlockhash:(0,Me.Yj)(),parentSlot:(0,Me.ai)(),transactions:(0,Me.YO)((0,Me.NW)({transaction:bn,meta:(0,Me.me)(_n),version:(0,Me.lq)(In)})),rewards:(0,Me.lq)((0,Me.YO)(Sn)),blockTime:(0,Me.me)((0,Me.ai)()),blockHeight:(0,Me.me)((0,Me.ai)())}))),Tn=or((0,Me.me)((0,Me.NW)({blockhash:(0,Me.Yj)(),previousBlockhash:(0,Me.Yj)(),parentSlot:(0,Me.ai)(),transactions:(0,Me.YO)((0,Me.NW)({transaction:pn,meta:(0,Me.me)(_n),version:(0,Me.lq)(In)})),rewards:(0,Me.lq)((0,Me.YO)(Sn)),blockTime:(0,Me.me)((0,Me.ai)()),blockHeight:(0,Me.me)((0,Me.ai)())}))),On=or((0,Me.me)((0,Me.NW)({blockhash:(0,Me.Yj)(),previousBlockhash:(0,Me.Yj)(),parentSlot:(0,Me.ai)(),rewards:(0,Me.lq)((0,Me.YO)(Sn)),blockTime:(0,Me.me)((0,Me.ai)()),blockHeight:(0,Me.me)((0,Me.ai)())}))),Pn=or((0,Me.me)((0,Me.NW)({blockhash:(0,Me.Yj)(),previousBlockhash:(0,Me.Yj)(),parentSlot:(0,Me.ai)(),transactions:(0,Me.YO)((0,Me.NW)({transaction:hn,meta:(0,Me.me)(An)})),rewards:(0,Me.lq)((0,Me.YO)(Sn)),blockTime:(0,Me.me)((0,Me.ai)())}))),Rn=or((0,Me.me)((0,Me.NW)({blockhash:(0,Me.Yj)(),previousBlockhash:(0,Me.Yj)(),parentSlot:(0,Me.ai)(),signatures:(0,Me.YO)((0,Me.Yj)()),blockTime:(0,Me.me)((0,Me.ai)())}))),Un=or((0,Me.me)((0,Me.NW)({slot:(0,Me.ai)(),meta:(0,Me.me)(An),blockTime:(0,Me.lq)((0,Me.me)((0,Me.ai)())),transaction:hn,version:(0,Me.lq)(In)}))),Bn=or((0,Me.me)((0,Me.NW)({slot:(0,Me.ai)(),transaction:bn,meta:(0,Me.me)(_n),blockTime:(0,Me.lq)((0,Me.me)((0,Me.ai)())),version:(0,Me.lq)(In)}))),Mn=ar((0,Me.NW)({blockhash:(0,Me.Yj)(),lastValidBlockHeight:(0,Me.ai)()})),Ln=ar((0,Me.zM)()),Dn=(0,Me.NW)({slot:(0,Me.ai)(),numTransactions:(0,Me.ai)(),numSlots:(0,Me.ai)(),samplePeriodSecs:(0,Me.ai)()}),Wn=or((0,Me.YO)(Dn)),jn=ar((0,Me.me)((0,Me.NW)({feeCalculator:(0,Me.NW)({lamportsPerSignature:(0,Me.ai)()})}))),$n=or((0,Me.Yj)()),zn=or((0,Me.Yj)()),qn=(0,Me.NW)({err:yr,logs:(0,Me.YO)((0,Me.Yj)()),signature:(0,Me.Yj)()}),Fn=(0,Me.NW)({result:cr(qn),subscription:(0,Me.ai)()}),Hn={"solana-client":"js/1.0.0-maintenance"};class Kn{constructor(e,t){let r,n,i,s,o,a;var c;this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const e={};return async t=>{const{commitment:r,config:n}=rr(t),i=this._buildArgs([],r,void 0,n),s=Ht(i);return e[s]=e[s]??(async()=>{try{const e=await this._rpcRequest("getBlockHeight",i),t=(0,Me.vt)(e,or((0,Me.ai)()));if("error"in t)throw new xt(t.error,"failed to get block height information");return t.result}finally{delete e[s]}})(),await e[s]}})(),t&&"string"==typeof t?this._commitment=t:t&&(this._commitment=t.commitment,this._confirmTransactionInitialTimeout=t.confirmTransactionInitialTimeout,r=t.wsEndpoint,n=t.httpHeaders,i=t.fetch,s=t.fetchMiddleware,o=t.disableRetryOnRateLimit,a=t.httpAgent),this._rpcEndpoint=function(e){if(!1===/^https?:/.test(e))throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return e}(e),this._rpcWsEndpoint=r||function(e){const t=e.match(Xt);if(null==t)throw TypeError(`Failed to validate endpoint URL \`${e}\``);const[r,n,i,s]=t,o=e.startsWith("https:")?"wss:":"ws:",a=null==i?null:parseInt(i.slice(1),10);return`${o}//${n}${null==a?"":`:${a+1}`}${s}`}(e),this._rpcClient=function(e,t,r,n,i,s){const o=r||Yt;let a;return null!=s&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments."),n&&(a=async(e,t)=>{const r=await new Promise((r,i)=>{try{n(e,t,(e,t)=>r([e,t]))}catch(e){i(e)}});return await o(...r)}),new(De())(async(r,n)=>{const s={method:"POST",body:r,agent:void 0,headers:Object.assign({"Content-Type":"application/json"},t||{},Hn)};try{let t,r=5,c=500;for(;t=a?await a(e,s):await o(e,s),429===t.status&&!0!==i&&(r-=1,0!==r);)console.error(`Server responded with ${t.status} ${t.statusText}.  Retrying after ${c}ms delay...`),await Ot(c),c*=2;const l=await t.text();t.ok?n(null,l):n(new Error(`${t.status} ${t.statusText}: ${l}`))}catch(e){e instanceof Error&&n(e)}},{})}(e,n,i,s,o,a),this._rpcRequest=(c=this._rpcClient,(e,t)=>new Promise((r,n)=>{c.request(e,t,(e,t)=>{e?n(e):r(t)})})),this._rpcBatchRequest=function(e){return t=>new Promise((r,n)=>{0===t.length&&r([]);const i=t.map(t=>e.request(t.methodName,t.args));e.request(i,(e,t)=>{e?n(e):r(t)})})}(this._rpcClient),this._rpcWebSocket=new Gt(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(e,t){const{commitment:r,config:n}=rr(t),i=this._buildArgs([e.toBase58()],r,void 0,n),s=await this._rpcRequest("getBalance",i),o=(0,Me.vt)(s,ar((0,Me.ai)()));if("error"in o)throw new xt(o.error,`failed to get balance for ${e.toBase58()}`);return o.result}async getBalance(e,t){return await this.getBalanceAndContext(e,t).then(e=>e.value).catch(t=>{throw new Error("failed to get balance of account "+e.toBase58()+": "+t)})}async getBlockTime(e){const t=await this._rpcRequest("getBlockTime",[e]),r=(0,Me.vt)(t,or((0,Me.me)((0,Me.ai)())));if("error"in r)throw new xt(r.error,`failed to get block time for slot ${e}`);return r.result}async getMinimumLedgerSlot(){const e=await this._rpcRequest("minimumLedgerSlot",[]),t=(0,Me.vt)(e,or((0,Me.ai)()));if("error"in t)throw new xt(t.error,"failed to get minimum ledger slot");return t.result}async getFirstAvailableBlock(){const e=await this._rpcRequest("getFirstAvailableBlock",[]),t=(0,Me.vt)(e,Or);if("error"in t)throw new xt(t.error,"failed to get first available block");return t.result}async getSupply(e){let t={};t="string"==typeof e?{commitment:e}:e?{...e,commitment:e&&e.commitment||this.commitment}:{commitment:this.commitment};const r=await this._rpcRequest("getSupply",[t]),n=(0,Me.vt)(r,Pr);if("error"in n)throw new xt(n.error,"failed to get supply");return n.result}async getTokenSupply(e,t){const r=this._buildArgs([e.toBase58()],t),n=await this._rpcRequest("getTokenSupply",r),i=(0,Me.vt)(n,ar(Rr));if("error"in i)throw new xt(i.error,"failed to get token supply");return i.result}async getTokenAccountBalance(e,t){const r=this._buildArgs([e.toBase58()],t),n=await this._rpcRequest("getTokenAccountBalance",r),i=(0,Me.vt)(n,ar(Rr));if("error"in i)throw new xt(i.error,"failed to get token account balance");return i.result}async getTokenAccountsByOwner(e,t,r){const{commitment:n,config:i}=rr(r);let s=[e.toBase58()];"mint"in t?s.push({mint:t.mint.toBase58()}):s.push({programId:t.programId.toBase58()});const o=this._buildArgs(s,n,"base64",i),a=await this._rpcRequest("getTokenAccountsByOwner",o),c=(0,Me.vt)(a,Br);if("error"in c)throw new xt(c.error,`failed to get token accounts owned by account ${e.toBase58()}`);return c.result}async getParsedTokenAccountsByOwner(e,t,r){let n=[e.toBase58()];"mint"in t?n.push({mint:t.mint.toBase58()}):n.push({programId:t.programId.toBase58()});const i=this._buildArgs(n,r,"jsonParsed"),s=await this._rpcRequest("getTokenAccountsByOwner",i),o=(0,Me.vt)(s,Lr);if("error"in o)throw new xt(o.error,`failed to get token accounts owned by account ${e.toBase58()}`);return o.result}async getLargestAccounts(e){const t={...e,commitment:e&&e.commitment||this.commitment},r=t.filter||t.commitment?[t]:[],n=await this._rpcRequest("getLargestAccounts",r),i=(0,Me.vt)(n,Dr);if("error"in i)throw new xt(i.error,"failed to get largest accounts");return i.result}async getTokenLargestAccounts(e,t){const r=this._buildArgs([e.toBase58()],t),n=await this._rpcRequest("getTokenLargestAccounts",r),i=(0,Me.vt)(n,Ur);if("error"in i)throw new xt(i.error,"failed to get token largest accounts");return i.result}async getAccountInfoAndContext(e,t){const{commitment:r,config:n}=rr(t),i=this._buildArgs([e.toBase58()],r,"base64",n),s=await this._rpcRequest("getAccountInfo",i),o=(0,Me.vt)(s,ar((0,Me.me)(Wr)));if("error"in o)throw new xt(o.error,`failed to get info about account ${e.toBase58()}`);return o.result}async getParsedAccountInfo(e,t){const{commitment:r,config:n}=rr(t),i=this._buildArgs([e.toBase58()],r,"jsonParsed",n),s=await this._rpcRequest("getAccountInfo",i),o=(0,Me.vt)(s,ar((0,Me.me)(zr)));if("error"in o)throw new xt(o.error,`failed to get info about account ${e.toBase58()}`);return o.result}async getAccountInfo(e,t){try{return(await this.getAccountInfoAndContext(e,t)).value}catch(t){throw new Error("failed to get info about account "+e.toBase58()+": "+t)}}async getMultipleParsedAccounts(e,t){const{commitment:r,config:n}=rr(t),i=e.map(e=>e.toBase58()),s=this._buildArgs([i],r,"jsonParsed",n),o=await this._rpcRequest("getMultipleAccounts",s),a=(0,Me.vt)(o,ar((0,Me.YO)((0,Me.me)(zr))));if("error"in a)throw new xt(a.error,`failed to get info for accounts ${i}`);return a.result}async getMultipleAccountsInfoAndContext(e,t){const{commitment:r,config:n}=rr(t),i=e.map(e=>e.toBase58()),s=this._buildArgs([i],r,"base64",n),o=await this._rpcRequest("getMultipleAccounts",s),a=(0,Me.vt)(o,ar((0,Me.YO)((0,Me.me)(Wr))));if("error"in a)throw new xt(a.error,`failed to get info for accounts ${i}`);return a.result}async getMultipleAccountsInfo(e,t){return(await this.getMultipleAccountsInfoAndContext(e,t)).value}async getStakeActivation(e,t,r){const{commitment:n,config:i}=rr(t),s=this._buildArgs([e.toBase58()],n,void 0,{...i,epoch:null!=r?r:i?.epoch}),o=await this._rpcRequest("getStakeActivation",s),a=(0,Me.vt)(o,or(Fr));if("error"in a)throw new xt(a.error,`failed to get Stake Activation ${e.toBase58()}`);return a.result}async getProgramAccounts(e,t){const{commitment:r,config:n}=rr(t),{encoding:i,...s}=n||{},o=this._buildArgs([e.toBase58()],r,i||"base64",{...s,...s.filters?{filters:nr(s.filters)}:null}),a=await this._rpcRequest("getProgramAccounts",o),c=(0,Me.YO)(jr),l=!0===s.withContext?(0,Me.vt)(a,ar(c)):(0,Me.vt)(a,or(c));if("error"in l)throw new xt(l.error,`failed to get accounts owned by program ${e.toBase58()}`);return l.result}async getParsedProgramAccounts(e,t){const{commitment:r,config:n}=rr(t),i=this._buildArgs([e.toBase58()],r,"jsonParsed",n),s=await this._rpcRequest("getProgramAccounts",i),o=(0,Me.vt)(s,or((0,Me.YO)(qr)));if("error"in o)throw new xt(o.error,`failed to get accounts owned by program ${e.toBase58()}`);return o.result}async confirmTransaction(e,t){let r,n;if("string"==typeof e)r=e;else{const t=e;if(t.abortSignal?.aborted)return Promise.reject(t.abortSignal.reason);r=t.signature}try{n=_e().decode(r)}catch(e){throw new Error("signature must be base58 encoded: "+r)}return ht(64===n.length,"signature has invalid length"),"string"==typeof e?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:t||this.commitment,signature:r}):"lastValidBlockHeight"in e?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t||this.commitment,strategy:e}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:t||this.commitment,strategy:e})}getCancellationPromise(e){return new Promise((t,r)=>{null!=e&&(e.aborted?r(e.reason):e.addEventListener("abort",()=>{r(e.reason)}))})}getTransactionConfirmationPromise({commitment:e,signature:t}){let r,n,i=!1;return{abortConfirmation:()=>{n&&(n(),n=void 0),null!=r&&(this.removeSignatureListener(r),r=void 0)},confirmationPromise:new Promise((s,o)=>{try{r=this.onSignature(t,(e,t)=>{r=void 0;const n={context:t,value:e};s({__type:bt.PROCESSED,response:n})},e);const a=new Promise(e=>{null==r?e():n=this._onSubscriptionStateChange(r,t=>{"subscribed"===t&&e()})});(async()=>{if(await a,i)return;const r=await this.getSignatureStatus(t);if(i)return;if(null==r)return;const{context:n,value:c}=r;if(null!=c)if(c?.err)o(c.err);else{switch(e){case"confirmed":case"single":case"singleGossip":if("processed"===c.confirmationStatus)return;break;case"finalized":case"max":case"root":if("processed"===c.confirmationStatus||"confirmed"===c.confirmationStatus)return}i=!0,s({__type:bt.PROCESSED,response:{context:n,value:c}})}})()}catch(e){o(e)}})}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e,strategy:{abortSignal:t,lastValidBlockHeight:r,signature:n}}){let i=!1;const s=new Promise(t=>{const n=async()=>{try{return await this.getBlockHeight(e)}catch(e){return-1}};(async()=>{let e=await n();if(!i){for(;e<=r;){if(await Ot(1e3),i)return;if(e=await n(),i)return}t({__type:bt.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:o,confirmationPromise:a}=this.getTransactionConfirmationPromise({commitment:e,signature:n}),c=this.getCancellationPromise(t);let l;try{const e=await Promise.race([c,a,s]);if(e.__type!==bt.PROCESSED)throw new tt(n);l=e.response}finally{i=!0,o()}return l}async confirmTransactionUsingDurableNonceStrategy({commitment:e,strategy:{abortSignal:t,minContextSlot:r,nonceAccountPubkey:n,nonceValue:i,signature:s}}){let o=!1;const a=new Promise(t=>{let s=i,a=null;const c=async()=>{try{const{context:t,value:i}=await this.getNonceAndContext(n,{commitment:e,minContextSlot:r});return a=t.slot,i?.nonce}catch(e){return s}};(async()=>{if(s=await c(),!o)for(;;){if(i!==s)return void t({__type:bt.NONCE_INVALID,slotInWhichNonceDidAdvance:a});if(await Ot(2e3),o)return;if(s=await c(),o)return}})()}),{abortConfirmation:c,confirmationPromise:l}=this.getTransactionConfirmationPromise({commitment:e,signature:s}),u=this.getCancellationPromise(t);let h;try{const t=await Promise.race([u,l,a]);if(t.__type===bt.PROCESSED)h=t.response;else{let n;for(;;){const e=await this.getSignatureStatus(s);if(null==e)break;if(!(e.context.slot<(t.slotInWhichNonceDidAdvance??r))){n=e;break}await Ot(400)}if(!n?.value)throw new nt(s);{const t=e||"finalized",{confirmationStatus:r}=n.value;switch(t){case"processed":case"recent":if("processed"!==r&&"confirmed"!==r&&"finalized"!==r)throw new nt(s);break;case"confirmed":case"single":case"singleGossip":if("confirmed"!==r&&"finalized"!==r)throw new nt(s);break;case"finalized":case"max":case"root":if("finalized"!==r)throw new nt(s)}h={context:n.context,value:{err:n.value.err}}}}}finally{o=!0,c()}return h}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:e,signature:t}){let r;const n=new Promise(t=>{let n=this._confirmTransactionInitialTimeout||6e4;switch(e){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":n=this._confirmTransactionInitialTimeout||3e4}r=setTimeout(()=>t({__type:bt.TIMED_OUT,timeoutMs:n}),n)}),{abortConfirmation:i,confirmationPromise:s}=this.getTransactionConfirmationPromise({commitment:e,signature:t});let o;try{const e=await Promise.race([s,n]);if(e.__type!==bt.PROCESSED)throw new rt(t,e.timeoutMs/1e3);o=e.response}finally{clearTimeout(r),i()}return o}async getClusterNodes(){const e=await this._rpcRequest("getClusterNodes",[]),t=(0,Me.vt)(e,or((0,Me.YO)(rn)));if("error"in t)throw new xt(t.error,"failed to get cluster nodes");return t.result}async getVoteAccounts(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getVoteAccounts",t),n=(0,Me.vt)(r,sn);if("error"in n)throw new xt(n.error,"failed to get vote accounts");return n.result}async getSlot(e){const{commitment:t,config:r}=rr(e),n=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getSlot",n),s=(0,Me.vt)(i,or((0,Me.ai)()));if("error"in s)throw new xt(s.error,"failed to get slot");return s.result}async getSlotLeader(e){const{commitment:t,config:r}=rr(e),n=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getSlotLeader",n),s=(0,Me.vt)(i,or((0,Me.Yj)()));if("error"in s)throw new xt(s.error,"failed to get slot leader");return s.result}async getSlotLeaders(e,t){const r=[e,t],n=await this._rpcRequest("getSlotLeaders",r),i=(0,Me.vt)(n,or((0,Me.YO)(Qt)));if("error"in i)throw new xt(i.error,"failed to get slot leaders");return i.result}async getSignatureStatus(e,t){const{context:r,value:n}=await this.getSignatureStatuses([e],t);return ht(1===n.length),{context:r,value:n[0]}}async getSignatureStatuses(e,t){const r=[e];t&&r.push(t);const n=await this._rpcRequest("getSignatureStatuses",r),i=(0,Me.vt)(n,cn);if("error"in i)throw new xt(i.error,"failed to get signature status");return i.result}async getTransactionCount(e){const{commitment:t,config:r}=rr(e),n=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getTransactionCount",n),s=(0,Me.vt)(i,or((0,Me.ai)()));if("error"in s)throw new xt(s.error,"failed to get transaction count");return s.result}async getTotalSupply(e){return(await this.getSupply({commitment:e,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getInflationGovernor",t),n=(0,Me.vt)(r,Sr);if("error"in n)throw new xt(n.error,"failed to get inflation");return n.result}async getInflationReward(e,t,r){const{commitment:n,config:i}=rr(r),s=this._buildArgs([e.map(e=>e.toBase58())],n,void 0,{...i,epoch:null!=t?t:i?.epoch}),o=await this._rpcRequest("getInflationReward",s),a=(0,Me.vt)(o,hr);if("error"in a)throw new xt(a.error,"failed to get inflation reward");return a.result}async getInflationRate(){const e=await this._rpcRequest("getInflationRate",[]),t=(0,Me.vt)(e,Cr);if("error"in t)throw new xt(t.error,"failed to get inflation rate");return t.result}async getEpochInfo(e){const{commitment:t,config:r}=rr(e),n=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getEpochInfo",n),s=(0,Me.vt)(i,Nr);if("error"in s)throw new xt(s.error,"failed to get epoch info");return s.result}async getEpochSchedule(){const e=await this._rpcRequest("getEpochSchedule",[]),t=(0,Me.vt)(e,xr);if("error"in t)throw new xt(t.error,"failed to get epoch schedule");const r=t.result;return new Vt(r.slotsPerEpoch,r.leaderScheduleSlotOffset,r.warmup,r.firstNormalEpoch,r.firstNormalSlot)}async getLeaderSchedule(){const e=await this._rpcRequest("getLeaderSchedule",[]),t=(0,Me.vt)(e,Tr);if("error"in t)throw new xt(t.error,"failed to get leader schedule");return t.result}async getMinimumBalanceForRentExemption(e,t){const r=this._buildArgs([e],t),n=await this._rpcRequest("getMinimumBalanceForRentExemption",r),i=(0,Me.vt)(n,ln);return"error"in i?(console.warn("Unable to fetch minimum balance for rent exemption"),0):i.result}async getRecentBlockhashAndContext(e){const{context:t,value:{blockhash:r}}=await this.getLatestBlockhashAndContext(e);return{context:t,value:{blockhash:r,feeCalculator:{get lamportsPerSignature(){throw new Error("The capability to fetch `lamportsPerSignature` using the `getRecentBlockhash` API is no longer offered by the network. Use the `getFeeForMessage` API to obtain the fee for a given message.")},toJSON:()=>({})}}}}async getRecentPerformanceSamples(e){const t=await this._rpcRequest("getRecentPerformanceSamples",e?[e]:[]),r=(0,Me.vt)(t,Wn);if("error"in r)throw new xt(r.error,"failed to get recent performance samples");return r.result}async getFeeCalculatorForBlockhash(e,t){const r=this._buildArgs([e],t),n=await this._rpcRequest("getFeeCalculatorForBlockhash",r),i=(0,Me.vt)(n,jn);if("error"in i)throw new xt(i.error,"failed to get fee calculator");const{context:s,value:o}=i.result;return{context:s,value:null!==o?o.feeCalculator:null}}async getFeeForMessage(e,t){const r=Ve(e.serialize()).toString("base64"),n=this._buildArgs([r],t),i=await this._rpcRequest("getFeeForMessage",n),s=(0,Me.vt)(i,ar((0,Me.me)((0,Me.ai)())));if("error"in s)throw new xt(s.error,"failed to get fee for message");if(null===s.result)throw new Error("invalid blockhash");return s.result}async getRecentPrioritizationFees(e){const t=e?.lockedWritableAccounts?.map(e=>e.toBase58()),r=t?.length?[t]:[],n=await this._rpcRequest("getRecentPrioritizationFees",r),i=(0,Me.vt)(n,kr);if("error"in i)throw new xt(i.error,"failed to get recent prioritization fees");return i.result}async getRecentBlockhash(e){try{return(await this.getRecentBlockhashAndContext(e)).value}catch(e){throw new Error("failed to get recent blockhash: "+e)}}async getLatestBlockhash(e){try{return(await this.getLatestBlockhashAndContext(e)).value}catch(e){throw new Error("failed to get recent blockhash: "+e)}}async getLatestBlockhashAndContext(e){const{commitment:t,config:r}=rr(e),n=this._buildArgs([],t,void 0,r),i=await this._rpcRequest("getLatestBlockhash",n),s=(0,Me.vt)(i,Mn);if("error"in s)throw new xt(s.error,"failed to get latest blockhash");return s.result}async isBlockhashValid(e,t){const{commitment:r,config:n}=rr(t),i=this._buildArgs([e],r,void 0,n),s=await this._rpcRequest("isBlockhashValid",i),o=(0,Me.vt)(s,Ln);if("error"in o)throw new xt(o.error,"failed to determine if the blockhash `"+e+"`is valid");return o.result}async getVersion(){const e=await this._rpcRequest("getVersion",[]),t=(0,Me.vt)(e,or(vr));if("error"in t)throw new xt(t.error,"failed to get version");return t.result}async getGenesisHash(){const e=await this._rpcRequest("getGenesisHash",[]),t=(0,Me.vt)(e,or((0,Me.Yj)()));if("error"in t)throw new xt(t.error,"failed to get genesis hash");return t.result}async getBlock(e,t){const{commitment:r,config:n}=rr(t),i=this._buildArgsAtLeastConfirmed([e],r,void 0,n),s=await this._rpcRequest("getBlock",i);try{switch(n?.transactionDetails){case"accounts":{const e=(0,Me.vt)(s,Nn);if("error"in e)throw e.error;return e.result}case"none":{const e=(0,Me.vt)(s,kn);if("error"in e)throw e.error;return e.result}default:{const e=(0,Me.vt)(s,Cn);if("error"in e)throw e.error;const{result:t}=e;return t?{...t,transactions:t.transactions.map(({transaction:e,meta:t,version:r})=>({meta:t,transaction:{...e,message:lr(r,e.message)},version:r}))}:null}}}catch(e){throw new xt(e,"failed to get confirmed block")}}async getParsedBlock(e,t){const{commitment:r,config:n}=rr(t),i=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",n),s=await this._rpcRequest("getBlock",i);try{switch(n?.transactionDetails){case"accounts":{const e=(0,Me.vt)(s,Tn);if("error"in e)throw e.error;return e.result}case"none":{const e=(0,Me.vt)(s,On);if("error"in e)throw e.error;return e.result}default:{const e=(0,Me.vt)(s,xn);if("error"in e)throw e.error;return e.result}}}catch(e){throw new xt(e,"failed to get block")}}async getBlockProduction(e){let t,r;if("string"==typeof e)r=e;else if(e){const{commitment:n,...i}=e;r=n,t=i}const n=this._buildArgs([],r,"base64",t),i=await this._rpcRequest("getBlockProduction",n),s=(0,Me.vt)(i,Ir);if("error"in s)throw new xt(s.error,"failed to get block production information");return s.result}async getTransaction(e,t){const{commitment:r,config:n}=rr(t),i=this._buildArgsAtLeastConfirmed([e],r,void 0,n),s=await this._rpcRequest("getTransaction",i),o=(0,Me.vt)(s,Un);if("error"in o)throw new xt(o.error,"failed to get transaction");const a=o.result;return a?{...a,transaction:{...a.transaction,message:lr(a.version,a.transaction.message)}}:a}async getParsedTransaction(e,t){const{commitment:r,config:n}=rr(t),i=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",n),s=await this._rpcRequest("getTransaction",i),o=(0,Me.vt)(s,Bn);if("error"in o)throw new xt(o.error,"failed to get transaction");return o.result}async getParsedTransactions(e,t){const{commitment:r,config:n}=rr(t),i=e.map(e=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",n)}));return(await this._rpcBatchRequest(i)).map(e=>{const t=(0,Me.vt)(e,Bn);if("error"in t)throw new xt(t.error,"failed to get transactions");return t.result})}async getTransactions(e,t){const{commitment:r,config:n}=rr(t),i=e.map(e=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([e],r,void 0,n)}));return(await this._rpcBatchRequest(i)).map(e=>{const t=(0,Me.vt)(e,Un);if("error"in t)throw new xt(t.error,"failed to get transactions");const r=t.result;return r?{...r,transaction:{...r.transaction,message:lr(r.version,r.transaction.message)}}:r})}async getConfirmedBlock(e,t){const r=this._buildArgsAtLeastConfirmed([e],t),n=await this._rpcRequest("getBlock",r),i=(0,Me.vt)(n,Pn);if("error"in i)throw new xt(i.error,"failed to get confirmed block");const s=i.result;if(!s)throw new Error("Confirmed block "+e+" not found");const o={...s,transactions:s.transactions.map(({transaction:e,meta:t})=>{const r=new mt(e.message);return{meta:t,transaction:{...e,message:r}}})};return{...o,transactions:o.transactions.map(({transaction:e,meta:t})=>({meta:t,transaction:At.populate(e.message,e.signatures)}))}}async getBlocks(e,t,r){const n=this._buildArgsAtLeastConfirmed(void 0!==t?[e,t]:[e],r),i=await this._rpcRequest("getBlocks",n),s=(0,Me.vt)(i,or((0,Me.YO)((0,Me.ai)())));if("error"in s)throw new xt(s.error,"failed to get blocks");return s.result}async getBlockSignatures(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),n=await this._rpcRequest("getBlock",r),i=(0,Me.vt)(n,Rn);if("error"in i)throw new xt(i.error,"failed to get block");const s=i.result;if(!s)throw new Error("Block "+e+" not found");return s}async getConfirmedBlockSignatures(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),n=await this._rpcRequest("getBlock",r),i=(0,Me.vt)(n,Rn);if("error"in i)throw new xt(i.error,"failed to get confirmed block");const s=i.result;if(!s)throw new Error("Confirmed block "+e+" not found");return s}async getConfirmedTransaction(e,t){const r=this._buildArgsAtLeastConfirmed([e],t),n=await this._rpcRequest("getTransaction",r),i=(0,Me.vt)(n,Un);if("error"in i)throw new xt(i.error,"failed to get transaction");const s=i.result;if(!s)return s;const o=new mt(s.transaction.message),a=s.transaction.signatures;return{...s,transaction:At.populate(o,a)}}async getParsedConfirmedTransaction(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,"jsonParsed"),n=await this._rpcRequest("getTransaction",r),i=(0,Me.vt)(n,Bn);if("error"in i)throw new xt(i.error,"failed to get confirmed transaction");return i.result}async getParsedConfirmedTransactions(e,t){const r=e.map(e=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([e],t,"jsonParsed")}));return(await this._rpcBatchRequest(r)).map(e=>{const t=(0,Me.vt)(e,Bn);if("error"in t)throw new xt(t.error,"failed to get confirmed transactions");return t.result})}async getConfirmedSignaturesForAddress(e,t,r){let n={},i=await this.getFirstAvailableBlock();for(;!("until"in n)&&!(--t<=0||t<i);)try{const e=await this.getConfirmedBlockSignatures(t,"finalized");e.signatures.length>0&&(n.until=e.signatures[e.signatures.length-1].toString())}catch(e){if(e instanceof Error&&e.message.includes("skipped"))continue;throw e}let s=await this.getSlot("finalized");for(;!("before"in n||++r>s);)try{const e=await this.getConfirmedBlockSignatures(r);e.signatures.length>0&&(n.before=e.signatures[e.signatures.length-1].toString())}catch(e){if(e instanceof Error&&e.message.includes("skipped"))continue;throw e}return(await this.getConfirmedSignaturesForAddress2(e,n)).map(e=>e.signature)}async getConfirmedSignaturesForAddress2(e,t,r){const n=this._buildArgsAtLeastConfirmed([e.toBase58()],r,void 0,t),i=await this._rpcRequest("getConfirmedSignaturesForAddress2",n),s=(0,Me.vt)(i,Hr);if("error"in s)throw new xt(s.error,"failed to get confirmed signatures for address");return s.result}async getSignaturesForAddress(e,t,r){const n=this._buildArgsAtLeastConfirmed([e.toBase58()],r,void 0,t),i=await this._rpcRequest("getSignaturesForAddress",n),s=(0,Me.vt)(i,Kr);if("error"in s)throw new xt(s.error,"failed to get signatures for address");return s.result}async getAddressLookupTable(e,t){const{context:r,value:n}=await this.getAccountInfoAndContext(e,t);let i=null;return null!==n&&(i=new Zt({key:e,state:Zt.deserialize(n.data)})),{context:r,value:i}}async getNonceAndContext(e,t){const{context:r,value:n}=await this.getAccountInfoAndContext(e,t);let i=null;return null!==n&&(i=Mt.fromAccountData(n.data)),{context:r,value:i}}async getNonce(e,t){return await this.getNonceAndContext(e,t).then(e=>e.value).catch(t=>{throw new Error("failed to get nonce for account "+e.toBase58()+": "+t)})}async requestAirdrop(e,t){const r=await this._rpcRequest("requestAirdrop",[e.toBase58(),t]),n=(0,Me.vt)(r,$n);if("error"in n)throw new xt(n.error,`airdrop to ${e.toBase58()} failed`);return n.result}async _blockhashWithExpiryBlockHeight(e){if(!e){for(;this._pollingBlockhash;)await Ot(100);const e=Date.now()-this._blockhashInfo.lastFetch>=3e4;if(null!==this._blockhashInfo.latestBlockhash&&!e)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const e=Date.now(),t=this._blockhashInfo.latestBlockhash,r=t?t.blockhash:null;for(let e=0;e<50;e++){const e=await this.getLatestBlockhash("finalized");if(r!==e.blockhash)return this._blockhashInfo={latestBlockhash:e,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},e;await Ot(200)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-e}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(e){const{commitment:t,config:r}=rr(e),n=this._buildArgs([],t,"base64",r),i=await this._rpcRequest("getStakeMinimumDelegation",n),s=(0,Me.vt)(i,ar((0,Me.ai)()));if("error"in s)throw new xt(s.error,"failed to get stake minimum delegation");return s.result}async simulateTransaction(e,t,r){if("message"in e){const n=e.serialize(),i=we.Buffer.from(n).toString("base64");if(Array.isArray(t)||void 0!==r)throw new Error("Invalid arguments");const s=t||{};s.encoding="base64","commitment"in s||(s.commitment=this.commitment),t&&"object"==typeof t&&"innerInstructions"in t&&(s.innerInstructions=t.innerInstructions);const o=[i,s],a=await this._rpcRequest("simulateTransaction",o),c=(0,Me.vt)(a,_r);if("error"in c)throw new Error("failed to simulate transaction: "+c.error.message);return c.result}let n;if(e instanceof At){let t=e;n=new At,n.feePayer=t.feePayer,n.instructions=e.instructions,n.nonceInfo=t.nonceInfo,n.signatures=t.signatures}else n=At.populate(e),n._message=n._json=void 0;if(void 0!==t&&!Array.isArray(t))throw new Error("Invalid arguments");const i=t;if(n.nonceInfo&&i)n.sign(...i);else{let e=this._disableBlockhashCaching;for(;;){const t=await this._blockhashWithExpiryBlockHeight(e);if(n.lastValidBlockHeight=t.lastValidBlockHeight,n.recentBlockhash=t.blockhash,!i)break;if(n.sign(...i),!n.signature)throw new Error("!signature");const r=n.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(r)&&!this._blockhashInfo.transactionSignatures.includes(r)){this._blockhashInfo.simulatedSignatures.push(r);break}e=!0}}const s=n._compile(),o=s.serialize(),a=n._serialize(o).toString("base64"),c={encoding:"base64",commitment:this.commitment};if(r){const e=(Array.isArray(r)?r:s.nonProgramIds()).map(e=>e.toBase58());c.accounts={encoding:"base64",addresses:e}}i&&(c.sigVerify=!0),t&&"object"==typeof t&&"innerInstructions"in t&&(c.innerInstructions=t.innerInstructions);const l=[a,c],u=await this._rpcRequest("simulateTransaction",l),h=(0,Me.vt)(u,_r);if("error"in h){let e;if("data"in h.error&&(e=h.error.data.logs,e&&Array.isArray(e))){const t="\n    ",r=t+e.join(t);console.error(h.error.message,r)}throw new Nt({action:"simulate",signature:"",transactionMessage:h.error.message,logs:e})}return h.result}async sendTransaction(e,t,r){if("version"in e){if(t&&Array.isArray(t))throw new Error("Invalid arguments");const r=e.serialize();return await this.sendRawTransaction(r,t)}if(void 0===t||!Array.isArray(t))throw new Error("Invalid arguments");const n=t;if(e.nonceInfo)e.sign(...n);else{let t=this._disableBlockhashCaching;for(;;){const r=await this._blockhashWithExpiryBlockHeight(t);if(e.lastValidBlockHeight=r.lastValidBlockHeight,e.recentBlockhash=r.blockhash,e.sign(...n),!e.signature)throw new Error("!signature");const i=e.signature.toString("base64");if(!this._blockhashInfo.transactionSignatures.includes(i)){this._blockhashInfo.transactionSignatures.push(i);break}t=!0}}const i=e.serialize();return await this.sendRawTransaction(i,r)}async sendRawTransaction(e,t){const r=Ve(e).toString("base64");return await this.sendEncodedTransaction(r,t)}async sendEncodedTransaction(e,t){const r={encoding:"base64"},n=t&&t.skipPreflight,i=!0===n?"processed":t&&t.preflightCommitment||this.commitment;t&&null!=t.maxRetries&&(r.maxRetries=t.maxRetries),t&&null!=t.minContextSlot&&(r.minContextSlot=t.minContextSlot),n&&(r.skipPreflight=n),i&&(r.preflightCommitment=i);const s=[e,r],o=await this._rpcRequest("sendTransaction",s),a=(0,Me.vt)(o,zn);if("error"in a){let e;throw"data"in a.error&&(e=a.error.data.logs),new Nt({action:n?"send":"simulate",signature:"",transactionMessage:a.error.message,logs:e})}return a.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}_wsOnClose(e){this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),1e3!==e?(this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([e,t])=>{this._setSubscription(e,{...t,state:"pending"})})):this._updateSubscriptions()}_setSubscription(e,t){const r=this._subscriptionsByHash[e]?.state;if(this._subscriptionsByHash[e]=t,r!==t.state){const r=this._subscriptionStateChangeCallbacksByHash[e];r&&r.forEach(e=>{try{e(t.state)}catch{}})}}_onSubscriptionStateChange(e,t){const r=this._subscriptionHashByClientSubscriptionId[e];if(null==r)return()=>{};const n=this._subscriptionStateChangeCallbacksByHash[r]||=new Set;return n.add(t),()=>{n.delete(t),0===n.size&&delete this._subscriptionStateChangeCallbacksByHash[r]}}async _updateSubscriptions(){if(0===Object.keys(this._subscriptionsByHash).length)return void(this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(e){e instanceof Error&&console.log(`Error when closing socket connection: ${e.message}`)}},500)));if(null!==this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected)return void this._rpcWebSocket.connect();const e=this._rpcWebSocketGeneration,t=()=>e===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async e=>{const r=this._subscriptionsByHash[e];if(void 0!==r)switch(r.state){case"pending":case"unsubscribed":if(0===r.callbacks.size)return delete this._subscriptionsByHash[e],"unsubscribed"===r.state&&delete this._subscriptionCallbacksByServerSubscriptionId[r.serverSubscriptionId],void await this._updateSubscriptions();await(async()=>{const{args:n,method:i}=r;try{this._setSubscription(e,{...r,state:"subscribing"});const t=await this._rpcWebSocket.call(i,n);this._setSubscription(e,{...r,serverSubscriptionId:t,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[t]=r.callbacks,await this._updateSubscriptions()}catch(s){if(console.error(`Received ${s instanceof Error?"":"JSON-RPC "}error calling \`${i}\``,{args:n,error:s}),!t())return;this._setSubscription(e,{...r,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":0===r.callbacks.size&&await(async()=>{const{serverSubscriptionId:n,unsubscribeMethod:i}=r;if(this._subscriptionsAutoDisposedByRpc.has(n))this._subscriptionsAutoDisposedByRpc.delete(n);else{this._setSubscription(e,{...r,state:"unsubscribing"}),this._setSubscription(e,{...r,state:"unsubscribing"});try{await this._rpcWebSocket.call(i,[n])}catch(n){if(n instanceof Error&&console.error(`${i} error:`,n.message),!t())return;return this._setSubscription(e,{...r,state:"subscribed"}),void await this._updateSubscriptions()}}this._setSubscription(e,{...r,state:"unsubscribed"}),await this._updateSubscriptions()})()}}))}_handleServerNotification(e,t){const r=this._subscriptionCallbacksByServerSubscriptionId[e];void 0!==r&&r.forEach(e=>{try{e(...t)}catch(e){console.error(e)}})}_wsOnAccountNotification(e){const{result:t,subscription:r}=(0,Me.vt)(e,Vr);this._handleServerNotification(r,[t.value,t.context])}_makeSubscription(e,t){const r=this._nextClientSubscriptionId++,n=Ht([e.method,t]),i=this._subscriptionsByHash[n];return void 0===i?this._subscriptionsByHash[n]={...e,args:t,callbacks:new Set([e.callback]),state:"pending"}:i.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[r]=n,this._subscriptionDisposeFunctionsByClientSubscriptionId[r]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[r],delete this._subscriptionHashByClientSubscriptionId[r];const t=this._subscriptionsByHash[n];ht(void 0!==t,`Could not find a \`Subscription\` when tearing down client subscription #${r}`),t.callbacks.delete(e.callback),await this._updateSubscriptions()},this._updateSubscriptions(),r}onAccountChange(e,t,r){const{commitment:n,config:i}=rr(r),s=this._buildArgs([e.toBase58()],n||this._commitment||"finalized","base64",i);return this._makeSubscription({callback:t,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},s)}async removeAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"account change")}_wsOnProgramAccountNotification(e){const{result:t,subscription:r}=(0,Me.vt)(e,Gr);this._handleServerNotification(r,[{accountId:t.value.pubkey,accountInfo:t.value.account},t.context])}onProgramAccountChange(e,t,r,n){const{commitment:i,config:s}=rr(r),o=this._buildArgs([e.toBase58()],i||this._commitment||"finalized","base64",s||(n?{filters:nr(n)}:void 0));return this._makeSubscription({callback:t,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},o)}async removeProgramAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"program account change")}onLogs(e,t,r){const n=this._buildArgs(["object"==typeof e?{mentions:[e.toString()]}:e],r||this._commitment||"finalized");return this._makeSubscription({callback:t,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},n)}async removeOnLogsListener(e){await this._unsubscribeClientSubscription(e,"logs")}_wsOnLogsNotification(e){const{result:t,subscription:r}=(0,Me.vt)(e,Fn);this._handleServerNotification(r,[t.value,t.context])}_wsOnSlotNotification(e){const{result:t,subscription:r}=(0,Me.vt)(e,Jr);this._handleServerNotification(r,[t])}onSlotChange(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(e){await this._unsubscribeClientSubscription(e,"slot change")}_wsOnSlotUpdatesNotification(e){const{result:t,subscription:r}=(0,Me.vt)(e,Qr);this._handleServerNotification(r,[t])}onSlotUpdate(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(e){await this._unsubscribeClientSubscription(e,"slot update")}async _unsubscribeClientSubscription(e,t){const r=this._subscriptionDisposeFunctionsByClientSubscriptionId[e];r?await r():console.warn(`Ignored unsubscribe request because an active subscription with id \`${e}\` for '${t}' events could not be found.`)}_buildArgs(e,t,r,n){const i=t||this._commitment;if(i||r||n){let t={};r&&(t.encoding=r),i&&(t.commitment=i),n&&(t=Object.assign(t,n)),e.push(t)}return e}_buildArgsAtLeastConfirmed(e,t,r,n){const i=t||this._commitment;if(i&&!["confirmed","finalized"].includes(i))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,t,r,n)}_wsOnSignatureNotification(e){const{result:t,subscription:r}=(0,Me.vt)(e,en);"receivedSignature"!==t.value&&this._subscriptionsAutoDisposedByRpc.add(r),this._handleServerNotification(r,"receivedSignature"===t.value?[{type:"received"},t.context]:[{type:"status",result:t.value},t.context])}onSignature(e,t,r){const n=this._buildArgs([e],r||this._commitment||"finalized"),i=this._makeSubscription({callback:(e,r)=>{if("status"===e.type){t(e.result,r);try{this.removeSignatureListener(i)}catch(e){}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},n);return i}onSignatureWithOptions(e,t,r){const{commitment:n,...i}={...r,commitment:r&&r.commitment||this._commitment||"finalized"},s=this._buildArgs([e],n,void 0,i),o=this._makeSubscription({callback:(e,r)=>{t(e,r);try{this.removeSignatureListener(o)}catch(e){}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},s);return o}async removeSignatureListener(e){await this._unsubscribeClientSubscription(e,"signature result")}_wsOnRootNotification(e){const{result:t,subscription:r}=(0,Me.vt)(e,tn);this._handleServerNotification(r,[t])}onRootChange(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(e){await this._unsubscribeClientSubscription(e,"root change")}}class Vn{constructor(e){this._keypair=void 0,this._keypair=e??ze()}static generate(){return new Vn(ze())}static fromSecretKey(e,t){if(64!==e.byteLength)throw new Error("bad secret key size");const r=e.slice(32,64);if(!t||!t.skipValidation){const t=e.slice(0,32),n=qe(t);for(let e=0;e<32;e++)if(r[e]!==n[e])throw new Error("provided secretKey is invalid")}return new Vn({publicKey:r,secretKey:e})}static fromSeed(e){const t=qe(e),r=new Uint8Array(64);return r.set(e),r.set(t,32),new Vn({publicKey:t,secretKey:r})}get publicKey(){return new Qe(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}Object.freeze({CreateLookupTable:{index:0,layout:Ce.w3([Ce.DH("instruction"),Lt("recentSlot"),Ce.u8("bumpSeed")])},FreezeLookupTable:{index:1,layout:Ce.w3([Ce.DH("instruction")])},ExtendLookupTable:{index:2,layout:Ce.w3([Ce.DH("instruction"),Lt(),Ce.O6(st(),Ce.cY(Ce.DH(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:Ce.w3([Ce.DH("instruction")])},CloseLookupTable:{index:4,layout:Ce.w3([Ce.DH("instruction")])}});new Qe("AddressLookupTab1e1111111111111111111111111");const Yn=Object.freeze({RequestUnits:{index:0,layout:Ce.w3([Ce.u8("instruction"),Ce.DH("units"),Ce.DH("additionalFee")])},RequestHeapFrame:{index:1,layout:Ce.w3([Ce.u8("instruction"),Ce.DH("bytes")])},SetComputeUnitLimit:{index:2,layout:Ce.w3([Ce.u8("instruction"),Ce.DH("units")])},SetComputeUnitPrice:{index:3,layout:Ce.w3([Ce.u8("instruction"),Lt("microLamports")])}});class Gn{constructor(){}static requestUnits(e){const t=Pt(Yn.RequestUnits,e);return new Et({keys:[],programId:this.programId,data:t})}static requestHeapFrame(e){const t=Pt(Yn.RequestHeapFrame,e);return new Et({keys:[],programId:this.programId,data:t})}static setComputeUnitLimit(e){const t=Pt(Yn.SetComputeUnitLimit,e);return new Et({keys:[],programId:this.programId,data:t})}static setComputeUnitPrice(e){const t=Pt(Yn.SetComputeUnitPrice,{microLamports:BigInt(e.microLamports)});return new Et({keys:[],programId:this.programId,data:t})}}Gn.programId=new Qe("ComputeBudget111111111111111111111111111111");const Zn=Ce.w3([Ce.u8("numSignatures"),Ce.u8("padding"),Ce.NX("signatureOffset"),Ce.NX("signatureInstructionIndex"),Ce.NX("publicKeyOffset"),Ce.NX("publicKeyInstructionIndex"),Ce.NX("messageDataOffset"),Ce.NX("messageDataSize"),Ce.NX("messageInstructionIndex")]);class Jn{constructor(){}static createInstructionWithPublicKey(e){const{publicKey:t,message:r,signature:n,instructionIndex:i}=e;ht(32===t.length,`Public Key must be 32 bytes but received ${t.length} bytes`),ht(64===n.length,`Signature must be 64 bytes but received ${n.length} bytes`);const s=Zn.span,o=s+t.length,a=o+n.length,c=we.Buffer.alloc(a+r.length),l=null==i?65535:i;return Zn.encode({numSignatures:1,padding:0,signatureOffset:o,signatureInstructionIndex:l,publicKeyOffset:s,publicKeyInstructionIndex:l,messageDataOffset:a,messageDataSize:r.length,messageInstructionIndex:l},c),c.fill(t,s),c.fill(n,o),c.fill(r,a),new Et({keys:[],programId:Jn.programId,data:c})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:r,instructionIndex:n}=e;ht(64===t.length,`Private key must be 64 bytes but received ${t.length} bytes`);try{const e=Vn.fromSecretKey(t),i=e.publicKey.toBytes(),s=He(r,e.secretKey);return this.createInstructionWithPublicKey({publicKey:i,message:r,signature:s,instructionIndex:n})}catch(e){throw new Error(`Error creating instruction; ${e}`)}}}Jn.programId=new Qe("Ed25519SigVerify111111111111111111111111111"),$e.bI.utils.isValidPrivateKey;const Xn=$e.bI.getPublicKey,Qn=Ce.w3([Ce.u8("numSignatures"),Ce.NX("signatureOffset"),Ce.u8("signatureInstructionIndex"),Ce.NX("ethAddressOffset"),Ce.u8("ethAddressInstructionIndex"),Ce.NX("messageDataOffset"),Ce.NX("messageDataSize"),Ce.u8("messageInstructionIndex"),Ce.av(20,"ethAddress"),Ce.av(64,"signature"),Ce.u8("recoveryId")]);class ei{constructor(){}static publicKeyToEthAddress(e){ht(64===e.length,`Public key must be 64 bytes but received ${e.length} bytes`);try{return we.Buffer.from((0,je.lY)(Ve(e))).slice(-20)}catch(e){throw new Error(`Error constructing Ethereum address: ${e}`)}}static createInstructionWithPublicKey(e){const{publicKey:t,message:r,signature:n,recoveryId:i,instructionIndex:s}=e;return ei.createInstructionWithEthAddress({ethAddress:ei.publicKeyToEthAddress(t),message:r,signature:n,recoveryId:i,instructionIndex:s})}static createInstructionWithEthAddress(e){const{ethAddress:t,message:r,signature:n,recoveryId:i,instructionIndex:s=0}=e;let o;o="string"==typeof t?t.startsWith("0x")?we.Buffer.from(t.substr(2),"hex"):we.Buffer.from(t,"hex"):t,ht(20===o.length,`Address must be 20 bytes but received ${o.length} bytes`);const a=12+o.length,c=a+n.length+1,l=we.Buffer.alloc(Qn.span+r.length);return Qn.encode({numSignatures:1,signatureOffset:a,signatureInstructionIndex:s,ethAddressOffset:12,ethAddressInstructionIndex:s,messageDataOffset:c,messageDataSize:r.length,messageInstructionIndex:s,signature:Ve(n),ethAddress:Ve(o),recoveryId:i},l),l.fill(Ve(r),Qn.span),new Et({keys:[],programId:ei.programId,data:l})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:r,instructionIndex:n}=e;ht(32===t.length,`Private key must be 32 bytes but received ${t.length} bytes`);try{const e=Ve(t),i=Xn(e,!1).slice(1),s=we.Buffer.from((0,je.lY)(Ve(r))),[o,a]=((e,t)=>{const r=$e.bI.sign(e,t);return[r.toCompactRawBytes(),r.recovery]})(s,e);return this.createInstructionWithPublicKey({publicKey:i,message:r,signature:o,recoveryId:a,instructionIndex:n})}catch(e){throw new Error(`Error creating instruction; ${e}`)}}}var ti;ei.programId=new Qe("KeccakSecp256k11111111111111111111111111111");const ri=new Qe("StakeConfig11111111111111111111111111111111");class ni{constructor(e,t,r){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=r}}ti=ni,ni.default=new ti(0,0,Qe.default);const ii=Object.freeze({Initialize:{index:0,layout:Ce.w3([Ce.DH("instruction"),((e="authorized")=>Ce.w3([st("staker"),st("withdrawer")],e))(),((e="lockup")=>Ce.w3([Ce.Wg("unixTimestamp"),Ce.Wg("epoch"),st("custodian")],e))()])},Authorize:{index:1,layout:Ce.w3([Ce.DH("instruction"),st("newAuthorized"),Ce.DH("stakeAuthorizationType")])},Delegate:{index:2,layout:Ce.w3([Ce.DH("instruction")])},Split:{index:3,layout:Ce.w3([Ce.DH("instruction"),Ce.Wg("lamports")])},Withdraw:{index:4,layout:Ce.w3([Ce.DH("instruction"),Ce.Wg("lamports")])},Deactivate:{index:5,layout:Ce.w3([Ce.DH("instruction")])},Merge:{index:7,layout:Ce.w3([Ce.DH("instruction")])},AuthorizeWithSeed:{index:8,layout:Ce.w3([Ce.DH("instruction"),st("newAuthorized"),Ce.DH("stakeAuthorizationType"),at("authoritySeed"),st("authorityOwner")])}});Object.freeze({Staker:{index:0},Withdrawer:{index:1}});class si{constructor(){}static initialize(e){const{stakePubkey:t,authorized:r,lockup:n}=e,i=n||ni.default,s=Pt(ii.Initialize,{authorized:{staker:Ve(r.staker.toBuffer()),withdrawer:Ve(r.withdrawer.toBuffer())},lockup:{unixTimestamp:i.unixTimestamp,epoch:i.epoch,custodian:Ve(i.custodian.toBuffer())}}),o={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Ct,isSigner:!1,isWritable:!1}],programId:this.programId,data:s};return new Et(o)}static createAccountWithSeed(e){const t=new At;t.add(Wt.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:r,authorized:n,lockup:i}=e;return t.add(this.initialize({stakePubkey:r,authorized:n,lockup:i}))}static createAccount(e){const t=new At;t.add(Wt.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:r,authorized:n,lockup:i}=e;return t.add(this.initialize({stakePubkey:r,authorized:n,lockup:i}))}static delegate(e){const{stakePubkey:t,authorizedPubkey:r,votePubkey:n}=e,i=Pt(ii.Delegate);return(new At).add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:It,isSigner:!1,isWritable:!1},{pubkey:kt,isSigner:!1,isWritable:!1},{pubkey:ri,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:i})}static authorize(e){const{stakePubkey:t,authorizedPubkey:r,newAuthorizedPubkey:n,stakeAuthorizationType:i,custodianPubkey:s}=e,o=Pt(ii.Authorize,{newAuthorized:Ve(n.toBuffer()),stakeAuthorizationType:i.index}),a=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:It,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}];return s&&a.push({pubkey:s,isSigner:!0,isWritable:!1}),(new At).add({keys:a,programId:this.programId,data:o})}static authorizeWithSeed(e){const{stakePubkey:t,authorityBase:r,authoritySeed:n,authorityOwner:i,newAuthorizedPubkey:s,stakeAuthorizationType:o,custodianPubkey:a}=e,c=Pt(ii.AuthorizeWithSeed,{newAuthorized:Ve(s.toBuffer()),stakeAuthorizationType:o.index,authoritySeed:n,authorityOwner:Ve(i.toBuffer())}),l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1},{pubkey:It,isSigner:!1,isWritable:!1}];return a&&l.push({pubkey:a,isSigner:!0,isWritable:!1}),(new At).add({keys:l,programId:this.programId,data:c})}static splitInstruction(e){const{stakePubkey:t,authorizedPubkey:r,splitStakePubkey:n,lamports:i}=e,s=Pt(ii.Split,{lamports:i});return new Et({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:s})}static split(e,t){const r=new At;return r.add(Wt.createAccount({fromPubkey:e.authorizedPubkey,newAccountPubkey:e.splitStakePubkey,lamports:t,space:this.space,programId:this.programId})),r.add(this.splitInstruction(e))}static splitWithSeed(e,t){const{stakePubkey:r,authorizedPubkey:n,splitStakePubkey:i,basePubkey:s,seed:o,lamports:a}=e,c=new At;return c.add(Wt.allocate({accountPubkey:i,basePubkey:s,seed:o,space:this.space,programId:this.programId})),t&&t>0&&c.add(Wt.transfer({fromPubkey:e.authorizedPubkey,toPubkey:i,lamports:t})),c.add(this.splitInstruction({stakePubkey:r,authorizedPubkey:n,splitStakePubkey:i,lamports:a}))}static merge(e){const{stakePubkey:t,sourceStakePubKey:r,authorizedPubkey:n}=e,i=Pt(ii.Merge);return(new At).add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:It,isSigner:!1,isWritable:!1},{pubkey:kt,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:i})}static withdraw(e){const{stakePubkey:t,authorizedPubkey:r,toPubkey:n,lamports:i,custodianPubkey:s}=e,o=Pt(ii.Withdraw,{lamports:i}),a=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:It,isSigner:!1,isWritable:!1},{pubkey:kt,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return s&&a.push({pubkey:s,isSigner:!0,isWritable:!1}),(new At).add({keys:a,programId:this.programId,data:o})}static deactivate(e){const{stakePubkey:t,authorizedPubkey:r}=e,n=Pt(ii.Deactivate);return(new At).add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:It,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}}si.programId=new Qe("Stake11111111111111111111111111111111111111"),si.space=200;const oi=Object.freeze({InitializeAccount:{index:0,layout:Ce.w3([Ce.DH("instruction"),((e="voteInit")=>Ce.w3([st("nodePubkey"),st("authorizedVoter"),st("authorizedWithdrawer"),Ce.u8("commission")],e))()])},Authorize:{index:1,layout:Ce.w3([Ce.DH("instruction"),st("newAuthorized"),Ce.DH("voteAuthorizationType")])},Withdraw:{index:3,layout:Ce.w3([Ce.DH("instruction"),Ce.Wg("lamports")])},UpdateValidatorIdentity:{index:4,layout:Ce.w3([Ce.DH("instruction")])},AuthorizeWithSeed:{index:10,layout:Ce.w3([Ce.DH("instruction"),((e="voteAuthorizeWithSeedArgs")=>Ce.w3([Ce.DH("voteAuthorizationType"),st("currentAuthorityDerivedKeyOwnerPubkey"),at("currentAuthorityDerivedKeySeed"),st("newAuthorized")],e))()])}});Object.freeze({Voter:{index:0},Withdrawer:{index:1}});class ai{constructor(){}static initializeAccount(e){const{votePubkey:t,nodePubkey:r,voteInit:n}=e,i=Pt(oi.InitializeAccount,{voteInit:{nodePubkey:Ve(n.nodePubkey.toBuffer()),authorizedVoter:Ve(n.authorizedVoter.toBuffer()),authorizedWithdrawer:Ve(n.authorizedWithdrawer.toBuffer()),commission:n.commission}}),s={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Ct,isSigner:!1,isWritable:!1},{pubkey:It,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:i};return new Et(s)}static createAccount(e){const t=new At;return t.add(Wt.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.votePubkey,lamports:e.lamports,space:this.space,programId:this.programId})),t.add(this.initializeAccount({votePubkey:e.votePubkey,nodePubkey:e.voteInit.nodePubkey,voteInit:e.voteInit}))}static authorize(e){const{votePubkey:t,authorizedPubkey:r,newAuthorizedPubkey:n,voteAuthorizationType:i}=e,s=Pt(oi.Authorize,{newAuthorized:Ve(n.toBuffer()),voteAuthorizationType:i.index}),o=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:It,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return(new At).add({keys:o,programId:this.programId,data:s})}static authorizeWithSeed(e){const{currentAuthorityDerivedKeyBasePubkey:t,currentAuthorityDerivedKeyOwnerPubkey:r,currentAuthorityDerivedKeySeed:n,newAuthorizedPubkey:i,voteAuthorizationType:s,votePubkey:o}=e,a=Pt(oi.AuthorizeWithSeed,{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:Ve(r.toBuffer()),currentAuthorityDerivedKeySeed:n,newAuthorized:Ve(i.toBuffer()),voteAuthorizationType:s.index}}),c=[{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:It,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!0,isWritable:!1}];return(new At).add({keys:c,programId:this.programId,data:a})}static withdraw(e){const{votePubkey:t,authorizedWithdrawerPubkey:r,lamports:n,toPubkey:i}=e,s=Pt(oi.Withdraw,{lamports:n}),o=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}];return(new At).add({keys:o,programId:this.programId,data:s})}static safeWithdraw(e,t,r){if(e.lamports>t-r)throw new Error("Withdraw will leave vote account with insufficient funds.");return ai.withdraw(e)}static updateValidatorIdentity(e){const{votePubkey:t,authorizedWithdrawerPubkey:r,nodePubkey:n}=e,i=Pt(oi.UpdateValidatorIdentity),s=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return(new At).add({keys:s,programId:this.programId,data:i})}}ai.programId=new Qe("Vote111111111111111111111111111111111111111"),ai.space=3762,new Qe("Va1idator1nfo111111111111111111111111111111"),(0,Me.NW)({name:(0,Me.Yj)(),website:(0,Me.lq)((0,Me.Yj)()),details:(0,Me.lq)((0,Me.Yj)()),iconUrl:(0,Me.lq)((0,Me.Yj)()),keybaseUsername:(0,Me.lq)((0,Me.Yj)())}),new Qe("Vote111111111111111111111111111111111111111"),Ce.w3([st("nodePubkey"),st("authorizedWithdrawer"),Ce.u8("commission"),Ce.I0(),Ce.O6(Ce.w3([Ce.I0("slot"),Ce.DH("confirmationCount")]),Ce.cY(Ce.DH(),-8),"votes"),Ce.u8("rootSlotValid"),Ce.I0("rootSlot"),Ce.I0(),Ce.O6(Ce.w3([Ce.I0("epoch"),st("authorizedVoter")]),Ce.cY(Ce.DH(),-8),"authorizedVoters"),Ce.w3([Ce.O6(Ce.w3([st("authorizedPubkey"),Ce.I0("epochOfLastAuthorizedSwitch"),Ce.I0("targetEpoch")]),32,"buf"),Ce.I0("idx"),Ce.u8("isEmpty")],"priorVoters"),Ce.I0(),Ce.O6(Ce.w3([Ce.I0("epoch"),Ce.I0("credits"),Ce.I0("prevCredits")]),Ce.cY(Ce.DH(),-8),"epochCredits"),Ce.w3([Ce.I0("slot"),Ce.I0("timestamp")],"lastTimestamp")]);var ci=i(9477);function li(e){return"version"in e}function ui(e){if("string"==typeof e)return`solana:${e}`}class hi{constructor(){this.listeners={accountsChanged:[],chainChanged:[],connect:[],disconnect:[],pendingTransaction:[],auth_rpcRequest:[],auth_rpcSuccess:[],auth_rpcError:[]}}on(e,t){this.listeners[e].push(t)}removeListener(e,t){this.listeners[e]=this.listeners[e].filter(e=>e!==t)}emit(e,t){this.listeners[e].forEach(e=>e(t))}}class di extends hi{constructor(e){super(),this.id=o.o.CONNECTOR_ID.AUTH,this.name=o.o.CONNECTOR_NAMES.AUTH,this.type="AUTH",this.chain=o.o.CHAIN.SOLANA,this.provider=e.w3mFrameProvider,this.requestedChains=e.chains,this.getActiveChain=e.getActiveChain}get publicKey(){const e=m.W.state.chains.get(o.o.CHAIN.SOLANA)?.accountState?.address;return e?new Qe(e):void 0}get chains(){const e=this.provider.getAvailableChainIds();return this.requestedChains.filter(t=>e.includes(t.caipNetworkId))}async connect(e={}){const t=e.chainId||this.getActiveChain()?.id,r=(0,l.lj)("solana");if(await c.U.authConnectorAuthenticate({authConnector:this.provider,chainId:ui(t),socialUri:e.socialUri,preferredAccountType:r,chainNamespace:o.o.CHAIN.SOLANA}),!this.publicKey)throw new Error("Failed to connect to the wallet");return this.emit("connect",this.publicKey),this.publicKey.toBase58()}async disconnect(){await this.provider.disconnect(),this.emit("disconnect",void 0)}async signMessage(e){if(!this.publicKey)throw new Error("Wallet not connected");const t=await this.provider.request({method:"solana_signMessage",params:{message:Y.A.encode(e),pubkey:this.publicKey.toBase58()},chainNamespace:this.chain});return Y.A.decode(t.signature)}async signTransaction(e){const t=await this.provider.request({method:"solana_signTransaction",params:{transaction:this.serializeTransaction(e)},chainNamespace:this.chain}),r=Y.A.decode(t.transaction);return li(e)?_t.deserialize(r):At.from(r)}async signAndSendTransaction(e,t){const r=this.serializeTransaction(e);return(await this.provider.request({method:"solana_signAndSendTransaction",params:{transaction:r,options:t},chainNamespace:this.chain})).signature}async sendTransaction(e,t,r){const n=await this.signTransaction(e);return await t.sendRawTransaction(n.serialize(),r)}async signAllTransactions(e){return(await this.provider.request({method:"solana_signAllTransactions",params:{transactions:e.map(e=>this.serializeTransaction(e))},chainNamespace:this.chain})).transactions.map((t,r)=>{const n=e[r];if(!n)throw new Error("Invalid solana_signAllTransactions response");const i=Y.A.decode(t);return li(n)?_t.deserialize(i):At.from(i)})}async request(e){return this.provider.request({method:e.method,params:e.params,chainNamespace:this.chain})}async getAccounts(){return this.publicKey?Promise.resolve([{namespace:this.chain,address:this.publicKey.toBase58(),type:"eoa"}]):Promise.resolve([])}serializeTransaction(e){return Y.A.encode(new Uint8Array(e.serialize({verifySignatures:!1})))}}class pi extends hi{constructor(e){super(),this.name="Coinbase Wallet",this.id=Z.L.ConnectorExplorerIds[o.o.CONNECTOR_ID.COINBASE_SDK]||this.name,this.explorerId=Z.L.ConnectorExplorerIds[o.o.CONNECTOR_ID.COINBASE_SDK],this.type="ANNOUNCED",this.imageUrl="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAyNCIgaGVpZ2h0PSIxMDI0IiB2aWV3Qm94PSIwIDAgMTAyNCAxMDI0IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8Y2lyY2xlIGN4PSI1MTIiIGN5PSI1MTIiIHI9IjUxMiIgZmlsbD0iIzAwNTJGRiIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE1MiA1MTJDMTUyIDcxMC44MjMgMzEzLjE3NyA4NzIgNTEyIDg3MkM3MTAuODIzIDg3MiA4NzIgNzEwLjgyMyA4NzIgNTEyQzg3MiAzMTMuMTc3IDcxMC44MjMgMTUyIDUxMiAxNTJDMzEzLjE3NyAxNTIgMTUyIDMxMy4xNzcgMTUyIDUxMlpNNDIwIDM5NkM0MDYuNzQ1IDM5NiAzOTYgNDA2Ljc0NSAzOTYgNDIwVjYwNEMzOTYgNjE3LjI1NSA0MDYuNzQ1IDYyOCA0MjAgNjI4SDYwNEM2MTcuMjU1IDYyOCA2MjggNjE3LjI1NSA2MjggNjA0VjQyMEM2MjggNDA2Ljc0NSA2MTcuMjU1IDM5NiA2MDQgMzk2SDQyMFoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=",this.chain=o.o.CHAIN.SOLANA,this.provider=this,this.coinbase=e.provider,this.requestedChains=e.chains}get chains(){return this.requestedChains.filter(e=>e.id===te.id)}get publicKey(){return this.coinbase.publicKey}get imageId(){return Z.L.ConnectorImageIds[o.o.CONNECTOR_ID.COINBASE]}async connect(){try{await this.coinbase.connect();const e=this.getAccount(!0);return this.coinbase.emit("connect",this.coinbase.publicKey),this.emit("connect",e),e.toBase58()}catch(e){throw this.coinbase.emit("error",e),e}}async disconnect(){await this.coinbase.disconnect(),this.coinbase.emit("disconnect",void 0),this.emit("disconnect",void 0)}async signMessage(e){return(await this.coinbase.signMessage(e)).signature}async signTransaction(e){return this.coinbase.signTransaction(e)}async signAndSendTransaction(e,t){return(await this.coinbase.signAndSendTransaction(e,t)).signature}async sendTransaction(e,t,r){const n=await this.signTransaction(e);return await t.sendRawTransaction(n.serialize(),r)}async signAllTransactions(e){return await this.coinbase.signAllTransactions(e)}async request(e){return Promise.reject(new Error('The "request" method is not supported on Coinbase Wallet'))}async getAccounts(){const e=this.getAccount();return e?Promise.resolve([{namespace:this.chain,address:e.toBase58(),type:"eoa"}]):Promise.resolve([])}getAccount(e){const t=this.coinbase.publicKey;if(e&&!t)throw new Error("Not connected");return t}}var fi=i(3337);class gi extends Error{constructor(e){super(`The wallet does not support the "${e}" feature`)}}class mi extends Error{constructor(e){super(`The method "${e}" is not supported by the wallet`)}}var yi,wi=i(8287).Buffer;class bi extends ce{constructor({provider:e,chains:t,getActiveChain:r}){super({caipNetworks:t,namespace:"solana",provider:e}),this.eventEmitter=new hi,this.emit=this.eventEmitter.emit.bind(this.eventEmitter),this.on=this.eventEmitter.on.bind(this.eventEmitter),this.removeListener=this.eventEmitter.removeListener.bind(this.eventEmitter),yi.set(this,"1.0.0"),this.getActiveChain=r}get session(){return this.provider.session}get chains(){return this.sessionChains.map(e=>{let t=e;return t===ci.w.CHAIN_IDS.Deprecated_Mainnet?t=ci.w.CHAIN_IDS.Mainnet:t===ci.w.CHAIN_IDS.Deprecated_Devnet&&(t=ci.w.CHAIN_IDS.Devnet),this.caipNetworks.find(e=>e.caipNetworkId===t)}).filter(Boolean)}get icon(){return fi.j.state.connectorImages[this.id]}get version(){return function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}(this,yi,"f")}get publicKey(){const e=this.getAccount(!1);if(e)return new Qe(e.publicKey)}async connect(){await super.connectWalletConnect();const e=this.getAccount(!0);return this.emit("connect",new Qe(e.publicKey)),e.address}async disconnect(){await super.disconnect(),this.emit("disconnect",void 0)}async signMessage(e){this.checkIfMethodIsSupported("solana_signMessage");const t=await this.internalRequest("solana_signMessage",{message:Y.A.encode(e),pubkey:this.getAccount(!0).address});return Y.A.decode(t.signature)}async signTransaction(e){this.checkIfMethodIsSupported("solana_signTransaction");const t=this.serializeTransaction(e),r=await this.internalRequest("solana_signTransaction",{transaction:t,pubkey:this.getAccount(!0).address,...this.getRawRPCParams(e)});if("signature"in r){const t=Y.A.decode(r.signature);return e.addSignature(new Qe(this.getAccount(!0).publicKey),wi.from(t)),e}const n=wi.from(r.transaction,"base64");return li(e)?_t.deserialize(new Uint8Array(n)):At.from(n)}async signAndSendTransaction(e,t){this.checkIfMethodIsSupported("solana_signAndSendTransaction");const r=this.serializeTransaction(e),n=await this.internalRequest("solana_signAndSendTransaction",{transaction:r,pubkey:this.getAccount(!0).address,sendOptions:t});return this.emit("pendingTransaction",void 0),n.signature}async sendTransaction(e,t,r){const n=await this.signTransaction(e),i=await t.sendRawTransaction(n.serialize(),r);return this.emit("pendingTransaction",void 0),i}async signAllTransactions(e){try{return this.checkIfMethodIsSupported("solana_signAllTransactions"),(await this.internalRequest("solana_signAllTransactions",{transactions:e.map(e=>this.serializeTransaction(e))})).transactions.map((t,r)=>{const n=e[r];if(!n)throw new Error("Invalid transactions response");const i=wi.from(t,"base64");return li(n)?_t.deserialize(new Uint8Array(i)):(this.emit("pendingTransaction",void 0),At.from(i))})}catch(t){if(t instanceof mi){const t=[];for(const r of e)t.push(await this.signTransaction(r));return t}throw t}}request(e){return this.internalRequest(e.method,e.params)}async getAccounts(){const e=this.session?.namespaces.solana?.accounts||[];return Promise.resolve(e.map(e=>({namespace:this.chain,address:O.C.parseCaipAddress(e).address,type:"eoa"})))}internalRequest(e,t){const r=this.chains.find(e=>this.getActiveChain()?.id===e.id);let n=r?.caipNetworkId;switch(n){case ci.w.CHAIN_IDS.Mainnet:this.sessionChains.includes(ci.w.CHAIN_IDS.Mainnet)||(n=ci.w.CHAIN_IDS.Deprecated_Mainnet);break;case ci.w.CHAIN_IDS.Devnet:this.sessionChains.includes(ci.w.CHAIN_IDS.Devnet)||(n=ci.w.CHAIN_IDS.Deprecated_Devnet)}return this.provider?.request({method:e,params:t},n)}get sessionChains(){return se.getChainsFromNamespaces(this.session?.namespaces)}serializeTransaction(e){return wi.from(new Uint8Array(e.serialize({verifySignatures:!1}))).toString("base64")}getAccount(e){const t=this.session?.namespaces.solana?.accounts[0];if(!t){if(e)throw new Error("Account not found");return}const r=t.split(":")[2];if(r)return{address:r,publicKey:Y.A.decode(r)};if(e)throw new Error("Address not found")}getRawRPCParams(e){return li(e)?{}:{feePayer:e.feePayer?.toBase58()??"",instructions:e.instructions.map(e=>({data:Y.A.encode(new Uint8Array(e.data)),keys:e.keys.map(e=>({isWritable:e.isWritable,isSigner:e.isSigner,pubkey:e.pubkey.toBase58()})),programId:e.programId.toBase58()})),recentBlockhash:e.recentBlockhash??""}}checkIfMethodIsSupported(e){if(!this.session?.namespaces.solana?.methods.includes(e))throw new mi(e)}}yi=new WeakMap;var vi=i(8126),Ei=i(4707);const Ai=(0,vi.BX)({connection:null}),_i={state:Ai,subscribeKey:(e,t)=>(0,Ei.u$)(Ai,e,t),subscribe:e=>(0,vi.B1)(Ai,()=>e(Ai)),setConnection(e){Ai.connection=(0,vi.KR)(e)}};var Ii=i(7803);const Si=e=>({decode:e.decode.bind(e),encode:e.encode.bind(e)});var Ci=i(8287).Buffer;const ki=e=>t=>{const r=(0,Ce.av)(e,t),{encode:n,decode:i}=Si(r),s=r;return s.decode=(e,t)=>{const r=i(e,t);return(0,Ii.k5)(Ci.from(r))},s.encode=(t,r,i)=>{const s=(0,Ii.Bq)(t,e);return n(s,r,i)},s},Ni=e=>t=>{const r=(0,Ce.av)(e,t),{encode:n,decode:i}=Si(r),s=r;return s.decode=(e,t)=>{const r=i(e,t);return(0,Ii.cI)(Ci.from(r))},s.encode=(t,r,i)=>{const s=(0,Ii.zy)(t,e);return n(s,r,i)},s},xi=ki(8);Ni(8),ki(16),Ni(16),ki(24),Ni(24),ki(32),Ni(32);var Ti=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Oi=Math.ceil,Pi=Math.floor,Ri="[BigNumber Error] ",Ui=Ri+"Number primitive has more than 15 significant digits: ",Bi=1e14,Mi=14,Li=9007199254740991,Di=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Wi=1e7,ji=1e9;function $i(e){var t=0|e;return e>0||e===t?t:t-1}function zi(e){for(var t,r,n=1,i=e.length,s=e[0]+"";n<i;){for(t=e[n++]+"",r=Mi-t.length;r--;t="0"+t);s+=t}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function qi(e,t){var r,n,i=e.c,s=t.c,o=e.s,a=t.s,c=e.e,l=t.e;if(!o||!a)return null;if(r=i&&!i[0],n=s&&!s[0],r||n)return r?n?0:-a:o;if(o!=a)return o;if(r=o<0,n=c==l,!i||!s)return n?0:!i^r?1:-1;if(!n)return c>l^r?1:-1;for(a=(c=i.length)<(l=s.length)?c:l,o=0;o<a;o++)if(i[o]!=s[o])return i[o]>s[o]^r?1:-1;return c==l?0:c>l^r?1:-1}function Fi(e,t,r,n){if(e<t||e>r||e!==Pi(e))throw Error(Ri+(n||"Argument")+("number"==typeof e?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function Hi(e){var t=e.c.length-1;return $i(e.e/Mi)==t&&e.c[t]%2!=0}function Ki(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function Vi(e,t,r){var n,i;if(t<0){for(i=r+".";++t;i+=r);e=i+e}else if(++t>(n=e.length)){for(i=r,t-=n;--t;i+=r);e+=i}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}var Yi=function e(t){var r,n,i,s,o,a,c,l,u,h,d=C.prototype={constructor:C,toString:null,valueOf:null},p=new C(1),f=20,g=4,m=-7,y=21,w=-1e7,b=1e7,v=!1,E=1,A=0,_={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},I="0123456789abcdefghijklmnopqrstuvwxyz",S=!0;function C(e,t){var r,s,o,a,c,l,u,h,d=this;if(!(d instanceof C))return new C(e,t);if(null==t){if(e&&!0===e._isBigNumber)return d.s=e.s,void(!e.c||e.e>b?d.c=d.e=null:e.e<w?d.c=[d.e=0]:(d.e=e.e,d.c=e.c.slice()));if((l="number"==typeof e)&&0*e==0){if(d.s=1/e<0?(e=-e,-1):1,e===~~e){for(a=0,c=e;c>=10;c/=10,a++);return void(a>b?d.c=d.e=null:(d.e=a,d.c=[e]))}h=String(e)}else{if(!Ti.test(h=String(e)))return i(d,h,l);d.s=45==h.charCodeAt(0)?(h=h.slice(1),-1):1}(a=h.indexOf("."))>-1&&(h=h.replace(".","")),(c=h.search(/e/i))>0?(a<0&&(a=c),a+=+h.slice(c+1),h=h.substring(0,c)):a<0&&(a=h.length)}else{if(Fi(t,2,I.length,"Base"),10==t&&S)return T(d=new C(e),f+d.e+1,g);if(h=String(e),l="number"==typeof e){if(0*e!=0)return i(d,h,l,t);if(d.s=1/e<0?(h=h.slice(1),-1):1,C.DEBUG&&h.replace(/^0\.0*|\./,"").length>15)throw Error(Ui+e)}else d.s=45===h.charCodeAt(0)?(h=h.slice(1),-1):1;for(r=I.slice(0,t),a=c=0,u=h.length;c<u;c++)if(r.indexOf(s=h.charAt(c))<0){if("."==s){if(c>a){a=u;continue}}else if(!o&&(h==h.toUpperCase()&&(h=h.toLowerCase())||h==h.toLowerCase()&&(h=h.toUpperCase()))){o=!0,c=-1,a=0;continue}return i(d,String(e),l,t)}l=!1,(a=(h=n(h,t,10,d.s)).indexOf("."))>-1?h=h.replace(".",""):a=h.length}for(c=0;48===h.charCodeAt(c);c++);for(u=h.length;48===h.charCodeAt(--u););if(h=h.slice(c,++u)){if(u-=c,l&&C.DEBUG&&u>15&&(e>Li||e!==Pi(e)))throw Error(Ui+d.s*e);if((a=a-c-1)>b)d.c=d.e=null;else if(a<w)d.c=[d.e=0];else{if(d.e=a,d.c=[],c=(a+1)%Mi,a<0&&(c+=Mi),c<u){for(c&&d.c.push(+h.slice(0,c)),u-=Mi;c<u;)d.c.push(+h.slice(c,c+=Mi));c=Mi-(h=h.slice(c)).length}else c-=u;for(;c--;h+="0");d.c.push(+h)}}else d.c=[d.e=0]}function k(e,t,r,n){var i,s,o,a,c;if(null==r?r=g:Fi(r,0,8),!e.c)return e.toString();if(i=e.c[0],o=e.e,null==t)c=zi(e.c),c=1==n||2==n&&(o<=m||o>=y)?Ki(c,o):Vi(c,o,"0");else if(s=(e=T(new C(e),t,r)).e,a=(c=zi(e.c)).length,1==n||2==n&&(t<=s||s<=m)){for(;a<t;c+="0",a++);c=Ki(c,s)}else if(t-=o+(2===n&&s>o),c=Vi(c,s,"0"),s+1>a){if(--t>0)for(c+=".";t--;c+="0");}else if((t+=s-a)>0)for(s+1==a&&(c+=".");t--;c+="0");return e.s<0&&i?"-"+c:c}function N(e,t){for(var r,n,i=1,s=new C(e[0]);i<e.length;i++)(!(n=new C(e[i])).s||(r=qi(s,n))===t||0===r&&s.s===t)&&(s=n);return s}function x(e,t,r){for(var n=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,n++);return(r=n+r*Mi-1)>b?e.c=e.e=null:r<w?e.c=[e.e=0]:(e.e=r,e.c=t),e}function T(e,t,r,n){var i,s,o,a,c,l,u,h=e.c,d=Di;if(h){e:{for(i=1,a=h[0];a>=10;a/=10,i++);if((s=t-i)<0)s+=Mi,o=t,c=h[l=0],u=Pi(c/d[i-o-1]%10);else if((l=Oi((s+1)/Mi))>=h.length){if(!n)break e;for(;h.length<=l;h.push(0));c=u=0,i=1,o=(s%=Mi)-Mi+1}else{for(c=a=h[l],i=1;a>=10;a/=10,i++);u=(o=(s%=Mi)-Mi+i)<0?0:Pi(c/d[i-o-1]%10)}if(n=n||t<0||null!=h[l+1]||(o<0?c:c%d[i-o-1]),n=r<4?(u||n)&&(0==r||r==(e.s<0?3:2)):u>5||5==u&&(4==r||n||6==r&&(s>0?o>0?c/d[i-o]:0:h[l-1])%10&1||r==(e.s<0?8:7)),t<1||!h[0])return h.length=0,n?(t-=e.e+1,h[0]=d[(Mi-t%Mi)%Mi],e.e=-t||0):h[0]=e.e=0,e;if(0==s?(h.length=l,a=1,l--):(h.length=l+1,a=d[Mi-s],h[l]=o>0?Pi(c/d[i-o]%d[o])*a:0),n)for(;;){if(0==l){for(s=1,o=h[0];o>=10;o/=10,s++);for(o=h[0]+=a,a=1;o>=10;o/=10,a++);s!=a&&(e.e++,h[0]==Bi&&(h[0]=1));break}if(h[l]+=a,h[l]!=Bi)break;h[l--]=0,a=1}for(s=h.length;0===h[--s];h.pop());}e.e>b?e.c=e.e=null:e.e<w&&(e.c=[e.e=0])}return e}function O(e){var t,r=e.e;return null===r?e.toString():(t=zi(e.c),t=r<=m||r>=y?Ki(t,r):Vi(t,r,"0"),e.s<0?"-"+t:t)}return C.clone=e,C.ROUND_UP=0,C.ROUND_DOWN=1,C.ROUND_CEIL=2,C.ROUND_FLOOR=3,C.ROUND_HALF_UP=4,C.ROUND_HALF_DOWN=5,C.ROUND_HALF_EVEN=6,C.ROUND_HALF_CEIL=7,C.ROUND_HALF_FLOOR=8,C.EUCLID=9,C.config=C.set=function(e){var t,r;if(null!=e){if("object"!=typeof e)throw Error(Ri+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(Fi(r=e[t],0,ji,t),f=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(Fi(r=e[t],0,8,t),g=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(Fi(r[0],-ji,0,t),Fi(r[1],0,ji,t),m=r[0],y=r[1]):(Fi(r,-ji,ji,t),m=-(y=r<0?-r:r))),e.hasOwnProperty(t="RANGE"))if((r=e[t])&&r.pop)Fi(r[0],-ji,-1,t),Fi(r[1],1,ji,t),w=r[0],b=r[1];else{if(Fi(r,-ji,ji,t),!r)throw Error(Ri+t+" cannot be zero: "+r);w=-(b=r<0?-r:r)}if(e.hasOwnProperty(t="CRYPTO")){if((r=e[t])!==!!r)throw Error(Ri+t+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw v=!r,Error(Ri+"crypto unavailable");v=r}else v=r}if(e.hasOwnProperty(t="MODULO_MODE")&&(Fi(r=e[t],0,9,t),E=r),e.hasOwnProperty(t="POW_PRECISION")&&(Fi(r=e[t],0,ji,t),A=r),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(r=e[t]))throw Error(Ri+t+" not an object: "+r);_=r}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(Ri+t+" invalid: "+r);S="0123456789"==r.slice(0,10),I=r}}return{DECIMAL_PLACES:f,ROUNDING_MODE:g,EXPONENTIAL_AT:[m,y],RANGE:[w,b],CRYPTO:v,MODULO_MODE:E,POW_PRECISION:A,FORMAT:_,ALPHABET:I}},C.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!C.DEBUG)return!0;var t,r,n=e.c,i=e.e,s=e.s;e:if("[object Array]"=={}.toString.call(n)){if((1===s||-1===s)&&i>=-ji&&i<=ji&&i===Pi(i)){if(0===n[0]){if(0===i&&1===n.length)return!0;break e}if((t=(i+1)%Mi)<1&&(t+=Mi),String(n[0]).length==t){for(t=0;t<n.length;t++)if((r=n[t])<0||r>=Bi||r!==Pi(r))break e;if(0!==r)return!0}}}else if(null===n&&null===i&&(null===s||1===s||-1===s))return!0;throw Error(Ri+"Invalid BigNumber: "+e)},C.maximum=C.max=function(){return N(arguments,-1)},C.minimum=C.min=function(){return N(arguments,1)},C.random=(s=9007199254740992,o=Math.random()*s&2097151?function(){return Pi(Math.random()*s)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,r,n,i,s,a=0,c=[],l=new C(p);if(null==e?e=f:Fi(e,0,ji),i=Oi(e/Mi),v)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(i*=2));a<i;)(s=131072*t[a]+(t[a+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),t[a]=r[0],t[a+1]=r[1]):(c.push(s%1e14),a+=2);a=i/2}else{if(!crypto.randomBytes)throw v=!1,Error(Ri+"crypto unavailable");for(t=crypto.randomBytes(i*=7);a<i;)(s=281474976710656*(31&t[a])+1099511627776*t[a+1]+4294967296*t[a+2]+16777216*t[a+3]+(t[a+4]<<16)+(t[a+5]<<8)+t[a+6])>=9e15?crypto.randomBytes(7).copy(t,a):(c.push(s%1e14),a+=7);a=i/7}if(!v)for(;a<i;)(s=o())<9e15&&(c[a++]=s%1e14);for(i=c[--a],e%=Mi,i&&e&&(s=Di[Mi-e],c[a]=Pi(i/s)*s);0===c[a];c.pop(),a--);if(a<0)c=[n=0];else{for(n=-1;0===c[0];c.splice(0,1),n-=Mi);for(a=1,s=c[0];s>=10;s/=10,a++);a<Mi&&(n-=Mi-a)}return l.e=n,l.c=c,l}),C.sum=function(){for(var e=1,t=arguments,r=new C(t[0]);e<t.length;)r=r.plus(t[e++]);return r},n=function(){var e="0123456789";function t(e,t,r,n){for(var i,s,o=[0],a=0,c=e.length;a<c;){for(s=o.length;s--;o[s]*=t);for(o[0]+=n.indexOf(e.charAt(a++)),i=0;i<o.length;i++)o[i]>r-1&&(null==o[i+1]&&(o[i+1]=0),o[i+1]+=o[i]/r|0,o[i]%=r)}return o.reverse()}return function(n,i,s,o,a){var c,l,u,h,d,p,m,y,w=n.indexOf("."),b=f,v=g;for(w>=0&&(h=A,A=0,n=n.replace(".",""),p=(y=new C(i)).pow(n.length-w),A=h,y.c=t(Vi(zi(p.c),p.e,"0"),10,s,e),y.e=y.c.length),u=h=(m=t(n,i,s,a?(c=I,e):(c=e,I))).length;0==m[--h];m.pop());if(!m[0])return c.charAt(0);if(w<0?--u:(p.c=m,p.e=u,p.s=o,m=(p=r(p,y,b,v,s)).c,d=p.r,u=p.e),w=m[l=u+b+1],h=s/2,d=d||l<0||null!=m[l+1],d=v<4?(null!=w||d)&&(0==v||v==(p.s<0?3:2)):w>h||w==h&&(4==v||d||6==v&&1&m[l-1]||v==(p.s<0?8:7)),l<1||!m[0])n=d?Vi(c.charAt(1),-b,c.charAt(0)):c.charAt(0);else{if(m.length=l,d)for(--s;++m[--l]>s;)m[l]=0,l||(++u,m=[1].concat(m));for(h=m.length;!m[--h];);for(w=0,n="";w<=h;n+=c.charAt(m[w++]));n=Vi(n,u,c.charAt(0))}return n}}(),r=function(){function e(e,t,r){var n,i,s,o,a=0,c=e.length,l=t%Wi,u=t/Wi|0;for(e=e.slice();c--;)a=((i=l*(s=e[c]%Wi)+(n=u*s+(o=e[c]/Wi|0)*l)%Wi*Wi+a)/r|0)+(n/Wi|0)+u*o,e[c]=i%r;return a&&(e=[a].concat(e)),e}function t(e,t,r,n){var i,s;if(r!=n)s=r>n?1:-1;else for(i=s=0;i<r;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function r(e,t,r,n){for(var i=0;r--;)e[r]-=i,i=e[r]<t[r]?1:0,e[r]=i*n+e[r]-t[r];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(n,i,s,o,a){var c,l,u,h,d,p,f,g,m,y,w,b,v,E,A,_,I,S=n.s==i.s?1:-1,k=n.c,N=i.c;if(!(k&&k[0]&&N&&N[0]))return new C(n.s&&i.s&&(k?!N||k[0]!=N[0]:N)?k&&0==k[0]||!N?0*S:S/0:NaN);for(m=(g=new C(S)).c=[],S=s+(l=n.e-i.e)+1,a||(a=Bi,l=$i(n.e/Mi)-$i(i.e/Mi),S=S/Mi|0),u=0;N[u]==(k[u]||0);u++);if(N[u]>(k[u]||0)&&l--,S<0)m.push(1),h=!0;else{for(E=k.length,_=N.length,u=0,S+=2,(d=Pi(a/(N[0]+1)))>1&&(N=e(N,d,a),k=e(k,d,a),_=N.length,E=k.length),v=_,w=(y=k.slice(0,_)).length;w<_;y[w++]=0);I=N.slice(),I=[0].concat(I),A=N[0],N[1]>=a/2&&A++;do{if(d=0,(c=t(N,y,_,w))<0){if(b=y[0],_!=w&&(b=b*a+(y[1]||0)),(d=Pi(b/A))>1)for(d>=a&&(d=a-1),f=(p=e(N,d,a)).length,w=y.length;1==t(p,y,f,w);)d--,r(p,_<f?I:N,f,a),f=p.length,c=1;else 0==d&&(c=d=1),f=(p=N.slice()).length;if(f<w&&(p=[0].concat(p)),r(y,p,w,a),w=y.length,-1==c)for(;t(N,y,_,w)<1;)d++,r(y,_<w?I:N,w,a),w=y.length}else 0===c&&(d++,y=[0]);m[u++]=d,y[0]?y[w++]=k[v]||0:(y=[k[v]],w=1)}while((v++<E||null!=y[0])&&S--);h=null!=y[0],m[0]||m.splice(0,1)}if(a==Bi){for(u=1,S=m[0];S>=10;S/=10,u++);T(g,s+(g.e=u+l*Mi-1)+1,o,h)}else g.e=l,g.r=+h;return g}}(),a=/^(-?)0([xbo])(?=\w[\w.]*$)/i,c=/^([^.]+)\.$/,l=/^\.([^.]+)$/,u=/^-?(Infinity|NaN)$/,h=/^\s*\+(?=[\w.])|^\s+|\s+$/g,i=function(e,t,r,n){var i,s=r?t:t.replace(h,"");if(u.test(s))e.s=isNaN(s)?null:s<0?-1:1;else{if(!r&&(s=s.replace(a,function(e,t,r){return i="x"==(r=r.toLowerCase())?16:"b"==r?2:8,n&&n!=i?e:t}),n&&(i=n,s=s.replace(c,"$1").replace(l,"0.$1")),t!=s))return new C(s,i);if(C.DEBUG)throw Error(Ri+"Not a"+(n?" base "+n:"")+" number: "+t);e.s=null}e.c=e.e=null},d.absoluteValue=d.abs=function(){var e=new C(this);return e.s<0&&(e.s=1),e},d.comparedTo=function(e,t){return qi(this,new C(e,t))},d.decimalPlaces=d.dp=function(e,t){var r,n,i,s=this;if(null!=e)return Fi(e,0,ji),null==t?t=g:Fi(t,0,8),T(new C(s),e+s.e+1,t);if(!(r=s.c))return null;if(n=((i=r.length-1)-$i(this.e/Mi))*Mi,i=r[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},d.dividedBy=d.div=function(e,t){return r(this,new C(e,t),f,g)},d.dividedToIntegerBy=d.idiv=function(e,t){return r(this,new C(e,t),0,1)},d.exponentiatedBy=d.pow=function(e,t){var r,n,i,s,o,a,c,l,u=this;if((e=new C(e)).c&&!e.isInteger())throw Error(Ri+"Exponent not an integer: "+O(e));if(null!=t&&(t=new C(t)),o=e.e>14,!u.c||!u.c[0]||1==u.c[0]&&!u.e&&1==u.c.length||!e.c||!e.c[0])return l=new C(Math.pow(+O(u),o?e.s*(2-Hi(e)):+O(e))),t?l.mod(t):l;if(a=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new C(NaN);(n=!a&&u.isInteger()&&t.isInteger())&&(u=u.mod(t))}else{if(e.e>9&&(u.e>0||u.e<-1||(0==u.e?u.c[0]>1||o&&u.c[1]>=24e7:u.c[0]<8e13||o&&u.c[0]<=9999975e7)))return s=u.s<0&&Hi(e)?-0:0,u.e>-1&&(s=1/s),new C(a?1/s:s);A&&(s=Oi(A/Mi+2))}for(o?(r=new C(.5),a&&(e.s=1),c=Hi(e)):c=(i=Math.abs(+O(e)))%2,l=new C(p);;){if(c){if(!(l=l.times(u)).c)break;s?l.c.length>s&&(l.c.length=s):n&&(l=l.mod(t))}if(i){if(0===(i=Pi(i/2)))break;c=i%2}else if(T(e=e.times(r),e.e+1,1),e.e>14)c=Hi(e);else{if(0===(i=+O(e)))break;c=i%2}u=u.times(u),s?u.c&&u.c.length>s&&(u.c.length=s):n&&(u=u.mod(t))}return n?l:(a&&(l=p.div(l)),t?l.mod(t):s?T(l,A,g,void 0):l)},d.integerValue=function(e){var t=new C(this);return null==e?e=g:Fi(e,0,8),T(t,t.e+1,e)},d.isEqualTo=d.eq=function(e,t){return 0===qi(this,new C(e,t))},d.isFinite=function(){return!!this.c},d.isGreaterThan=d.gt=function(e,t){return qi(this,new C(e,t))>0},d.isGreaterThanOrEqualTo=d.gte=function(e,t){return 1===(t=qi(this,new C(e,t)))||0===t},d.isInteger=function(){return!!this.c&&$i(this.e/Mi)>this.c.length-2},d.isLessThan=d.lt=function(e,t){return qi(this,new C(e,t))<0},d.isLessThanOrEqualTo=d.lte=function(e,t){return-1===(t=qi(this,new C(e,t)))||0===t},d.isNaN=function(){return!this.s},d.isNegative=function(){return this.s<0},d.isPositive=function(){return this.s>0},d.isZero=function(){return!!this.c&&0==this.c[0]},d.minus=function(e,t){var r,n,i,s,o=this,a=o.s;if(t=(e=new C(e,t)).s,!a||!t)return new C(NaN);if(a!=t)return e.s=-t,o.plus(e);var c=o.e/Mi,l=e.e/Mi,u=o.c,h=e.c;if(!c||!l){if(!u||!h)return u?(e.s=-t,e):new C(h?o:NaN);if(!u[0]||!h[0])return h[0]?(e.s=-t,e):new C(u[0]?o:3==g?-0:0)}if(c=$i(c),l=$i(l),u=u.slice(),a=c-l){for((s=a<0)?(a=-a,i=u):(l=c,i=h),i.reverse(),t=a;t--;i.push(0));i.reverse()}else for(n=(s=(a=u.length)<(t=h.length))?a:t,a=t=0;t<n;t++)if(u[t]!=h[t]){s=u[t]<h[t];break}if(s&&(i=u,u=h,h=i,e.s=-e.s),(t=(n=h.length)-(r=u.length))>0)for(;t--;u[r++]=0);for(t=Bi-1;n>a;){if(u[--n]<h[n]){for(r=n;r&&!u[--r];u[r]=t);--u[r],u[n]+=Bi}u[n]-=h[n]}for(;0==u[0];u.splice(0,1),--l);return u[0]?x(e,u,l):(e.s=3==g?-1:1,e.c=[e.e=0],e)},d.modulo=d.mod=function(e,t){var n,i,s=this;return e=new C(e,t),!s.c||!e.s||e.c&&!e.c[0]?new C(NaN):!e.c||s.c&&!s.c[0]?new C(s):(9==E?(i=e.s,e.s=1,n=r(s,e,0,3),e.s=i,n.s*=i):n=r(s,e,0,E),(e=s.minus(n.times(e))).c[0]||1!=E||(e.s=s.s),e)},d.multipliedBy=d.times=function(e,t){var r,n,i,s,o,a,c,l,u,h,d,p,f,g,m,y=this,w=y.c,b=(e=new C(e,t)).c;if(!(w&&b&&w[0]&&b[0]))return!y.s||!e.s||w&&!w[0]&&!b||b&&!b[0]&&!w?e.c=e.e=e.s=null:(e.s*=y.s,w&&b?(e.c=[0],e.e=0):e.c=e.e=null),e;for(n=$i(y.e/Mi)+$i(e.e/Mi),e.s*=y.s,(c=w.length)<(h=b.length)&&(f=w,w=b,b=f,i=c,c=h,h=i),i=c+h,f=[];i--;f.push(0));for(g=Bi,m=Wi,i=h;--i>=0;){for(r=0,d=b[i]%m,p=b[i]/m|0,s=i+(o=c);s>i;)r=((l=d*(l=w[--o]%m)+(a=p*l+(u=w[o]/m|0)*d)%m*m+f[s]+r)/g|0)+(a/m|0)+p*u,f[s--]=l%g;f[s]=r}return r?++n:f.splice(0,1),x(e,f,n)},d.negated=function(){var e=new C(this);return e.s=-e.s||null,e},d.plus=function(e,t){var r,n=this,i=n.s;if(t=(e=new C(e,t)).s,!i||!t)return new C(NaN);if(i!=t)return e.s=-t,n.minus(e);var s=n.e/Mi,o=e.e/Mi,a=n.c,c=e.c;if(!s||!o){if(!a||!c)return new C(i/0);if(!a[0]||!c[0])return c[0]?e:new C(a[0]?n:0*i)}if(s=$i(s),o=$i(o),a=a.slice(),i=s-o){for(i>0?(o=s,r=c):(i=-i,r=a),r.reverse();i--;r.push(0));r.reverse()}for((i=a.length)-(t=c.length)<0&&(r=c,c=a,a=r,t=i),i=0;t;)i=(a[--t]=a[t]+c[t]+i)/Bi|0,a[t]=Bi===a[t]?0:a[t]%Bi;return i&&(a=[i].concat(a),++o),x(e,a,o)},d.precision=d.sd=function(e,t){var r,n,i,s=this;if(null!=e&&e!==!!e)return Fi(e,1,ji),null==t?t=g:Fi(t,0,8),T(new C(s),e,t);if(!(r=s.c))return null;if(n=(i=r.length-1)*Mi+1,i=r[i]){for(;i%10==0;i/=10,n--);for(i=r[0];i>=10;i/=10,n++);}return e&&s.e+1>n&&(n=s.e+1),n},d.shiftedBy=function(e){return Fi(e,-9007199254740991,Li),this.times("1e"+e)},d.squareRoot=d.sqrt=function(){var e,t,n,i,s,o=this,a=o.c,c=o.s,l=o.e,u=f+4,h=new C("0.5");if(1!==c||!a||!a[0])return new C(!c||c<0&&(!a||a[0])?NaN:a?o:1/0);if(0==(c=Math.sqrt(+O(o)))||c==1/0?(((t=zi(a)).length+l)%2==0&&(t+="0"),c=Math.sqrt(+t),l=$i((l+1)/2)-(l<0||l%2),n=new C(t=c==1/0?"5e"+l:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+l)):n=new C(c+""),n.c[0])for((c=(l=n.e)+u)<3&&(c=0);;)if(s=n,n=h.times(s.plus(r(o,s,u,1))),zi(s.c).slice(0,c)===(t=zi(n.c)).slice(0,c)){if(n.e<l&&--c,"9999"!=(t=t.slice(c-3,c+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(T(n,n.e+f+2,1),e=!n.times(n).eq(o));break}if(!i&&(T(s,s.e+f+2,0),s.times(s).eq(o))){n=s;break}u+=4,c+=4,i=1}return T(n,n.e+f+1,g,e)},d.toExponential=function(e,t){return null!=e&&(Fi(e,0,ji),e++),k(this,e,t,1)},d.toFixed=function(e,t){return null!=e&&(Fi(e,0,ji),e=e+this.e+1),k(this,e,t)},d.toFormat=function(e,t,r){var n,i=this;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=_;else if("object"!=typeof r)throw Error(Ri+"Argument not an object: "+r);if(n=i.toFixed(e,t),i.c){var s,o=n.split("."),a=+r.groupSize,c=+r.secondaryGroupSize,l=r.groupSeparator||"",u=o[0],h=o[1],d=i.s<0,p=d?u.slice(1):u,f=p.length;if(c&&(s=a,a=c,c=s,f-=s),a>0&&f>0){for(s=f%a||a,u=p.substr(0,s);s<f;s+=a)u+=l+p.substr(s,a);c>0&&(u+=l+p.slice(s)),d&&(u="-"+u)}n=h?u+(r.decimalSeparator||"")+((c=+r.fractionGroupSize)?h.replace(new RegExp("\\d{"+c+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):h):u}return(r.prefix||"")+n+(r.suffix||"")},d.toFraction=function(e){var t,n,i,s,o,a,c,l,u,h,d,f,m=this,y=m.c;if(null!=e&&(!(c=new C(e)).isInteger()&&(c.c||1!==c.s)||c.lt(p)))throw Error(Ri+"Argument "+(c.isInteger()?"out of range: ":"not an integer: ")+O(c));if(!y)return new C(m);for(t=new C(p),u=n=new C(p),i=l=new C(p),f=zi(y),o=t.e=f.length-m.e-1,t.c[0]=Di[(a=o%Mi)<0?Mi+a:a],e=!e||c.comparedTo(t)>0?o>0?t:u:c,a=b,b=1/0,c=new C(f),l.c[0]=0;h=r(c,t,0,1),1!=(s=n.plus(h.times(i))).comparedTo(e);)n=i,i=s,u=l.plus(h.times(s=u)),l=s,t=c.minus(h.times(s=t)),c=s;return s=r(e.minus(n),i,0,1),l=l.plus(s.times(u)),n=n.plus(s.times(i)),l.s=u.s=m.s,d=r(u,i,o*=2,g).minus(m).abs().comparedTo(r(l,n,o,g).minus(m).abs())<1?[u,i]:[l,n],b=a,d},d.toNumber=function(){return+O(this)},d.toPrecision=function(e,t){return null!=e&&Fi(e,1,ji),k(this,e,t,2)},d.toString=function(e){var t,r=this,i=r.s,s=r.e;return null===s?i?(t="Infinity",i<0&&(t="-"+t)):t="NaN":(null==e?t=s<=m||s>=y?Ki(zi(r.c),s):Vi(zi(r.c),s,"0"):10===e&&S?t=Vi(zi((r=T(new C(r),f+s+1,g)).c),r.e,"0"):(Fi(e,2,I.length,"Base"),t=n(Vi(zi(r.c),s,"0"),10,e,i,!0)),i<0&&r.c[0]&&(t="-"+t)),t},d.valueOf=d.toJSON=function(){return O(this)},d._isBigNumber=!0,d[Symbol.toStringTag]="BigNumber",d[Symbol.for("nodejs.util.inspect.custom")]=d.valueOf,null!=t&&C.set(t),C}();new Yi("1e+18");const Gi=e=>{const t=(0,Ce.u8)(e),{encode:r,decode:n}=Si(t),i=t;return i.decode=(e,t)=>!!n(e,t),i.encode=(e,t,n)=>{const i=Number(e);return r(i,t,n)},i};var Zi=i(7323);const Ji=e=>{const t=(0,Ce.av)(32,e),{encode:r,decode:n}=Si(t),i=t;return i.decode=(e,t)=>{const r=n(e,t);return new Zi.J3(r)},i.encode=(e,t,n)=>{const i=e.toBuffer();return r(i,t,n)},i},Xi=new Zi.J3("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),Qi=(new Zi.J3("TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb"),new Zi.J3("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"));new Zi.J3("So11111111111111111111111111111111111111112"),new Zi.J3("9pan9bMn5HatX4EJdBwg9VgCa7Uz5HL8N1m5D3NdXejP");class es extends Error{constructor(e){super(e)}}class ts extends es{constructor(){super(...arguments),this.name="TokenAccountNotFoundError"}}class rs extends es{constructor(){super(...arguments),this.name="TokenInvalidAccountError"}}class ns extends es{constructor(){super(...arguments),this.name="TokenInvalidAccountOwnerError"}}class is extends es{constructor(){super(...arguments),this.name="TokenInvalidAccountSizeError"}}class ss extends es{constructor(){super(...arguments),this.name="TokenInvalidMintError"}}class os extends es{constructor(){super(...arguments),this.name="TokenOwnerOffCurveError"}}var as;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Mint=1]="Mint",e[e.Account=2]="Account"}(as||(as={}));const cs=(0,Ce.w3)([(0,Ce.u8)("m"),(0,Ce.u8)("n"),Gi("isInitialized"),Ji("signer1"),Ji("signer2"),Ji("signer3"),Ji("signer4"),Ji("signer5"),Ji("signer6"),Ji("signer7"),Ji("signer8"),Ji("signer9"),Ji("signer10"),Ji("signer11")]).span;var ls,us=i(8287).Buffer;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initialized=1]="Initialized",e[e.Frozen=2]="Frozen"}(ls||(ls={}));const hs=(0,Ce.w3)([Ji("mint"),Ji("owner"),xi("amount"),(0,Ce.DH)("delegateOption"),Ji("delegate"),(0,Ce.u8)("state"),(0,Ce.DH)("isNativeOption"),xi("isNative"),xi("delegatedAmount"),(0,Ce.DH)("closeAuthorityOption"),Ji("closeAuthority")]),ds=hs.span;async function ps(e,t,r,n=Xi){return function(e,t,r=Xi){if(!t)throw new ts;if(!t.owner.equals(r))throw new ns;if(t.data.length<ds)throw new is;const n=hs.decode(t.data.slice(0,ds));let i=us.alloc(0);if(t.data.length>ds){if(t.data.length===cs)throw new is;if(t.data[ds]!=as.Account)throw new rs;i=t.data.slice(ds+1)}return{address:e,mint:n.mint,owner:n.owner,amount:n.amount,delegate:n.delegateOption?n.delegate:null,delegatedAmount:n.delegatedAmount,isInitialized:n.state!==ls.Uninitialized,isFrozen:n.state===ls.Frozen,isNative:!!n.isNativeOption,rentExemptReserve:n.isNativeOption?n.isNative:null,closeAuthority:n.closeAuthorityOption?n.closeAuthority:null,tlvData:i}}(t,await e.getAccountInfo(t,r),n)}var fs=i(8287).Buffer;const gs=(0,Ce.w3)([(0,Ce.DH)("mintAuthorityOption"),Ji("mintAuthority"),xi("supply"),(0,Ce.u8)("decimals"),Gi("isInitialized"),(0,Ce.DH)("freezeAuthorityOption"),Ji("freezeAuthority")]),ms=gs.span;function ys(e,t,r=!1,n=Xi,i=Qi){if(!r&&!Zi.J3.isOnCurve(t.toBuffer()))throw new os;const[s]=Zi.J3.findProgramAddressSync([t.toBuffer(),n.toBuffer(),e.toBuffer()],i);return s}var ws,bs,vs=i(8287).Buffer;(bs=ws||(ws={}))[bs.InitializeMint=0]="InitializeMint",bs[bs.InitializeAccount=1]="InitializeAccount",bs[bs.InitializeMultisig=2]="InitializeMultisig",bs[bs.Transfer=3]="Transfer",bs[bs.Approve=4]="Approve",bs[bs.Revoke=5]="Revoke",bs[bs.SetAuthority=6]="SetAuthority",bs[bs.MintTo=7]="MintTo",bs[bs.Burn=8]="Burn",bs[bs.CloseAccount=9]="CloseAccount",bs[bs.FreezeAccount=10]="FreezeAccount",bs[bs.ThawAccount=11]="ThawAccount",bs[bs.TransferChecked=12]="TransferChecked",bs[bs.ApproveChecked=13]="ApproveChecked",bs[bs.MintToChecked=14]="MintToChecked",bs[bs.BurnChecked=15]="BurnChecked",bs[bs.InitializeAccount2=16]="InitializeAccount2",bs[bs.SyncNative=17]="SyncNative",bs[bs.InitializeAccount3=18]="InitializeAccount3",bs[bs.InitializeMultisig2=19]="InitializeMultisig2",bs[bs.InitializeMint2=20]="InitializeMint2",bs[bs.GetAccountDataSize=21]="GetAccountDataSize",bs[bs.InitializeImmutableOwner=22]="InitializeImmutableOwner",bs[bs.AmountToUiAmount=23]="AmountToUiAmount",bs[bs.UiAmountToAmount=24]="UiAmountToAmount",bs[bs.InitializeMintCloseAuthority=25]="InitializeMintCloseAuthority",bs[bs.TransferFeeExtension=26]="TransferFeeExtension",bs[bs.ConfidentialTransferExtension=27]="ConfidentialTransferExtension",bs[bs.DefaultAccountStateExtension=28]="DefaultAccountStateExtension",bs[bs.Reallocate=29]="Reallocate",bs[bs.MemoTransferExtension=30]="MemoTransferExtension",bs[bs.CreateNativeMint=31]="CreateNativeMint",bs[bs.InitializeNonTransferableMint=32]="InitializeNonTransferableMint",bs[bs.InterestBearingMintExtension=33]="InterestBearingMintExtension",bs[bs.CpiGuardExtension=34]="CpiGuardExtension",bs[bs.InitializePermanentDelegate=35]="InitializePermanentDelegate",bs[bs.TransferHookExtension=36]="TransferHookExtension",bs[bs.MetadataPointerExtension=39]="MetadataPointerExtension",bs[bs.GroupPointerExtension=40]="GroupPointerExtension",bs[bs.GroupMemberPointerExtension=41]="GroupMemberPointerExtension",bs[bs.ScaledUiAmountExtension=43]="ScaledUiAmountExtension",bs[bs.PausableExtension=44]="PausableExtension";var Es=i(8287).Buffer;const As=(0,Ce.w3)([(0,Ce.u8)("instruction"),xi("amount")]);async function _s({provider:e,to:t,amount:r,tokenMint:n,connection:i}){if(!e.publicKey)throw new Error("No public key found");if(r<=0)throw new Error("Amount must be greater than 0");try{const s=e.publicKey,o=new Qe(t),a=new Qe(n),c=(await async function(e,t,r,n=Xi){return function(e,t,r=Xi){if(!t)throw new ts;if(!t.owner.equals(r))throw new ns;if(t.data.length<ms)throw new is;const n=gs.decode(t.data.slice(0,ms));let i=fs.alloc(0);if(t.data.length>ms){if(t.data.length<=ds)throw new is;if(t.data.length===cs)throw new is;if(t.data[ds]!=as.Mint)throw new ss;i=t.data.slice(ds+1)}return{address:e,mintAuthority:n.mintAuthorityOption?n.mintAuthority:null,supply:n.supply,decimals:n.decimals,isInitialized:n.isInitialized,freezeAuthority:n.freezeAuthorityOption?n.freezeAuthority:null,tlvData:i}}(t,await e.getAccountInfo(t,r),n)}(i,a)).decimals;if(c<0)throw new Error("Invalid token decimals");const l=Math.floor(r*10**c),u=ys(a,s),h=ys(a,o);try{if((await ps(i,u)).amount<BigInt(l))throw new Error("Insufficient token balance")}catch(e){if(e instanceof ts)throw new Error("Sender does not have a token account for this mint");throw e}let d=!1;try{await ps(i,h)}catch(e){if(!(e instanceof ts))throw e;d=!0}const p=[],f=d?ci.Y.UNIT_LIMIT_WITH_ATA_CREATION:ci.Y.UNIT_LIMIT_TRANSFER_ONLY;p.push(Gn.setComputeUnitPrice({microLamports:ci.Y.UNIT_PRICE_MICRO_LAMPORTS}),Gn.setComputeUnitLimit({units:f})),d&&p.push(function(e,t,r,n,i=Xi,s=Qi){return function(e,t,r,n,i,s=Xi,o=Qi){const a=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:Zi.yq.programId,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1}];return new Zi.fH({keys:a,programId:o,data:i})}(e,t,r,n,vs.alloc(0),i,s)}(s,h,o,a)),p.push(function(e,t,r,n,i=[],s=Xi){const o=function(e,t,r){if(r.length){e.push({pubkey:t,isSigner:!1,isWritable:!1});for(const t of r)e.push({pubkey:t instanceof Zi.J3?t:t.publicKey,isSigner:!0,isWritable:!1})}else e.push({pubkey:t,isSigner:!0,isWritable:!1});return e}([{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}],r,i),a=Es.alloc(As.span);return As.encode({instruction:ws.Transfer,amount:BigInt(n)},a),new Zi.fH({keys:o,programId:s,data:a})}(u,h,s,l,[],Xi));const{blockhash:g,lastValidBlockHeight:m}=await i.getLatestBlockhash();return new At({feePayer:s,blockhash:g,lastValidBlockHeight:m}).add(...p)}catch(e){throw new Error(`Failed to create SPL token transaction: ${e instanceof Error?e.message:"Unknown error"}`)}}async function Is({provider:e,to:t,value:r,connection:n}){if(!e.publicKey)throw Error("No public key found");const i=new Qe(t),s=Math.floor(1e9*r),{blockhash:o,lastValidBlockHeight:a}=await n.getLatestBlockhash(),c=[Gn.setComputeUnitPrice({microLamports:2e7}),Gn.setComputeUnitLimit({units:500}),Wt.transfer({fromPubkey:e.publicKey,toPubkey:i,lamports:s})];return new At({feePayer:e.publicKey,blockhash:o,lastValidBlockHeight:a}).add(...c)}const Ss="solana:signAndSendTransaction",Cs="solana:signTransaction",ks="standard:connect",Ns="standard:events";var xs;let Ts;const Os=new Set,Ps={};function Rs(...e){return(e=e.filter(e=>!Os.has(e))).length?(e.forEach(e=>function(e){Us=void 0,Os.add(e)}(e)),Ps.register?.forEach(t=>Ls(()=>t(...e))),function(){e.forEach(e=>function(e){Us=void 0,Os.delete(e)}(e)),Ps.unregister?.forEach(t=>Ls(()=>t(...e)))}):()=>{}}let Us;function Bs(){return Us||(Us=[...Os]),Us}function Ms(e,t){return Ps[e]?.push(t)||(Ps[e]=[t]),function(){Ps[e]=Ps[e]?.filter(e=>t!==e)}}function Ls(e){try{e()}catch(e){console.error(e)}}class Ds extends Event{get detail(){return function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}(this,xs,"f")}get type(){return"wallet-standard:app-ready"}constructor(e){super("wallet-standard:app-ready",{bubbles:!1,cancelable:!1,composed:!1}),xs.set(this,void 0),function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===n?i.call(e,r):i?i.value=r:t.set(e,r)}(this,xs,e,"f")}preventDefault(){throw new Error("preventDefault cannot be called")}stopImmediatePropagation(){throw new Error("stopImmediatePropagation cannot be called")}stopPropagation(){throw new Error("stopPropagation cannot be called")}}xs=new WeakMap;class Ws extends Error{constructor(e,t){super(e),this.error=t}}class js extends Ws{constructor(){super(...arguments),this.name="WalletAccountError"}}class $s extends Ws{constructor(){super(...arguments),this.name="WalletSendTransactionError"}}class zs extends Ws{constructor(){super(...arguments),this.name="WalletSignTransactionError"}}class qs extends Ws{constructor(){super(...arguments),this.name="WalletSignMessageError"}}function Fs(e){switch(e){case"processed":case"confirmed":case"finalized":case void 0:return e;case"recent":return"processed";case"single":case"singleGossip":return"confirmed";case"max":case"root":return"finalized";default:return}}const Hs={"solana:mainnet":te,"solana:testnet":ne,"solana:devnet":re};class Ks extends hi{constructor({wallet:e,getActiveChain:t,requestedChains:r}){super(),this.chain=o.o.CHAIN.SOLANA,this.provider=this,this.wallet=e,this.getActiveChain=t,this.requestedChains=r,this.bindEvents()}get id(){const e=this.name;return Z.L.ConnectorExplorerIds[e]||e}get name(){return"Trust"===this.wallet.name?"Trust Wallet":this.wallet.name}get type(){return"ANNOUNCED"}get explorerId(){return Z.L.ConnectorExplorerIds[this.name]}get publicKey(){const e=this.getAccount(!1);if(e)return new Qe(e.publicKey)}get imageUrl(){return this.wallet.icon}get chains(){return this.wallet.chains.map(e=>this.requestedChains.find(t=>t.id===e||t.id===Hs[e]?.id)).filter(Boolean)}async connect(){const e=this.getWalletFeature(ks);await e.connect();const t=this.getAccount(!0),r=new Qe(t.publicKey);return this.emit("connect",r),t.address}async disconnect(){const e=this.getWalletFeature("standard:disconnect");await e.disconnect(),this.emit("disconnect",void 0)}async signMessage(e){const t=this.getWalletFeature("solana:signMessage"),r=this.getAccount(!0),[n]=await t.signMessage({message:e,account:r});if(!n)throw new qs("Empty result");return n.signature}async signTransaction(e){const t=this.getWalletFeature(Cs),r=this.getAccount(!0),n=this.serializeTransaction(e),[i]=await t.signTransaction({account:r,transaction:new Uint8Array(n),chain:this.getActiveChainName()});if(!i)throw new zs("Empty result");return this.emit("pendingTransaction",void 0),li(e)?_t.deserialize(i.signedTransaction):At.from(i.signedTransaction)}async signAndSendTransaction(e,t){const r=this.getWalletFeature(Ss),n=this.getAccount(!0),[i]=await r.signAndSendTransaction({account:n,transaction:new Uint8Array(this.serializeTransaction(e)),options:{...t,preflightCommitment:Fs(t?.preflightCommitment)},chain:this.getActiveChainName()});if(!i)throw new $s("Empty result");return this.emit("pendingTransaction",void 0),Y.A.encode(i.signature)}async sendTransaction(e,t,r){const n=await this.signTransaction(e);return await t.sendRawTransaction(n.serialize(),r)}async signAllTransactions(e){const t=this.getWalletFeature(Cs),r=this.getAccount(!0),n=this.getActiveChainName();return(await t.signTransaction(...e.map(e=>({transaction:new Uint8Array(this.serializeTransaction(e)),account:r,chain:n})))).map(({signedTransaction:t},r)=>{const n=e[r];if(!n)throw new zs("Invalid transaction signature response");return this.emit("pendingTransaction",void 0),li(n)?_t.deserialize(t):At.from(t)})}async request(e){return Promise.reject(new gi("request"))}async getAccounts(){return Promise.resolve(this.wallet.accounts.map(e=>({namespace:this.chain,address:e.address,type:"eoa"})))}serializeTransaction(e){return e.serialize({verifySignatures:!1})}getAccount(e){const t=this.wallet.accounts[0];if(e&&!t)throw new js;return t}getWalletFeature(e){if(!(e in this.wallet.features))throw new gi(e);return this.wallet.features[e]}getActiveChainName(){const e=Object.entries(Hs).find(([,e])=>e.id===this.getActiveChain()?.id);if(!e)throw new Error("Invalid chain id");return e[0]}bindEvents(){this.getWalletFeature(Ns).on("change",e=>{if(e.accounts){const t=e.accounts[0];t&&this.emit("accountsChanged",new Qe(t.publicKey))}})}}const{get:Vs,on:Ys}=function(){if(Ts)return Ts;if(Ts=Object.freeze({register:Rs,get:Bs,on:Ms}),"undefined"==typeof window)return Ts;const e=Object.freeze({register:Rs});try{window.addEventListener("wallet-standard:register-wallet",({detail:t})=>t(e))}catch(e){console.error("wallet-standard:register-wallet event listener could not be added\n",e)}try{window.dispatchEvent(new Ds(e))}catch(e){console.error("wallet-standard:app-ready event could not be dispatched\n",e)}return Ts}();let Gs=[];function Zs(e,t,r){return e.filter(e=>"WalletConnect"!==e.name&&function(e){return ks in e.features&&Ns in e.features&&(Ss in e.features||Cs in e.features)}(e)).map(e=>new Ks({wallet:e,requestedChains:t,getActiveChain:r}))}const Js=[o.o.CONNECTOR_ID.AUTH,o.o.CONNECTOR_ID.WALLET_CONNECT];function Xs(e){return Xs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xs(e)}function Qs(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function eo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Qs(Object(r),!0).forEach(function(t){to(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qs(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function to(e,t,r){return(t=ao(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ro(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function s(r,n,i,s){var c=n&&n.prototype instanceof a?n:a,l=Object.create(c.prototype);return no(l,"_invoke",function(r,n,i){var s,a,c,l=0,u=i||[],h=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return s=t,a=0,c=e,d.n=r,o}};function p(r,n){for(a=r,c=n,t=0;!h&&l&&!i&&t<u.length;t++){var i,s=u[t],p=d.p,f=s[2];r>3?(i=f===n)&&(c=s[(a=s[4])?5:(a=3,3)],s[4]=s[5]=e):s[0]<=p&&((i=r<2&&p<s[1])?(a=0,d.v=n,d.n=s[1]):p<f&&(i=r<3||s[0]>n||n>f)&&(s[4]=r,s[5]=n,d.n=f,a=0))}if(i||r>1)return o;throw h=!0,n}return function(i,u,f){if(l>1)throw TypeError("Generator is already running");for(h&&1===u&&p(u,f),a=u,c=f;(t=a<2?e:c)||!h;){s||(a?a<3?(a>1&&(d.n=-1),p(a,c)):d.n=c:d.v=c);try{if(l=2,s){if(a||(i="next"),t=s[i]){if(!(t=t.call(s,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,a<2&&(a=0)}else 1===a&&(t=s.return)&&t.call(s),a<2&&(c=TypeError("The iterator does not provide a '"+i+"' method"),a=1);s=e}else if((t=(h=d.n<0)?c:r.call(n,d))!==o)break}catch(t){s=e,a=1,c=t}finally{l=1}}return{value:t,done:h}}}(r,i,s),!0),l}var o={};function a(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][n]?t(t([][n]())):(no(t={},n,function(){return this}),t),h=l.prototype=a.prototype=Object.create(u);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,no(e,i,"GeneratorFunction")),e.prototype=Object.create(h),e}return c.prototype=l,no(h,"constructor",l),no(l,"constructor",c),c.displayName="GeneratorFunction",no(l,i,"GeneratorFunction"),no(h),no(h,i,"Generator"),no(h,n,function(){return this}),no(h,"toString",function(){return"[object Generator]"}),(ro=function(){return{w:s,m:d}})()}function no(e,t,r,n){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}no=function(e,t,r,n){function s(t,r){no(e,t,function(e){return this._invoke(t,r,e)})}t?i?i(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(s("next",0),s("throw",1),s("return",2))},no(e,t,r,n)}function io(e,t,r,n,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,i)}function so(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var s=e.apply(t,r);function o(e){io(s,n,i,o,a,"next",e)}function a(e){io(s,n,i,o,a,"throw",e)}o(void 0)})}}function oo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ao(n.key),n)}}function ao(e){var t=function(e){if("object"!=Xs(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Xs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Xs(t)?t:t+""}var co,lo=new class extends he{constructor(e={}){super({adapterType:o.o.ADAPTER_TYPES.SOLANA,namespace:o.o.CHAIN.SOLANA}),this.balancePromises={},this.connectionSettings=e.connectionSettings||"confirmed",this.wallets=e.wallets,this.registerWalletStandard=e.registerWalletStandard}construct(e){super.construct(e);const t=v.i.getActiveCaipNetworkId(),r=e.networks?.find(e=>e.caipNetworkId===t)||e.networks?.[0],n=r?.rpcUrls.default.http[0];n&&_i.setConnection(new Kn(n,this.connectionSettings))}setAuthProvider(e){this.addConnector(new di({w3mFrameProvider:e,getActiveChain:()=>m.W.getCaipNetworkByNamespace(this.namespace),chains:this.getCaipNetworks()}))}syncConnectors(e,t){e.projectId||E.h.open(I.R.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");const r=()=>t.getCaipNetwork(this.namespace);s.w.isClient()&&"coinbaseSolana"in window&&this.addConnector(new pi({provider:window.coinbaseSolana,chains:this.getCaipNetworks(),getActiveChain:r})),function(e,t,r){Ys("register",(...n)=>{Gs=[...Gs,...Zs(n,e,t)],r(...Gs)}),Ys("unregister",(...e)=>{Gs=Gs.filter(t=>e.some(e=>e.name===t.wallet.name)),r(...Gs)});Gs=Zs(Vs(),e,t),r(...Gs)}(this.getCaipNetworks(),r,this.addConnector.bind(this))}async writeContract(){return Promise.resolve({hash:""})}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async walletGetAssets(e){return Promise.resolve({})}async getAccounts(e){const t=this.connectors.find(t=>t.id===e.id);return t?{accounts:await t.getAccounts()}:{accounts:[]}}async signMessage(e){const t=e.provider;if(!t)throw new Error("connectionControllerClient:signMessage - provider is undefined");const r=await t.signMessage((new TextEncoder).encode(e.message));return{signature:Y.A.encode(r)}}async estimateGas(e){const t=_i.state.connection;if(!t||!e.provider)throw new Error("Connection is not set");const r=await Is({provider:e.provider,connection:t,to:"11111111111111111111111111111111",value:1}),n=await r.getEstimatedFee(t);return{gas:BigInt(n||0)}}async sendTransaction(e){const t=_i.state.connection;if(!t||!e.provider)throw new Error("Connection is not set");const r=e.provider,n=e.tokenMint?await _s({provider:r,connection:t,to:e.to,amount:Number(e.value),tokenMint:e.tokenMint}):await Is({provider:r,connection:t,to:e.to,value:Number.isNaN(Number(e.value))?0:Number(e.value)}),i=await r.sendTransaction(n,t);return await new Promise(e=>{const r=setInterval(async()=>{const n=await t.getSignatureStatus(i);n?.value&&(clearInterval(r),e())},1e3)}),{hash:i}}parseUnits(){return 0n}formatUnits(){return""}async connect(e){const t=this.connectors.find(t=>t.id===e.id);if(!t)throw new Error("Provider not found");const r={...t,...e.id===o.o.CONNECTOR_ID.AUTH?{provider:t}:{}},n=e.rpcUrl||this.getCaipNetworks()?.find(t=>t.id===e.chainId)?.rpcUrls.default.http[0];if(!n)throw new Error(`RPC URL not found for chainId: ${e.chainId}`);const i=this.connectionManager?.getConnection({address:e.address,connectorId:t.id,connections:this.connections,connectors:this.connectors});if(i?.account)return this.emit("accountChanged",{address:i.account.address,chainId:i.caipNetwork?.id,connector:r}),{id:t.id,address:i.account.address,chainId:e.chainId,provider:t,type:t.type};const s=await t.connect({chainId:e.chainId,socialUri:e.socialUri});_i.setConnection(new Kn(n,this.connectionSettings)),this.emit("accountChanged",{address:s,chainId:e.chainId,connector:r});const a=t.id===o.o.CONNECTOR_ID.AUTH,c=this.getCaipNetworks()?.find(t=>t.id===e.chainId);return this.addConnection({connectorId:t.id,accounts:[{address:s}],caipNetwork:c,auth:a?{name:v.i.getConnectedSocialProvider(),username:v.i.getConnectedSocialUsername()}:void 0}),t.id!==o.o.CONNECTOR_ID.WALLET_CONNECT&&this.listenSolanaProviderEvents(t.id,t.provider),{id:t.id,address:s,chainId:e.chainId,provider:t,type:t.type}}async getBalance(e){const t=e.address,r=this.getCaipNetworks()?.find(t=>t.id===e.chainId);if(!t)return Promise.resolve({balance:"0.00",symbol:"SOL"});const n=new Kn(r?.rpcUrls?.default?.http?.[0],this.connectionSettings),i=`${r?.caipNetworkId}:${e.address}`,s=this.balancePromises[i];if(s)return s;const o=v.i.getNativeBalanceCacheForCaipAddress(i);return o?{balance:o.balance,symbol:o.symbol}:(this.balancePromises[i]=new Promise(async r=>{try{const s=(await n.getBalance(new Qe(t))/ci.w.LAMPORTS_PER_SOL).toString();if(v.i.updateNativeBalanceCache({caipAddress:i,balance:s,symbol:e.caipNetwork?.nativeCurrency.symbol||"SOL",timestamp:Date.now()}),!e.caipNetwork)throw new Error("caipNetwork is required");r({balance:s,symbol:e.caipNetwork?.nativeCurrency.symbol})}catch(e){r({balance:"0.00",symbol:"SOL"})}}).finally(()=>{delete this.balancePromises[i]}),this.balancePromises[i]||{balance:"0.00",symbol:"SOL"})}async switchNetwork(e){await super.switchNetwork(e);const{caipNetwork:t}=e;t?.rpcUrls?.default?.http?.[0]&&_i.setConnection(new Kn(t.rpcUrls.default.http[0],this.connectionSettings))}listenProviderEvents(){}listenSolanaProviderEvents(e,t){if(Js.includes(e))return;const r=t=>{this.onAccountsChanged([t.toBase58()],e,!1)},n=()=>this.onDisconnect(e);this.providerHandlers[e]||(t.on("disconnect",n),t.on("accountsChanged",r),t.on("connect",r),this.providerHandlers[e]={provider:t,disconnect:n,accountsChanged:r,chainChanged:()=>{}})}async setUniversalProvider(e){this.universalProvider=e;const t=o.o.CONNECTOR_ID.WALLET_CONNECT;se.listenWcProvider({universalProvider:e,namespace:o.o.CHAIN.SOLANA,onConnect:e=>this.onConnect(e,t),onDisconnect:()=>this.onDisconnect(t),onAccountsChanged:e=>this.onAccountsChanged(e,t,!1)});const r=new bi({provider:e,chains:this.getCaipNetworks(),getActiveChain:()=>m.W.getCaipNetworkByNamespace(this.namespace)});if(this.registerWalletStandard){const{SolanaWalletConnectStandardWallet:t}=await i.e(7394).then(i.bind(i,7394));t.register(e)}return this.addConnector(r),Promise.resolve()}async connectWalletConnect(e){const t=await super.connectWalletConnect(e),r=this.getCaipNetworks()?.find(t=>t.id===e)?.rpcUrls.default.http[0],n=new Kn(r,this.connectionSettings);return _i.setConnection(n),t}async disconnect(e){if(e.id){const t=this.connectors.find(t=>t.id===e.id);if(!t)throw new Error("Provider not found");const r=this.connections.find(t=>_.y.isLowerCaseMatch(t.connectorId,e.id));return await t.provider.disconnect(),this.deleteConnection(t.id),0===this.connections.length?this.emit("disconnect"):this.emitFirstAvailableConnection(),{connections:r?[r]:[]}}return this.disconnectAll()}async syncConnection(e){return this.connect({...e,type:""})}async syncConnections({connectToFirstConnector:e,caipNetwork:t,getConnectorStorageInfo:r}){await(this.connectionManager?.syncConnections({connectors:this.connectors,caipNetwork:t,caipNetworks:this.getCaipNetworks(),universalProvider:this.universalProvider,onConnection:this.addConnection.bind(this),onListenProvider:this.listenSolanaProviderEvents.bind(this),getConnectionStatusInfo:r})),e&&this.emitFirstAvailableConnection()}getWalletConnectProvider(e){return new bi({provider:e.provider,chains:e.caipNetworks,getActiveChain:()=>m.W.getCaipNetworkByNamespace(this.namespace)})}async disconnectAll(){return{connections:await Promise.all(this.connections.map(async e=>{const t=this.connectors.find(t=>_.y.isLowerCaseMatch(t.id,e.connectorId));if(!t)throw new Error("Connector not found");return await this.disconnect({id:t.id}),e}))}}},uo=(co={adapters:[lo],networks:[te,re],metadata:{name:"Roast Rush",description:"Roast Rush game",url:"https://roastrush.ai/",icons:["icons/icon-16.png"]},projectId:"61f529aa30c77838f2502740d05202ad",features:{analytics:!0}},new class extends me{async onAuthProviderConnected(e){e.message&&e.signature&&e.siwxMessage&&await c.U.addEmbeddedWalletSession({chainId:e.siwxMessage.chainId,accountAddress:e.address,notBefore:e.siwxMessage.notBefore,statement:e.siwxMessage.statement,resources:e.siwxMessage.resources,requestId:e.siwxMessage.requestId,issuedAt:e.siwxMessage.issuedAt,domain:e.siwxMessage.domain,uri:e.siwxMessage.uri,version:e.siwxMessage.version,nonce:e.siwxMessage.nonce},e.message,e.signature);const t=m.W.state.activeChain;if(!t)throw new Error("AppKit:onAuthProviderConnected - namespace is required");const r=t===o.o.CHAIN.EVM?`eip155:${e.chainId}:${e.address}`:`${e.chainId}:${e.address}`,n=y.H.state.defaultAccountTypes[t],i=(0,l.lj)(t),s=e.preferredAccountType||i||n;this.setCaipAddress(r,t);const{signature:a,siwxMessage:u,message:h,...d}=e;this.setUser({...w.U.state.user||{},...d},t),this.setSmartAccountDeployed(Boolean(e.smartAccountDeployed),t),this.setPreferredAccountType(s,t),this.setLoading(!1,t)}setupAuthConnectorListeners(e){e.onRpcRequest(t=>{C.Q.checkIfRequestExists(t)?C.Q.checkIfRequestIsSafe(t)||this.handleUnsafeRPCRequest():(this.open(),console.error(k.Vl.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:t.method}),setTimeout(()=>{this.showErrorMessage(k.Vl.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close():this.popTransactionStack("error"))}),e.onRpcSuccess((e,t)=>{const r=C.Q.checkIfRequestIsSafe(t),n=w.U.state.address,i=m.W.state.activeCaipNetwork;r||(n&&i?.id&&this.updateNativeBalance(n,i.id,i.chainNamespace),this.isTransactionStackEmpty()?this.close():this.popTransactionStack("success"))}),e.onNotConnected(()=>{const e=m.W.state.activeChain;if(!e)throw new Error("AppKit:onNotConnected - namespace is required");u.a.getConnectorId(e)===o.o.CONNECTOR_ID.AUTH&&(this.setCaipAddress(void 0,e),this.setLoading(!1,e))}),e.onConnect(this.onAuthProviderConnected.bind(this)),e.onSocialConnected(this.onAuthProviderConnected.bind(this)),e.onSetPreferredAccount(({address:e,type:t})=>{const r=m.W.state.activeChain;if(!r)throw new Error("AppKit:onSetPreferredAccount - namespace is required");e&&this.setPreferredAccountType(t,r)})}async syncAuthConnectorTheme(e){if(!e)return;const t=b.W.getSnapshot(),r=y.H.getSnapshot();await Promise.all([e.syncDappData({metadata:r.metadata,sdkVersion:r.sdkVersion,projectId:r.projectId,sdkType:r.sdkType}),e.syncTheme({themeMode:t.themeMode,themeVariables:t.themeVariables,w3mThemeVariables:(0,a.o)(t.themeVariables,t.themeMode)})])}async syncAuthConnector(e,t){const r=o.o.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(t),n=t===m.W.state.activeChain;if(!r)return;this.setLoading(!0,t);const i=e.getLoginEmailUsed();this.setLoading(i,t),i&&this.setStatus("connecting",t);const s=e.getEmail(),a=e.getUsername();this.setUser({...w.U.state?.user||{},username:a,email:s},t),this.setupAuthConnectorListeners(e);const{isConnected:c}=await e.isConnected();if(await this.syncAuthConnectorTheme(e),t&&r&&n){const r=await e.getSmartAccountEnabledNetworks();m.W.setSmartAccountEnabledNetworks(r?.smartAccountEnabledNetworks||[],t),c&&this.connectionControllerClient?.connectExternal?(await(this.connectionControllerClient?.connectExternal({id:o.o.CONNECTOR_ID.AUTH,info:{name:o.o.CONNECTOR_ID.AUTH},type:A.o.CONNECTOR_TYPE_AUTH,provider:e,chainId:m.W.state.activeCaipNetwork?.id,chain:t})),this.setStatus("connected",t)):u.a.getConnectorId(t)===o.o.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",t),v.i.removeConnectedNamespace(t))}this.setLoading(!1,t)}async checkExistingTelegramSocialConnection(e){try{if(!s.w.isTelegram())return;const t=v.i.getTelegramSocialProvider();if(!t)return;if(!s.w.isClient())return;const r=new URL(window.location.href).searchParams.get("result_uri");if(!r)return;w.U.setSocialProvider(t,e),await(this.authProvider?.init());const n=u.a.getAuthConnector();t&&n&&(this.setLoading(!0,e),await h.x.connectExternal({id:n.id,type:n.type,socialUri:r},n.chain),v.i.setConnectedSocialProvider(t),v.i.removeTelegramSocialProvider(),d.E.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:t}}))}catch(t){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",t)}try{const e=new URL(window.location.href);e.searchParams.delete("result_uri"),window.history.replaceState({},document.title,e.toString())}catch(e){console.error("tma social login failed",e)}}createAuthProvider(e){if(!o.o.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const t=this.remoteFeatures?.email,r=Array.isArray(this.remoteFeatures?.socials)&&this.remoteFeatures.socials.length>0,n=t||r,i=_.y.getActiveNamespaceConnectedToAuth()||e;!this.authProvider&&this.options?.projectId&&n&&(this.authProvider=x.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:this.getCaipNetwork(i)?.caipNetworkId,abortController:I.R.EmbeddedWalletAbortController,onTimeout:e=>{"iframe_load_failed"===e?E.h.open(I.R.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):"iframe_request_timeout"===e?E.h.open(I.R.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):"unverified_domain"===e&&E.h.open(I.R.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:e=>(0,l.kg)(e),getCaipNetworks:e=>m.W.getCaipNetworks(e)}),p.z.subscribeOpen(e=>{!e&&this.isTransactionStackEmpty()&&this.authProvider?.rejectRpcRequests()}));const s=e===m.W.state.activeChain&&y.H.state.enableReconnect;!1===y.H.state.enableReconnect?this.syncAuthConnectorTheme(this.authProvider):this.authProvider&&s&&(this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){this.createAuthProvider(e),this.authProvider&&this.chainAdapters?.[e]?.setAuthProvider?.(this.authProvider)}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&f.N.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){if(!e)return;const t=m.W.state.activeChain,r=e.chainNamespace,n=this.getAddressByChainNamespace(r);if(r===t&&n){const t=this.getAdapter(r),n=S.A.getProvider(r),i=S.A.getProviderId(r);await(t?.switchNetwork({caipNetwork:e,provider:n,providerType:i})),this.setCaipNetwork(e)}else{const i=S.A.getProviderId(t)===A.o.CONNECTOR_TYPE_AUTH,s=S.A.getProviderId(r),a=s===A.o.CONNECTOR_TYPE_AUTH,c=o.o.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(r);if(!r)throw new Error("AppKit:switchCaipNetwork - networkNamespace is required");if((i&&void 0===s||a)&&c)try{if(m.W.state.activeChain=e.chainNamespace,n){const t=this.getAdapter(r);await(t?.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:s}))}else await(this.connectionControllerClient?.connectExternal?.({id:o.o.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:r,chainId:e.id,type:A.o.CONNECTOR_TYPE_AUTH,caipNetwork:e}));this.setCaipNetwork(e)}catch(t){const n=this.getAdapter(r);await(n?.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:s}))}else if(s===A.o.CONNECTOR_TYPE_WALLET_CONNECT){if(!m.W.state.noAdapters){const t=this.getAdapter(r),n=S.A.getProvider(r),i=S.A.getProviderId(r);await(t?.switchNetwork({caipNetwork:e,provider:n,providerType:i}))}this.setCaipNetwork(e),this.syncWalletConnectAccount()}else this.setCaipNetwork(e),n&&this.syncAccount({address:n,chainId:e.id,chainNamespace:r})}}async initialize(e){await super.initialize(e),this.chainNamespaces?.forEach(e=>{this.createAuthProviderForAdapter(e)}),await this.injectModalUi(),p.z.set({initialized:!0})}async syncIdentity({address:e,chainId:t,chainNamespace:r}){const n=`${r}:${t}`,i=this.caipNetworks?.find(e=>e.caipNetworkId===n);if(r!==o.o.CHAIN.EVM||i?.testnet)return this.setProfileName(null,r),void this.setProfileImage(null,r);const s=u.a.getConnectorId(r)===o.o.CONNECTOR_ID.AUTH;try{const{name:t,avatar:i}=await this.fetchIdentity({address:e,caipNetworkId:n});!t&&s?await this.syncReownName(e,r):(this.setProfileName(t,r),this.setProfileImage(i,r))}catch{1!==t&&this.setProfileImage(null,r)}}syncConnectedWalletInfo(e){const t=S.A.getProviderId(e);if(t===A.o.CONNECTOR_TYPE_AUTH){const r=this.authProvider;if(r){const n=v.i.getConnectedSocialProvider()??"email",i=r.getEmail()??r.getUsername();this.setConnectedWalletInfo({name:t,identifier:i,social:n},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(s.w.isClient()&&!ye)try{const e={...g.oU.DEFAULT_FEATURES,...this.options.features},t=this.remoteFeatures;if(await this.loadModalComponents(e,t),s.w.isClient()&&!document.querySelector("w3m-modal")){const e=document.createElement("w3m-modal");y.H.state.disableAppend||y.H.state.enableEmbedded||document.body.insertAdjacentElement("beforeend",e)}ye=!0}catch(e){console.error("Error injecting modal UI:",e)}}async loadModalComponents(e,t){if(!s.w.isClient())return;const r=[];(t.email||t.socials&&t.socials.length>0)&&r.push(Promise.all([i.e(6554),i.e(9922),i.e(3796)]).then(i.bind(i,3796))),t.email&&r.push(Promise.all([i.e(6554),i.e(9922),i.e(8831)]).then(i.bind(i,8831))),t.socials&&r.push(Promise.all([i.e(6554),i.e(6283),i.e(3302)]).then(i.bind(i,3302))),t.swaps&&t.swaps.length>0&&r.push(Promise.all([i.e(6554),i.e(9922),i.e(1730),i.e(6311)]).then(i.bind(i,6311))),e.send&&r.push(Promise.all([i.e(6554),i.e(9922),i.e(1730),i.e(6323)]).then(i.bind(i,6323))),e.receive&&r.push(Promise.all([i.e(6554),i.e(6283),i.e(9567)]).then(i.bind(i,9567))),t.onramp&&t.onramp.length>0&&r.push(Promise.all([i.e(6554),i.e(9922),i.e(3548),i.e(218)]).then(i.bind(i,218))),t.activity&&r.push(Promise.all([i.e(6554),i.e(4009),i.e(2676)]).then(i.bind(i,4951))),e.pay&&r.push(Promise.all([i.e(6554),i.e(6056)]).then(i.bind(i,3675))),t.emailCapture&&r.push(Promise.all([i.e(6554),i.e(9922),i.e(8831),i.e(2451)]).then(i.bind(i,2451))),await Promise.all([...r,Promise.all([i.e(6554),i.e(9922),i.e(6283),i.e(3548),i.e(4009),i.e(3158),i.e(4058)]).then(i.bind(i,4058)),Promise.all([i.e(6554),i.e(1730),i.e(3158),i.e(124)]).then(i.bind(i,124))])}}({...co,sdkVersion:s.w.generateSdkVersion(co.adapters??[],"html","1.7.19")})),ho={},po={};uo.subscribeProviders(function(e){var t=(ho=e.solana).getActiveChain().rpcUrls.default.http[0];po=new Zi.Ng(t)});var fo=function(){return e=function e(t){t.net;var r=t.name,n=t.url,i=t.icon,s=t.backendUrl;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.wallets=new Map,this.activeWallet=this.getConnectedWallet(),this.isMobile=!1,this.backendUrl=s,this.APP_IDENTITY={name:r||"Roast Rush",uri:n||"https://ff93-179-42-145-50.ngrok-free.app/",icon:i||"public/icon-16.ico"},this.auth_token=void 0},t=[{key:"getAccountStatus",value:(o=so(ro().m(function e(){var t;return ro().w(function(e){for(;;)switch(e.n){case 0:if(console.log("wait"),!(t=uo.getAccount("solana"))||"connecting"===t.status){e.n=1;break}return e.a(2,t);case 1:if(!t){e.n=3;break}return e.n=2,this.waitForFinalAccountStatus();case 2:t=e.v;case 3:return e.a(2,t)}},e,this)})),function(){return o.apply(this,arguments)})},{key:"waitForFinalAccountStatus",value:(s=so(ro().m(function e(){return ro().w(function(e){for(;;)if(0===e.n)return e.a(2,new Promise(function(e){uo.subscribeAccount(function(t){"connecting"!==t.status&&e(t)},"solana")}))},e)})),function(){return s.apply(this,arguments)})},{key:"setMobile",value:function(e){this.isMobile=e}},{key:"connectWallet",value:(i=so(ro().m(function e(t){var r=this;return ro().w(function(e){for(;;)if(0===e.n)return console.log(t),e.a(2,new Promise(function(){var e=so(ro().m(function e(n,i){var s,o,a,c;return ro().w(function(e){for(;;)switch(e.n){case 0:if(s=function(){var e=so(ro().m(function e(n,i){var s,o;return ro().w(function(e){for(;;)switch(e.n){case 0:return s={"Content-Type":"application/json"},i&&(s.Authorization="Bearer ".concat(i)),e.n=1,fetch("".concat(r.backendUrl,"/auth/nonce"),{method:"POST",headers:s,body:JSON.stringify({address:n,referKey:t})});case 1:if((o=e.v).ok){e.n=2;break}throw new Error("Error in call a /auth/nonce");case 2:return e.a(2,o.json())}},e)}));return function(t,r){return e.apply(this,arguments)}}(),o=function(){var e=so(ro().m(function e(t){var o,a,c,l,u,h,d;return ro().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,o=localStorage.getItem("jwt-".concat(t.address)),e.n=1,s(t.address,o);case 1:if(a=e.v,console.log(a),!a.token){e.n=2;break}return localStorage.setItem("jwt-".concat(t.address),a.token),n(eo(eo({},a),{},{account:t})),e.a(2);case 2:return c=(new TextEncoder).encode(a.nonce),e.n=3,ho.signMessage(c);case 3:return l=e.v,e.n=4,fetch("".concat(r.backendUrl,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({publicKey:t.address,signature:l,nonce:a.nonce})});case 4:if((u=e.v).ok){e.n=5;break}throw new Error("Login failed");case 5:return e.n=6,u.json();case 6:h=e.v,n(h),e.n=8;break;case 7:e.p=7,d=e.v,i(d);case 8:return e.a(2)}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),!(a=uo.getAccount("solana"))||!a.isConnected){e.n=1;break}return o(a),e.a(2);case 1:uo.open(),c=uo.subscribeState(function(e){if(!e.open){c();var t=uo.getAccount("solana");if(!t)return void i(new Error("No wallet connected"));o(t)}});case 2:return e.a(2)}},e)}));return function(t,r){return e.apply(this,arguments)}}()))},e)})),function(e){return i.apply(this,arguments)})},{key:"disconnectWallet",value:(n=so(ro().m(function e(){var t;return ro().w(function(e){for(;;)switch(e.p=e.n){case 0:e.p=0,uo.disconnect("solana"),console.log("Disconnect wallet called"),e.n=2;break;case 1:throw e.p=1,t=e.v,console.error("Error disconnecting wallet:",t),t;case 2:return e.a(2)}},e,null,[[0,1]])})),function(){return n.apply(this,arguments)})},{key:"getConnectedWallet",value:function(){return uo.getAccount("solana").address}},{key:"getWallets",value:function(){var e=uo.getWalletInfo();return e?[{name:e.name,icon:e.icon}]:[]}},{key:"sendTransaction",value:(r=so(ro().m(function e(t,r,n){var i,s,o,a,c,l,u,h;return ro().w(function(e){for(;;)switch(e.p=e.n){case 0:if((i=uo.getAccount("solana"))||i.address){e.n=2;break}return e.n=1,this.connectWallet();case 1:if(i=e.v){e.n=2;break}return console.error("No account found"),e.a(2,{success:!1});case 2:return s=i.address,o=new Zi.J3(s),e.n=3,po.getLatestBlockhash();case 3:return a=e.v,c=new Zi.ZX({feePayer:o,recentBlockhash:null==a?void 0:a.blockhash}).add(Zi.yq.transfer({fromPubkey:o,toPubkey:new Zi.J3(r),lamports:Math.round(n*Math.pow(10,9))})),e.p=4,e.n=5,ho.signTransaction(c);case 5:return l=e.v,e.n=6,po.sendRawTransaction(l.serialize());case 6:return u=e.v,e.n=7,po.confirmTransaction(u);case 7:return e.a(2,{success:!0,signature:u});case 8:return e.p=8,h=e.v,console.error("Error sending transaction:",h),e.a(2,{success:!1,error:h.message})}},e,this,[[4,8]])})),function(e,t,n){return r.apply(this,arguments)})}],t&&oo(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r,n,i,s,o}();const go=fo,mo=Zi.ZX;export{mo as Transaction,go as default,uo as modal,ho as solanaProvider};export const Buffer=we.Buffer;